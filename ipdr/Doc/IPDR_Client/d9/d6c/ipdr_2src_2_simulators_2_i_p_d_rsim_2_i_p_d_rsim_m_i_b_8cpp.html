<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>IPDRAPI: ipdr/src/Simulators/IPDRsim/IPDRsimMIB.cpp File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.2 -->
<div class="qindex"><a class="qindex" href="../../index.html">Main&nbsp;Page</a> | <a class="qindex" href="../../modules.html">Modules</a> | <a class="qindex" href="../../namespaces.html">Namespace List</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="../../dirs.html">Directories</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="../../globals.html">Globals</a></div>
<div class="nav">
<a class="el" href="../../dir_000003.html">ipdr</a>&nbsp;/&nbsp;<a class="el" href="../../dir_000010.html">src</a>&nbsp;/&nbsp;<a class="el" href="../../dir_000020.html">Simulators</a>&nbsp;/&nbsp;<a class="el" href="../../dir_000021.html">IPDRsim</a></div>
<h1>IPDRsimMIB.cpp File Reference</h1><code>#include &lt;<a class="el" href="../../d4/d3a/ipdr_2include_2_i_p_d_r_2_config_8h.html">IPDR/Config.h</a>&gt;</code><br>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;arpa/inet.h&gt;</code><br>
<code>#include &lt;agentx.h&gt;</code><br>
<code>#include &lt;<a class="el" href="../../de/d8c/ipdr_2include_2_i_p_d_r_2_i_p_d_r_8h.html">IPDR/IPDR.h</a>&gt;</code><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">agentx_errortype_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d6c/ipdr_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_m_i_b_8cpp.html#a1">IPDRAgent_Get</a> (int Nsubids, u_int *subids, agentx_varbind_t *varbind, int map)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d6c/ipdr_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_m_i_b_8cpp.html#a2">IPDRAgent_GetNext</a> (agentx_oid_t *oid, int base_len, int map)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">agentx_errortype_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d6c/ipdr_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_m_i_b_8cpp.html#a3">IPDRAgent_Test</a> (int Nsubids, u_int *subids, agentx_varbind_t *varbind, int map)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">agentx_errortype_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d6c/ipdr_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_m_i_b_8cpp.html#a4">IPDRAgent_Commit</a> (int Nsubids, u_int *subids, agentx_varbind_t *varbind, int map)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">agentx_errortype_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d6c/ipdr_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_m_i_b_8cpp.html#a5">IPDRAgent_Undo</a> (int Nsubids, u_int *subids, agentx_varbind_t *varbind, int map)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">agentx_errortype_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d6c/ipdr_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_m_i_b_8cpp.html#a6">IPDRAgent_Clean</a> (int Nsubids, u_int *subids, agentx_varbind_t *varbind, int map)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d6c/ipdr_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_m_i_b_8cpp.html#a7">IPDRAgent_Initialize</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a> C)</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d6c/ipdr_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_m_i_b_8cpp.html#a0">IPDRsimMIB_rcsid</a> []</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a6" doxytag="IPDRsimMIB.cpp::IPDRAgent_Clean"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">agentx_errortype_t IPDRAgent_Clean           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>Nsubids</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u_int *&nbsp;</td>
          <td class="mdname" nowrap> <em>subids</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>agentx_varbind_t *&nbsp;</td>
          <td class="mdname" nowrap> <em>varbind</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>map</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00184 {
00185     <span class="keywordflow">return</span> agentx_noError;
00186 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="IPDRsimMIB.cpp::IPDRAgent_Commit"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">agentx_errortype_t IPDRAgent_Commit           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>Nsubids</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u_int *&nbsp;</td>
          <td class="mdname" nowrap> <em>subids</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>agentx_varbind_t *&nbsp;</td>
          <td class="mdname" nowrap> <em>varbind</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>map</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00172 {
00173     <span class="keywordflow">return</span> agentx_noError;
00174 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="IPDRsimMIB.cpp::IPDRAgent_Get"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">agentx_errortype_t IPDRAgent_Get           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>Nsubids</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u_int *&nbsp;</td>
          <td class="mdname" nowrap> <em>subids</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>agentx_varbind_t *&nbsp;</td>
          <td class="mdname" nowrap> <em>varbind</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>map</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00037 {
00038     <a class="code" href="../../d5/d79/struct_i_p_d_r___o_i_d.html">IPDR_OID</a> O;
00039     <span class="keywordtype">int</span> i;
00040     <span class="keyword">const</span> <span class="keywordtype">char</span> *Value;
00041     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status;
00042     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Type;
00043     <span class="keywordtype">long</span> <span class="keywordtype">long</span> l;
00044     <a class="code" href="../../db/d2e/_for_doxygen_2include_2_i_p_d_r_2_defs_8h.html#a16">IPDR_BOOL</a> Persistent, Writable;
00045 
00046     <span class="comment">/* build a IPDR_OID corresponding to the received subids */</span>
00047     O.<a class="code" href="../../d5/d79/struct_i_p_d_r___o_i_d.html#o0">Length</a> = Nsubids;
00048     <span class="keywordflow">for</span> (i = 0; i &lt; Nsubids; i++) {
00049         O.<a class="code" href="../../d5/d79/struct_i_p_d_r___o_i_d.html#o1">OIDArray</a>[i] = subids[i];
00050     }
00051 
00052     Status = IPDR_MIBGet(g_ExporterH, &amp; O, &amp; Value, &amp; Type, &amp;Persistent, &amp;Writable);
00053     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(Status)) {
00054         <span class="keywordflow">return</span> agentx_noSuchName;
00055     }
00056 
00057     <span class="keywordflow">if</span> (Value == NULL) {
00058         varbind-&gt;type = agentx_Null;
00059         <span class="keywordflow">return</span> agentx_noError;
00060     }
00061 
00062     <span class="keywordflow">switch</span> (Type) {
00063     <span class="keywordflow">case</span> <a class="code" href="../../df/dcb/group___i_p_d_r__key__type__attributes.html#gga67a145">XDR_TYPE_IPV4ADDR</a>:
00064         varbind-&gt;type = agentx_IpAddress;
00065         i = inet_addr(Value);
00066         agentx_ostrcpy(&amp; (varbind-&gt;data.ostr_data), 4, (u_char *) &amp; i);
00067         <span class="keywordflow">break</span>;
00068     <span class="keywordflow">case</span> <a class="code" href="../../df/dcb/group___i_p_d_r__key__type__attributes.html#gga67a138">XDR_TYPE_BOOLEAN</a>:
00069         varbind-&gt;type = agentx_Integer;
00070         varbind-&gt;data.int_data = atoi(Value);
00071         <span class="keywordflow">break</span>;
00072     <span class="keywordflow">case</span> <a class="code" href="../../df/dcb/group___i_p_d_r__key__type__attributes.html#gga67a129">XDR_TYPE_INT</a>:
00073     <span class="keywordflow">case</span> <a class="code" href="../../df/dcb/group___i_p_d_r__key__type__attributes.html#gga67a130">XDR_TYPE_UINT</a>:
00074         varbind-&gt;type = agentx_Integer;
00075         varbind-&gt;data.int_data = atoi(Value);
00076         <span class="keywordflow">break</span>;
00077     <span class="keywordflow">case</span> <a class="code" href="../../df/dcb/group___i_p_d_r__key__type__attributes.html#gga67a131">XDR_TYPE_LONG</a>:
00078     <span class="keywordflow">case</span> <a class="code" href="../../df/dcb/group___i_p_d_r__key__type__attributes.html#gga67a132">XDR_TYPE_ULONG</a>:
00079         l = <span class="comment">/*atoll(Value)*/</span> strtoll(Value, (<span class="keywordtype">char</span> **)NULL, 10);
00080         varbind-&gt;type = agentx_Counter64;
00081         memcpy(&amp; (varbind-&gt;data.counter64), &amp; l, <span class="keyword">sizeof</span>(<span class="keywordtype">long</span> <span class="keywordtype">long</span>));
00082         <span class="keywordflow">break</span>;
00083     <span class="keywordflow">case</span> <a class="code" href="../../df/dcb/group___i_p_d_r__key__type__attributes.html#gga67a137">XDR_TYPE_STRING</a>:
00084         varbind-&gt;type = agentx_OctetString;
00085         agentx_ostrcpy(&amp; (varbind-&gt;data.ostr_data), strlen(Value), (u_char*) Value);
00086         <span class="keywordflow">break</span>;
00087     }
00088 
00089     <span class="keywordflow">return</span> agentx_noError;
00090 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="IPDRsimMIB.cpp::IPDRAgent_GetNext"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int IPDRAgent_GetNext           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">agentx_oid_t *&nbsp;</td>
          <td class="mdname" nowrap> <em>oid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>base_len</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>map</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00093 {
00094     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status;
00095     <a class="code" href="../../d5/d79/struct_i_p_d_r___o_i_d.html">IPDR_OID</a> O, NextOID;
00096     <span class="keywordtype">int</span> i;
00097     <span class="keyword">const</span> <span class="keywordtype">char</span> *Value;
00098     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Type;
00099     <a class="code" href="../../db/d2e/_for_doxygen_2include_2_i_p_d_r_2_defs_8h.html#a16">IPDR_BOOL</a> Persistent, Writable;
00100 
00101     <span class="comment">/* build a IPDR_OID corresponding to the received subids */</span>
00102     O.<a class="code" href="../../d5/d79/struct_i_p_d_r___o_i_d.html#o0">Length</a> = oid-&gt;Nsubid - base_len;
00103     <span class="keywordflow">for</span> (i = 0; i &lt; oid-&gt;Nsubid - base_len; i++)
00104         O.<a class="code" href="../../d5/d79/struct_i_p_d_r___o_i_d.html#o1">OIDArray</a>[i] = oid-&gt;subids[i + base_len];
00105 
00106     <span class="comment">/* if the get next is inclusive, check if the current oid exists within</span>
00107 <span class="comment">       the MIB */</span>
00108     <span class="keywordflow">if</span> (oid-&gt;include == 1) {
00109         Status = IPDR_MIBGet(g_ExporterH, &amp; O, &amp; Value, &amp; Type, &amp;Persistent, &amp;Writable);
00110         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a17">SUCCESS</a>(Status))
00111             <span class="keywordflow">return</span> AGENTX_OK;
00112     }
00113 
00114     Status = IPDR_MIBGetNext(g_ExporterH, &amp; O, &amp; NextOID);
00115     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(Status)) {
00116         <span class="keywordflow">return</span> AGENTX_NOTFOUND;
00117     }
00118 
00119     <span class="comment">/* copy the result to the oid */</span>
00120     oid-&gt;Nsubid = NextOID.<a class="code" href="../../d5/d79/struct_i_p_d_r___o_i_d.html#o0">Length</a> + base_len;
00121     <span class="keywordflow">for</span> (i = 0; i &lt; NextOID.<a class="code" href="../../d5/d79/struct_i_p_d_r___o_i_d.html#o0">Length</a>; i++) {
00122         oid-&gt;subids[i + base_len] = NextOID.<a class="code" href="../../d5/d79/struct_i_p_d_r___o_i_d.html#o1">OIDArray</a>[i];
00123     }
00124 
00125     <span class="keywordflow">return</span> AGENTX_OK;
00126 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="IPDRsimMIB.cpp::IPDRAgent_Initialize"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void IPDRAgent_Initialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>C</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00189 {
00190     <span class="keywordtype">int</span> s, reg, map;
00191     agentx_oid_t oid;
00192 
00193     g_ExporterH = C;
00194 
00195     <span class="keywordflow">if</span> (agentx_init(NULL) != <a class="code" href="../../db/d2e/_for_doxygen_2include_2_i_p_d_r_2_defs_8h.html#a2">TRUE</a>) {
00196         fprintf(stderr, <span class="stringliteral">"Unable to initialize AgentX\n"</span>);
00197         exit(1);
00198     }
00199 
00200     oid.subids = agentx_newoid(<a class="code" href="../../d4/db0/group___i_p_d_r__transmitter___m_i_b.html#ga12">IPDR_MIB_ROOT_OID_LENGTH</a>,
00201                                IPDR_MIB_ROOT_OID_INTS <span class="comment">/* 1, 3, 6, 1, 4, 4316, 2*/</span>);
00202     oid.include = 0;
00203     oid.Nsubid = <a class="code" href="../../d4/db0/group___i_p_d_r__transmitter___m_i_b.html#ga12">IPDR_MIB_ROOT_OID_LENGTH</a> - 1;
00204 
00205     s = agentx_open(60 <span class="comment">/* seconds timeout */</span>, &amp; oid, <span class="stringliteral">"crane"</span>);
00206     <span class="keywordflow">if</span> (s == AGENTX_NOTRUNNING) {
00207         fprintf(stderr, <span class="stringliteral">"Unable to open AgentX session\n"</span>);
00208         exit(1);
00209     }
00210 
00211     <span class="comment">/* agentx_setdebug(10); */</span>
00212 
00213     reg = agentx_register(s, 0, 0, 1, <a class="code" href="../../d4/db0/group___i_p_d_r__transmitter___m_i_b.html#ga12">IPDR_MIB_ROOT_OID_LENGTH</a>,
00214                           agentx_newoid(<a class="code" href="../../d4/db0/group___i_p_d_r__transmitter___m_i_b.html#ga12">IPDR_MIB_ROOT_OID_LENGTH</a>,
00215                                         IPDR_MIB_ROOT_OID_INTS <span class="comment">/* 1, 3, 6, 1, 4, 4316, 2 */</span>));
00216 
00217     map = agentx_mapget(reg, 0, NULL, <a class="code" href="../../d3/dd8/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_m_i_b_8cpp.html#a1">IPDRAgent_Get</a>, <a class="code" href="../../d3/dd8/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_m_i_b_8cpp.html#a2">IPDRAgent_GetNext</a>);
00218     agentx_mapset(map, <a class="code" href="../../d3/dd8/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_m_i_b_8cpp.html#a3">IPDRAgent_Test</a>, <a class="code" href="../../d3/dd8/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_m_i_b_8cpp.html#a4">IPDRAgent_Commit</a>,
00219                   <a class="code" href="../../d3/dd8/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_m_i_b_8cpp.html#a5">IPDRAgent_Undo</a>, <a class="code" href="../../d3/dd8/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_m_i_b_8cpp.html#a6">IPDRAgent_Clean</a>);
00220 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="IPDRsimMIB.cpp::IPDRAgent_Test"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">agentx_errortype_t IPDRAgent_Test           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>Nsubids</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u_int *&nbsp;</td>
          <td class="mdname" nowrap> <em>subids</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>agentx_varbind_t *&nbsp;</td>
          <td class="mdname" nowrap> <em>varbind</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>map</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00130 {
00131     <span class="keywordtype">char</span> Buf[1024];
00132     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *Addr;
00133     <span class="keywordtype">long</span> <span class="keywordtype">long</span> l;
00134     <a class="code" href="../../d5/d79/struct_i_p_d_r___o_i_d.html">IPDR_OID</a> O;
00135     <span class="keywordtype">int</span> i;
00136 
00137     <span class="comment">/* build a IPDR_OID corresponding to the received subids */</span>
00138     O.<a class="code" href="../../d5/d79/struct_i_p_d_r___o_i_d.html#o0">Length</a> = Nsubids;
00139     <span class="keywordflow">for</span> (i = 0; i &lt; Nsubids; i++) {
00140         O.<a class="code" href="../../d5/d79/struct_i_p_d_r___o_i_d.html#o1">OIDArray</a>[i] = subids[i];
00141     }
00142 
00143     <span class="keywordflow">switch</span> (varbind-&gt;type) {
00144     <span class="keywordflow">case</span> agentx_Integer:
00145         sprintf(Buf, <span class="stringliteral">"%d"</span>, varbind-&gt;data.int_data);
00146         <span class="keywordflow">break</span>;
00147     <span class="keywordflow">case</span> agentx_OctetString:
00148         memcpy(Buf, varbind-&gt;data.ostr_data.data, varbind-&gt;data.ostr_data.len);
00149         Buf[varbind-&gt;data.ostr_data.len] = <span class="charliteral">'\0'</span>;
00150         <span class="keywordflow">break</span>;
00151     <span class="keywordflow">case</span> agentx_IpAddress:
00152         Addr = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) varbind-&gt;data.ostr_data.data;
00153         sprintf(Buf, <span class="stringliteral">"%d.%d.%d.%d"</span>, Addr[0], Addr[1], Addr[2], Addr[3]);
00154         <span class="keywordflow">break</span>;
00155     <span class="keywordflow">case</span> agentx_Counter64:
00156         l = *((<span class="keywordtype">long</span> <span class="keywordtype">long</span> *) &amp; (varbind-&gt;data));
00157         sprintf(Buf, <span class="stringliteral">"%lld"</span>, l);
00158         <span class="keywordflow">break</span>;
00159     <span class="keywordflow">default</span>:
00160         <span class="keywordflow">return</span> agentx_wrongType;
00161     }
00162 
00163     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(IPDR_MIBSet(g_ExporterH, &amp; O, Buf))) {
00164         <span class="keywordflow">return</span> agentx_notWritable;
00165     }
00166 
00167     <span class="keywordflow">return</span> agentx_noError;
00168 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="IPDRsimMIB.cpp::IPDRAgent_Undo"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">agentx_errortype_t IPDRAgent_Undo           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>Nsubids</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>u_int *&nbsp;</td>
          <td class="mdname" nowrap> <em>subids</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>agentx_varbind_t *&nbsp;</td>
          <td class="mdname" nowrap> <em>varbind</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>map</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00178 {
00179     <span class="keywordflow">return</span> agentx_noError;
00180 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a0" doxytag="IPDRsimMIB.cpp::IPDRsimMIB_rcsid"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char <a class="el" href="../../d9/d6c/ipdr_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_m_i_b_8cpp.html#a0">IPDRsimMIB_rcsid</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment"> <span class="stringliteral">"@(#) $Id: IPDRsimMIB.cpp,v 1.12 2005/03/29 09:46:07 dmitryk Exp $"</span> <a class="code" href="../../d4/de2/_for_doxygen_2include_2_i_p_d_r_2_config_8h.html#a0">IPDR_COPYRIGHT_STR</a>





 




<span class="keyword">static</span> <a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a> g_ExporterH
</pre></div>.cpp<p>
Implementation of an SNMP agent, using the public-domain CMU AgentX code.<p>
Copyright (2005) Â© Amdocs, All Rights Reserved<p>
This software is distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND either expresses or implied.<p>
<dl compact><dt><b>Id</b></dt><dd>IPDRsimMIB.cpp,v 1.12 2005/03/29 09:46:07 dmitryk Exp </dd></dl>
<p>
The public-domain codee can be obtained from <a href="ftp://ftp.net.cmu.edu/pub/snmp/cmu-snmp-V1.10.tar.gz">ftp://ftp.net.cmu.edu/pub/snmp/cmu-snmp-V1.10.tar.gz</a> (or later), <a href="http://www.net.cmu.edu/projects/snmp/,">http://www.net.cmu.edu/projects/snmp/,</a> <a href="ftp://ftp.net.cmu.edu/projects/snmp">ftp://ftp.net.cmu.edu/projects/snmp</a>     </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Mon Apr 25 09:26:33 2005 for IPDRAPI by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.2 </small></address>
</body>
</html>
