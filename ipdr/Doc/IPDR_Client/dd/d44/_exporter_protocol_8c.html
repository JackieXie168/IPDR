<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>IPDRAPI: For Doxygen/src/Exporter/ExporterProtocol.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.2 -->
<div class="qindex"><a class="qindex" href="../../index.html">Main&nbsp;Page</a> | <a class="qindex" href="../../modules.html">Modules</a> | <a class="qindex" href="../../namespaces.html">Namespace List</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="../../dirs.html">Directories</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="../../globals.html">Globals</a></div>
<div class="nav">
<a class="el" href="../../dir_000000.html">For Doxygen</a>&nbsp;/&nbsp;<a class="el" href="../../dir_000003.html">src</a>&nbsp;/&nbsp;<a class="el" href="../../dir_000006.html">Exporter</a></div>
<h1>ExporterProtocol.c File Reference</h1><code>#include &lt;<a class="el" href="../../d4/d71/_config_8h.html">IPDR/Config.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="../../db/d1e/_protocol_8h.html">Common/Protocol.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="../../d8/d75/_exporter_protocol_8h.html">Exporter/ExporterProtocol.h</a>&gt;</code><br>
<code>#include &lt;stddef.h&gt;</code><br>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &lt;<a class="el" href="../../d5/d93/_transport_8h.html">Common/Transport.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="../../d1/d4c/_common_util_8h.html">Common/CommonUtil.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="../../d1/dc1/_templates_8h.html">Exporter/Templates.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="../../d0/dc0/_exporter_msgs_8h.html">Exporter/ExporterMsgs.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="../../d9/d7b/_protocol_debug_8h.html">Exporter/ProtocolDebug.h</a>&gt;</code><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../df/dde/_defs_8h.html#a16">IPDR_BOOL</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a4">ExporterProtocol_NeedSessionID</a> (unsigned char MessageID)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a5">ExporterProtocol_CollectorSession</a> (<a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html">CollectorSession</a> **CS, <a class="el" href="../../df/dde/_defs_8h.html#a16">IPDR_BOOL</a> *High, <a class="el" href="../../df/dde/_defs_8h.html#a16">IPDR_BOOL</a> allStates)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a6">ExporterProtocol_SyncTemplateDataAll</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a7">ExporterProtocol_ConnectWaitWaitBestCollectorCallback</a> (void *Arg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a8">ExporterProtocol_GetFieldDescriptorDataLength</a> (<a class="el" href="../../de/d6f/struct_i_p_d_r__tag___key.html">Key</a> *K)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a9">ExporterProtocol_GetTemplateBlockDataLength</a> (<a class="el" href="../../da/d62/struct_i_p_d_r__tag___template.html">Template</a> *T)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a10">ExporterProtocol_GetTemplateDataMsgLen</a> (<a class="el" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html">TransmissionContext</a> *TC)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a11">ExporterProtocol_GetTemplatesResponseMsgLen</a> (<a class="el" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html">TransmissionContext</a> *TC)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a12">ExporterProtocol_GetSessionBlockDataLength</a> (<a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a13">ExporterProtocol_GetSessionsResponseMsgLen</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a14">ExporterProtocol_WriteShort</a> (unsigned short Short, unsigned char **Buffer)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a15">ExporterProtocol_WriteInt</a> (unsigned int Int, unsigned char **Buffer)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a16">ExporterProtocol_WriteTime</a> (<a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga10">IPDR_Time</a> Time, unsigned char **Buffer)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a17">ExporterProtocol_WriteLong</a> (long long Long, unsigned char **Buffer)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a18">ExporterProtocol_WriteUF8String</a> (const char *String, unsigned char **Buffer)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a19">ExporterProtocol_WriteFieldDescriptorBlock</a> (<a class="el" href="../../de/d6f/struct_i_p_d_r__tag___key.html">Key</a> *K, unsigned char **Buffer)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a20">ExporterProtocol_WriteTemplateBlock</a> (<a class="el" href="../../da/d62/struct_i_p_d_r__tag___template.html">Template</a> *T, unsigned char **Buffer)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a21">ExporterProtocol_WriteTemplateData</a> (<a class="el" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html">TransmissionContext</a> *TC, unsigned char *Buffer, <a class="el" href="../../df/dde/_defs_8h.html#a16">IPDR_BOOL</a> Negotiable)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a22">ExporterProtocol_ReadTemplateShort</a> (<a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, short *Short, unsigned char **Buffer, int *LengthLeft)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a23">ExporterProtocol_ReadTemplateInt</a> (<a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, int *Ints, unsigned char **Buffer, int *LengthLeft)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a24">ExporterProtocol_ReadTemplateString</a> (<a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, char **String, unsigned char **Buffer, int *LengthLeft)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a25">ExporterProtocol_ReadFieldDescriptorBlock</a> (<a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../da/d62/struct_i_p_d_r__tag___template.html">Template</a> *T, unsigned char **Buffer, int *LengthLeft)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a26">ExporterProtocol_ReadTemplateBlock</a> (<a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../da/d62/struct_i_p_d_r__tag___template.html">Template</a> **T, unsigned char **Buffer, int *LengthLeft)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a27">ExporterProtocol_ReadTemplateByte</a> (<a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, unsigned char *Byte, unsigned char **Buffer, int *LengthLeft)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a28">ExporterProtocol_GetTemplates</a> (<a class="el" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html">TransmissionContext</a> *TC, unsigned char *Buffer, int RequestID)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a29">ExporterProtocol_KeepAliveInTimerCallback</a> (void *Arg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a30">ExporterProtocol_KeepAliveOutTimerCallback</a> (void *Arg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a31">ExporterProtocol_ConnectResponseTimeoutCallback</a> (void *Arg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a32">ExporterProtocol_TmplDataTimerCallback</a> (void *Arg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a33">ExporterProtocol_SetCollectorCapabilities</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, unsigned int CollCaps)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a34">ExporterProtocol_GetCollectorCapabilities</a> (<a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a35">ExporterProtocol_AutoconnectCallback</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, <a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> C)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a36">ExporterProtocol_ConnectCallback</a> (<a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn, <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga9">IPDR_IPAddress</a> Addr, unsigned short Port, void *Arg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a37">ExporterProtocol_DisconnectCallback</a> (<a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn, void *Arg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a38">ExporterProtocol_DataCallback</a> (<a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> C, <a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *BH, unsigned int MsgLen, void *Arg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a39">ExporterProtocol_FlushRecordsQueue</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, const char *DebugMsg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a40">ExporterProtocol_FillHeader</a> (<a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, char *Msg, unsigned char MessageID, unsigned long MessageLength)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a41">ExporterProtocol_HandleFlowStart</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, const MessageHeader *Msg, <a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a42">ExporterProtocol_HandleFlowStop</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, const MessageHeader *Msg, <a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a43">ExporterProtocol_HandleModifyTemplate</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, const MessageHeader *Msg, <a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a44">ExporterProtocol_HandleFinalTmplDataACK</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, const MessageHeader *Msg, <a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a45">ExporterProtocol_HandleStartNegotiation</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, const MessageHeader *Msg, <a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a46">ExporterProtocol_HandleGetSessions</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, const MessageHeader *Msg, <a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a47">ExporterProtocol_HandleGetTemplates</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, const MessageHeader *Msg, <a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a48">ExporterProtocol_HandleDataACK</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, const MessageHeader *Msg, <a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a49">ExporterProtocol_HandleConnect</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, const MessageHeader *Msg, <a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a50">ExporterProtocol_HandleConnectResponse</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, const MessageHeader *Msg, <a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a51">ExporterProtocol_HandleDisconnect</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, const MessageHeader *Msg, <a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a52">ExporterProtocol_HandleError</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, const MessageHeader *Msg, <a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a53">ExporterProtocol_HandleKeepAlive</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, const MessageHeader *Msg, <a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a54">ExporterProtocol_SendConnect</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, <a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a55">ExporterProtocol_SendConnectResponse</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, <a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a56">ExporterProtocol_SendDisconnect</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, <a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a57">ExporterProtocol_SendError</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, <a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn, enum <a class="el" href="../../db/d1e/_protocol_8h.html#a57">ErrorCode</a> ErrCode, const char *Msg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a58">ExporterProtocol_SendKeepAlive</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, <a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a59">ExporterProtocol_SendSessionStart</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, <a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a60">ExporterProtocol_SendSessionStop</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, <a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn, unsigned short reasonCode, const char *ReasonDescripsion)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a61">ExporterProtocol_SendTemplateData</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, <a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn, <a class="el" href="../../df/dde/_defs_8h.html#a16">IPDR_BOOL</a> Negotiable)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a62">ExporterProtocol_SendModifyTemplateResponse</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, <a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a63">ExporterProtocol_SendStartNegotiationReject</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, <a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a64">ExporterProtocol_SendGetSessionsResponse</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, <a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn, int RequestID)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a65">ExporterProtocol_SendGetTemplatesResponse</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, <a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn, int RequestID)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a66">ExporterProtocol_SendData</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, <a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn, <a class="el" href="../../d4/dc8/struct_i_p_d_r__tag___template_handle.html">IPDR_TemplateHandle</a> TH, const void *Data)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a67">ExporterProtocol_HandleUnknownMsg</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll, const MessageHeader *Msg, <a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a68">ExporterProtocol_KeepAliveInTimerReset</a> (<a class="el" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a> *IC)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a69">ExporterProtocol_KeepAliveOutTimerReset</a> (<a class="el" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a> *IC)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a70">ExporterProtocol_SelectCollector</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S, <a class="el" href="../../df/dde/_defs_8h.html#a16">IPDR_BOOL</a> forceNegotiate, <a class="el" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html">CollectorSession</a> *forceCS)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a71">ExporterProtocol_ResetIPDRConnection</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a> *IC)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a72">ExporterProtocol_CloseTLConnection</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E, <a class="el" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a> *IC)</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a0">ExporterProtocol_rcsid</a> [] = "@(#) $Id: ExporterProtocol.c,v 1.111 2005/04/21 11:30:09 dmitryk Exp $"</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a1">ExporterProtocol_h_rcsid</a> [] = EXPORTER_PROTOCOL_H_RCSID</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a2">Protocol_h_rcsid</a> [] = PROTOCOL_H_RCSID</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../db/dcd/struct_i_p_d_r__tag___connection_handlers.html">ConnectionHandlers</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a3">ExporterProtocol_ConnectionHandlers</a></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Implementation of functions handling the client (transmitter) side of the IPDR protocol.<p>
Copyright (2005) Â© Amdocs, All Rights Reserved<p>
This software is distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND either expresses or implied.<p>
<dl compact><dt><b>Id</b></dt><dd><a class="el" href="../../dd/d44/_exporter_protocol_8c.html">ExporterProtocol.c</a>,v 1.111 2005/04/21 11:30:09 dmitryk Exp </dd></dl>
<p>
The initial connection handling is done by Exporter/Exporter.c, which switches to here for handling the protocol. This module uses functions in Exporter/Exporter.c on disconnection. <hr><h2>Function Documentation</h2>
<a class="anchor" name="a35" doxytag="ExporterProtocol.c::ExporterProtocol_AutoconnectCallback"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_AutoconnectCallback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>C</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00141 {
00142         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status;
00143         Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a54">ExporterProtocol_SendConnect</a>(E, NULL, Coll, C);
00144         <span class="keywordflow">if</span> (<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
00145         {
00146                 <a class="code" href="../../da/df4/_log_8h.html#a31">Log_Write3</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a1">EXPORTER_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>, <span class="stringliteral">"ExporterProtocol_AutoconnectCallback"</span>,
00147                                         <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a56">MSG_EXPORTER_LOG_CONNECT_ERROR</a>,
00148                                         <span class="stringliteral">"ExporterProtocol_SendConnect"</span>, <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_StatusMsg</a>(E,Status), <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(C));
00149         }
00150         <span class="keywordflow">return</span> Status;
00151 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a72" doxytag="ExporterProtocol.c::ExporterProtocol_CloseTLConnection"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_CloseTLConnection           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>IC</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Fully closes a connection <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>E</em>&nbsp;</td><td>exporter handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>IC</em>&nbsp;</td><td>Contains information about a ipdr connection (IPDRConnection structure) </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">03736 {
03737         <a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> C = IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>;
03738 
03739         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a71">ExporterProtocol_ResetIPDRConnection</a>( E, IC );
03740 
03741         <span class="keywordflow">if</span>( C &amp;&amp; <a class="code" href="../../dc/d2f/group___i_p_d_r__transitional__typedefs.html#ga2">IPDR_IsValidSocket</a>(C-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o6">FD</a>) )
03742                 <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(C);
03743 
03744         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
03745 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="ExporterProtocol.c::ExporterProtocol_CollectorSession"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_CollectorSession           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html">CollectorSession</a> **&nbsp;</td>
          <td class="mdname" nowrap> <em>CS</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../df/dde/_defs_8h.html#a16">IPDR_BOOL</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>High</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../df/dde/_defs_8h.html#a16">IPDR_BOOL</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>allStates</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Finds the collector in session and determines its priority rank.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Coll</em>&nbsp;</td><td>collector handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>session handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>CS</em>&nbsp;</td><td>a pointer to the CollectorSession handle of the requested collector </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>High</em>&nbsp;</td><td>indicates if Coll has the highest priority is S </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>allStates</em>&nbsp;</td><td>determnes whether to search for Coll between disconnected collectors as well.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">02041 {
02042         <span class="comment">/*Find CollectorSession...      */</span>
02043         <span class="keywordtype">int</span> Index = 0;
02044         <span class="keywordflow">if</span>(Coll == NULL || S == NULL || CS == NULL)
02045                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>;
02046 
02047         (*CS) = NULL ;
02048         <span class="keywordflow">if</span>( High != NULL )
02049         {
02050                 (*High) = <a class="code" href="../../d5/d93/_exporter_8h.html#a7">PRIORITY_MAX</a>;
02051                 <span class="keywordflow">for</span> (Index = 0; Index &lt; S-&gt;CollectorSessions.Length; Index++)
02052                 {
02053                         (*CS) = (<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html">CollectorSession</a> *) S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o14">CollectorSessions</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[Index];
02054                                 <span class="comment">/* Find out maximum priority for the session</span>
02055 <span class="comment">                                if we have maximum one, we have not to wait for timeout */</span>
02056                         <span class="keywordflow">if</span>( ((*CS) != NULL) &amp;&amp; (High != NULL) &amp;&amp; ((*CS)-&gt;Priority &lt; (*High)) &amp;&amp;
02057                                 ((*CS)-&gt;CSState == <a class="code" href="../../d5/d93/_exporter_8h.html#a52a26">IPDR_CS_READY</a> ||
02058                                 (*CS)-&gt;CSState == <a class="code" href="../../d5/d93/_exporter_8h.html#a52a27">IPDR_CS_ACTIVE</a> ||
02059                                 (*CS)-&gt;CSState == <a class="code" href="../../d5/d93/_exporter_8h.html#a52a25">IPDR_CS_INITIATION</a> ||
02060                                 allStates == <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>))
02061                                 (*High) = (*CS)-&gt;Priority ;
02062                         (*CS) = NULL ;
02063                 }
02064         }
02065         <span class="keywordflow">for</span> (Index = 0; Index &lt; S-&gt;CollectorSessions.Length; Index++)
02066         {
02067                 (*CS) = (<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html">CollectorSession</a> *) S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o14">CollectorSessions</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[Index];
02068                 <span class="keywordflow">if</span> (((*CS) != NULL) &amp;&amp; ((*CS)-&gt;Collector == Coll))
02069                 {
02070                         <span class="keywordflow">if</span>( High != NULL )
02071                                 (*High) = (((*High) - (*CS)-&gt;Priority) &gt; -1);
02072                         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a> ;
02073                 }
02074                 (*CS) = NULL ;
02075         }
02076         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>;
02077 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a36" doxytag="ExporterProtocol.c::ExporterProtocol_ConnectCallback"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ExporterProtocol_ConnectCallback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Conn</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga9">IPDR_IPAddress</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Addr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned short&nbsp;</td>
          <td class="mdname" nowrap> <em>Port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>Arg</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Callback invoked when a server (collector) connects.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Conn</em>&nbsp;</td><td>connected connection </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Addr</em>&nbsp;</td><td>remove address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Port</em>&nbsp;</td><td>remove port </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Arg</em>&nbsp;</td><td>additional argument (Server) </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00165 {
00166 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a31" doxytag="ExporterProtocol.c::ExporterProtocol_ConnectResponseTimeoutCallback"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void ExporterProtocol_ConnectResponseTimeoutCallback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Arg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Callback triggered in when ConnectResponse did not received in time <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Arg</em>&nbsp;</td><td>callback argument (IPDRConnection) </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">03312 {
03313         <a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a> *IC = (<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a> *)Arg ;
03314         <a class="code" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll = (<a class="code" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *)IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o4">Owner</a>;
03315         <a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E = Coll-&gt;<a class="code" href="../../de/d0d/struct_i_p_d_r__tag___collector.html#o8">ExporterPtr</a>;
03316 
03317         <a class="code" href="../../d2/dc9/_platform_8h.html#a34">Platform_Lock</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>);
03318 
03319         <a class="code" href="../../da/df4/_log_8h.html#a29">Log_Write1</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a1">EXPORTER_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>, <span class="stringliteral">"ExporterProtocol_ConnectResponseTimeoutCallback"</span>,
03320                                 <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a111">MSG_EXPORTER_NO_CONNECT_RESPONSE</a>, Coll-&gt;<a class="code" href="../../de/d0d/struct_i_p_d_r__tag___collector.html#o3">Name</a>);
03321 
03322         <span class="keywordflow">if</span>( IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a> == NULL )
03323         {
03324                 <a class="code" href="../../da/df4/_log_8h.html#a29">Log_Write1</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a1">EXPORTER_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>, <span class="stringliteral">"ExporterProtocol_ConnectResponseTimeoutCallback"</span>,
03325                                 <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a112">MSG_EXPORTER__RESET_TIMER_NEEDED</a>, Coll-&gt;<a class="code" href="../../de/d0d/struct_i_p_d_r__tag___collector.html#o3">Name</a>);
03326                 <a class="code" href="../../d2/dc9/_platform_8h.html#a35">Platform_Unlock</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>);
03327                 <span class="keywordflow">return</span>;
03328         }
03329 
03330         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a51">ExporterProtocol_HandleDisconnect</a>(E, NULL, Coll, NULL, IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>);
03331 
03332         <a class="code" href="../../d2/dc9/_platform_8h.html#a35">Platform_Unlock</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>);
03333 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="ExporterProtocol.c::ExporterProtocol_ConnectWaitWaitBestCollectorCallback"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void ExporterProtocol_ConnectWaitWaitBestCollectorCallback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Arg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Callback triggered in when a flow sart event is received from a collector <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Arg</em>&nbsp;</td><td>callback argument (handle to a CollectorSession) </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">03342 {
03343         <a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html">CollectorSession</a>* CS = (<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html">CollectorSession</a>* )Arg;
03344         <a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a>* E = CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o4">Collector</a>-&gt;<a class="code" href="../../de/d0d/struct_i_p_d_r__tag___collector.html#o8">ExporterPtr</a>;
03345         <a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S = CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o3">SessionPtr</a>;
03346 
03347         <span class="keywordflow">if</span>(S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o20">waitBestCollectorTimerID</a> != NULL)
03348                 <a class="code" href="../../d2/dc9/_platform_8h.html#a13">Platform_UnregisterTimerAndClear</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, &amp;S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o20">waitBestCollectorTimerID</a>);
03349                 
03350         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a70">ExporterProtocol_SelectCollector</a>( E, CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o3">SessionPtr</a>, <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>, NULL);
03351         return ;
03352 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a38" doxytag="ExporterProtocol.c::ExporterProtocol_DataCallback"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ExporterProtocol_DataCallback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>C</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>BH</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>MsgLen</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>Arg</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Callback invoked when data arrives from a server (collector)<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>C</em>&nbsp;</td><td>connection </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BH</em>&nbsp;</td><td>buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>MsgLen</em>&nbsp;</td><td>message length </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Arg</em>&nbsp;</td><td>callback argument (Server) </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00221 {
00222         <a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a>                *E = (<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *) Arg;
00223         <a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a>                 *S = NULL;
00224         <a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a>  *IC = C-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>;
00225         <a class="code" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a>               *Coll ;
00226         <a class="code" href="../../df/dde/_defs_8h.html#a16">IPDR_BOOL</a>               needsSessionID ;
00227 
00228         <span class="comment">/*char *Buf;*/</span>
00229         <span class="keywordtype">char</span>    Buf[<a class="code" href="../../d8/d75/_exporter_protocol_8h.html#a1">EXPORTER_PROTOCOL_MAX_MSG</a>];
00230     MessageHeader *H;
00231         <a class="code" href="../../d5/d93/_transport_8h.html#a28">TL_PABuf</a> paBuf;
00232 
00233     <span class="keywordflow">if</span> (BH == NULL || MsgLen == 0)
00234         return ;
00235 
00236         memcpy(Buf, BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, MsgLen &gt; <a class="code" href="../../d8/d75/_exporter_protocol_8h.html#a1">EXPORTER_PROTOCOL_MAX_MSG</a> ? <a class="code" href="../../d8/d75/_exporter_protocol_8h.html#a1">EXPORTER_PROTOCOL_MAX_MSG</a> : MsgLen);
00237 
00238     H = (MessageHeader *) Buf;
00239 
00240         <span class="keywordflow">if</span>(IC == NULL)
00241         {
00242                 <a class="code" href="../../da/df4/_log_8h.html#a31">Log_Write3</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
00243                                         <span class="stringliteral">"ExporterProtocol_DataCallback"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a33">MSG_EXPORTER_UNEXPECTED_MSG</a>,
00244                                         <a class="code" href="../../d9/d9f/_t_c_p_transport_8c.html#a21">TCP_PrintConnectionFull</a>(C, paBuf), H-&gt;MessageID, <span class="stringliteral">"NO CONNECTION"</span>);
00245                 <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(C);
00246                 <a class="code" href="../../d8/d51/_chunks_manager_8c.html#a24">ChunksManager_ReleaseBuffer</a>(BH, MsgLen);
00247                 return ;
00248         }
00249         Coll = IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o4">Owner</a>;
00250 
00251         <span class="keywordflow">if</span>(Coll == NULL)
00252         {
00253         <a class="code" href="../../da/df4/_log_8h.html#a31">Log_Write3</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
00254                                         <span class="stringliteral">"ExporterProtocol_DataCallback"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a33">MSG_EXPORTER_UNEXPECTED_MSG</a>,
00255                                         <a class="code" href="../../d9/d9f/_t_c_p_transport_8c.html#a21">TCP_PrintConnectionFull</a>(C, paBuf), H-&gt;MessageID, <span class="stringliteral">"NO COLLECTOR"</span>);
00256                 <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(C);
00257                 <a class="code" href="../../d8/d51/_chunks_manager_8c.html#a24">ChunksManager_ReleaseBuffer</a>(BH, MsgLen);
00258                 return ;
00259          }
00260 
00261     <span class="comment">/*Buf = BH-&gt;Data;*/</span>
00262     <span class="keywordflow">if</span>( <a class="code" href="../../d8/d75/_exporter_protocol_8h.html#a1">EXPORTER_PROTOCOL_MAX_MSG</a> &lt;= MsgLen )
00263     {
00264                 <a class="code" href="../../da/df4/_log_8h.html#a29">Log_Write1</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
00265                    <span class="stringliteral">"ExporterProtocol_DataCallback"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a76">MSG_EXPORTER_MESSAGE_TOO_LONG</a>,
00266                                    <a class="code" href="../../d9/d9f/_t_c_p_transport_8c.html#a21">TCP_PrintConnectionFull</a>(C, paBuf));
00267                 <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(C);
00268                 <a class="code" href="../../d8/d51/_chunks_manager_8c.html#a24">ChunksManager_ReleaseBuffer</a>(BH, MsgLen);
00269                 return ;
00270     }
00271 
00272     <span class="keywordflow">switch</span> (H-&gt;MessageID) {
00273     <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a39">IPDR_MSG_DATA</a>:
00274     <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a26">IPDR_MSG_DATA_ACK</a>:
00275                 <span class="comment">/*case IPDR_MSG_KEEP_ALIVE:*/</span>
00276         <span class="comment">/* case IPDR_MSG_DATA_NACK:*/</span>
00277         <span class="keywordflow">if</span> (<a class="code" href="../../da/df4/_log_8h.html#a15">Log_ShouldWrite</a>(&amp;E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o29">ExporterLog</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a172">IPDR_LEVEL_DEBUG</a>)) {
00278             <a class="code" href="../../de/da6/_protocol_debug_8c.html#a5">ProtocolDebug_PrintIncomingMessage</a>(&amp;E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o29">ExporterLog</a>, C, Buf, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a172">IPDR_LEVEL_DEBUG</a>);
00279         }
00280         <span class="keywordflow">break</span>;
00281     <span class="keywordflow">default</span>:
00282         <span class="keywordflow">if</span> (<a class="code" href="../../da/df4/_log_8h.html#a15">Log_ShouldWrite</a>(&amp;E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o29">ExporterLog</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>)) {
00283             <a class="code" href="../../de/da6/_protocol_debug_8c.html#a5">ProtocolDebug_PrintIncomingMessage</a>(&amp;E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o29">ExporterLog</a>, C, Buf, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>);
00284         }
00285     }
00286 
00287     <span class="comment">/* find the session associated with the message */</span>
00288 
00289         needsSessionID = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a4">ExporterProtocol_NeedSessionID</a>(H-&gt;MessageID);
00290 
00291     <span class="keywordflow">if</span> (needsSessionID &amp;&amp; H-&gt;SessionID &gt; 0 ) {
00292         <span class="keywordtype">int</span> i;
00293         <span class="keywordflow">for</span> (i = 0; i &lt; E-&gt;Sessions.Length; i++) {
00294             <a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S1 = (<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *) E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o13">Sessions</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[i];
00295             <span class="keywordflow">if</span> (S1 != NULL &amp;&amp; S1-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o16">ID</a> == H-&gt;SessionID) {
00296                 S = S1;
00297                 break ;
00298             }
00299         }
00300     }
00301 
00302     <span class="keywordflow">if</span> (S == NULL &amp;&amp; needsSessionID) {
00303         <span class="comment">/* We got an unexpected message - we don't don't know about</span>
00304 <span class="comment">         * this session, so complain and disconnect */</span>
00305                 <a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a> *IC = (<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a> *)C-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>;
00306                 <a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> Sess;
00307         <a class="code" href="../../d6/df8/struct_i_p_d_r___event_data.html">IPDR_EventData</a> eventData;
00308         <a class="code" href="../../d5/db3/_exporter_8c.html#a98">EventDataInit</a>(&amp;eventData, <a class="code" href="../../df/dd7/group___i_p_d_r__event__notification.html#gga4a156">IPDR_EVENT_ERROR</a>, E, NULL, NULL);
00309         eventData.<a class="code" href="../../d6/df8/struct_i_p_d_r___event_data.html#o13">Extra</a>.Error.Reason = <a class="code" href="../../df/dd7/group___i_p_d_r__event__notification.html#gga6a165">IPDR_EVENT_ERROR_UNKNOWN_SESSION</a>;
00310         eventData.<a class="code" href="../../d6/df8/struct_i_p_d_r___event_data.html#o4">SessionID</a> = H-&gt;SessionID;
00311         <a class="code" href="../../d5/db3/_exporter_8c.html#a99">Exporter_TriggerEvent</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
00312                             &amp;eventData, NULL,
00313                             <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a20">MSG_EXPORTER_UNKNOWN_SESSION</a>,
00314                             <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(C), H-&gt;SessionID, H-&gt;MessageID);
00315 
00316                 <a class="code" href="../../da/df4/_log_8h.html#a31">Log_Write3</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
00317                          <span class="stringliteral">"                              ExporterProtocol_DataCallback"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a20">MSG_EXPORTER_UNKNOWN_SESSION</a>,
00318                             <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(C), H-&gt;SessionID, H-&gt;MessageID);
00319 
00320                 <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a68">ExporterProtocol_KeepAliveInTimerReset</a>(IC);
00321 
00322                 Sess.<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o16">ID</a> = H-&gt;SessionID;
00323                 <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(<a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a57">ExporterProtocol_SendError</a>(E, &amp;Sess, Coll, C, <a class="code" href="../../db/d1e/_protocol_8h.html#a57a53">CollectorNotInSession</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a123">MSG_EXPORTER_COLLECTOR_NOT_IN_SESSION</a>)))
00324                 {
00325                         <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(C);
00326                 }
00327 
00328                 <a class="code" href="../../d8/d51/_chunks_manager_8c.html#a24">ChunksManager_ReleaseBuffer</a>(BH, MsgLen);
00329                 <span class="keywordflow">return</span>;
00330     }
00331 
00332     <span class="keywordflow">switch</span> (H-&gt;MessageID) {
00333 
00334     <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a19">IPDR_MSG_FLOW_START</a>:
00335         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a41">ExporterProtocol_HandleFlowStart</a>(E, S, Coll, H, C);
00336         <span class="keywordflow">break</span>;
00337 
00338     <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a20">IPDR_MSG_FLOW_STOP</a>:
00339         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a42">ExporterProtocol_HandleFlowStop</a>(E, S, Coll, H, C);
00340         <span class="keywordflow">break</span>;
00341 
00342         <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a21">IPDR_MSG_MODIFY_TEMPLATE</a>:
00343                 <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a43">ExporterProtocol_HandleModifyTemplate</a>(E, S, Coll, H, C);
00344                 <span class="keywordflow">break</span>;
00345 
00346     <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a22">IPDR_MSG_FINAL_TEMPLATE_DATA_ACK</a>:
00347         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a44">ExporterProtocol_HandleFinalTmplDataACK</a>(E, S, Coll, H, C);
00348         <span class="keywordflow">break</span>;
00349 
00350         <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a23">IPDR_MSG_START_NEGOTIATION</a>:
00351                 <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a45">ExporterProtocol_HandleStartNegotiation</a>(E, S, Coll, H, C);
00352                 <span class="keywordflow">break</span>;
00353 
00354         <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a24">IPDR_MSG_GET_SESSIONS</a>:
00355                 <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a46">ExporterProtocol_HandleGetSessions</a>(E, S, Coll, H, C);
00356                 <span class="keywordflow">break</span>;
00357 
00358         <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a25">IPDR_MSG_GET_TEMPLATES</a>:
00359                 <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a47">ExporterProtocol_HandleGetTemplates</a>(E, S, Coll, H, C);
00360                 <span class="keywordflow">break</span>;
00361 
00362     <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a26">IPDR_MSG_DATA_ACK</a>:
00363         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a48">ExporterProtocol_HandleDataACK</a>(E, S, Coll, H, C);
00364         <span class="keywordflow">break</span>;
00365 
00366         <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a27">IPDR_MSG_CONNECT</a>:
00367         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a49">ExporterProtocol_HandleConnect</a>(E, S, Coll, H, C);
00368         <span class="keywordflow">break</span>;
00369 
00370         <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a28">IPDR_MSG_CONNECT_RESPONSE</a>:
00371         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a50">ExporterProtocol_HandleConnectResponse</a>(E, S, Coll, H, C);
00372         <span class="keywordflow">break</span>;
00373 
00374         <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a29">IPDR_MSG_DISCONNECT</a>:
00375                 <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a51">ExporterProtocol_HandleDisconnect</a>(E, S, Coll, H, C);
00376                 <span class="keywordflow">break</span>;
00377 
00378         <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a30">IPDR_MSG_ERROR</a>:
00379                 <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a52">ExporterProtocol_HandleError</a>(E, S, Coll, H, C);
00380                 <span class="keywordflow">break</span>;
00381 
00382         <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a31">IPDR_MSG_KEEP_ALIVE</a>:
00383                 <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a53">ExporterProtocol_HandleKeepAlive</a>(E, S, Coll, H, C);
00384                 <span class="keywordflow">break</span>;
00385 
00386     <span class="keywordflow">default</span>:
00387         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a67">ExporterProtocol_HandleUnknownMsg</a>(E, S, Coll, H, C);
00388         <span class="keywordflow">break</span>;
00389     }
00390         <span class="comment">/* Can not call ReleaseMessage here because of no padding, may be releaseBuffer will do */</span>
00391     <span class="comment">/*ChunksManager_ReleaseMessage(BH);*/</span>
00392     <a class="code" href="../../d8/d51/_chunks_manager_8c.html#a24">ChunksManager_ReleaseBuffer</a>(BH, MsgLen);
00393 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a37" doxytag="ExporterProtocol.c::ExporterProtocol_DisconnectCallback"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ExporterProtocol_DisconnectCallback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Conn</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>Arg</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Callback invoked when a server (collector) disconnects.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Conn</em>&nbsp;</td><td>disconnected connection </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Arg</em>&nbsp;</td><td>additional argument </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00176 {
00177     <a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a>*                   E = (<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a>*)Arg;
00178     <a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a>*             IC = (<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a> *)Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>;
00179         <a class="code" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a>*                      Coll = (<a class="code" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *)IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o4">Owner</a>;
00180         <a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html">CollectorSession</a>*       CS;
00181         <a class="code" href="../../df/dde/_defs_8h.html#a16">IPDR_BOOL</a>                       WasActive;
00182         <span class="keywordtype">int</span>                                     Index ;
00183 
00184         Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a> = NULL;
00185 
00186         <a class="code" href="../../da/df4/_log_8h.html#a27">Log_StateTransition</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a172">IPDR_LEVEL_DEBUG</a>,
00187                         <span class="stringliteral">"ExporterProtocol_DisconnectCallback"</span>, Conn,
00188                         IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o1">State</a>, IPDR_SERVER_DISCONNECTED,
00189                         <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn));
00190 
00191         <span class="comment">/* for each Session of this connection, need to have if we had active session there */</span>
00192         <span class="keywordflow">for</span>( Index = 0; Index &lt; Coll-&gt;<a class="code" href="../../de/d0d/struct_i_p_d_r__tag___collector.html#o1">CollectorSessions</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o1">Length</a>; Index++ )
00193         {
00194                 CS = (<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html">CollectorSession</a>*)Coll-&gt;<a class="code" href="../../de/d0d/struct_i_p_d_r__tag___collector.html#o1">CollectorSessions</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[Index];
00195 
00196                 <span class="comment">/* If it is active CollectorSession need to select new server now*/</span>
00197                 WasActive = (CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a> == <a class="code" href="../../d5/d93/_exporter_8h.html#a52a27">IPDR_CS_ACTIVE</a> &amp;&amp; CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o3">SessionPtr</a>-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o13">ActiveCS</a> == CS) ;
00198                 CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a> = <a class="code" href="../../d5/d93/_exporter_8h.html#a52a24">IPDR_CS_DISCONNECTED</a>;
00199                 CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a> = NULL ;
00200 
00201                 <span class="keywordflow">if</span>(WasActive)
00202                         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a70">ExporterProtocol_SelectCollector</a>( E, CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o3">SessionPtr</a>, <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>, NULL);
00203         }
00204 
00205 
00206         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a71">ExporterProtocol_ResetIPDRConnection</a>( E, IC );
00207 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a40" doxytag="ExporterProtocol.c::ExporterProtocol_FillHeader"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_FillHeader           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>Msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned char&nbsp;</td>
          <td class="mdname" nowrap> <em>MessageID</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned long&nbsp;</td>
          <td class="mdname" nowrap> <em>MessageLength</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set the header fields within a message.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>session handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Msg</em>&nbsp;</td><td>message to update </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>MessageID</em>&nbsp;</td><td>message id to put in the header </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>MessageLength</em>&nbsp;</td><td>length of the message</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga15">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00429 {
00430     MessageHeader *H = (MessageHeader *) Msg;
00431 
00432     H-&gt;Version = <a class="code" href="../../db/d1e/_protocol_8h.html#a18">IPDR_PROTOCOL_VERSION</a>;
00433     H-&gt;SessionID = S ? S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o16">ID</a> : 0;
00434     H-&gt;MessageFlags = 0;
00435     H-&gt;MessageID = MessageID;
00436     <a class="code" href="../../df/dde/_defs_8h.html#a9">IPDR_SET_HTONL</a>(H-&gt;MessageLength, MessageLength);
00437 
00438     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
00439 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a39" doxytag="ExporterProtocol.c::ExporterProtocol_FlushRecordsQueue"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_FlushRecordsQueue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>DebugMsg</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Move to the next transmission context if needed (i.e. the queue of the current context is empty and a next context is available), otherwise send any outstanding data.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>E</em>&nbsp;</td><td>exporter handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>session handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Coll</em>&nbsp;</td><td>collector handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>DebugMsg</em>&nbsp;</td><td>context message for any debug message produced by this function</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga15">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00411 {
00412         <span class="keywordflow">return</span> <a class="code" href="../../d5/db3/_exporter_8c.html#a48">Session_SendOutstandingData</a>(E, S);
00413 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a34" doxytag="ExporterProtocol.c::ExporterProtocol_GetCollectorCapabilities"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int ExporterProtocol_GetCollectorCapabilities           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Coll</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">03749 {
03750         <span class="keywordtype">int</span>  collectorCapabilities = 0;
03751         <span class="keywordflow">if</span>(Coll-&gt;<a class="code" href="../../de/d0d/struct_i_p_d_r__tag___collector.html#o7">Capabilities</a>.StructureSupport == <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>)
03752                 collectorCapabilities = collectorCapabilities | 0x1u ;
03753         <span class="keywordflow">if</span>(Coll-&gt;<a class="code" href="../../de/d0d/struct_i_p_d_r__tag___collector.html#o7">Capabilities</a>.MultiSession == <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>)
03754                 collectorCapabilities = collectorCapabilities | 0x2u ;
03755         <span class="keywordflow">if</span>(Coll-&gt;<a class="code" href="../../de/d0d/struct_i_p_d_r__tag___collector.html#o7">Capabilities</a>.TemplateNegotiation == <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>)
03756                 collectorCapabilities = collectorCapabilities | 0x4u ;
03757         <span class="keywordflow">return</span> collectorCapabilities ;
03758 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="ExporterProtocol.c::ExporterProtocol_GetFieldDescriptorDataLength"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">size_t ExporterProtocol_GetFieldDescriptorDataLength           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../de/d6f/struct_i_p_d_r__tag___key.html">Key</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>K</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02081 {
02082         size_t                  Size ;
02083 
02084 
02085         Size =  <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> int) + <span class="comment">/* key type id */</span>
02086                         <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> int) + <span class="comment">/* key id */</span>
02087                         <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> int) +
02088                         strlen(K-&gt;<a class="code" href="../../de/d6f/struct_i_p_d_r__tag___key.html#o2">Name</a>) +               <span class="comment">/* key name */</span>
02089                         1 ;                                             <span class="comment">/* enabled */</span>
02090         <span class="keywordflow">return</span> Size ;
02091 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="ExporterProtocol.c::ExporterProtocol_GetSessionBlockDataLength"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">size_t ExporterProtocol_GetSessionBlockDataLength           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>S</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02775 {
02776         size_t  Size = <span class="keyword">sizeof</span>(SessionBlock) + strlen(S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o17">Name</a>) + strlen(S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o18">Description</a>);
02777         <span class="keywordflow">return</span> Size ;
02778 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="ExporterProtocol.c::ExporterProtocol_GetSessionsResponseMsgLen"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">size_t ExporterProtocol_GetSessionsResponseMsgLen           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>E</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02782 {
02783         size_t                  Size ;
02784         <span class="keywordtype">int</span>                             Index ;
02785 
02786         Size = <span class="keyword">sizeof</span>( GetSessionsResponseMessage ) ;
02787         <span class="keywordflow">for</span>( Index = 0 ; Index &lt; E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o13">Sessions</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o1">Length</a> ; Index++ )
02788         {
02789                 Size += <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a12">ExporterProtocol_GetSessionBlockDataLength</a>( (<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *)E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o13">Sessions</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[Index] );
02790         }
02791         <span class="keywordflow">return</span> Size ;
02792 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="ExporterProtocol.c::ExporterProtocol_GetTemplateBlockDataLength"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">size_t ExporterProtocol_GetTemplateBlockDataLength           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../da/d62/struct_i_p_d_r__tag___template.html">Template</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>T</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02095 {
02096         size_t                  Size ;
02097         <span class="keywordtype">int</span>                             Index ;
02098 
02099         Size =  <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> short) + <span class="comment">/* template id*/</span>
02100                         <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> int) + strlen(T-&gt;<a class="code" href="../../da/d62/struct_i_p_d_r__tag___template.html#o1">SchemaName</a>) +
02101                         <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> int) + strlen(T-&gt;<a class="code" href="../../da/d62/struct_i_p_d_r__tag___template.html#o2">TypeName</a>) +
02102                         <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> int) ; <span class="comment">/* number of fields */</span>
02103 
02104         <span class="keywordflow">for</span>( Index = 0 ; Index &lt; T-&gt;<a class="code" href="../../da/d62/struct_i_p_d_r__tag___template.html#o3">Keys</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o1">Length</a> ; Index++ )
02105         {
02106                 Size += <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a8">ExporterProtocol_GetFieldDescriptorDataLength</a>( T-&gt;<a class="code" href="../../da/d62/struct_i_p_d_r__tag___template.html#o3">Keys</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[Index] );
02107         }
02108         <span class="keywordflow">return</span> Size ;
02109 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="ExporterProtocol.c::ExporterProtocol_GetTemplateDataMsgLen"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">size_t ExporterProtocol_GetTemplateDataMsgLen           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html">TransmissionContext</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>TC</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02113 {
02114         size_t                  Size ;
02115         <span class="keywordtype">int</span>                             Index ;
02116 
02117         Size = <span class="keyword">sizeof</span>( TmplDataMessage ) ;
02118         <span class="keywordflow">for</span>( Index = 0 ; Index &lt; TC-&gt;<a class="code" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html#o2">Templates</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o1">Length</a> ; Index++ )
02119         {
02120                 Size += <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a9">ExporterProtocol_GetTemplateBlockDataLength</a>( TC-&gt;<a class="code" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html#o2">Templates</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[Index] );
02121         }
02122         <span class="keywordflow">return</span> Size ;
02123 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="ExporterProtocol.c::ExporterProtocol_GetTemplates"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_GetTemplates           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html">TransmissionContext</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>TC</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned char *&nbsp;</td>
          <td class="mdname" nowrap> <em>Buffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>RequestID</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02915 {
02916         <span class="keywordtype">int</span>                                     Index ;
02917         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*                  WriteBuffer ;
02918         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>                     Status = <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
02919         GetTemplatesResponseMessage* TDHeader ;
02920 
02921         TDHeader = (GetTemplatesResponseMessage *)Buffer;
02922 
02923         <a class="code" href="../../df/dde/_defs_8h.html#a8">IPDR_SET_HTONS</a>(TDHeader-&gt;ConfigurationID, TC-&gt;<a class="code" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html#o3">ConfigurationID</a>);
02924         <a class="code" href="../../df/dde/_defs_8h.html#a8">IPDR_SET_HTONS</a>(TDHeader-&gt;RequestID, RequestID);
02925         <a class="code" href="../../df/dde/_defs_8h.html#a9">IPDR_SET_HTONL</a>(TDHeader-&gt;NumTemplates, TC-&gt;<a class="code" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html#o2">Templates</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o1">Length</a>);
02926         WriteBuffer = Buffer + <span class="keyword">sizeof</span>( GetTemplatesResponseMessage ) ;
02927 
02928         <span class="keywordflow">for</span>( Index = 0 ; Index &lt; TC-&gt;<a class="code" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html#o2">Templates</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o1">Length</a> ; Index++ )
02929         {
02930                 Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a20">ExporterProtocol_WriteTemplateBlock</a>( TC-&gt;<a class="code" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html#o2">Templates</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[Index], &amp;WriteBuffer );
02931                 <span class="keywordflow">if</span>( <a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status) )
02932                 {
02933                         break ;
02934                 }
02935         }
02936         <span class="keywordflow">return</span> Status ;
02937 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="ExporterProtocol.c::ExporterProtocol_GetTemplatesResponseMsgLen"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">size_t ExporterProtocol_GetTemplatesResponseMsgLen           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html">TransmissionContext</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>TC</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02901 {
02902         size_t                  Size ;
02903         <span class="keywordtype">int</span>                             Index ;
02904 
02905         Size = <span class="keyword">sizeof</span>( GetTemplatesResponseMessage ) ;
02906         <span class="keywordflow">for</span>( Index = 0 ; Index &lt; TC-&gt;<a class="code" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html#o2">Templates</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o1">Length</a> ; Index++ )
02907         {
02908                 Size += <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a9">ExporterProtocol_GetTemplateBlockDataLength</a>( TC-&gt;<a class="code" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html#o2">Templates</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[Index] );
02909         }
02910         <span class="keywordflow">return</span> Size ;
02911 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a49" doxytag="ExporterProtocol.c::ExporterProtocol_HandleConnect"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_HandleConnect           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const MessageHeader *&nbsp;</td>
          <td class="mdname" nowrap> <em>Msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Conn</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handles a connect event recived from a collector<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>E</em>&nbsp;</td><td>exporter handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>session handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Coll</em>&nbsp;</td><td>collector handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Msg</em>&nbsp;</td><td>message header from the collector </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Conn</em>&nbsp;</td><td>The Connection between S to Coll </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">01214 {
01215         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status = <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01216         <a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a> *IC = Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>;
01217         <span class="keyword">const</span> ConnectMessage *CM = (<span class="keyword">const</span> ConnectMessage *)Msg;
01218         <span class="keywordtype">int</span> clientCapabilities = 0, Index;
01219         <a class="code" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *RealCollector = NULL ;
01220         <a class="code" href="../../d5/d93/_transport_8h.html#a28">TL_PABuf</a> paBuf;
01221         
01222         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga9">IPDR_IPAddress</a> Addr = <a class="code" href="../../df/dde/_defs_8h.html#a12">IPDR_NTOHL</a>(CM-&gt;Addr);
01223         Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o5">DummyAddr</a> = Addr ;
01224         
01225         
01226         <span class="keywordflow">if</span>(Coll-&gt;<a class="code" href="../../de/d0d/struct_i_p_d_r__tag___collector.html#o9">isDummy</a> == <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>)
01227         {
01228                 <span class="keywordflow">for</span> (Index = 0; Index &lt; E-&gt;Collectors.Length; Index++)
01229                 {
01230                         RealCollector = (<a class="code" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *) E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o14">Collectors</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[Index];
01231                         <span class="keywordflow">if</span> (Addr == RealCollector-&gt;<a class="code" href="../../de/d0d/struct_i_p_d_r__tag___collector.html#o4">Addr</a>)
01232                                 break ;
01233                         
01234                         RealCollector = NULL ;
01235                 }
01236                 
01237                 <span class="keywordflow">if</span>(RealCollector == NULL)
01238                 {
01239                         <a class="code" href="../../da/df4/_log_8h.html#a29">Log_Write1</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
01240                                         <span class="stringliteral">"ExporterProtocol_HandleConnect"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a19">MSG_EXPORTER_UNKNOWN_SERVER</a>,
01241                                         <a class="code" href="../../d5/d93/_transport_8h.html#a20">TL_PrintConnectionFull</a>(Conn, paBuf));
01242         
01243                         Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a57">ExporterProtocol_SendError</a>(E, S, Coll, Conn, <a class="code" href="../../db/d1e/_protocol_8h.html#a57a50">CollectorNotConfigured</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a125">MSG_EXPORTER_UNKNOWN_SERVER2</a>);
01244                         <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
01245                         {
01246                                 <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(Conn);
01247                         }
01248                         <span class="keywordflow">return</span> Status ;
01249                 }
01250                 
01251                 <span class="keywordflow">if</span>(IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o5">ConnectResponseTimerID</a> != NULL)
01252                         <a class="code" href="../../d2/dc9/_platform_8h.html#a13">Platform_UnregisterTimerAndClear</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, &amp; (IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o5">ConnectResponseTimerID</a>));
01253                 
01254                 <span class="keywordflow">if</span>(IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>)
01255                         IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a> = NULL ;
01256                 IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a> = NULL ;
01257                 
01258                 Status = <a class="code" href="../../d5/db3/_exporter_8c.html#a43">Exporter_AddIPDRConnectionToCollector</a>( E, RealCollector, Conn );
01259                 <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
01260                 {
01261                         <a class="code" href="../../da/df4/_log_8h.html#a29">Log_Write1</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
01262                                         <span class="stringliteral">"Exporter_ConnectCallback"</span>, <span class="stringliteral">"Failed To Add IPDRConnection To Collector, Addres: %.98s"</span>,
01263                                         <a class="code" href="../../d5/d93/_transport_8h.html#a20">TL_PrintConnectionFull</a>(Conn, paBuf));
01264                         
01265                         <a class="code" href="../../d5/d55/_memory_management_8c.html#a5">Object_Release</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, Coll);
01266                         <span class="keywordflow">return</span> Status;
01267                 }
01268                 <a class="code" href="../../d5/d55/_memory_management_8c.html#a5">Object_Release</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, Coll);
01269                 IC = Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>;
01270         }
01271         
01272         <span class="keywordflow">if</span>(IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o1">State</a> != <a class="code" href="../../d5/d93/_exporter_8h.html#a51a21">IPDR_CONNECTION_DISCONNECTED</a>)
01273         {
01274                 <a class="code" href="../../da/df4/_log_8h.html#a31">Log_Write3</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
01275                    <span class="stringliteral">"ExporterProtocol_HandleConnect"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a35">MSG_EXPORTER_UNEXPECTED_CONNECT</a>,
01276                    <a class="code" href="../../d5/d93/_transport_8h.html#a20">TL_PrintConnectionFull</a>(Conn, paBuf), <span class="stringliteral">"CONNECTED"</span>, <span class="stringliteral">""</span>);
01277 
01278                 Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a57">ExporterProtocol_SendError</a>(E, S, RealCollector, Conn, <a class="code" href="../../db/d1e/_protocol_8h.html#a57a51">InvalidConnectionState</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a78">MSG_EXPORTER_WRONG_COLLECTOR_STATE</a>);
01279                 <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
01280                 {
01281                         <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(Conn);
01282                 }
01283                 <span class="keywordflow">return</span> Status ;
01284         }
01285 
01286         clientCapabilities = <a class="code" href="../../df/dde/_defs_8h.html#a12">IPDR_NTOHL</a>(CM-&gt;Capabilities);
01287         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a33">ExporterProtocol_SetCollectorCapabilities</a>(E, RealCollector, clientCapabilities);
01288         IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o8">RemoteKeepAliveInterval</a> = <a class="code" href="../../df/dde/_defs_8h.html#a12">IPDR_NTOHL</a>(CM-&gt;keepAliveInterval);
01289 
01290         Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a55">ExporterProtocol_SendConnectResponse</a>(E, S, RealCollector, Conn);
01291         <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
01292         {
01293                 <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
01294                   <span class="stringliteral">"ExporterProtocol_HandleConnect"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a97">MSG_EXPORTER_SEND_CONNECT_RESPONSE_ERROR</a>);
01295                 <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(Conn);
01296                 <span class="keywordflow">return</span> Status ;
01297         }
01298 
01299         IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o1">State</a> = <a class="code" href="../../d5/d93/_exporter_8h.html#a51a23">IPDR_CONNECTION_CONNECTED</a>;
01300         <span class="keywordflow">if</span>(IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o6">KeepAliveINTimerID</a> != NULL)
01301         {
01302                 <a class="code" href="../../d2/dc9/_platform_8h.html#a13">Platform_UnregisterTimerAndClear</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, &amp;IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o6">KeepAliveINTimerID</a>);
01303                 IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o6">KeepAliveINTimerID</a> = NULL;
01304         }
01305         <a class="code" href="../../d2/dc9/_platform_8h.html#a11">Platform_RegisterPeriodicTimer</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>,
01306                                                         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a29">ExporterProtocol_KeepAliveInTimerCallback</a>,
01307                                                         IC,
01308                                                         (E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o4">Parameters</a>.<a class="code" href="../../d1/dac/struct_exporter_parameters.html#o4">KeepAliveInterval</a>)+500,
01309                                                         &amp; (IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o6">KeepAliveINTimerID</a>));
01310 
01311         <span class="keywordflow">if</span>(IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o7">KeepAliveOUTTimerID</a> != NULL)
01312         {
01313                 <a class="code" href="../../d2/dc9/_platform_8h.html#a13">Platform_UnregisterTimerAndClear</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, &amp;IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o7">KeepAliveOUTTimerID</a>);
01314                 IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o7">KeepAliveOUTTimerID</a> = NULL;
01315         }
01316         <a class="code" href="../../d2/dc9/_platform_8h.html#a11">Platform_RegisterPeriodicTimer</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>,
01317                                                         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a30">ExporterProtocol_KeepAliveOutTimerCallback</a>,
01318                                                         IC,
01319                                                         ((IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o8">RemoteKeepAliveInterval</a>)*1000)-500,
01320                                                         &amp; (IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o7">KeepAliveOUTTimerID</a>));
01321 
01322         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a> ;
01323 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a50" doxytag="ExporterProtocol.c::ExporterProtocol_HandleConnectResponse"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_HandleConnectResponse           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const MessageHeader *&nbsp;</td>
          <td class="mdname" nowrap> <em>Msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Conn</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handles a connect response event recived from a collector<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>E</em>&nbsp;</td><td>exporter handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>session handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Coll</em>&nbsp;</td><td>collector handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Msg</em>&nbsp;</td><td>message header from the collector </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Conn</em>&nbsp;</td><td>The Connection between S to Coll </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">01340 {
01341         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status = <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01342         <a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a> *IC = Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>;
01343         <span class="keyword">const</span> ConnectResponseMessage *CRM = (<span class="keyword">const</span> ConnectResponseMessage *)Msg;
01344         <span class="keywordtype">int</span> clientCapabilities = 0;
01345 
01346         <span class="keywordflow">if</span>(IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o1">State</a> != <a class="code" href="../../d5/d93/_exporter_8h.html#a51a22">IPDR_CONNECTION_WAITRESPONSE</a>)
01347         {
01348                 <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
01349                   <span class="stringliteral">"ExporterProtocol_HandleConnectResponse"</span>,
01350                   <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a105">MSG_EXPORTER_STATE_NOT_WAITRESPONSE</a>);
01351                 Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a57">ExporterProtocol_SendError</a>(E, S, Coll, Conn, <a class="code" href="../../db/d1e/_protocol_8h.html#a57a51">InvalidConnectionState</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a78">MSG_EXPORTER_WRONG_COLLECTOR_STATE</a>);
01352                 <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
01353                 {
01354                         <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(Conn);
01355                 }
01356                 <span class="keywordflow">return</span> Status ;
01357         }
01358 
01359         <a class="code" href="../../d2/dc9/_platform_8h.html#a34">Platform_Lock</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>);
01360 
01361         <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
01362                   <span class="stringliteral">"ExporterProtocol_HandleConnectResponse"</span>,
01363                   <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a104">MSG_EXPORTER_CONNECT_RESPONSE_RECEIVED</a>);
01364         <a class="code" href="../../d2/dc9/_platform_8h.html#a13">Platform_UnregisterTimerAndClear</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, &amp;IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o5">ConnectResponseTimerID</a>);
01365         IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o5">ConnectResponseTimerID</a> = NULL;
01366 
01367         IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o1">State</a> = <a class="code" href="../../d5/d93/_exporter_8h.html#a51a23">IPDR_CONNECTION_CONNECTED</a>;
01368         IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o8">RemoteKeepAliveInterval</a> = <a class="code" href="../../df/dde/_defs_8h.html#a12">IPDR_NTOHL</a>(CRM-&gt;keepAliveInterval);
01369         clientCapabilities = <a class="code" href="../../df/dde/_defs_8h.html#a12">IPDR_NTOHL</a>(CRM-&gt;Capabilities);
01370         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a33">ExporterProtocol_SetCollectorCapabilities</a>(E, Coll, clientCapabilities);
01371         <span class="keywordflow">if</span>(IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o6">KeepAliveINTimerID</a> != NULL)
01372         {
01373                 <a class="code" href="../../d2/dc9/_platform_8h.html#a13">Platform_UnregisterTimerAndClear</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, &amp;IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o6">KeepAliveINTimerID</a>);
01374                 IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o6">KeepAliveINTimerID</a> = NULL;
01375         }
01376         <a class="code" href="../../d2/dc9/_platform_8h.html#a11">Platform_RegisterPeriodicTimer</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>,
01377                                                         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a29">ExporterProtocol_KeepAliveInTimerCallback</a>,
01378                                                         IC,
01379                                                         (E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o4">Parameters</a>.<a class="code" href="../../d1/dac/struct_exporter_parameters.html#o4">KeepAliveInterval</a>)+500,
01380                                                         &amp; (IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o6">KeepAliveINTimerID</a>));
01381 
01382         <span class="keywordflow">if</span>(IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o7">KeepAliveOUTTimerID</a> != NULL)
01383         {
01384                 <a class="code" href="../../d2/dc9/_platform_8h.html#a13">Platform_UnregisterTimerAndClear</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, &amp;IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o7">KeepAliveOUTTimerID</a>);
01385                 IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o7">KeepAliveOUTTimerID</a> = NULL;
01386         }
01387         <a class="code" href="../../d2/dc9/_platform_8h.html#a11">Platform_RegisterPeriodicTimer</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>,
01388                                                         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a30">ExporterProtocol_KeepAliveOutTimerCallback</a>,
01389                                                         IC,
01390                                                         ((IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o8">RemoteKeepAliveInterval</a>)*1000)-500,
01391                                                         &amp; (IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o7">KeepAliveOUTTimerID</a>));
01392 
01393         <a class="code" href="../../d2/dc9/_platform_8h.html#a35">Platform_Unlock</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>);
01394         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01395 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a48" doxytag="ExporterProtocol.c::ExporterProtocol_HandleDataACK"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_HandleDataACK           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const MessageHeader *&nbsp;</td>
          <td class="mdname" nowrap> <em>Msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Conn</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle a DATA ACK message from a server (collector).<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>E</em>&nbsp;</td><td>exporter handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>session handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Coll</em>&nbsp;</td><td>collector originating the message </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Msg</em>&nbsp;</td><td>received message </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Conn</em>&nbsp;</td><td>connection handle</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga15">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">01069 {
01070         <span class="keyword">const</span> DataACKMessage*   DAM = (<span class="keyword">const</span> DataACKMessage *) Msg;
01071     <a class="code" href="../../df/dd7/group___i_p_d_r__event__notification.html#ga0">IPDR_DSN_TYPE</a>                       DSN = 0 ;
01072     <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>                      ConfigurationID = <a class="code" href="../../df/dde/_defs_8h.html#a11">IPDR_NTOHS</a>(DAM-&gt;ConfigurationID);
01073         <a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html">CollectorSession</a>*               CS ;
01074     <a class="code" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html">TransmissionContext</a>*        TC = S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o3">ActiveContext</a>;
01075         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>                             Status ;
01076 
01077         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a68">ExporterProtocol_KeepAliveInTimerReset</a>(Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>);
01078 
01079         DSN = <a class="code" href="../../df/dde/_defs_8h.html#a13">IPDR_NTOHLL</a>(DAM-&gt;sequenceNum);
01080 
01081         <a class="code" href="../../da/df4/_log_8h.html#a32">Log_Write4</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a1">EXPORTER_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a172">IPDR_LEVEL_DEBUG</a>,
01082                    <span class="stringliteral">"ExporterProtocol_HandleDataACK"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a50">MSG_EXPORTER_DATA_ACK</a>,
01083                    DSN, <a class="code" href="../../d5/d93/_exporter_8h.html#a3">EXPORTER_QHANDLER</a>-&gt;OutstandingDataCount(E, S),
01084                    <a class="code" href="../../d5/d93/_exporter_8h.html#a3">EXPORTER_QHANDLER</a>-&gt;UnacknowledgedDataCount(E, S), <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn));
01085 
01086         Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a5">ExporterProtocol_CollectorSession</a>(Coll, S, &amp;CS, NULL, <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a> );
01087 
01088         <span class="keywordflow">if</span>( <a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status) || CS == NULL)
01089         {
01090                 <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
01091                          <span class="stringliteral">"ExporterProtocol_HandleDataACK"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a69">MSG_EXPORTER_COLLECTOR_SESSION_FAILED</a>);
01092                 Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a57">ExporterProtocol_SendError</a>(E, S, Coll, Conn, <a class="code" href="../../db/d1e/_protocol_8h.html#a57a50">CollectorNotConfigured</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a69">MSG_EXPORTER_COLLECTOR_SESSION_FAILED</a>);
01093                 <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
01094                 {
01095                         <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(Conn);
01096                 }
01097                 <span class="keywordflow">return</span> Status;
01098         }
01099 
01100     <span class="comment">/* Because IPDR_INVALID_DSN is negative, it ought not have any</span>
01101 <span class="comment">       effect ... but just to be sure, let's short-circuit the whole</span>
01102 <span class="comment">       execution path below. */</span>
01103     <span class="keywordflow">if</span> (<a class="code" href="../../db/d1e/_protocol_8h.html#a3">IPDR_INVALID_DSN</a>(DSN))
01104         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01105 
01106     <span class="keywordflow">if</span> (TC-&gt;<a class="code" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html#o3">ConfigurationID</a> != ConfigurationID)
01107         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01108 
01109     <span class="keywordflow">if</span> (S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o13">ActiveCS</a> == CS)
01110         {
01111         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> RemovedRecords;
01112         <a class="code" href="../../d5/d93/_exporter_8h.html#a3">EXPORTER_QHANDLER</a>-&gt;ACK(E, S, CS, DSN, &amp;RemovedRecords);
01113         <span class="keywordflow">if</span> (RemovedRecords &gt; 0)
01114                 {
01115             <span class="keywordflow">if</span> (<a class="code" href="../../d5/d93/_exporter_8h.html#a3">EXPORTER_QHANDLER</a>-&gt;UnacknowledgedDataCount(E, S) &lt;= 0 &amp;&amp;
01116                 <a class="code" href="../../d5/d93/_exporter_8h.html#a3">EXPORTER_QHANDLER</a>-&gt;OutstandingDataCount(E, S) &lt;= 0)
01117                         {
01118                 <a class="code" href="../../d6/df8/struct_i_p_d_r___event_data.html">IPDR_EventData</a> eventData;
01119 
01120                 <a class="code" href="../../d2/dc9/_platform_8h.html#a13">Platform_UnregisterTimerAndClear</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, &amp;CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o9">WindowSizeTimer</a>);
01121 
01122                 <a class="code" href="../../d5/db3/_exporter_8c.html#a98">EventDataInit</a>(&amp;eventData, <a class="code" href="../../df/dd7/group___i_p_d_r__event__notification.html#gga4a154">IPDR_EVENT_QUEUE_EMPTY</a>, E, CS, S);
01123                 <a class="code" href="../../d5/db3/_exporter_8c.html#a99">Exporter_TriggerEvent</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>, &amp;eventData, NULL, <span class="comment">/* don't record this event in server's "last event" */</span>
01124                                     <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a59">MSG_EXPORTER_QUEUE_EMPTIED</a>,
01125                                     <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>),
01126                                     <a class="code" href="../../d5/d93/_exporter_8h.html#a3">EXPORTER_QHANDLER</a>-&gt;OutstandingDataCount(E, S),
01127                                     <a class="code" href="../../d5/d93/_exporter_8h.html#a3">EXPORTER_QHANDLER</a>-&gt;UnacknowledgedDataCount(E, S),
01128                                     S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o16">ID</a>, S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o17">Name</a>, S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o18">Description</a>);
01129                         }
01130                         <span class="keywordflow">else</span>
01131                         {
01132                                 <a class="code" href="../../d2/dc9/_platform_8h.html#a10">Platform_ReregisterTimer</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>,
01133                                          <a class="code" href="../../d5/db3/_exporter_8c.html#a44">Exporter_WindowSizeTimerCallback</a>, CS,
01134                                          E-&gt;Parameters.WindowTimeout,
01135                                          &amp;CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o9">WindowSizeTimer</a>);
01136                         }
01137                         <span class="comment">/* We don't need to check whether:</span>
01138 <span class="comment">                        EXPORTER_QHANDLER-&gt;OutstandingDataCount(C, S) &lt;</span>
01139 <span class="comment">                        C-&gt;Parameters.WindowSize)</span>
01140 <span class="comment">                        because the flush will do this implicitly (at most WindowSize</span>
01141 <span class="comment">                        records will be outstanding). */</span>
01142                 <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a39">ExporterProtocol_FlushRecordsQueue</a>(E, S, Coll, <span class="stringliteral">"DataACK"</span>);
01143                 }
01144         }
01145         <span class="keywordflow">else</span>
01146         {
01147         <span class="comment">/* When we received an data ack from a server (collector) with a higher</span>
01148 <span class="comment">           priority, which is paused, reselect the active server (collector). Note</span>
01149 <span class="comment">           that this means that an ACK from a lower priority server (collector)</span>
01150 <span class="comment">           will be ignored; but that shouldn't matter because the</span>
01151 <span class="comment">           higher priority server (collector) will be ACKing as well. In case the</span>
01152 <span class="comment">           higher priority server (collector) does time out, the lower priority</span>
01153 <span class="comment">           server (collector) will be re-sent everything, which is safe, even</span>
01154 <span class="comment">           though perhaps not desirable (but also quite</span>
01155 <span class="comment">           unlikely). Also note that this code does behave correctly</span>
01156 <span class="comment">           in the situation with a single server (collector) that times out and</span>
01157 <span class="comment">           then sends an ACK. */</span>
01158         <span class="comment">/* The fact that we got a DATA ACK indicates that that this</span>
01159 <span class="comment">           server (collector) ought to be put into a more ready state if it isn't</span>
01160 <span class="comment">           already */</span>
01161                 <span class="keywordflow">if</span> (S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o13">ActiveCS</a> == NULL ||
01162                         ( (CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a> == <a class="code" href="../../d5/d93/_exporter_8h.html#a52a26">IPDR_CS_READY</a> ) &amp;&amp; CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o6">Priority</a> &lt; S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o13">ActiveCS</a>-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o6">Priority</a>) )
01163                 {
01164                         <a class="code" href="../../da/df4/_log_8h.html#a27">Log_StateTransition</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
01165                                 <span class="stringliteral">"ExporterProtocol_HandleDataACK"</span>,
01166                                                                 CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>,
01167                                                                 CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a>, CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a>,
01168                                 (S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o13">ActiveCS</a> ? <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a87">MSG_EXPORTER_DATA_ACK1</a> : <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a88">MSG_EXPORTER_DATA_ACK2</a>));
01169 
01170                         <a class="code" href="../../d5/db3/_exporter_8c.html#a46">Session_SelectActiveCollector</a>(E, S);
01171                         <span class="keywordflow">if</span> (S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o13">ActiveCS</a> != NULL &amp;&amp; S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o13">ActiveCS</a>-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o4">Collector</a> != NULL &amp;&amp;
01172                                 S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o13">ActiveCS</a>-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a> != NULL &amp;&amp;
01173                                 S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o13">ActiveCS</a>-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a> != NULL &amp;&amp;
01174                                 (S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o13">ActiveCS</a>-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a> == <a class="code" href="../../d5/d93/_exporter_8h.html#a52a27">IPDR_CS_ACTIVE</a>))
01175                         {
01176                 <span class="comment">/* (recursively) do it with the new active server (collector) */</span>
01177                 <span class="keywordflow">return</span> <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a48">ExporterProtocol_HandleDataACK</a>(E, S, S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o13">ActiveCS</a>-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o4">Collector</a>,
01178                                                                                                         Msg, S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o13">ActiveCS</a>-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>);
01179             }
01180                         <span class="keywordflow">else</span>
01181                         {
01182                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01183             }
01184         }
01185                 <span class="keywordflow">else</span>
01186                 {
01187             <span class="comment">/* It's normal to get an ACK from a lower priority server (collector),</span>
01188 <span class="comment">               if a fail-back has occurred. Just throw them away.</span>
01189 <span class="comment">            */</span>
01190             <a class="code" href="../../da/df4/_log_8h.html#a27">Log_StateTransition</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>,
01191                                 <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
01192                                 <span class="stringliteral">"ExporterProtocol_HandleDataACK"</span>, CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>, CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a>, CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a>,
01193                                 <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a89">MSG_EXPORTER_DATA_ACK3</a>);
01194         }
01195     }
01196     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01197 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a51" doxytag="ExporterProtocol.c::ExporterProtocol_HandleDisconnect"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_HandleDisconnect           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const MessageHeader *&nbsp;</td>
          <td class="mdname" nowrap> <em>Msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Conn</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handles a disconnect event recived from a collector<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>E</em>&nbsp;</td><td>exporter handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>session handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Coll</em>&nbsp;</td><td>collector handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Msg</em>&nbsp;</td><td>message header from the collector </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Conn</em>&nbsp;</td><td>The Connection between S to Coll </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">01412 {
01413         <a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a>*                 IC = Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>;
01414 
01415         <span class="keywordflow">if</span>( IC == NULL )
01416         {
01417                 <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
01418                   <span class="stringliteral">"ExporterProtocol_HandleDisconnect"</span>,
01419                   <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a109">MSG_NO_CONNECTION_OWNER</a>);
01420                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a> ;
01421         }
01422 
01423         <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(Conn);
01424         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01425 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a52" doxytag="ExporterProtocol.c::ExporterProtocol_HandleError"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_HandleError           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const MessageHeader *&nbsp;</td>
          <td class="mdname" nowrap> <em>Msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Conn</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handles an error event recived from a collector<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>E</em>&nbsp;</td><td>exporter handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>session handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Coll</em>&nbsp;</td><td>collector handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Msg</em>&nbsp;</td><td>message header from the collector </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Conn</em>&nbsp;</td><td>The Connection between S to Coll </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">01441 {
01442         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga10">IPDR_Time</a>               ErrorTime;
01443         <span class="keyword">const</span> ErrorMessage*     EM;
01444         <span class="keyword">enum</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a57">ErrorCode</a> ErrCode;
01445         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>    MsgLen;
01446         <span class="keywordtype">char</span>                    Buf[<a class="code" href="../../d8/d75/_exporter_protocol_8h.html#a1">EXPORTER_PROTOCOL_MAX_MSG</a>];
01447 
01448         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a68">ExporterProtocol_KeepAliveInTimerReset</a>(Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>);
01449 
01450         EM = (<span class="keyword">const</span> ErrorMessage*)Msg;
01451         ErrorTime = <a class="code" href="../../df/dde/_defs_8h.html#a12">IPDR_NTOHL</a>(EM-&gt;Timestamp);
01452     ErrCode = <a class="code" href="../../df/dde/_defs_8h.html#a11">IPDR_NTOHS</a>(EM-&gt;ErrorCode);
01453     MsgLen = <a class="code" href="../../df/dde/_defs_8h.html#a12">IPDR_NTOHL</a>(EM-&gt;DescrLength);
01454         memset(Buf, 0, <a class="code" href="../../d8/d75/_exporter_protocol_8h.html#a1">EXPORTER_PROTOCOL_MAX_MSG</a>);
01455         strncpy(Buf, (<span class="keywordtype">char</span>*)((size_t)EM + <span class="keyword">sizeof</span>(ErrorMessage)), MsgLen);
01456         Buf[MsgLen] = 0;
01457         <a class="code" href="../../da/df4/_log_8h.html#a31">Log_Write3</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a1">EXPORTER_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
01458                <span class="stringliteral">"ExporterProtocol_HandleError"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a101">MSG_EXPORTER_ERROR_RECEIVED</a>,
01459                            <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn), ErrCode, Buf);
01460         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01461 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a44" doxytag="ExporterProtocol.c::ExporterProtocol_HandleFinalTmplDataACK"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_HandleFinalTmplDataACK           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const MessageHeader *&nbsp;</td>
          <td class="mdname" nowrap> <em>Msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Conn</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle a FINAL TMPL DATA ACK arriving from a collector.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>E</em>&nbsp;</td><td>exporter handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>session handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Coll</em>&nbsp;</td><td>collector originating the message </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Msg</em>&nbsp;</td><td>received message </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Conn</em>&nbsp;</td><td>The Connection between S to Coll</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga15">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00853 {
00854         <a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html">CollectorSession</a>*       CS ;
00855         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>                     Status ;
00856         <a class="code" href="../../df/dde/_defs_8h.html#a16">IPDR_BOOL</a>                       takeThisOne ;
00857 
00858         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a68">ExporterProtocol_KeepAliveInTimerReset</a>(Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>);
00859 
00860         Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a5">ExporterProtocol_CollectorSession</a>(Coll, S, &amp;CS, &amp;takeThisOne, <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>);
00861 
00862         <span class="keywordflow">if</span>( CS == NULL )
00863         {
00864                 <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
00865                          <span class="stringliteral">"ExporterProtocol_HandleFinalTmplDataACK"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a69">MSG_EXPORTER_COLLECTOR_SESSION_FAILED</a>);
00866                 Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a57">ExporterProtocol_SendError</a>(E, S, Coll, Conn, <a class="code" href="../../db/d1e/_protocol_8h.html#a57a50">CollectorNotConfigured</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a69">MSG_EXPORTER_COLLECTOR_SESSION_FAILED</a>);
00867                 <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
00868                 {
00869                         <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(Conn);
00870                 }
00871                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>;
00872         }
00873 
00874         <span class="keywordflow">if</span>(CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o8">TmplDataTimer</a> != NULL)
00875         <a class="code" href="../../d2/dc9/_platform_8h.html#a13">Platform_UnregisterTimerAndClear</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, &amp;CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o8">TmplDataTimer</a>);
00876 
00877         <span class="keywordflow">if</span>( takeThisOne &amp;&amp; S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o10">Running</a> == <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>)
00878         {
00879                 <span class="comment">/* This collector was sent supposed to be the active one */</span>
00880                 <span class="comment">/* Send session start to this one */</span>
00881                 Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a59">ExporterProtocol_SendSessionStart</a>(E, S, CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o4">Collector</a>, CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>);
00882                 <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
00883                 {
00884                         <a class="code" href="../../da/df4/_log_8h.html#a29">Log_Write1</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
00885                          <span class="stringliteral">"ExporterProtocol_HandleFinalTmplDataACK"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a79">MSG_EXPORTER_SEND_SESSION_START_FAILED</a>,
00886                          <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn));
00887                          <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(Conn);
00888                          <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>;
00889 
00890                 }
00891                 S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o13">ActiveCS</a> = CS ;
00892                 S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o9">Retransmite</a> = <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>;
00893                 CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a> = <a class="code" href="../../d5/d93/_exporter_8h.html#a52a27">IPDR_CS_ACTIVE</a>;
00894                 Status = <a class="code" href="../../d5/db3/_exporter_8c.html#a48">Session_SendOutstandingData</a>(E, S);
00895                 <span class="comment">/* Send NN template data to rest of collectors in this session  */</span>
00896                 <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a6">ExporterProtocol_SyncTemplateDataAll</a>(E, S);
00897 
00898                 <a class="code" href="../../da/df4/_log_8h.html#a27">Log_StateTransition</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
00899                                                         <span class="stringliteral">"ExporterProtocol_HandleFinalTmplDataACK"</span>, Conn, CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a>, <a class="code" href="../../d5/d93/_exporter_8h.html#a52a27">IPDR_CS_ACTIVE</a>,
00900                                                         <span class="stringliteral">"got template final data ack - ready to send data"</span>);
00901                 <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a39">ExporterProtocol_FlushRecordsQueue</a>(E, S, CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o4">Collector</a>, <span class="stringliteral">"FinalTmplDataACK"</span>);
00902         }
00903         <span class="keywordflow">else</span>
00904         {
00905                 <span class="comment">/* check if the state is correct*/</span>
00906                 <span class="keywordflow">if</span>(CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a> != <a class="code" href="../../d5/d93/_exporter_8h.html#a52a25">IPDR_CS_INITIATION</a>)
00907                 {
00908                         <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
00909                                   <span class="stringliteral">"ExporterProtocol_HandleFlowStart"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a107">MSG_EXPORTER_COLLECTOR_NOT_INITIATION</a>);
00910                         Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a57">ExporterProtocol_SendError</a>(E, S, Coll, Conn, <a class="code" href="../../db/d1e/_protocol_8h.html#a57a46">MessageInvalidForState</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a107">MSG_EXPORTER_COLLECTOR_NOT_INITIATION</a>);
00911                         <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
00912                         {
00913                                 <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(Conn);
00914                         }
00915                         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
00916                 }
00917                 CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a> = <a class="code" href="../../d5/d93/_exporter_8h.html#a52a26">IPDR_CS_READY</a>;
00918                 <a class="code" href="../../da/df4/_log_8h.html#a27">Log_StateTransition</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
00919                             <span class="stringliteral">"ExporterProtocol_HandleFinalTmplDataACK"</span>, Conn, CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a>, <a class="code" href="../../d5/d93/_exporter_8h.html#a52a26">IPDR_CS_READY</a>,
00920                             <span class="stringliteral">"got template final data ack - not ActiveCS"</span>);
00921         }
00922     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
00923 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a41" doxytag="ExporterProtocol.c::ExporterProtocol_HandleFlowStart"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_HandleFlowStart           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const MessageHeader *&nbsp;</td>
          <td class="mdname" nowrap> <em>Msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Conn</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handles a flow start event recived from a collector<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>E</em>&nbsp;</td><td>exporter handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>session handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Coll</em>&nbsp;</td><td>collector handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Msg</em>&nbsp;</td><td>message header from the collector </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Conn</em>&nbsp;</td><td>The Connection between S to Coll </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00456 {
00457         <a class="code" href="../../df/dde/_defs_8h.html#a16">IPDR_BOOL</a>                       takeThisOne = <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
00458         <a class="code" href="../../df/dde/_defs_8h.html#a16">IPDR_BOOL</a>                       forceThisOne = <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
00459         <a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html">CollectorSession</a>                *CS     = NULL;
00460         <a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a> *IC = Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>;
00461         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>                     Status;
00462 
00463         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a68">ExporterProtocol_KeepAliveInTimerReset</a>(IC);
00464 
00465         Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a5">ExporterProtocol_CollectorSession</a>(Coll, S, &amp;CS, &amp;takeThisOne, <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>);
00466 
00467         <span class="keywordflow">if</span>( CS == NULL )
00468         {
00469                 <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
00470                          <span class="stringliteral">"ExporterProtocol_HandleFlowStart"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a69">MSG_EXPORTER_COLLECTOR_SESSION_FAILED</a>);
00471                 Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a57">ExporterProtocol_SendError</a>(E, S, Coll, Conn, <a class="code" href="../../db/d1e/_protocol_8h.html#a57a50">CollectorNotConfigured</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a69">MSG_EXPORTER_COLLECTOR_SESSION_FAILED</a>);
00472                 <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
00473                 {
00474                         <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(Conn);
00475                 }
00476                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>;
00477         }
00478 
00479 
00480         <span class="keywordflow">if</span>(IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o1">State</a> != <a class="code" href="../../d5/d93/_exporter_8h.html#a51a23">IPDR_CONNECTION_CONNECTED</a>)
00481         {
00482                 <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
00483                          <span class="stringliteral">"ExporterProtocol_HandleFlowStart"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a77">MSG_EXPORTER_COLLECTOR_NOT_CONNECTED</a>);
00484                 Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a57">ExporterProtocol_SendError</a>(E, S, Coll, Conn, <a class="code" href="../../db/d1e/_protocol_8h.html#a57a51">InvalidConnectionState</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a77">MSG_EXPORTER_COLLECTOR_NOT_CONNECTED</a>);
00485                 <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
00486                 {
00487                         <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(Conn);
00488                 }
00489                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>;
00490         }
00491 
00492         <span class="comment">/*if(S-&gt;Running == IPDR_FALSE)</span>
00493 <span class="comment">        {</span>
00494 <span class="comment">                Log_Write(EXPORTER_LOG, PROTOCOL_MODULE_ID, IPDR_LEVEL_ERROR,</span>
00495 <span class="comment">                         "ExporterProtocol_HandleFlowStart", MSG_EXPORTER_COLLECTOR_NOT_CONNECTED);</span>
00496 <span class="comment">                Status = ExporterProtocol_SendError(E, S, Coll, Conn, MessageInvalidForState, MSG_EXPORTER_WRONG_COLLECTOR_STATE);</span>
00497 <span class="comment">                if(FAILURE(Status))</span>
00498 <span class="comment">                {</span>
00499 <span class="comment">                        TL_HandleDisconnection(Conn);</span>
00500 <span class="comment">                }</span>
00501 <span class="comment">                return IPDR_ERR;</span>
00502 <span class="comment">        }*/</span>
00503 
00504         CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a> = <a class="code" href="../../d5/d93/_exporter_8h.html#a52a25">IPDR_CS_INITIATION</a>;
00505         CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a> = IC ;
00506 
00507         <span class="keywordflow">if</span>(E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o25">FlowStartCallback</a> != NULL)
00508                 E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o25">FlowStartCallback</a>(S, Coll, &amp;forceThisOne, E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o26">FlowStartCallbackArg</a>);
00509 
00510         <span class="keywordflow">if</span>( !takeThisOne &amp;&amp; !forceThisOne)
00511         {
00512                 <span class="keywordflow">if</span>(S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o13">ActiveCS</a> == NULL)
00513                 {
00514                         <span class="comment">/* Now, setup wait for best collector and sent TEMPLATE DATA later*/</span>
00515                         <span class="keywordflow">if</span>(S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o20">waitBestCollectorTimerID</a> == NULL)
00516                                 <a class="code" href="../../d2/dc9/_platform_8h.html#a9">Platform_RegisterTimer</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>,
00517                                                                 <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a7">ExporterProtocol_ConnectWaitWaitBestCollectorCallback</a>,
00518                                                                 CS,
00519                                                                 E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o4">Parameters</a>.<a class="code" href="../../d1/dac/struct_exporter_parameters.html#o8">WaitBestCollectorTimeout</a>,
00520                                                                 &amp; (S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o20">waitBestCollectorTimerID</a>));
00521                         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
00522                 }
00523                 <span class="keywordflow">else</span>
00524                 {
00525                         Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a61">ExporterProtocol_SendTemplateData</a>(E, S, CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o4">Collector</a>,
00526                                                                    CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>, <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>);
00527                         <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
00528                         {
00529                                 <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>);
00530                                 <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
00531                                           <span class="stringliteral">"ExporterProtocol_HandleFlowStart"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a70">MSG_EXPORTER_SEND_TEMPLATE_DATA_FAILED</a>);
00532                         }
00533                         <span class="keywordflow">return</span> Status;
00534                 }
00535         }
00536 
00537         <span class="keywordflow">if</span>(S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o20">waitBestCollectorTimerID</a> != NULL)
00538                 <a class="code" href="../../d2/dc9/_platform_8h.html#a13">Platform_UnregisterTimerAndClear</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, &amp;S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o20">waitBestCollectorTimerID</a>);
00539 
00540         <span class="keywordflow">return</span> <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a70">ExporterProtocol_SelectCollector</a>(E, S, <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>, forceThisOne==<a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>?CS:NULL);
00541 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a42" doxytag="ExporterProtocol.c::ExporterProtocol_HandleFlowStop"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_HandleFlowStop           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const MessageHeader *&nbsp;</td>
          <td class="mdname" nowrap> <em>Msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Conn</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handles a flow stop event recived from a collector<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>E</em>&nbsp;</td><td>exporter handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>session handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Coll</em>&nbsp;</td><td>collector handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Msg</em>&nbsp;</td><td>message header from the collector </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Conn</em>&nbsp;</td><td>The Connection between S to Coll </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00557 {
00558         <span class="keywordtype">int</span> Index;
00559         <a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html">CollectorSession</a> *SCS;
00560         <a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a> *IC = Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>;
00561         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status;
00562 
00563         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a68">ExporterProtocol_KeepAliveInTimerReset</a>(Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>);
00564 
00565         <span class="keywordflow">for</span> (Index = 0; Index &lt; S-&gt;CollectorSessions.Length; Index++)
00566         {
00567                 SCS = (<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html">CollectorSession</a> *) S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o14">CollectorSessions</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[Index];
00568                 <span class="keywordflow">if</span>(IC == SCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>)
00569                 {
00570                         <span class="keywordflow">if</span>(SCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a> != <a class="code" href="../../d5/d93/_exporter_8h.html#a52a26">IPDR_CS_READY</a> &amp;&amp; SCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a> != <a class="code" href="../../d5/d93/_exporter_8h.html#a52a27">IPDR_CS_ACTIVE</a>)
00571                         {
00572 
00573                                 <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
00574                                           <span class="stringliteral">"ExporterProtocol_HandleFlowStop"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a78">MSG_EXPORTER_WRONG_COLLECTOR_STATE</a>);
00575                                 Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a57">ExporterProtocol_SendError</a>(E, S, Coll, Conn, <a class="code" href="../../db/d1e/_protocol_8h.html#a57a46">MessageInvalidForState</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a78">MSG_EXPORTER_WRONG_COLLECTOR_STATE</a>);
00576                                 <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
00577                                 {
00578                                         <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(Conn);
00579                                 }
00580                         }
00581                         SCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a> = <a class="code" href="../../d5/d93/_exporter_8h.html#a52a24">IPDR_CS_DISCONNECTED</a> ;
00582                 }
00583         }
00584     <span class="keywordflow">return</span> <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a70">ExporterProtocol_SelectCollector</a>( E, S, <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>, NULL);
00585 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a46" doxytag="ExporterProtocol.c::ExporterProtocol_HandleGetSessions"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_HandleGetSessions           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const MessageHeader *&nbsp;</td>
          <td class="mdname" nowrap> <em>Msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Conn</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle a GET SESSIONS message from a collector.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>E</em>&nbsp;</td><td>exporter handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>session handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Coll</em>&nbsp;</td><td>collector </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Msg</em>&nbsp;</td><td>received message </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Conn</em>&nbsp;</td><td>connection</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga15">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">01019 {
01020     <span class="keyword">const</span> GetSessionsMessage *GSM = (<span class="keyword">const</span> GetSessionsMessage *) Msg;
01021         <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> RequestID = <a class="code" href="../../df/dde/_defs_8h.html#a11">IPDR_NTOHS</a>(GSM-&gt;RequestID);
01022 
01023         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a68">ExporterProtocol_KeepAliveInTimerReset</a>(Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>);
01024 
01025     <span class="keywordflow">return</span> <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a64">ExporterProtocol_SendGetSessionsResponse</a>(E, S, Coll, Conn, RequestID);
01026 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a47" doxytag="ExporterProtocol.c::ExporterProtocol_HandleGetTemplates"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_HandleGetTemplates           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const MessageHeader *&nbsp;</td>
          <td class="mdname" nowrap> <em>Msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Conn</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle a GET TMPLS message from a server (collector).<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>E</em>&nbsp;</td><td>exporter handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>session handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Coll</em>&nbsp;</td><td>collector </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Msg</em>&nbsp;</td><td>received message </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Conn</em>&nbsp;</td><td>The Connection between S to Coll</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga15">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">01044 {
01045     <span class="keyword">const</span> GetTemplatesMessage *GTH = (<span class="keyword">const</span> GetTemplatesMessage *) Msg;
01046         <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> RequestID = <a class="code" href="../../df/dde/_defs_8h.html#a11">IPDR_NTOHS</a>(GTH-&gt;RequestID);
01047 
01048         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a68">ExporterProtocol_KeepAliveInTimerReset</a>(Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>);
01049 
01050     <span class="keywordflow">return</span> <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a65">ExporterProtocol_SendGetTemplatesResponse</a>(E, S, Coll, Conn, RequestID);
01051 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a53" doxytag="ExporterProtocol.c::ExporterProtocol_HandleKeepAlive"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_HandleKeepAlive           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const MessageHeader *&nbsp;</td>
          <td class="mdname" nowrap> <em>Msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Conn</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01468 {
01469         <a class="code" href="../../d5/d93/_transport_8h.html#a28">TL_PABuf</a> paBuf;
01470         <a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a> *IC = (<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a> *)Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>;
01471         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a68">ExporterProtocol_KeepAliveInTimerReset</a>(IC);
01472         <a class="code" href="../../da/df4/_log_8h.html#a29">Log_Write1</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a1">EXPORTER_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
01473                <span class="stringliteral">"ExporterProtocol_HandleKeepAlive"</span>,
01474                <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a96">MSG_EXPORTER_SEND_KEEPALIVE_RECEIVED</a>,
01475                            <a class="code" href="../../d5/d93/_transport_8h.html#a18">TL_PrintConnectionRemote</a>(Conn, paBuf));
01476         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01477 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a43" doxytag="ExporterProtocol.c::ExporterProtocol_HandleModifyTemplate"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_HandleModifyTemplate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const MessageHeader *&nbsp;</td>
          <td class="mdname" nowrap> <em>Msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Conn</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handles a modify template event recived from a collector<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>E</em>&nbsp;</td><td>exporter handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>session handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Coll</em>&nbsp;</td><td>collector handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Msg</em>&nbsp;</td><td>message header from the collector </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Conn</em>&nbsp;</td><td>The Connection between S to Coll </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00602 {
00603         <a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a>*                                 IC;
00604         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                                    MsgLen;
00605         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*                                  ReadBuffer;
00606         <span class="keywordtype">int</span>                                                             Index, TmplIndex, IndexTC, IndexNew, iTCFld, iNewFld;
00607         <span class="keywordtype">int</span>                                                             LengthLeft;
00608         ModifyTemplateResponseMessage   H ;
00609         <a class="code" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html">TransmissionContext</a>*                            TC;
00610         <a class="code" href="../../db/dc0/struct_dynamic_array.html">DynamicArray</a>                                    NewTmpls;
00611         <a class="code" href="../../da/d62/struct_i_p_d_r__tag___template.html">Template</a>                                                *T, *TemplTC ;
00612         <a class="code" href="../../de/d6f/struct_i_p_d_r__tag___key.html">Key</a>                                                     *TCKey, *NewKey;
00613     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>                                       ConfigurationID ;
00614     <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>                                      NumOfTemplates ;
00615         <a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html">CollectorSession</a>                                *CS ;
00616         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>                                             Status;
00617         <a class="code" href="../../df/dde/_defs_8h.html#a16">IPDR_BOOL</a>                                               TemplatesChanged = <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
00618 
00619         <span class="keywordflow">if</span>(!E || !S || !Coll || !Conn || !(Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>) || !Msg)
00620                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a> ;
00621 
00622         IC = Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>;
00623         MsgLen = <a class="code" href="../../df/dde/_defs_8h.html#a12">IPDR_NTOHL</a>(Msg-&gt;MessageLength);
00624         TC = S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o3">ActiveContext</a>;
00625 
00626         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a68">ExporterProtocol_KeepAliveInTimerReset</a>(IC);
00627 
00628         <span class="comment">/* check for out of the blue ACK */</span>
00629         <span class="keywordflow">if</span>( MsgLen &lt; <span class="keyword">sizeof</span>(ModifyTemplateResponseMessage) )
00630         {
00631                 <a class="code" href="../../da/df4/_log_8h.html#a30">Log_Write2</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
00632                    <span class="stringliteral">"ExporterProtocol_HandleModifyTemplate"</span>,
00633                    <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a68">MSG_EXPORTER_TEMPLATE_RESPONSE_INVALID_VALUE</a>,
00634                    MsgLen, <span class="keyword">sizeof</span>(ModifyTemplateResponseMessage));
00635                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
00636         }
00637         memcpy( &amp;H, Msg, <span class="keyword">sizeof</span>(ModifyTemplateResponseMessage) );
00638         ConfigurationID = <a class="code" href="../../df/dde/_defs_8h.html#a11">IPDR_NTOHS</a>(H.ConfigurationID);
00639         NumOfTemplates = <a class="code" href="../../df/dde/_defs_8h.html#a12">IPDR_NTOHL</a>(H.NumOfTemplates);
00640 
00641         <span class="keywordflow">if</span> (ConfigurationID != TC-&gt;<a class="code" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html#o3">ConfigurationID</a>)
00642         {
00643         <span class="comment">/* XXX should signal error event */</span>
00644         <a class="code" href="../../da/df4/_log_8h.html#a30">Log_Write2</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
00645                            <span class="stringliteral">"ExporterProtocol_HandleModifyTemplate"</span>,
00646                            <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a15">MSG_EXPORTER_WRONG_CONFIGURATION_ID</a>, TC-&gt;<a class="code" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html#o3">ConfigurationID</a>,ConfigurationID);
00647         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
00648     }
00649 
00650         <span class="comment">// The template is not negotiable, Modify Templateis not allowed</span>
00651         <span class="keywordflow">if</span> (TC-&gt;<a class="code" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html#o4">Negotiable</a> != <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>)
00652         {
00653                 <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a170">IPDR_LEVEL_WARNING</a>,
00654                          <span class="stringliteral">"ExporterProtocol_HandleModifyTemplate"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a114">MSG_EXPORTER_INVALID_CAPABILITIES</a>);
00655                 <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a57">ExporterProtocol_SendError</a>(E, S, Coll, Conn, <a class="code" href="../../db/d1e/_protocol_8h.html#a57a45">MessageInvalidForCapabilities</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a114">MSG_EXPORTER_INVALID_CAPABILITIES</a>);
00656                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a> ;
00657         }
00658 
00659         Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a5">ExporterProtocol_CollectorSession</a>(Coll, S, &amp;CS, NULL, <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>);
00660         <span class="keywordflow">if</span>( <a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
00661         {
00662                 <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
00663                          <span class="stringliteral">"ExporterProtocol_HandleModifyTemplate"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a69">MSG_EXPORTER_COLLECTOR_SESSION_FAILED</a>);
00664                 <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a57">ExporterProtocol_SendError</a>(E, S, Coll, Conn, <a class="code" href="../../db/d1e/_protocol_8h.html#a57a50">CollectorNotConfigured</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a69">MSG_EXPORTER_COLLECTOR_SESSION_FAILED</a>);
00665                 <span class="keywordflow">return</span> Status ;
00666         }
00667 
00668         <span class="comment">/* Read the received templates into array */</span>
00669         Status = <a class="code" href="../../d3/d58/_dynamic_array_8c.html#a2">DynamicArray_Create</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, &amp;NewTmpls, 0);
00670         <span class="keywordflow">if</span>( <a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status) )
00671         {
00672                 <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
00673                          <span class="stringliteral">"ExporterProtocol_HandleModifyTemplate"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a110">MSG_EXPORTER_CREATE_DYNAMIC_ARRAY_FAILED</a>);
00674                 <span class="keywordflow">return</span> Status;
00675         }
00676 
00677         ReadBuffer = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)((size_t)Msg +
00678 <span class="keyword">sizeof</span>(ModifyTemplateResponseMessage));
00679         <span class="keywordflow">for</span>( Index = 0; Index &lt; NumOfTemplates; Index++ )
00680         {
00681                 <span class="comment">/* Calculate, how much of message left to read. Do not allow to overflow this value */</span>
00682                 LengthLeft = MsgLen - ((size_t)ReadBuffer - ((size_t)Msg +
00683 <span class="keyword">sizeof</span>(ModifyTemplateResponseMessage)));
00684                 Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a26">ExporterProtocol_ReadTemplateBlock</a>(S, &amp;T, &amp;ReadBuffer, &amp;LengthLeft );
00685                 <span class="keywordflow">if</span>( <a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status) )
00686                 {
00687                         <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
00688                                   <span class="stringliteral">"ExporterProtocol_HandleModifyTemplate"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a86">MSG_EXPORTER_READ_TEMPLATE_BLOCK_FAILED</a>);
00689                         break ;
00690                 }
00691                 Status = <a class="code" href="../../d3/d58/_dynamic_array_8c.html#a12">DynamicArray_AddElement</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, &amp; (NewTmpls), T, &amp;TmplIndex);
00692         }
00693 
00694         <span class="comment">/*Status = IPDR_OK;*/</span>
00695         <span class="keywordflow">for</span>(IndexTC = 0 ; IndexTC &lt; TC-&gt;<a class="code" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html#o2">Templates</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o1">Length</a>; IndexTC++)
00696         {
00697                 TemplTC = (<a class="code" href="../../da/d62/struct_i_p_d_r__tag___template.html">Template</a> *) TC-&gt;<a class="code" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html#o2">Templates</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[IndexTC];
00698                 <span class="keywordflow">for</span>(IndexNew = 0 ; IndexNew &lt; NewTmpls.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o1">Length</a>; IndexNew++)
00699                 {
00700                         T = (<a class="code" href="../../da/d62/struct_i_p_d_r__tag___template.html">Template</a> *) NewTmpls.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[IndexNew];
00701                         <span class="keywordflow">if</span>(TemplTC-&gt;<a class="code" href="../../da/d62/struct_i_p_d_r__tag___template.html#o0">TemplateID</a> == T-&gt;<a class="code" href="../../da/d62/struct_i_p_d_r__tag___template.html#o0">TemplateID</a>)
00702                         {
00703                                 <span class="keywordtype">int</span> keysFound = 0;
00704                                 <span class="keywordflow">for</span>(iTCFld = 0 ; iTCFld &lt; TemplTC-&gt;<a class="code" href="../../da/d62/struct_i_p_d_r__tag___template.html#o3">Keys</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o1">Length</a> ; iTCFld++)
00705                                 {
00706                                         TCKey = (<a class="code" href="../../de/d6f/struct_i_p_d_r__tag___key.html">Key</a> *) TemplTC-&gt;<a class="code" href="../../da/d62/struct_i_p_d_r__tag___template.html#o3">Keys</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[iTCFld];
00707                                         <span class="keywordflow">for</span>(iNewFld = 0 ; iNewFld &lt; T-&gt;<a class="code" href="../../da/d62/struct_i_p_d_r__tag___template.html#o3">Keys</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o1">Length</a> ; iNewFld++)
00708                                         {
00709                                                 NewKey = (<a class="code" href="../../de/d6f/struct_i_p_d_r__tag___key.html">Key</a> *) T-&gt;<a class="code" href="../../da/d62/struct_i_p_d_r__tag___template.html#o3">Keys</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[iNewFld];
00710                                                 <span class="keywordflow">if</span>(TCKey-&gt;<a class="code" href="../../de/d6f/struct_i_p_d_r__tag___key.html#o0">KeyID</a> == NewKey-&gt;<a class="code" href="../../de/d6f/struct_i_p_d_r__tag___key.html#o0">KeyID</a>)
00711                                                 {
00712                                                         keysFound++;
00713                                                         <span class="keywordflow">if</span>((TCKey-&gt;<a class="code" href="../../de/d6f/struct_i_p_d_r__tag___key.html#o1">KeyTypeID</a> &amp;~<a class="code" href="../../df/dcb/group___i_p_d_r__key__type__attributes.html#ga21">IPDR_TYPE_VAR_LENGTH</a>) != NewKey-&gt;<a class="code" href="../../de/d6f/struct_i_p_d_r__tag___key.html#o1">KeyTypeID</a>)
00714                                                         {
00715                                                                 Status = <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>;
00716                                                                 break ;
00717                                                         }
00718                                                         <span class="keywordflow">if</span>(strcmp(TCKey-&gt;<a class="code" href="../../de/d6f/struct_i_p_d_r__tag___key.html#o2">Name</a>, NewKey-&gt;<a class="code" href="../../de/d6f/struct_i_p_d_r__tag___key.html#o2">Name</a>) != 0)
00719                                                         {
00720                                                                 Status = <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>;
00721                                                                 break ;
00722                                                         }
00723 
00724                                                 }
00725                                         }
00726                                         <span class="keywordflow">if</span>(Status == <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>)
00727                                                 <span class="keywordflow">break</span>;
00728                                 }
00729                                 <span class="keywordflow">if</span>(keysFound != TemplTC-&gt;<a class="code" href="../../da/d62/struct_i_p_d_r__tag___template.html#o3">Keys</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o1">Length</a> || Status == <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>)
00730                                 {
00731                                         Status = <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>;
00732                                         break ;
00733                                 }
00734                                 <span class="keywordflow">else</span>
00735                                 {
00736                                         <span class="keywordflow">for</span>(iTCFld = 0 ; iTCFld &lt; TemplTC-&gt;<a class="code" href="../../da/d62/struct_i_p_d_r__tag___template.html#o3">Keys</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o1">Length</a> ; iTCFld++)
00737                                         {
00738                                                 TCKey = (<a class="code" href="../../de/d6f/struct_i_p_d_r__tag___key.html">Key</a> *) TemplTC-&gt;<a class="code" href="../../da/d62/struct_i_p_d_r__tag___template.html#o3">Keys</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[iTCFld];
00739                                                 <span class="keywordflow">for</span>(iNewFld = 0 ; iNewFld &lt; T-&gt;<a class="code" href="../../da/d62/struct_i_p_d_r__tag___template.html#o3">Keys</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o1">Length</a> ; iNewFld++)
00740                                                 {
00741                                                         NewKey = (<a class="code" href="../../de/d6f/struct_i_p_d_r__tag___key.html">Key</a> *) T-&gt;<a class="code" href="../../da/d62/struct_i_p_d_r__tag___template.html#o3">Keys</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[iNewFld];
00742                                                         <span class="keywordflow">if</span>(TCKey-&gt;<a class="code" href="../../de/d6f/struct_i_p_d_r__tag___key.html#o0">KeyID</a> == NewKey-&gt;<a class="code" href="../../de/d6f/struct_i_p_d_r__tag___key.html#o0">KeyID</a>)
00743                                                         {
00744                                                                 <span class="keywordflow">if</span>(TCKey-&gt;<a class="code" href="../../de/d6f/struct_i_p_d_r__tag___key.html#o5">Enabled</a> != NewKey-&gt;<a class="code" href="../../de/d6f/struct_i_p_d_r__tag___key.html#o5">Enabled</a>)
00745                                                                 {
00746                                                                         TemplatesChanged = <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>;
00747                                                                         TCKey-&gt;<a class="code" href="../../de/d6f/struct_i_p_d_r__tag___key.html#o5">Enabled</a> = NewKey-&gt;<a class="code" href="../../de/d6f/struct_i_p_d_r__tag___key.html#o5">Enabled</a>;
00748                                                                         <a class="code" href="../../da/df4/_log_8h.html#a32">Log_Write4</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a172">IPDR_LEVEL_DEBUG</a>,
00749                                                                                   <span class="stringliteral">"ExporterProtocol_HandleModifyTemplate"</span>,
00750                                                                                   <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a115">MSG_EXPORTER_TEMPLATE_CHANGE_RECIVED</a>,
00751                                                                                   TemplTC-&gt;<a class="code" href="../../da/d62/struct_i_p_d_r__tag___template.html#o0">TemplateID</a>,
00752                                                                                   TCKey-&gt;<a class="code" href="../../de/d6f/struct_i_p_d_r__tag___key.html#o0">KeyID</a>,
00753                                                                                   TCKey-&gt;<a class="code" href="../../de/d6f/struct_i_p_d_r__tag___key.html#o2">Name</a>,
00754                                                                                   TCKey-&gt;<a class="code" href="../../de/d6f/struct_i_p_d_r__tag___key.html#o5">Enabled</a> == <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a> ? <span class="stringliteral">"Enable"</span> : <span class="stringliteral">"Disable"</span>);
00755                                                                 }
00756                                                         }
00757                                                 }
00758                                         }
00759                                 }
00760                         }
00761                         <span class="keywordflow">if</span>(Status == <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>)
00762                                 <span class="keywordflow">break</span>;
00763                 }
00764                 <span class="keywordflow">if</span>(Status == <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>)
00765                         <span class="keywordflow">break</span>;
00766         }
00767 
00768         <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a17">SUCCESS</a>(Status))
00769         {
00770                 <span class="keywordflow">if</span>(CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o8">TmplDataTimer</a> != NULL)
00771                 <a class="code" href="../../d2/dc9/_platform_8h.html#a13">Platform_UnregisterTimerAndClear</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, &amp;CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o8">TmplDataTimer</a>);
00772 
00773                 <span class="keywordflow">if</span>(TemplatesChanged == <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>)
00774                 {
00775                         S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o12">TemplatesChnged</a> = <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>;
00776                         <a class="code" href="../../d5/db3/_exporter_8c.html#a97">Exporter_TriggeTemplateChangedCallback</a>(S);
00777 
00778                         <a class="code" href="../../d5/d93/_exporter_8h.html#a3">EXPORTER_QHANDLER</a>-&gt;CleanUP(E, S);
00779                         <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
00780                                                   <span class="stringliteral">"ExporterProtocol_HandleModifyTemplate"</span>,
00781                                                         <span class="stringliteral">"Template Changed, Must CleanUP Queue."</span>);
00782                         
00783                         <span class="keywordflow">for</span>(IndexTC = 0 ; IndexTC &lt; TC-&gt;<a class="code" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html#o2">Templates</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o1">Length</a>; IndexTC++)
00784                         {
00785                                 TemplTC = (<a class="code" href="../../da/d62/struct_i_p_d_r__tag___template.html">Template</a> *) TC-&gt;<a class="code" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html#o2">Templates</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[IndexTC];
00786                                 <span class="keywordflow">for</span>(iTCFld = 0 ; iTCFld &lt; TemplTC-&gt;<a class="code" href="../../da/d62/struct_i_p_d_r__tag___template.html#o3">Keys</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o1">Length</a> ; iTCFld++)
00787                                 {
00788                                         TCKey = (<a class="code" href="../../de/d6f/struct_i_p_d_r__tag___key.html">Key</a> *) TemplTC-&gt;<a class="code" href="../../da/d62/struct_i_p_d_r__tag___template.html#o3">Keys</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[iTCFld];
00789                                         <a class="code" href="../../da/df4/_log_8h.html#a32">Log_Write4</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a172">IPDR_LEVEL_DEBUG</a>,
00790                                                   <span class="stringliteral">"ExporterProtocol_HandleModifyTemplate"</span>,
00791                                                   <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a116">MSG_EXPORTER_TEMPLATE_CHANGE_SENT</a>,
00792                                                   TemplTC-&gt;<a class="code" href="../../da/d62/struct_i_p_d_r__tag___template.html#o0">TemplateID</a>,
00793                                                   TCKey-&gt;<a class="code" href="../../de/d6f/struct_i_p_d_r__tag___key.html#o0">KeyID</a>,
00794                                                   TCKey-&gt;<a class="code" href="../../de/d6f/struct_i_p_d_r__tag___key.html#o2">Name</a>,
00795                                                   TCKey-&gt;<a class="code" href="../../de/d6f/struct_i_p_d_r__tag___key.html#o5">Enabled</a> == <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a> ? <span class="stringliteral">"Enable"</span> : <span class="stringliteral">"Disable"</span>);
00796                                 }
00797                         }
00798                 }
00799 
00800                 Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a62">ExporterProtocol_SendModifyTemplateResponse</a>(E, S, Coll, Conn);
00801                 <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
00802                 {
00803                         <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(Conn);
00804                 }
00805         }
00806         <span class="keywordflow">else</span>
00807         {
00808                 <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a1">EXPORTER_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a170">IPDR_LEVEL_WARNING</a>,
00809                           <span class="stringliteral">"ExporterProtocol_HandleModifyTemplate"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a83">MSG_EXPORTER_BROKEN_TEMPLATE</a>);
00810                 Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a57">ExporterProtocol_SendError</a>(E, S, Coll, Conn, <a class="code" href="../../db/d1e/_protocol_8h.html#a57a49">BrokenTemplate</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a83">MSG_EXPORTER_BROKEN_TEMPLATE</a>);
00811                 <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
00812                 {
00813                         <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(Conn);
00814                 }
00815         }
00816 
00817 
00818         <a class="code" href="../../d3/d58/_dynamic_array_8c.html#a5">DynamicArray_Delete</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, &amp;(NewTmpls));
00819 
00820     <span class="comment">/* check if there is a need to change the currently active server (collector) */</span>
00821     <span class="keywordflow">if</span> (S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o13">ActiveCS</a> == NULL || CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o6">Priority</a> &lt; S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o13">ActiveCS</a>-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o6">Priority</a>) {
00822                 <a class="code" href="../../d5/db3/_exporter_8c.html#a46">Session_SelectActiveCollector</a>(E, S);
00823     }
00824 
00825     <span class="comment">/* handle the changes placed within the message */</span>
00826     <span class="comment">/*Session_HandleTemplateChanges(E, S, NumOfTemplates,</span>
00827 <span class="comment">                                  (unsigned char*)((size_t)Msg +</span>
00828 <span class="comment">                                                                        sizeof(ModifyTemplateResponseMessage)),</span>
00829 <span class="comment">                                  IPDR_FALSE, IPDR_FALSE, IPDR_FALSE);*/</span>
00830 
00831     <span class="comment">/* send any outstanding data */</span>
00832     <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a39">ExporterProtocol_FlushRecordsQueue</a>(E, S, Coll, <span class="stringliteral">"TmplDataACK"</span>);
00833 
00834     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
00835 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a45" doxytag="ExporterProtocol.c::ExporterProtocol_HandleStartNegotiation"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_HandleStartNegotiation           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const MessageHeader *&nbsp;</td>
          <td class="mdname" nowrap> <em>Msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Conn</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle a START NEGOTIATE message from a collector.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>E</em>&nbsp;</td><td>exporter handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>session handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Coll</em>&nbsp;</td><td>server </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Msg</em>&nbsp;</td><td>received message </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Conn</em>&nbsp;</td><td>connection</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga15">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00941 {
00942         <a class="code" href="../../df/dde/_defs_8h.html#a16">IPDR_BOOL</a> Negotiate =   <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a> ;
00943         <a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html">CollectorSession</a>*       CS;
00944         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>             Status ;
00945 
00946         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a68">ExporterProtocol_KeepAliveInTimerReset</a>(Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>);
00947 
00948         <span class="keywordflow">if</span>(E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o27">StartNegotiationCallback</a> != NULL)
00949                 E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o27">StartNegotiationCallback</a>(S, Coll, &amp;Negotiate, E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o28">StartNegotiationCallbackArg</a>);
00950 
00951         <span class="keywordflow">if</span>(Negotiate == <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a> &amp;&amp; S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o11">Negotiable</a> == <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>)
00952         {
00953                 <span class="keywordflow">if</span>( <a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(<a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a5">ExporterProtocol_CollectorSession</a>(Coll, S, &amp;CS, NULL, <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>)))
00954                 {
00955                         <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
00956                                           <span class="stringliteral">"ExporterProtocol_HandleStartNegotiation"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a108">MSG_EXPORTER_SEND_NEGOTIATION_REJECT_FAILED</a>);
00957                         <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(Conn);
00958                         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>;
00959                 }
00960                 <span class="keywordflow">if</span>( CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a> != <a class="code" href="../../d5/d93/_exporter_8h.html#a52a27">IPDR_CS_ACTIVE</a> )
00961                 {
00962                         <span class="comment">/* TODO: set up correct message defines*/</span>
00963                         <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
00964                                           <span class="stringliteral">"ExporterProtocol_HandleStartNegotiation"</span>, <span class="stringliteral">"StartNegotiation is invalid in this state"</span>);
00965                         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a57">ExporterProtocol_SendError</a>(E, S, Coll, Conn, <a class="code" href="../../db/d1e/_protocol_8h.html#a57a46">MessageInvalidForState</a>, <span class="stringliteral">"StartNegotiation is invalid in this state"</span>);
00966                         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>;
00967                 }
00968                 CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a> = <a class="code" href="../../d5/d93/_exporter_8h.html#a52a25">IPDR_CS_INITIATION</a>;
00969                 <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a39">ExporterProtocol_FlushRecordsQueue</a>(E, S, Coll, <span class="stringliteral">"StartNegotiate"</span>);
00970 
00971                 Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a60">ExporterProtocol_SendSessionStop</a>(E, S, Coll, Conn, <a class="code" href="../../df/dcb/group___i_p_d_r__key__type__attributes.html#gga33a124">IPDR_STOP_REASON_RENEGOTIATION</a>, <span class="stringliteral">"StartNegotiate"</span>);
00972                 <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
00973                 {
00974                         <a class="code" href="../../da/df4/_log_8h.html#a29">Log_Write1</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
00975                                    <span class="stringliteral">"ExporterProtocol_HandleStartNegotiation"</span>,
00976                                    <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a98">MSG_EXPORTER_SEND_SESSION_STOP_FAILED</a>,<span class="stringliteral">"StartNegotiate"</span>);
00977                         <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(Conn);
00978                         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>;
00979                 }
00980                 Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a61">ExporterProtocol_SendTemplateData</a>(E, S, Coll, Conn, <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>);
00981                 <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
00982                 {
00983                         <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
00984                                           <span class="stringliteral">"ExporterProtocol_HandleStartNegotiation"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a70">MSG_EXPORTER_SEND_TEMPLATE_DATA_FAILED</a>);
00985                         <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(Conn);
00986                         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>;
00987                 }
00988         }
00989         <span class="keywordflow">else</span>
00990         {
00991                 Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a63">ExporterProtocol_SendStartNegotiationReject</a>(E, S, Coll, Conn);
00992                 <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
00993                 {
00994                         <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
00995                                           <span class="stringliteral">"ExporterProtocol_HandleStartNegotiation"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a108">MSG_EXPORTER_SEND_NEGOTIATION_REJECT_FAILED</a>);
00996                         <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(Conn);
00997                         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>;
00998                 }
00999         }
01000     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01001 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a67" doxytag="ExporterProtocol.c::ExporterProtocol_HandleUnknownMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_HandleUnknownMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const MessageHeader *&nbsp;</td>
          <td class="mdname" nowrap> <em>Msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Conn</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle an unknown message from a server (collector).<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>E</em>&nbsp;</td><td>exporter handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>session handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Coll</em>&nbsp;</td><td>collector originating the message </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Msg</em>&nbsp;</td><td>received message </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Conn</em>&nbsp;</td><td>connection</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga15">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">03137 {
03138     <span class="keywordtype">char</span> errorMsg[200];
03139 
03140     <a class="code" href="../../da/df4/_log_8h.html#a30">Log_Write2</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a1">EXPORTER_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a170">IPDR_LEVEL_WARNING</a>,
03141                <span class="stringliteral">"ExporterProtocol_DataCallback"</span>,
03142                <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a48">MSG_EXPORTER_UNKNOWN_MSG</a>,
03143                Msg-&gt;MessageID, Msg-&gt;MessageID);
03144 
03145     sprintf(errorMsg, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a48">MSG_EXPORTER_UNKNOWN_MSG</a>, Msg-&gt;MessageID, Msg-&gt;MessageID);
03146     <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a57">ExporterProtocol_SendError</a>(E, S, Coll, Conn, <a class="code" href="../../db/d1e/_protocol_8h.html#a57a47">MessageDecodeError</a>, errorMsg);
03147 
03148     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
03149 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="ExporterProtocol.c::ExporterProtocol_KeepAliveInTimerCallback"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void ExporterProtocol_KeepAliveInTimerCallback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Arg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">03255 {
03256         <a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a> * IC = (<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a> *)Arg;
03257         <a class="code" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll = IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o4">Owner</a>;
03258         <a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> * E = IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o10">ExporterPtr</a>;
03259         <a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn = IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>;
03260         
03261         <span class="keywordflow">if</span>(IC == NULL)
03262                 return ;
03263                 
03264         <span class="keywordflow">if</span>(! IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a> || ! Coll || ! E)
03265         {
03266                 return ;
03267         }
03268 
03269         <a class="code" href="../../d2/dc9/_platform_8h.html#a34">Platform_Lock</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>);
03270 
03271         <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a1">EXPORTER_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
03272                <span class="stringliteral">"ExporterProtocol_KeepAliveInTimerCallback"</span>,
03273                <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a99">MSG_EXPORTER_NO_KEEPALIVE_RECEIVED</a>);
03274 
03275         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a57">ExporterProtocol_SendError</a>(E, NULL, Coll, Conn, <a class="code" href="../../db/d1e/_protocol_8h.html#a57a44">KeepAliveExpired</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a99">MSG_EXPORTER_NO_KEEPALIVE_RECEIVED</a>);
03276 
03277         <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>);
03278         
03279         <a class="code" href="../../d2/dc9/_platform_8h.html#a35">Platform_Unlock</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>);
03280 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a68" doxytag="ExporterProtocol.c::ExporterProtocol_KeepAliveInTimerReset"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ExporterProtocol_KeepAliveInTimerReset           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>IC</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">03194 {
03195         <a class="code" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll = NULL;
03196         <a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> * E = NULL;
03197 
03198         <span class="keywordflow">if</span>(IC == NULL)
03199                 return ;
03200 
03201         Coll = IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o4">Owner</a>;
03202         E = IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o10">ExporterPtr</a>;
03203 
03204         <a class="code" href="../../d2/dc9/_platform_8h.html#a34">Platform_Lock</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>);
03205         
03206         <span class="keywordflow">if</span>(IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o6">KeepAliveINTimerID</a> != NULL)
03207         {
03208                 <a class="code" href="../../d2/dc9/_platform_8h.html#a13">Platform_UnregisterTimerAndClear</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, &amp;IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o6">KeepAliveINTimerID</a>);
03209                 IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o6">KeepAliveINTimerID</a> = NULL;
03210         }
03211         <span class="keywordflow">if</span>(IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o1">State</a> == <a class="code" href="../../d5/d93/_exporter_8h.html#a51a23">IPDR_CONNECTION_CONNECTED</a>)
03212         {
03213                 <a class="code" href="../../d2/dc9/_platform_8h.html#a11">Platform_RegisterPeriodicTimer</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>,
03214                                                                 <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a29">ExporterProtocol_KeepAliveInTimerCallback</a>,
03215                                                                 IC,
03216                                                                 (E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o4">Parameters</a>.<a class="code" href="../../d1/dac/struct_exporter_parameters.html#o4">KeepAliveInterval</a>)+500,
03217                                                                 &amp; (IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o6">KeepAliveINTimerID</a>));
03218         }                                               
03219         <a class="code" href="../../d2/dc9/_platform_8h.html#a35">Platform_Unlock</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>);
03220 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="ExporterProtocol.c::ExporterProtocol_KeepAliveOutTimerCallback"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void ExporterProtocol_KeepAliveOutTimerCallback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Arg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">03284 {
03285         <a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a> * IC = (<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a> *)Arg;
03286         <a class="code" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll = IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o4">Owner</a>;
03287         <a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> * E = IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o10">ExporterPtr</a>;
03288         
03289         <span class="keywordflow">if</span>(IC == NULL)
03290                 return ;
03291                 
03292         <span class="keywordflow">if</span>(! IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a> || ! Coll || ! E)
03293         {
03294                 return ;
03295         }
03296         
03297         <a class="code" href="../../d2/dc9/_platform_8h.html#a34">Platform_Lock</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>);
03298         
03299         <span class="comment">/*TODO: print info message, message mus be #define XXXXXX "xxxxxx" */</span>
03300         <span class="comment">/*NOTE: about what??? */</span>
03301         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a58">ExporterProtocol_SendKeepAlive</a>(E, NULL, Coll, IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>);
03302         
03303         <a class="code" href="../../d2/dc9/_platform_8h.html#a35">Platform_Unlock</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>);
03304 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a69" doxytag="ExporterProtocol.c::ExporterProtocol_KeepAliveOutTimerReset"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ExporterProtocol_KeepAliveOutTimerReset           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>IC</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">03224 {
03225         <a class="code" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll = NULL;
03226         <a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> * E = NULL;
03227 
03228         <span class="keywordflow">if</span>(IC == NULL)
03229                 return ;
03230 
03231         Coll = IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o4">Owner</a>;
03232         E = IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o10">ExporterPtr</a>;
03233 
03234         <a class="code" href="../../d2/dc9/_platform_8h.html#a34">Platform_Lock</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>);       
03235 
03236         <span class="keywordflow">if</span>(IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o7">KeepAliveOUTTimerID</a> != NULL)
03237         {
03238                 <a class="code" href="../../d2/dc9/_platform_8h.html#a13">Platform_UnregisterTimerAndClear</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, &amp;IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o7">KeepAliveOUTTimerID</a>);
03239                 IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o7">KeepAliveOUTTimerID</a> = NULL;
03240         }
03241         
03242         <span class="keywordflow">if</span>(IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o1">State</a> == <a class="code" href="../../d5/d93/_exporter_8h.html#a51a23">IPDR_CONNECTION_CONNECTED</a>)
03243         {
03244                 <a class="code" href="../../d2/dc9/_platform_8h.html#a11">Platform_RegisterPeriodicTimer</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>,
03245                                                                 <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a30">ExporterProtocol_KeepAliveOutTimerCallback</a>,
03246                                                                 IC,
03247                                                                 ((IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o8">RemoteKeepAliveInterval</a>)*1000)-500,
03248                                                                 &amp; (IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o7">KeepAliveOUTTimerID</a>));
03249         }                                               
03250         <a class="code" href="../../d2/dc9/_platform_8h.html#a35">Platform_Unlock</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>);
03251 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="ExporterProtocol.c::ExporterProtocol_NeedSessionID"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../df/dde/_defs_8h.html#a16">IPDR_BOOL</a> ExporterProtocol_NeedSessionID           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">unsigned char&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>MessageID</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Tests is a message requires SessionID to be sent<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>MessageID</em>&nbsp;</td><td>received message ID</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a> if so; <a class="el" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">03161 {
03162     <span class="keywordflow">switch</span> (MessageID) {
03163 
03164     <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a19">IPDR_MSG_FLOW_START</a>:                           <span class="keywordflow">return</span> <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>;
03165     <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a20">IPDR_MSG_FLOW_STOP</a>:                            <span class="keywordflow">return</span> <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>;
03166     <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a21">IPDR_MSG_MODIFY_TEMPLATE</a>:                      <span class="keywordflow">return</span> <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>;
03167     <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a22">IPDR_MSG_FINAL_TEMPLATE_DATA_ACK</a>:      <span class="keywordflow">return</span> <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>;
03168     <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a23">IPDR_MSG_START_NEGOTIATION</a>:            <span class="keywordflow">return</span> <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>;
03169     <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a24">IPDR_MSG_GET_SESSIONS</a>:                         <span class="keywordflow">return</span> <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
03170     <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a25">IPDR_MSG_GET_TEMPLATES</a>:                        <span class="keywordflow">return</span> <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>;
03171     <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a26">IPDR_MSG_DATA_ACK</a>:                                     <span class="keywordflow">return</span> <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>;
03172 
03173     <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a27">IPDR_MSG_CONNECT</a>:                                      <span class="keywordflow">return</span> <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
03174     <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a28">IPDR_MSG_CONNECT_RESPONSE</a>:                     <span class="keywordflow">return</span> <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
03175     <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a29">IPDR_MSG_DISCONNECT</a>:                           <span class="keywordflow">return</span> <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
03176     <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a30">IPDR_MSG_ERROR</a>:                                        <span class="keywordflow">return</span> <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
03177     <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a31">IPDR_MSG_KEEP_ALIVE</a>:                           <span class="keywordflow">return</span> <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
03178 
03179     <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a32">IPDR_MSG_SESSION_START</a>:                        <span class="keywordflow">return</span> <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>;
03180     <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a33">IPDR_MSG_SESSION_STOP</a>:                         <span class="keywordflow">return</span> <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>;
03181     <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a34">IPDR_MSG_TEMPLATE_DATA</a>:                        <span class="keywordflow">return</span> <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>;
03182     <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a35">IPDR_MSG_MODIFY_TEMPLATE_RESPONSE</a>:     <span class="keywordflow">return</span> <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>;
03183     <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a36">IPDR_MSG_START_NEGOTIATION_REJECT</a>:     <span class="keywordflow">return</span> <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>;
03184     <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a37">IPDR_MSG_GET_SESSIONS_RESPONSE</a>:        <span class="keywordflow">return</span> <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
03185     <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a38">IPDR_MSG_GET_TEMPLATES_RESPONSE</a>:       <span class="keywordflow">return</span> <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
03186     <span class="keywordflow">case</span> <a class="code" href="../../db/d1e/_protocol_8h.html#a39">IPDR_MSG_DATA</a>:                                         <span class="keywordflow">return</span> <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>;
03187     }
03188     <span class="keywordflow">return</span> <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
03189 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="ExporterProtocol.c::ExporterProtocol_ReadFieldDescriptorBlock"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_ReadFieldDescriptorBlock           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../da/d62/struct_i_p_d_r__tag___template.html">Template</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>T</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned char **&nbsp;</td>
          <td class="mdname" nowrap> <em>Buffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>LengthLeft</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
reads the fields data from the template.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>session handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>T</em>&nbsp;</td><td>the template that holds the block to be read </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Buffer</em>&nbsp;</td><td>the source of the block </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>LengthLeft</em>&nbsp;</td><td>determnes the size left in the buffer.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga15">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">02425 {
02426         <span class="keywordtype">int</span>                                             TypeID ;
02427         <span class="keywordtype">int</span>                                             FieldID ;
02428         <span class="keywordtype">char</span>*                                   FieldName;
02429         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>                   Enabled;
02430         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>                     Status = <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a> ;
02431 
02432         Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a23">ExporterProtocol_ReadTemplateInt</a>(S, &amp;TypeID, Buffer, LengthLeft);
02433         <span class="keywordflow">if</span>( <a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status) )
02434         {
02435                 <span class="keywordflow">return</span> Status;
02436         }
02437 
02438         Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a23">ExporterProtocol_ReadTemplateInt</a>(S, &amp;FieldID, Buffer, LengthLeft);
02439         <span class="keywordflow">if</span>( <a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status) )
02440         {
02441                 <span class="keywordflow">return</span> Status;
02442         }
02443 
02444         Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a24">ExporterProtocol_ReadTemplateString</a>(S, &amp;FieldName, Buffer, LengthLeft);
02445         <span class="keywordflow">if</span>( <a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status) )
02446         {
02447                 <span class="keywordflow">return</span> Status;
02448         }
02449 
02450         Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a27">ExporterProtocol_ReadTemplateByte</a>(S, &amp;Enabled, Buffer, LengthLeft);
02451         <span class="keywordflow">if</span>( <a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status) )
02452         {
02453                 <a class="code" href="../../d5/d55/_memory_management_8c.html#a5">Object_Release</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a5">SESSION_PLATFORM</a>, FieldName);
02454                 <span class="keywordflow">return</span> Status;
02455         }
02456         Status = <a class="code" href="../../dd/d68/_templates_8c.html#a18">Template_AddKey</a>(S, T, FieldID, TypeID, FieldName, NULL, NULL, Enabled, 0, NULL, NULL);
02457         <span class="keywordflow">if</span>( <a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status) )
02458         {
02459                 <a class="code" href="../../d5/d55/_memory_management_8c.html#a5">Object_Release</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a5">SESSION_PLATFORM</a>, FieldName);
02460                 <span class="keywordflow">return</span> Status;
02461         }
02462 
02463         <span class="keywordflow">return</span> Status;
02464 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="ExporterProtocol.c::ExporterProtocol_ReadTemplateBlock"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_ReadTemplateBlock           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../da/d62/struct_i_p_d_r__tag___template.html">Template</a> **&nbsp;</td>
          <td class="mdname" nowrap> <em>T</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned char **&nbsp;</td>
          <td class="mdname" nowrap> <em>Buffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>LengthLeft</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
reads all data from the template.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>session handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>T</em>&nbsp;</td><td>the template that holds the block to be read </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Buffer</em>&nbsp;</td><td>the source of the block </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>LengthLeft</em>&nbsp;</td><td>determnes the size left in the buffer.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga15">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">02477 {
02478         <span class="keywordtype">int</span>                                     Index ;
02479         <span class="keywordtype">short</span>                                   TemplateId ;
02480         <span class="keywordtype">char</span>*                                   SchemaName;
02481         <span class="keywordtype">char</span>*                                   TypeName;
02482         <span class="keywordtype">int</span>                                             NumFields ;
02483         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>                     Status = <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a> ;
02484         <a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a>* E = S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o19">ExporterPtr</a>;
02485 
02486         Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a22">ExporterProtocol_ReadTemplateShort</a>(S, &amp;TemplateId, Buffer, LengthLeft);
02487         <span class="keywordflow">if</span>( <a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status) )
02488         {
02489                 <span class="keywordflow">return</span> Status;
02490         }
02491 
02492         Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a24">ExporterProtocol_ReadTemplateString</a>(S, &amp;SchemaName, Buffer, LengthLeft);
02493         <span class="keywordflow">if</span>( <a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status) )
02494         {
02495                 <span class="keywordflow">return</span> Status;
02496         }
02497 
02498         Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a24">ExporterProtocol_ReadTemplateString</a>(S, &amp;TypeName, Buffer, LengthLeft);
02499         <span class="keywordflow">if</span>( <a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status) )
02500         {
02501                 <a class="code" href="../../d5/d55/_memory_management_8c.html#a5">Object_Release</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a5">SESSION_PLATFORM</a>, SchemaName);
02502                 <span class="keywordflow">return</span> Status;
02503         }
02504 
02505         Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a23">ExporterProtocol_ReadTemplateInt</a>(S, &amp;NumFields, Buffer, LengthLeft);
02506         <span class="keywordflow">if</span>( <a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status) )
02507         {
02508                 <a class="code" href="../../d5/d55/_memory_management_8c.html#a5">Object_Release</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a5">SESSION_PLATFORM</a>, SchemaName);
02509                 <a class="code" href="../../d5/d55/_memory_management_8c.html#a5">Object_Release</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a5">SESSION_PLATFORM</a>, TypeName);
02510                 <span class="keywordflow">return</span> Status;
02511         }
02512 
02513 
02514         Status = <a class="code" href="../../dd/d68/_templates_8c.html#a19">Template_Create</a>(S, TemplateId, SchemaName, TypeName, 0, <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>, T);
02515         <span class="keywordflow">if</span>( <a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status) )
02516         {
02517                 <a class="code" href="../../d5/d55/_memory_management_8c.html#a5">Object_Release</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a5">SESSION_PLATFORM</a>, SchemaName);
02518                 <a class="code" href="../../d5/d55/_memory_management_8c.html#a5">Object_Release</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a5">SESSION_PLATFORM</a>, TypeName);
02519                 <span class="keywordflow">return</span> Status;
02520         }
02521 
02522         <span class="keywordflow">for</span>( Index = 0 ; Index  &lt; NumFields ; Index++ )
02523         {
02524                 Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a25">ExporterProtocol_ReadFieldDescriptorBlock</a>(S, *T, Buffer, LengthLeft);
02525                 <span class="keywordflow">if</span>( <a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status) )
02526                 {
02527                         <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
02528                                   <span class="stringliteral">"ExporterProtocol_ReadTemplateBlock"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a85">MSG_EXPORTER_READ_FIELD_DESCRIPTOR_FAILED</a>);
02529                         <a class="code" href="../../d5/d55/_memory_management_8c.html#a5">Object_Release</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a5">SESSION_PLATFORM</a>, *T);
02530                         break ;
02531                 }
02532         }
02533         <span class="keywordflow">return</span> Status ;
02534 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="ExporterProtocol.c::ExporterProtocol_ReadTemplateByte"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_ReadTemplateByte           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned char *&nbsp;</td>
          <td class="mdname" nowrap> <em>Byte</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned char **&nbsp;</td>
          <td class="mdname" nowrap> <em>Buffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>LengthLeft</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02310 {
02311         <a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E = S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o19">ExporterPtr</a>;
02312 
02313         <span class="keywordflow">if</span>( *LengthLeft &lt; <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> char) )
02314         {
02315                 <a class="code" href="../../da/df4/_log_8h.html#a31">Log_Write3</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
02316                           <span class="stringliteral">"ExporterProtocol_ReadTemplateInt"</span>,
02317                           <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a71">MSG_EXPORTER_READ_TEMPLATE_INVALID_VALUE</a>,<span class="stringliteral">"unsigned char"</span>,<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>),*LengthLeft);
02318                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a181">IPDR_ERR_INVALID_VALUE</a> ;
02319         }
02320         memcpy( Byte, *Buffer, <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) );
02321         *Buffer += <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> char);
02322         *LengthLeft -= <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> char);
02323         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
02324 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="ExporterProtocol.c::ExporterProtocol_ReadTemplateInt"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_ReadTemplateInt           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>Ints</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned char **&nbsp;</td>
          <td class="mdname" nowrap> <em>Buffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>LengthLeft</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02349 {
02350         <span class="keywordtype">int</span> nInt;
02351         <a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E = S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o19">ExporterPtr</a>;
02352 
02353         <span class="keywordflow">if</span>( *LengthLeft &lt; <span class="keyword">sizeof</span>(int) )
02354         {
02355                 <a class="code" href="../../da/df4/_log_8h.html#a31">Log_Write3</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
02356                           <span class="stringliteral">"ExporterProtocol_ReadTemplateInt"</span>,
02357                           <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a71">MSG_EXPORTER_READ_TEMPLATE_INVALID_VALUE</a>,<span class="stringliteral">"int"</span>,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>),*LengthLeft);
02358                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a181">IPDR_ERR_INVALID_VALUE</a> ;
02359         }
02360         memcpy( &amp;nInt, *Buffer, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) );
02361         *Buffer += <span class="keyword">sizeof</span>(int);
02362         *LengthLeft -= <span class="keyword">sizeof</span>(int);
02363         *Int = ntohl(nInt);
02364         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
02365 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="ExporterProtocol.c::ExporterProtocol_ReadTemplateShort"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_ReadTemplateShort           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>short *&nbsp;</td>
          <td class="mdname" nowrap> <em>Short</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned char **&nbsp;</td>
          <td class="mdname" nowrap> <em>Buffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>LengthLeft</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02329 {
02330         <a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E = S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o19">ExporterPtr</a>;
02331         <span class="keywordtype">short</span> nShort;
02332 
02333         <span class="keywordflow">if</span>( *LengthLeft &lt; <span class="keyword">sizeof</span>(short) )
02334         {
02335                 <a class="code" href="../../da/df4/_log_8h.html#a31">Log_Write3</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
02336                           <span class="stringliteral">"ExporterProtocol_ReadTemplateShort"</span>,
02337                           <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a71">MSG_EXPORTER_READ_TEMPLATE_INVALID_VALUE</a>,<span class="stringliteral">"short"</span>,<span class="keyword">sizeof</span>(<span class="keywordtype">short</span>),*LengthLeft);
02338                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a181">IPDR_ERR_INVALID_VALUE</a> ;
02339         }
02340         memcpy( &amp;nShort, *Buffer, <span class="keyword">sizeof</span>(<span class="keywordtype">short</span>) );
02341         *Buffer += <span class="keyword">sizeof</span>(short);
02342         *LengthLeft -= <span class="keyword">sizeof</span>(short);
02343         *Short = ntohs(nShort);
02344         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
02345 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="ExporterProtocol.c::ExporterProtocol_ReadTemplateString"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_ReadTemplateString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char **&nbsp;</td>
          <td class="mdname" nowrap> <em>String</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned char **&nbsp;</td>
          <td class="mdname" nowrap> <em>Buffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>LengthLeft</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Reads a string from a template.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>session handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>String</em>&nbsp;</td><td>will hold the string read from the template </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Buffer</em>&nbsp;</td><td>the source of the string </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>LengthLeft</em>&nbsp;</td><td>determnes the size left in the buffer.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga15">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">02380 {
02381         <span class="keywordtype">int</span>                     StringLen;
02382         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status = <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a> ;
02383         <a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a>*       E = S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o19">ExporterPtr</a>;
02384 
02385         Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a23">ExporterProtocol_ReadTemplateInt</a>(S, &amp;StringLen, Buffer, LengthLeft);
02386 
02387         <span class="keywordflow">if</span>( StringLen == 0 )
02388         {
02389                 *String = NULL ;
02390                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
02391         }
02392         <span class="keywordflow">if</span>( *LengthLeft &lt; StringLen  )
02393         {
02394                 <a class="code" href="../../da/df4/_log_8h.html#a31">Log_Write3</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
02395                           <span class="stringliteral">"ExporterProtocol_ReadTemplateString"</span>,
02396                           <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a71">MSG_EXPORTER_READ_TEMPLATE_INVALID_VALUE</a>,<span class="stringliteral">"int"</span>,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>),*LengthLeft);
02397                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a181">IPDR_ERR_INVALID_VALUE</a> ;
02398         }
02399 
02400         Status = <a class="code" href="../../d5/d55/_memory_management_8c.html#a2">Object_Allocate</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a5">SESSION_PLATFORM</a>, StringLen+1, NULL, (<span class="keywordtype">void</span> **)String);
02401         <span class="keywordflow">if</span>( <a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status) )
02402         {
02403                 <span class="keywordflow">return</span> Status ;
02404         }
02405         memcpy( *String, *Buffer, StringLen );
02406         *Buffer+= StringLen;
02407         *LengthLeft-=StringLen;
02408         (*String)[StringLen] = <span class="charliteral">'\0'</span> ;
02409 
02410         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
02411 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a71" doxytag="ExporterProtocol.c::ExporterProtocol_ResetIPDRConnection"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_ResetIPDRConnection           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>IC</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Fully closes a connection <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>E</em>&nbsp;</td><td>exporter handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>IC</em>&nbsp;</td><td>Contains information about a ipdr connection (IPDRConnection structure) </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">03707 {
03708         <span class="keywordflow">if</span>(IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o5">ConnectResponseTimerID</a> != NULL)
03709         {
03710                 <a class="code" href="../../d2/dc9/_platform_8h.html#a13">Platform_UnregisterTimerAndClear</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, &amp;IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o5">ConnectResponseTimerID</a>);
03711                 IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o5">ConnectResponseTimerID</a> = NULL;
03712         }
03713         <span class="keywordflow">if</span>(IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o6">KeepAliveINTimerID</a> != NULL)
03714         {
03715                 <a class="code" href="../../d2/dc9/_platform_8h.html#a13">Platform_UnregisterTimerAndClear</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, &amp;IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o6">KeepAliveINTimerID</a>);
03716                 IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o6">KeepAliveINTimerID</a> = NULL;
03717         }
03718         <span class="keywordflow">if</span>(IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o7">KeepAliveOUTTimerID</a> != NULL)
03719         {
03720                 <a class="code" href="../../d2/dc9/_platform_8h.html#a13">Platform_UnregisterTimerAndClear</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, &amp;IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o7">KeepAliveOUTTimerID</a>);
03721                 IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o7">KeepAliveOUTTimerID</a> = NULL;
03722         }
03723 
03724         IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a> = NULL ;
03725         IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o1">State</a> = <a class="code" href="../../d5/d93/_exporter_8h.html#a51a21">IPDR_CONNECTION_DISCONNECTED</a>;
03726         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
03727 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a70" doxytag="ExporterProtocol.c::ExporterProtocol_SelectCollector"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_SelectCollector           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../df/dde/_defs_8h.html#a16">IPDR_BOOL</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>forceNegotiate</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html">CollectorSession</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>forceCS</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Performs a selection of a new collector from the session <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>E</em>&nbsp;</td><td>exporter handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>the session from which the new collector is selected </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>forceNegotiate</em>&nbsp;</td><td>TRUE if a negotation must accure </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>forceCS</em>&nbsp;</td><td>is not NULL if the specified collector must be the selected one </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">03415 {
03416         <span class="keywordtype">int</span> i;
03417         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status;
03418         <a class="code" href="../../df/dde/_defs_8h.html#a16">IPDR_BOOL</a> needsRollback;
03419     <a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html">CollectorSession</a> *OldCS;
03420     <a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html">CollectorSession</a> *SelectedCS = NULL;
03421 
03422     <span class="keywordflow">if</span> (S == NULL) {
03423         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>; <span class="comment">/* Can happen when shutting everything down. */</span>
03424     }
03425 
03426         <a class="code" href="../../d2/dc9/_platform_8h.html#a34">Platform_Lock</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>);
03427 
03428     OldCS = S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o13">ActiveCS</a>;
03429 
03430     S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o13">ActiveCS</a> = NULL;
03431 
03432         <span class="keywordflow">if</span>(forceCS == NULL)
03433         {
03434                 <span class="keywordflow">for</span> (i = 0; i &lt; S-&gt;CollectorSessions.Length; i++) {
03435                         <a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html">CollectorSession</a> *CS = (<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html">CollectorSession</a> *) S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o14">CollectorSessions</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[i];
03436                         <span class="keywordflow">switch</span> (CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a>) {
03437                         <span class="keywordflow">case</span> <a class="code" href="../../d5/d93/_exporter_8h.html#a52a25">IPDR_CS_INITIATION</a>:
03438                         <span class="keywordflow">case</span> <a class="code" href="../../d5/d93/_exporter_8h.html#a52a26">IPDR_CS_READY</a>:
03439                         <span class="keywordflow">case</span> <a class="code" href="../../d5/d93/_exporter_8h.html#a52a27">IPDR_CS_ACTIVE</a>:
03440                                 <span class="keywordflow">if</span> (SelectedCS == NULL || CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o6">Priority</a> &lt; SelectedCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o6">Priority</a>)
03441                                 {
03442                                         SelectedCS = CS;
03443                                 }
03444                                 <span class="keywordflow">break</span>;
03445                         <span class="keywordflow">default</span>:
03446                                 <span class="keywordflow">break</span>;
03447                         }
03448                 }
03449         }
03450         <span class="keywordflow">else</span>
03451         {
03452                 SelectedCS = forceCS;
03453         }
03454 
03455     <span class="keywordflow">if</span> (SelectedCS == NULL)
03456         {
03457                 <span class="comment">/* if we have no HIGH and our state collector  */</span>
03458         <a class="code" href="../../d6/df8/struct_i_p_d_r___event_data.html">IPDR_EventData</a> eventData;
03459         <span class="keywordflow">if</span> (OldCS != NULL &amp;&amp; OldCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o9">WindowSizeTimer</a> != NULL)
03460                 {
03461             <a class="code" href="../../d2/dc9/_platform_8h.html#a13">Platform_UnregisterTimerAndClear</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>,
03462                                              &amp;OldCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o9">WindowSizeTimer</a>);
03463             <span class="keywordflow">if</span> (OldCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a> != NULL &amp;&amp; OldCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a> != NULL)
03464                         {
03465                 <a class="code" href="../../d5/d93/_transport_8h.html#a11">TL_ResetConnection</a>(OldCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>);
03466                                 <span class="comment">/* See comment below for TCP_ResetConnection */</span>
03467             }
03468         }
03469         <a class="code" href="../../d5/db3/_exporter_8c.html#a98">EventDataInit</a>(&amp;eventData, <a class="code" href="../../df/dd7/group___i_p_d_r__event__notification.html#gga4a155">IPDR_EVENT_ALL_SERVERS_DISCONNECTED</a>, E, SelectedCS, S);
03470         <a class="code" href="../../d5/db3/_exporter_8c.html#a99">Exporter_TriggerEvent</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>, &amp;eventData, NULL, <span class="stringliteral">"All collectors disconnected"</span>);
03471     }
03472         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SelectedCS != OldCS)
03473         {
03474                 <span class="comment">/* if we have one to negotiate with TODO: WindowSizeTimer */</span>
03475         <span class="keywordflow">if</span> (OldCS != NULL &amp;&amp; OldCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o9">WindowSizeTimer</a> != NULL)
03476                 {
03477             <a class="code" href="../../d2/dc9/_platform_8h.html#a13">Platform_UnregisterTimerAndClear</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>,
03478                                              &amp;OldCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o9">WindowSizeTimer</a>);
03479         }
03480 
03481         <span class="keywordflow">if</span> (OldCS != NULL &amp;&amp;
03482                         OldCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a> != NULL &amp;&amp;
03483                         OldCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a> != NULL)
03484                 {
03485                         <span class="comment">/*if we choose not currently active ecollector (Active Collector changed)*/</span>
03486             <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga9">IPDR_IPAddress</a> OldAddr;
03487             <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> OldPort;
03488             <a class="code" href="../../d6/df8/struct_i_p_d_r___event_data.html">IPDR_EventData</a> eventData;
03489             <a class="code" href="../../d5/d93/_transport_8h.html#a28">TL_PABuf</a> paBuf;
03490             <a class="code" href="../../d5/db3/_exporter_8c.html#a98">EventDataInit</a>(&amp;eventData, <a class="code" href="../../df/dd7/group___i_p_d_r__event__notification.html#gga4a153">IPDR_EVENT_ACTIVE_SERVER_CHANGED</a>, E, SelectedCS, S);
03491                         <span class="comment">/* If an active collector didn't exist NULL; Otherwize, use previous active collector*/</span>
03492                         <span class="keywordflow">if</span> (OldCS != NULL &amp;&amp; OldCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a> != NULL)
03493                                 eventData.<a class="code" href="../../d6/df8/struct_i_p_d_r___event_data.html#o13">Extra</a>.ServerChanged.PreviousCollector = OldCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>;
03494                         <span class="keywordflow">else</span>
03495                                 eventData.<a class="code" href="../../d6/df8/struct_i_p_d_r___event_data.html#o13">Extra</a>.ServerChanged.PreviousCollector = NULL;
03496 
03497             <a class="code" href="../../d5/d93/_transport_8h.html#a13">TL_GetConnectionInfo</a>(OldCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>, &amp; OldAddr, &amp; OldPort);
03498             <a class="code" href="../../d5/db3/_exporter_8c.html#a99">Exporter_TriggerEvent</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a170">IPDR_LEVEL_WARNING</a>, &amp;eventData, SelectedCS,
03499                                                                 <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a60">MSG_EXPORTER_ACTIVE_COLLECTOR_CHANGED</a>,
03500                                 <a class="code" href="../../d5/d93/_transport_8h.html#a16">TL_PrintAddressAndPort</a>(OldAddr, OldPort, paBuf),
03501                                 <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(OldCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>),
03502                                 <a class="code" href="../../d5/d93/_exporter_8h.html#a3">EXPORTER_QHANDLER</a>-&gt;OutstandingDataCount(E, S),
03503                                 <a class="code" href="../../d5/d93/_exporter_8h.html#a3">EXPORTER_QHANDLER</a>-&gt;UnacknowledgedDataCount(E, S),
03504                                 S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o16">ID</a>, S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o17">Name</a>, S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o18">Description</a>);
03505 
03506                         <span class="comment">/* Active collector has changed, reset the previous connection</span>
03507 <span class="comment">                        (Empties any internal buffers used for sending (outgoing) data and unregister+clear socket)</span>
03508 <span class="comment">                        since it might try to send obsolete data later */</span>
03509             Status = <a class="code" href="../../d5/d93/_transport_8h.html#a11">TL_ResetConnection</a>(OldCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>);
03510                         <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
03511                         {
03512                                 <a class="code" href="../../da/df4/_log_8h.html#a27">Log_StateTransition</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
03513                                 <span class="stringliteral">"ExporterProtocol_SelectCollector"</span>, OldCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>,
03514                                 OldCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a>, <a class="code" href="../../d5/d93/_exporter_8h.html#a52a24">IPDR_CS_DISCONNECTED</a>,
03515                                 <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a61">MSG_EXPORTER_DISCONNECT_TRANSPORT1</a>);
03516                                 <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a72">ExporterProtocol_CloseTLConnection</a>(E,OldCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>);
03517                                 <a class="code" href="../../d2/dc9/_platform_8h.html#a35">Platform_Unlock</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>);
03518                                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
03519                         }
03520                         <span class="comment">/* if we already have an active collector and it's not the same as the new one, stop session*/</span>
03521                         Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a60">ExporterProtocol_SendSessionStop</a>(E, S, OldCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o4">Collector</a>,
03522                                                                   OldCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>,
03523                                                                   <a class="code" href="../../df/dcb/group___i_p_d_r__key__type__attributes.html#gga33a121">IPDR_STOP_REASON_SWITCHCOLLECTOR</a>,
03524                                                                   <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a65">MSG_EXPORTER_NEW_ACTIVE_COLLECTOR</a>);
03525                         <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
03526                         {
03527                                 <a class="code" href="../../da/df4/_log_8h.html#a27">Log_StateTransition</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
03528                                 <span class="stringliteral">"ExporterProtocol_SelectCollector"</span>, OldCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>,
03529                                 OldCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a>, <a class="code" href="../../d5/d93/_exporter_8h.html#a52a24">IPDR_CS_DISCONNECTED</a>,
03530                                 <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a62">MSG_EXPORTER_DISCONNECT_TRANSPORT2</a>);
03531                                 <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a72">ExporterProtocol_CloseTLConnection</a>(E,OldCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>);
03532                                 <a class="code" href="../../d2/dc9/_platform_8h.html#a35">Platform_Unlock</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>);
03533                                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
03534                         }
03535                         OldCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a> = <a class="code" href="../../d5/d93/_exporter_8h.html#a52a26">IPDR_CS_READY</a>;
03536         }
03537 
03538         <span class="keywordflow">switch</span> (SelectedCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a>) {
03539             <span class="keywordflow">case</span> <a class="code" href="../../d5/d93/_exporter_8h.html#a52a26">IPDR_CS_READY</a>:
03540                 <span class="comment">/* There are two cases when a server (collector) is un-paused:</span>
03541 <span class="comment">                   - the same server (collector) is being re-selected (OldSrv == NULL)</span>
03542 <span class="comment">                   - a new (higher priority) server (collector) is being selected (OldSrv != NULL)</span>
03543 <span class="comment"></span>
03544 <span class="comment">                   In theory, there shouldn't be any problem with doing a</span>
03545 <span class="comment">                   rollback in all cases (although it would be less</span>
03546 <span class="comment">                   efficient); in practice, there are subtle interactions</span>
03547 <span class="comment">                   between the queue and the list of buffers to be sent (kept</span>
03548 <span class="comment">                   by the transport layer).</span>
03549 <span class="comment"></span>
03550 <span class="comment">                   A rollback assumes that the output is freshly</span>
03551 <span class="comment">                   connected. But that's not true in the case of a "paused"</span>
03552 <span class="comment">                   server (collector) ... the connection is still connected. We could</span>
03553 <span class="comment">                   disconnect it --- but then it would have been better to</span>
03554 <span class="comment">                   have done the disconnect when the timeout happened (in</span>
03555 <span class="comment">                   fact, that might be a good idea anyway because the</span>
03556 <span class="comment">                   disconnection might jolt the collector into doing</span>
03557 <span class="comment">                   something). Otherwise, we must *not* do a rollback</span>
03558 <span class="comment">                   ... there could be records waiting to be sent (or even</span>
03559 <span class="comment">                   partially sent), and a rollback would smash them.</span>
03560 <span class="comment"></span>
03561 <span class="comment">                   This analysis applies for both cases of un-pausing. We can</span>
03562 <span class="comment">                   prune the queue (using the DSN from the DATA ACK) but we</span>
03563 <span class="comment">                   must do nothing with the data that is "pending" in the</span>
03564 <span class="comment">                   connection layer. If we do want to do a rollback, then we</span>
03565 <span class="comment">                   *must* force a disconnection first, to ensure that all the</span>
03566 <span class="comment">                   "pending" data are thrown away.</span>
03567 <span class="comment"></span>
03568 <span class="comment">                   However, we have another problem ... the sequencing</span>
03569 <span class="comment">                   of the DSNs. If we switch servers (collectors), then</span>
03570 <span class="comment">                   there will be a gap in the sequence numbers unless</span>
03571 <span class="comment">                   we also do a SyncNeeded. So, even though there is</span>
03572 <span class="comment">                   no rollback, a SYNC message is sent (when the</span>
03573 <span class="comment">                   server (collector) is switched).</span>
03574 <span class="comment"></span>
03575 <span class="comment">                   [Note added later: based on other considerations, it seemed</span>
03576 <span class="comment">                   best for timeouts to cause a disconnect anyway. So, we'll</span>
03577 <span class="comment">                   never see the "paused" state. But leave the code in, just</span>
03578 <span class="comment">                   in case we reverse this decision.</span>
03579 <span class="comment">                */</span>
03580                 needsRollback = <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
03581                 <span class="keywordflow">if</span> (OldCS != NULL) { <span class="comment">/* We're switching from another server (collector) */</span>
03582                     S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o7">SyncNeeded</a> = <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>;
03583                 }
03584                 <span class="keywordflow">break</span>;
03585             <span class="keywordflow">default</span>:
03586                 needsRollback = <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
03587                 S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o7">SyncNeeded</a> = <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>; <span class="comment">/* sync is needed after server (collector) change */</span>
03588                 }
03589 
03590                 <span class="keywordflow">if</span> (<a class="code" href="../../da/df4/_log_8h.html#a15">Log_ShouldWrite</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a1">EXPORTER_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a172">IPDR_LEVEL_DEBUG</a>))
03591                 {
03592                         <span class="keywordflow">if</span> (needsRollback)
03593                         {
03594                                 <a class="code" href="../../da/df4/_log_8h.html#a27">Log_StateTransition</a>(EXPORTER_LOG, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
03595                                                     <span class="stringliteral">"ExporterProtocol_SelectCollector"</span>, SelectedCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>,
03596                                                     SelectedCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a>, <a class="code" href="../../d5/d93/_exporter_8h.html#a52a27">IPDR_CS_ACTIVE</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a66">MSG_EXPORTER_NEW_ACTIVE_COLLECTOR_ROLLBACK</a>);
03597                         }
03598                         <span class="keywordflow">if</span> (S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o7">SyncNeeded</a>)
03599                         {
03600             <a class="code" href="../../da/df4/_log_8h.html#a27">Log_StateTransition</a>(EXPORTER_LOG, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
03601                                                     <span class="stringliteral">"ExporterProtocol_SelectCollector"</span>, SelectedCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>,
03602                                                     SelectedCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a>, <a class="code" href="../../d5/d93/_exporter_8h.html#a52a27">IPDR_CS_ACTIVE</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a67">MSG_EXPORTER_NEW_ACTIVE_COLLECTOR_SYNC</a>);
03603                         }
03604 
03605 
03606         }
03607         <span class="comment">/* The following event is also done by ExporterProtocol_HandleStart: */</span>
03608         <span class="keywordflow">if</span> (SelectedCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a> != NULL &amp;&amp;
03609                         SelectedCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a> != NULL)
03610                 {
03611                         <span class="comment">/*if we choose not currently activ ecollector*/</span>
03612             <a class="code" href="../../d6/df8/struct_i_p_d_r___event_data.html">IPDR_EventData</a> eventData;
03613             <a class="code" href="../../d5/db3/_exporter_8c.html#a98">EventDataInit</a>(&amp;eventData, <a class="code" href="../../df/dd7/group___i_p_d_r__event__notification.html#gga4a150">IPDR_EVENT_SERVER_CONNECTED</a>, E, SelectedCS, S);
03614             <a class="code" href="../../d5/db3/_exporter_8c.html#a99">Exporter_TriggerEvent</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a170">IPDR_LEVEL_WARNING</a>, &amp;eventData, SelectedCS,
03615                                 <span class="stringliteral">"Connected: %.98s, outstanding=%lu, unACKed=%lu, Session=%u [%.40s] (%.80s)"</span>,
03616                                 <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(SelectedCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>),
03617                                 <a class="code" href="../../d5/d93/_exporter_8h.html#a3">EXPORTER_QHANDLER</a>-&gt;OutstandingDataCount(E, S),
03618                                 <a class="code" href="../../d5/d93/_exporter_8h.html#a3">EXPORTER_QHANDLER</a>-&gt;UnacknowledgedDataCount(E, S),
03619                                 S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o16">ID</a>, S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o17">Name</a>, S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o18">Description</a>);
03620 
03621                         <span class="keywordflow">switch</span>(SelectedCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a>){
03622                                 <span class="keywordflow">case</span> <a class="code" href="../../d5/d93/_exporter_8h.html#a52a26">IPDR_CS_READY</a>:
03623                                         <span class="keywordflow">if</span>(forceNegotiate == <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>)
03624                                         {
03625                                                 Status = <a class="code" href="../../d5/d93/_transport_8h.html#a11">TL_ResetConnection</a>(SelectedCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>);
03626                                                 <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
03627                                                 {
03628                                                         <a class="code" href="../../da/df4/_log_8h.html#a27">Log_StateTransition</a>(EXPORTER_LOG, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
03629                                                                     <span class="stringliteral">"ExporterProtocol_SelectCollector"</span>,
03630                                                                     SelectedCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>, SelectedCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a>,
03631                                                                     <a class="code" href="../../d5/d93/_exporter_8h.html#a52a24">IPDR_CS_DISCONNECTED</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a61">MSG_EXPORTER_DISCONNECT_TRANSPORT1</a>);
03632                                                         <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(SelectedCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>);
03633                                                         <a class="code" href="../../d2/dc9/_platform_8h.html#a35">Platform_Unlock</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>);
03634                                                         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
03635                                                 }
03636                                                 <span class="keywordflow">if</span>(S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o10">Running</a> == <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>)
03637                                                 {
03638                                                         Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a59">ExporterProtocol_SendSessionStart</a>(E, S, SelectedCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o4">Collector</a>, SelectedCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>);
03639                                                         <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
03640                                                         {
03641                                                                 <a class="code" href="../../da/df4/_log_8h.html#a27">Log_StateTransition</a>(EXPORTER_LOG, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
03642                                                                                 <span class="stringliteral">"ExporterProtocol_SelectCollector"</span>,
03643                                                                                 SelectedCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>,
03644                                                                                                 SelectedCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a>, <a class="code" href="../../d5/d93/_exporter_8h.html#a52a24">IPDR_CS_DISCONNECTED</a>,
03645                                                                                 <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a63">MSG_EXPORTER_DISCONNECT_TRANSPORT3</a>);
03646                                                                 <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(SelectedCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>);
03647                                                                 <a class="code" href="../../d2/dc9/_platform_8h.html#a35">Platform_Unlock</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>);
03648                                                                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
03649                                                         }
03650                                                         SelectedCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a> = <a class="code" href="../../d5/d93/_exporter_8h.html#a52a27">IPDR_CS_ACTIVE</a>;
03651                                                         S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o13">ActiveCS</a> = SelectedCS;
03652                                                         S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o9">Retransmite</a> = <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>;
03653                                                         Status = <a class="code" href="../../d5/db3/_exporter_8c.html#a48">Session_SendOutstandingData</a>(E, S);
03654                                                 }
03655                                                 <span class="keywordflow">break</span>;
03656                                         }
03657                                 <span class="keywordflow">case</span> <a class="code" href="../../d5/d93/_exporter_8h.html#a52a25">IPDR_CS_INITIATION</a>:
03658                                         Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a61">ExporterProtocol_SendTemplateData</a>(E, S,
03659                                                                 SelectedCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o4">Collector</a>,
03660                                                                 SelectedCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>,
03661                                                                 (OldCS==NULL || <a class="code" href="../../d5/d93/_exporter_8h.html#a52a25">IPDR_CS_INITIATION</a>==<a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>)?IPDR_TRUE:IPDR_FALSE);
03662                                         <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
03663                                         {
03664                                                 <a class="code" href="../../da/df4/_log_8h.html#a27">Log_StateTransition</a>(EXPORTER_LOG, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
03665                                                                     <span class="stringliteral">"ExporterProtocol_SelectCollector"</span>,
03666                                                                     SelectedCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>,
03667                                                                     SelectedCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a>, <a class="code" href="../../d5/d93/_exporter_8h.html#a52a24">IPDR_CS_DISCONNECTED</a>,
03668                                                                     <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a70">MSG_EXPORTER_SEND_TEMPLATE_DATA_FAILED</a>);
03669                                                 <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(SelectedCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>);
03670                                                 <a class="code" href="../../d2/dc9/_platform_8h.html#a35">Platform_Unlock</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>);
03671                                                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
03672                                         }
03673                                         <span class="keywordflow">break</span>;
03674                                 <span class="keywordflow">default</span>:
03675                                         <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(EXPORTER_LOG, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
03676                                                 <span class="stringliteral">"ExporterProtocol_SelectCollector"</span>,<a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a64">MSG_EXPORTER_UNEXPECTED_STATE</a>);
03677                                         <span class="keywordflow">break</span>;
03678                         }
03679         }
03680 
03681                 <span class="keywordflow">if</span> (needsRollback)
03682                 {
03683             <a class="code" href="../../d5/d93/_exporter_8h.html#a3">EXPORTER_QHANDLER</a>-&gt;Rollback(E, S);
03684         }
03685     }
03686         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SelectedCS == OldCS)
03687         {
03688                 <span class="comment">/* nothing todo just log */</span>
03689                 <a class="code" href="../../da/df4/_log_8h.html#a27">Log_StateTransition</a>(EXPORTER_LOG, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a1">EXPORTER_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a172">IPDR_LEVEL_DEBUG</a>,
03690                                                         <span class="stringliteral">"Session_SelectActiveCollector"</span>, SelectedCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>,
03691                                                         SelectedCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a>, IPDR_SERVER_ACTIVE,
03692                                                         <span class="stringliteral">"got same active server (collector)"</span>);
03693         SelectedCS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a> = <a class="code" href="../../d5/d93/_exporter_8h.html#a52a27">IPDR_CS_ACTIVE</a>;
03694         S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o13">ActiveCS</a> = SelectedCS;
03695     }
03696         <a class="code" href="../../d2/dc9/_platform_8h.html#a35">Platform_Unlock</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>);
03697         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
03698 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a54" doxytag="ExporterProtocol.c::ExporterProtocol_SendConnect"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_SendConnect           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Conn</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Sends a connect event to a collector<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>E</em>&nbsp;</td><td>exporter handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>session handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Coll</em>&nbsp;</td><td>collector handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Conn</em>&nbsp;</td><td>The Connection between S to Coll </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">01491 {
01492         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status;
01493         <span class="keywordtype">int</span> exporterCapabilities = 0;
01494         <span class="keywordtype">int</span> collectorCapabilities = 0;
01495     <a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> BH;
01496         <span class="comment">/*MessageHeader *MH;*/</span>
01497     ConnectMessage *CM;
01498     <a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a> *CMgr;
01499         <a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a> *IC = Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>;
01500 
01501         <span class="keywordtype">char</span>*   vendorID = E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o4">Parameters</a>.<a class="code" href="../../d1/dac/struct_exporter_parameters.html#o3">VendorString</a>;
01502         <span class="keywordtype">int</span> vendorIDLength = strlen(vendorID);
01503 
01504         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a69">ExporterProtocol_KeepAliveOutTimerReset</a>(IC);
01505 
01506 
01507     <span class="keywordflow">if</span> (IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o1">State</a> != <a class="code" href="../../d5/d93/_exporter_8h.html#a51a21">IPDR_CONNECTION_DISCONNECTED</a>) {
01508         <span class="comment">/* XXX should signal error event */</span>
01509         <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
01510                   <span class="stringliteral">"ExporterProtocol_SendConnect"</span>,
01511                   <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a106">MSG_EXPORTER_STATE_NOT_DISCONNECTED</a>);
01512         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>;
01513     }
01514 
01515     <a class="code" href="../../d5/d93/_transport_8h.html#a22">TL_GetSendChunksManager</a>(Conn, &amp; CMgr);
01516     Status = <a class="code" href="../../d8/d51/_chunks_manager_8c.html#a19">ChunksManager_AllocateBuffer</a>(CMgr,
01517                                           <span class="keyword">sizeof</span>(ConnectMessage)+vendorIDLength+1,
01518                                                                                   &amp; BH);
01519     <span class="keywordflow">if</span> (<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
01520         <span class="keywordflow">return</span> Status;
01521 
01522     <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a40">ExporterProtocol_FillHeader</a>(S, BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, <a class="code" href="../../db/d1e/_protocol_8h.html#a27">IPDR_MSG_CONNECT</a>,
01523                               <span class="keyword">sizeof</span>(ConnectMessage)+vendorIDLength+1);
01524 
01525     CM = (ConnectMessage *) BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>;
01526 
01527         exporterCapabilities = <a class="code" href="../../d5/db3/_exporter_8c.html#a103">Exporter_GetCapabilities</a>(E);
01528         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a33">ExporterProtocol_SetCollectorCapabilities</a>(E, Coll, exporterCapabilities);
01529         collectorCapabilities = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a34">ExporterProtocol_GetCollectorCapabilities</a>(Coll);
01530 
01531         <a class="code" href="../../df/dde/_defs_8h.html#a9">IPDR_SET_HTONL</a>(CM-&gt;Addr, ((E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o4">Parameters</a>.<a class="code" href="../../d1/dac/struct_exporter_parameters.html#o1">ProtocolLevelAddr</a>==0)?Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o3">LocaleAddr</a>:E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o4">Parameters</a>.<a class="code" href="../../d1/dac/struct_exporter_parameters.html#o1">ProtocolLevelAddr</a>));
01532         <a class="code" href="../../df/dde/_defs_8h.html#a8">IPDR_SET_HTONS</a>(CM-&gt;Port, Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o4">LocalePort</a>);
01533         <a class="code" href="../../df/dde/_defs_8h.html#a9">IPDR_SET_HTONL</a>(CM-&gt;Capabilities, collectorCapabilities);
01534         <a class="code" href="../../df/dde/_defs_8h.html#a9">IPDR_SET_HTONL</a>(CM-&gt;keepAliveInterval, E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o4">Parameters</a>.<a class="code" href="../../d1/dac/struct_exporter_parameters.html#o4">KeepAliveInterval</a>/1000);
01535         <a class="code" href="../../df/dde/_defs_8h.html#a9">IPDR_SET_HTONL</a>(CM-&gt;vendorIDLength, vendorIDLength);
01536         strncpy(BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>+<span class="keyword">sizeof</span>(ConnectMessage), vendorID, vendorIDLength);
01537 
01538     <span class="keywordflow">if</span> (<a class="code" href="../../da/df4/_log_8h.html#a15">Log_ShouldWrite</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>)) {
01539         <a class="code" href="../../de/da6/_protocol_debug_8c.html#a4">ProtocolDebug_PrintOutgoingMessage</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, Conn, BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>);
01540     }
01541 
01542     Status = <a class="code" href="../../d5/d93/_transport_8h.html#a9">TL_Send</a>(Conn, &amp; BH, <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>);
01543         <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
01544         {
01545                 <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#ga3">IPDR_LogWrite</a>(E,<span class="stringliteral">"ExporterProtocol"</span>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>, <span class="stringliteral">"ExporterProtocol_SendConnect"</span>,
01546                                         <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a102">MSG_EXPORTER_SEND_CONNECT_FAILED</a>, <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn));
01547                 <span class="keywordflow">return</span> Status;
01548         }
01549 
01550         <a class="code" href="../../da/df4/_log_8h.html#a30">Log_Write2</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a172">IPDR_LEVEL_DEBUG</a>,
01551                                         <span class="stringliteral">"Exporter_AutoconnectCallback"</span>,
01552                                         <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a103">MSG_EXPORTER_SEND_CONNECT_TARGET</a>,
01553                                         <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn), E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o4">Parameters</a>.<a class="code" href="../../d1/dac/struct_exporter_parameters.html#o7">ConnectResponseTimeout</a>);
01554 
01555         <span class="keywordflow">if</span>(IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o5">ConnectResponseTimerID</a> != NULL)
01556                 <a class="code" href="../../d2/dc9/_platform_8h.html#a13">Platform_UnregisterTimerAndClear</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, &amp; (IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o5">ConnectResponseTimerID</a>));
01557 
01558         <a class="code" href="../../d2/dc9/_platform_8h.html#a9">Platform_RegisterTimer</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>,
01559                                                 <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a31">ExporterProtocol_ConnectResponseTimeoutCallback</a>,
01560                                                         IC,
01561                             E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o4">Parameters</a>.<a class="code" href="../../d1/dac/struct_exporter_parameters.html#o7">ConnectResponseTimeout</a>,
01562                             &amp; (IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o5">ConnectResponseTimerID</a>));
01563 
01564         IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o1">State</a> = <a class="code" href="../../d5/d93/_exporter_8h.html#a51a22">IPDR_CONNECTION_WAITRESPONSE</a>;
01565 
01566     <span class="keywordflow">return</span> Status;
01567 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a55" doxytag="ExporterProtocol.c::ExporterProtocol_SendConnectResponse"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_SendConnectResponse           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Conn</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01574 {
01575         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status;
01576         <span class="keywordtype">int</span>  collectorCapabilities = 0;
01577     <a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> BH;
01578     ConnectResponseMessage *CRM;
01579     <a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a> *CMgr;
01580         <a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a> *IC = Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>;
01581 
01582         <span class="keywordtype">char</span>*   vendorID = E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o4">Parameters</a>.<a class="code" href="../../d1/dac/struct_exporter_parameters.html#o3">VendorString</a>;
01583         <span class="keywordtype">int</span> vendorIDLength = strlen(vendorID);
01584 
01585         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a69">ExporterProtocol_KeepAliveOutTimerReset</a>(IC);
01586 
01587 
01588     <span class="keywordflow">if</span> (IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o1">State</a> != <a class="code" href="../../d5/d93/_exporter_8h.html#a51a21">IPDR_CONNECTION_DISCONNECTED</a>) {
01589         <span class="comment">/* XXX should signal error event */</span>
01590         <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
01591                   <span class="stringliteral">"ExporterProtocol_SendConnectResponse"</span>,
01592                   <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a106">MSG_EXPORTER_STATE_NOT_DISCONNECTED</a>);
01593         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>;
01594     }
01595 
01596     <a class="code" href="../../d5/d93/_transport_8h.html#a22">TL_GetSendChunksManager</a>(Conn, &amp; CMgr);
01597     Status = <a class="code" href="../../d8/d51/_chunks_manager_8c.html#a19">ChunksManager_AllocateBuffer</a>(CMgr,
01598                                           <span class="keyword">sizeof</span>(ConnectResponseMessage)+vendorIDLength+1,
01599                                                                                   &amp; BH);
01600     <span class="keywordflow">if</span> (<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
01601         <span class="keywordflow">return</span> Status;
01602 
01603     <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a40">ExporterProtocol_FillHeader</a>(S, BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, <a class="code" href="../../db/d1e/_protocol_8h.html#a28">IPDR_MSG_CONNECT_RESPONSE</a>,
01604                               <span class="keyword">sizeof</span>(ConnectResponseMessage)+vendorIDLength+1);
01605 
01606     CRM = (ConnectResponseMessage *) BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>;
01607 
01608         collectorCapabilities = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a34">ExporterProtocol_GetCollectorCapabilities</a>(Coll);
01609 
01610         <a class="code" href="../../df/dde/_defs_8h.html#a9">IPDR_SET_HTONL</a>(CRM-&gt;Capabilities, collectorCapabilities);
01611         <a class="code" href="../../df/dde/_defs_8h.html#a9">IPDR_SET_HTONL</a>(CRM-&gt;keepAliveInterval, E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o4">Parameters</a>.<a class="code" href="../../d1/dac/struct_exporter_parameters.html#o4">KeepAliveInterval</a>/1000);
01612         <a class="code" href="../../df/dde/_defs_8h.html#a9">IPDR_SET_HTONL</a>(CRM-&gt;vendorIDLength, vendorIDLength);
01613         strncpy(BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>+<span class="keyword">sizeof</span>(ConnectResponseMessage), vendorID, vendorIDLength);
01614 
01615     <span class="keywordflow">if</span> (<a class="code" href="../../da/df4/_log_8h.html#a15">Log_ShouldWrite</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>)) {
01616         <a class="code" href="../../de/da6/_protocol_debug_8c.html#a4">ProtocolDebug_PrintOutgoingMessage</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, Conn, BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>);
01617     }
01618 
01619     Status = <a class="code" href="../../d5/d93/_transport_8h.html#a9">TL_Send</a>(Conn, &amp; BH, <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>);
01620         <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
01621         {
01622                 <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#ga3">IPDR_LogWrite</a>(E,<span class="stringliteral">"ExporterProtocol"</span>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>, <span class="stringliteral">"ExporterProtocol_SendConnectResponse"</span>,
01623                                         <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a90">MSG_EXPORTER_SEND_CONNECT_RESPONSE_FAILED</a>, <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn));
01624                 <span class="keywordflow">return</span> Status;
01625         }
01626 
01627         <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#ga3">IPDR_LogWrite</a>(E,<span class="stringliteral">"ExporterProtocol"</span>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>, <span class="stringliteral">"ExporterProtocol_SendConnectResponse"</span>,
01628                                         <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a91">MSG_EXPORTER_SEND_CONNECT_RESPONSE_TARGET</a>, <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn));
01629 
01630     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01631 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a66" doxytag="ExporterProtocol.c::ExporterProtocol_SendData"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_SendData           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Conn</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/dc8/struct_i_p_d_r__tag___template_handle.html">IPDR_TemplateHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>TH</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const void *&nbsp;</td>
          <td class="mdname" nowrap> <em>Data</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">03034 {
03035         <a class="code" href="../../da/d62/struct_i_p_d_r__tag___template.html">Template</a>*       T ;
03036         <a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html">CollectorSession</a> *ACS = S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o13">ActiveCS</a>;
03037         <a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a> *IC = NULL;
03038         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status = <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
03039 
03040     <span class="keywordflow">if</span> (!E || !S || !Data) {
03041         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a181">IPDR_ERR_INVALID_VALUE</a>;
03042     }
03043 
03044         <span class="keywordflow">if</span>(S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o10">Running</a> != <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>)
03045                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a215">IPDR_ERR_SESSION_IS_NOT_RUNNING</a>;
03046 
03047     <span class="keywordflow">if</span> (! <a class="code" href="../../d2/dc9/_platform_8h.html#a4">Platform_IsRunning</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>)) {
03048         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a201">IPDR_ERR_NOT_RUNNING</a>;
03049     }
03050 
03051     <a class="code" href="../../d2/dc9/_platform_8h.html#a34">Platform_Lock</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>);
03052 
03053         <span class="keywordflow">if</span>(     !S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o3">ActiveContext</a> ||
03054                 S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o3">ActiveContext</a>-&gt;<a class="code" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html#o2">Templates</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o1">Length</a> &lt;= TH.<a class="code" href="../../d4/dc8/struct_i_p_d_r__tag___template_handle.html#o0">i</a> ||
03055                 TH.<a class="code" href="../../d4/dc8/struct_i_p_d_r__tag___template_handle.html#o1">s</a> != S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o16">ID</a>)
03056         {
03057                 <span class="comment">/*TODO: add errorCode and message*/</span>
03058                 <a class="code" href="../../d2/dc9/_platform_8h.html#a35">Platform_Unlock</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>);
03059                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a181">IPDR_ERR_INVALID_VALUE</a>;
03060         }
03061 
03062         T = (<a class="code" href="../../da/d62/struct_i_p_d_r__tag___template.html">Template</a> *) S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o3">ActiveContext</a>-&gt;<a class="code" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html#o2">Templates</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[TH.<a class="code" href="../../d4/dc8/struct_i_p_d_r__tag___template_handle.html#o0">i</a>];
03063     <span class="keywordflow">if</span> (!T || ! T-&gt;<a class="code" href="../../da/d62/struct_i_p_d_r__tag___template.html#o9">Enabled</a>)
03064         {
03065                 <a class="code" href="../../da/df4/_log_8h.html#a29">Log_Write1</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a1">EXPORTER_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,<span class="stringliteral">"IPDR_SendData"</span>,<a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a58">MSG_EXPORTER_DISABLED_TEMPLATE</a>,T-&gt;<a class="code" href="../../da/d62/struct_i_p_d_r__tag___template.html#o0">TemplateID</a>);
03066                 <a class="code" href="../../d2/dc9/_platform_8h.html#a35">Platform_Unlock</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>);
03067                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a210">IPDR_ERR_TEMPLATE_DISABLED</a>;
03068                 <span class="comment">/* NOT_DONE: Add event??? DONE: New IPDR_ERR in IPDR.H ; New field in "IPDR_API IPDR_StatusMsg" ; New Msg in ExporterMsgs,h */</span>
03069         }
03070 
03071         Status = <a class="code" href="../../d5/d93/_exporter_8h.html#a3">EXPORTER_QHANDLER</a>-&gt;SendData(E, S, T, Data);
03072 
03073         <span class="keywordflow">if</span>(ACS != NULL)
03074                 IC = ACS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>;
03075 
03076         <span class="keywordflow">if</span>(IC != NULL)
03077                 Conn = IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>;
03078 
03079         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a69">ExporterProtocol_KeepAliveOutTimerReset</a>(IC);
03080 
03081     <span class="keywordflow">if</span> (<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status)) {
03082                 <span class="keyword">const</span> <span class="keywordtype">char</span>* serverStr;
03083         <a class="code" href="../../d6/df8/struct_i_p_d_r___event_data.html">IPDR_EventData</a> eventData;
03084         <a class="code" href="../../d5/db3/_exporter_8c.html#a98">EventDataInit</a>(&amp;eventData, <a class="code" href="../../df/dd7/group___i_p_d_r__event__notification.html#gga4a152">IPDR_EVENT_RECORD_LOST</a>, E, ACS, S);
03085 
03086         <span class="keywordflow">if</span> (ACS &amp;&amp; IC &amp;&amp; Conn &amp;&amp; ACS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a> == <a class="code" href="../../d5/d93/_exporter_8h.html#a52a27">IPDR_CS_ACTIVE</a>) {
03087                         eventData.<a class="code" href="../../d6/df8/struct_i_p_d_r___event_data.html#o1">IC</a> = NULL;
03088                         serverStr = <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn);
03089                 } <span class="keywordflow">else</span> {
03090                         eventData.<a class="code" href="../../d6/df8/struct_i_p_d_r___event_data.html#o1">IC</a> = IC;
03091                         serverStr = <span class="stringliteral">"Server=none"</span>;
03092                 }
03093                 S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o21">Statistics</a>.<a class="code" href="../../d7/d1e/struct_i_p_d_r___statistics.html#o3">LostRecords</a>++;
03094                 <span class="keywordflow">if</span> (ACS) {
03095                         ACS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o10">Statistics</a>.<a class="code" href="../../d7/d1e/struct_i_p_d_r___statistics.html#o3">LostRecords</a>++;
03096                 }
03097 
03098         <a class="code" href="../../d5/db3/_exporter_8c.html#a99">Exporter_TriggerEvent</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>, &amp;eventData, NULL, <span class="comment">/* don't record this event with Collector*/</span>
03099                                         <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a100">MSG_EXPORTER_RECORD_LOST</a>,
03100                                     serverStr, S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o6">DSN</a>,
03101                                         <a class="code" href="../../d5/d93/_exporter_8h.html#a3">EXPORTER_QHANDLER</a>-&gt;OutstandingDataCount(E, S),
03102                                     <a class="code" href="../../d5/d93/_exporter_8h.html#a3">EXPORTER_QHANDLER</a>-&gt;UnacknowledgedDataCount(E, S),
03103                                         S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o16">ID</a>, S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o17">Name</a>, S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o18">Description</a>);
03104 
03105                 <a class="code" href="../../d2/dc9/_platform_8h.html#a35">Platform_Unlock</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>);
03106                 <span class="keywordflow">return</span> Status;
03107         }
03108 
03109         S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o21">Statistics</a>.<a class="code" href="../../d7/d1e/struct_i_p_d_r___statistics.html#o2">EnqueuedRecords</a>++;
03110         <span class="keywordflow">if</span> (ACS) {
03111                 ACS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o10">Statistics</a>.<a class="code" href="../../d7/d1e/struct_i_p_d_r___statistics.html#o2">EnqueuedRecords</a>++;
03112         }
03113         <a class="code" href="../../db/d1e/_protocol_8h.html#a8">IPDR_INCR_DSN</a>(S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o6">DSN</a>);
03114 
03115         <span class="comment">/* We ignore SendOutstandingData's return code because it just</span>
03116 <span class="comment">       indicates that something went wrong whilst trying to send all</span>
03117 <span class="comment">       the records on the queue and a server failover should fix</span>
03118 <span class="comment">       things up. */</span>
03119         (void)<a class="code" href="../../d5/d93/_exporter_8h.html#a3">EXPORTER_QHANDLER</a>-&gt;SendOutstandingData(E,S);
03120         <a class="code" href="../../d2/dc9/_platform_8h.html#a35">Platform_Unlock</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>);
03121         <span class="keywordflow">return</span> Status;
03122 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a56" doxytag="ExporterProtocol.c::ExporterProtocol_SendDisconnect"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_SendDisconnect           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Conn</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01637 {
01638         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>             Status;
01639         <a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a>            BH;
01640     DisconnectMessage*  DM;
01641     <a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a>*              CMgr;
01642         <a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a>*         IC = Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>;
01643 
01644         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a69">ExporterProtocol_KeepAliveOutTimerReset</a>(IC);
01645 
01646     <span class="keywordflow">if</span> (IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o1">State</a> == <a class="code" href="../../d5/d93/_exporter_8h.html#a51a21">IPDR_CONNECTION_DISCONNECTED</a>) {
01647         <span class="comment">/* XXX should signal error event */</span>
01648         <a class="code" href="../../da/df4/_log_8h.html#a31">Log_Write3</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
01649                   <span class="stringliteral">"ExporterProtocol_SendDisconnect"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a33">MSG_EXPORTER_UNEXPECTED_MSG</a>,
01650                                 <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn), <a class="code" href="../../db/d1e/_protocol_8h.html#a29">IPDR_MSG_DISCONNECT</a>, <span class="stringliteral">"DISCONNECTED"</span>);
01651         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>;
01652     }
01653 
01654     <a class="code" href="../../d5/d93/_transport_8h.html#a22">TL_GetSendChunksManager</a>(Conn, &amp; CMgr);
01655     Status = <a class="code" href="../../d8/d51/_chunks_manager_8c.html#a19">ChunksManager_AllocateBuffer</a>(CMgr,
01656                                           <span class="keyword">sizeof</span>(DisconnectMessage),
01657                                                                                   &amp; BH);
01658     <span class="keywordflow">if</span> (<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
01659     {
01660         <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
01661                   <span class="stringliteral">"ExporterProtocol_SendDisconnect"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a72">MSG_EXPORTER_CHUNKS_MANAGER_FAILED</a>);
01662         <span class="keywordflow">return</span> Status;
01663     }
01664 
01665     <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a40">ExporterProtocol_FillHeader</a>(S, BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, <a class="code" href="../../db/d1e/_protocol_8h.html#a29">IPDR_MSG_DISCONNECT</a>,
01666                               <span class="keyword">sizeof</span>(DisconnectMessage));
01667 
01668     DM = (DisconnectMessage *) BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>;
01669 
01670     <span class="keywordflow">if</span> (<a class="code" href="../../da/df4/_log_8h.html#a15">Log_ShouldWrite</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>)) {
01671         <a class="code" href="../../de/da6/_protocol_debug_8c.html#a4">ProtocolDebug_PrintOutgoingMessage</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, Conn, BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>);
01672     }
01673 
01674     Status = <a class="code" href="../../d5/d93/_transport_8h.html#a9">TL_Send</a>(Conn, &amp; BH, <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>);
01675         <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
01676         {
01677                 <a class="code" href="../../da/df4/_log_8h.html#a29">Log_Write1</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
01678                            <span class="stringliteral">"ExporterProtocol_SendDisconnect"</span>,
01679                            <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a92">MSG_EXPORTER_SEND_DISCONNECT_FAILED</a>, <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn));
01680                 <span class="keywordflow">return</span> Status;
01681         }
01682 
01683         <a class="code" href="../../da/df4/_log_8h.html#a29">Log_Write1</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a172">IPDR_LEVEL_DEBUG</a>,
01684                    <span class="stringliteral">"ExporterProtocol_SendDisconnect"</span>,
01685                    <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a93">MSG_EXPORTER_SEND_DISCONNECT_TARGET</a>, <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn));
01686                    
01687         <span class="keywordflow">if</span>(IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o7">KeepAliveOUTTimerID</a> != NULL)
01688         {
01689                 <a class="code" href="../../d2/dc9/_platform_8h.html#a13">Platform_UnregisterTimerAndClear</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, &amp;IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o7">KeepAliveOUTTimerID</a>);
01690                 IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o7">KeepAliveOUTTimerID</a> = NULL;
01691         }
01692         
01693         <span class="keywordflow">if</span>(IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o6">KeepAliveINTimerID</a> != NULL)
01694         {
01695                 <a class="code" href="../../d2/dc9/_platform_8h.html#a13">Platform_UnregisterTimerAndClear</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, &amp;IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o6">KeepAliveINTimerID</a>);
01696                 IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o6">KeepAliveINTimerID</a> = NULL;
01697         }
01698 
01699         IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o1">State</a> = <a class="code" href="../../d5/d93/_exporter_8h.html#a51a21">IPDR_CONNECTION_DISCONNECTED</a>;
01700     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01701 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a57" doxytag="ExporterProtocol.c::ExporterProtocol_SendError"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_SendError           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Conn</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>enum <a class="el" href="../../db/d1e/_protocol_8h.html#a57">ErrorCode</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ErrCode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>Msg</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Send an ERROR message to a collector.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>E</em>&nbsp;</td><td>exporter handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>session handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Coll</em>&nbsp;</td><td>collector to which to send the message </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Conn</em>&nbsp;</td><td>connection </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ErrCode</em>&nbsp;</td><td>the error code </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Msg</em>&nbsp;</td><td>the message to send (may be null or zero-length).</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga15">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">01717 {
01718         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status;
01719         <a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> BH;
01720         <a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a> *CMgr;
01721     ErrorMessage *EM;
01722     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga10">IPDR_Time</a> Now;
01723         <a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a> *IC = Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>;
01724     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> MsgLen = (Msg == NULL) ? 0 : strlen(Msg);
01725     <a class="code" href="../../d2/dc9/_platform_8h.html#a54">Platform_GetTime</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, &amp;Now);
01726 
01727         <span class="keywordflow">if</span>(Coll-&gt;<a class="code" href="../../de/d0d/struct_i_p_d_r__tag___collector.html#o9">isDummy</a> == <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>)
01728                 <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a69">ExporterProtocol_KeepAliveOutTimerReset</a>(IC);
01729 
01730         <span class="keywordflow">if</span> (IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a> == NULL <span class="comment">/*|| </span>
01731 <span class="comment">        ((IC-&gt;State == IPDR_CONNECTION_DISCONNECTED || </span>
01732 <span class="comment">        IC-&gt;State == IPDR_CONNECTION_WAITRESPONSE) &amp;&amp; (Coll-&gt;isDummy == IPDR_FALSE))*/</span>)
01733         {
01734         <span class="comment">/* XXX should signal error event */</span>
01735         <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
01736                   <span class="stringliteral">"ExporterProtocol_SendErrorMsg"</span>,
01737                   <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a37">MSG_EXPORTER_NOT_READY_SEND</a>);
01738         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a205">IPDR_ERR_NO_ACTIVE_COLLECTOR</a>;
01739     }
01740 
01741     <a class="code" href="../../d5/d93/_transport_8h.html#a22">TL_GetSendChunksManager</a>(Conn, &amp; CMgr);
01742     Status = <a class="code" href="../../d8/d51/_chunks_manager_8c.html#a19">ChunksManager_AllocateBuffer</a>(CMgr,
01743                                           <span class="keyword">sizeof</span> (ErrorMessage) + MsgLen + 1,
01744                                           &amp; BH);
01745     <span class="keywordflow">if</span> (<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
01746     {
01747         <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
01748                   <span class="stringliteral">"ExporterProtocol_SendError"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a72">MSG_EXPORTER_CHUNKS_MANAGER_FAILED</a>);
01749         <span class="keywordflow">return</span> Status;
01750     }
01751 
01752 
01753     EM = (ErrorMessage*)BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>;
01754     <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a40">ExporterProtocol_FillHeader</a>(S, BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, <a class="code" href="../../db/d1e/_protocol_8h.html#a30">IPDR_MSG_ERROR</a>,
01755                                 sizeof (ErrorMessage)  + MsgLen + 1 );
01756 
01757     <a class="code" href="../../df/dde/_defs_8h.html#a9">IPDR_SET_HTONL</a>(EM-&gt;Timestamp, Now);
01758     <a class="code" href="../../df/dde/_defs_8h.html#a8">IPDR_SET_HTONS</a>(EM-&gt;ErrorCode, ErrCode);
01759     <a class="code" href="../../df/dde/_defs_8h.html#a9">IPDR_SET_HTONL</a>(EM-&gt;DescrLength, MsgLen);
01760     <span class="comment">/* The description comes after the ErrorMessage ... it would have</span>
01761 <span class="comment">     * been nice to have had a char Descr[0] at the end of the</span>
01762 <span class="comment">     * struct,so we could do "memset(&amp;EM-&gt;Data, ...)" but some</span>
01763 <span class="comment">     * incorrect compilers don't allow this. */</span>
01764     memset(BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> + sizeof (ErrorMessage), 0, MsgLen + 1);
01765     strncpy(BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> + sizeof (ErrorMessage), Msg, MsgLen);
01766 
01767     <span class="keywordflow">if</span> (<a class="code" href="../../da/df4/_log_8h.html#a15">Log_ShouldWrite</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>)) {
01768         <a class="code" href="../../de/da6/_protocol_debug_8c.html#a4">ProtocolDebug_PrintOutgoingMessage</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, Conn, BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>);
01769     }
01770 
01771     Status = <a class="code" href="../../d5/d93/_transport_8h.html#a9">TL_Send</a>(Conn, &amp; BH, <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>);
01772     <span class="keywordflow">if</span> (<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
01773         {
01774                 <a class="code" href="../../da/df4/_log_8h.html#a29">Log_Write1</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
01775                                         <span class="stringliteral">"ExporterProtocol_SendError"</span>,
01776                                         <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a81">MSG_EXPORTER_ERROR_SEND_FAILED</a>, <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn));
01777                 <span class="keywordflow">return</span> Status;
01778         }
01779 
01780         <span class="comment">/*TODO: output detailed error message*/</span>
01781         <a class="code" href="../../da/df4/_log_8h.html#a29">Log_Write1</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a172">IPDR_LEVEL_DEBUG</a>,
01782                                         <span class="stringliteral">"ExporterProtocol_SendError"</span>,
01783                                         <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a82">MSG_EXPORTER_ERROR_SEND_TARGET</a>, <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn));
01784 
01785     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01786 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a64" doxytag="ExporterProtocol.c::ExporterProtocol_SendGetSessionsResponse"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_SendGetSessionsResponse           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Conn</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>RequestID</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02799 {
02800         size_t                          Size;
02801     <a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a>                BH;
02802     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>                 Status;
02803         <span class="keywordtype">int</span>                                     Index;
02804         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>            NumSessions;
02805     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>               MsgID = <a class="code" href="../../db/d1e/_protocol_8h.html#a37">IPDR_MSG_GET_SESSIONS_RESPONSE</a>;
02806         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>           *p1;
02807     <a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a>*              CMgr;
02808         <a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a>*         IC = Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>;
02809         <span class="comment">/*CollectorSession*     CS = NULL;*/</span>
02810         GetSessionsResponseMessage      *GTR;
02811 
02812         <span class="comment">/*Status = ExporterProtocol_CollectorSession(Coll, S, &amp;CS, NULL, IPDR_TRUE);*/</span>
02813 
02814         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a69">ExporterProtocol_KeepAliveOutTimerReset</a>(IC);
02815 
02816     <span class="keywordflow">if</span> (Conn == NULL || IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o1">State</a> == <a class="code" href="../../d5/d93/_exporter_8h.html#a51a21">IPDR_CONNECTION_DISCONNECTED</a> ||
02817                 IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o1">State</a> == <a class="code" href="../../d5/d93/_exporter_8h.html#a51a22">IPDR_CONNECTION_WAITRESPONSE</a>)
02818         {
02819         <span class="comment">/* XXX should signal error event */</span>
02820         <a class="code" href="../../da/df4/_log_8h.html#a29">Log_Write1</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
02821                   <span class="stringliteral">"ExporterProtocol_SendGetSessionsResponse"</span>,
02822                   <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a57">MSG_EXPORTER_NOT_READY_SEND2</a>,  <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn));
02823         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a205">IPDR_ERR_NO_ACTIVE_COLLECTOR</a>;
02824     }
02825 
02826         <span class="comment">/*if(CS == NULL)</span>
02827 <span class="comment">        {</span>
02828 <span class="comment">                Log_Write2(EXPORTER_LOG, PROTOCOL_MODULE_ID, IPDR_LEVEL_ERROR,</span>
02829 <span class="comment">                                        "ExporterProtocol_SendGetSessionsResponse",</span>
02830 <span class="comment">                                        MSG_EXPORTER_NO_SESSIONS,  TL_GetConnectionInfoStr(Conn),</span>
02831 <span class="comment">                                        TL_GetConnectionInfoStr(Conn));</span>
02832 <span class="comment">                return IPDR_ERR_UNABLE_TO_FIND_SESSION ;</span>
02833 <span class="comment">        }*/</span>
02834 
02835             <span class="comment">/* calculate the size of the message */</span>
02836 
02837     <a class="code" href="../../d3/d58/_dynamic_array_8c.html#a15">DynamicArray_CountObjects</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, &amp; (E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o13">Sessions</a>),
02838                               &amp; NumSessions);
02839 
02840     Size = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a13">ExporterProtocol_GetSessionsResponseMsgLen</a>(E);
02841 
02842             <span class="comment">/* allocate a buffer for the message */</span>
02843     <a class="code" href="../../d5/d93/_transport_8h.html#a22">TL_GetSendChunksManager</a>(Conn, &amp; CMgr);
02844     Status = <a class="code" href="../../d8/d51/_chunks_manager_8c.html#a19">ChunksManager_AllocateBuffer</a>(CMgr, Size, &amp; BH);
02845     <span class="keywordflow">if</span> (<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
02846         {
02847         <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
02848                    <span class="stringliteral">"ExporterProtocol_SendGetSessionsResponse"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a72">MSG_EXPORTER_CHUNKS_MANAGER_FAILED</a>);
02849         <span class="keywordflow">return</span> Status;
02850         }
02851 
02852     <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a40">ExporterProtocol_FillHeader</a>(S, BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, MsgID, Size);
02853 
02854         GTR = (GetSessionsResponseMessage *)BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>;
02855 
02856         <a class="code" href="../../df/dde/_defs_8h.html#a8">IPDR_SET_HTONS</a>(GTR-&gt;RequestID, RequestID);
02857         <a class="code" href="../../df/dde/_defs_8h.html#a9">IPDR_SET_HTONL</a>(GTR-&gt;NumSessions, E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o13">Sessions</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o1">Length</a>);
02858 
02859         p1 = BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> + <span class="keyword">sizeof</span>(GetSessionsResponseMessage);
02860         <span class="keywordflow">for</span>( Index = 0 ; Index &lt; E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o13">Sessions</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o1">Length</a> ; Index++ )
02861         {
02862                 <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sl;
02863                 <a class="code" href="../../d2/d1c/struct_protocol_unsigned32.html">ProtocolUnsigned32</a> nsl, ackTimeInterval, ackSequenceInterval;
02864                 <a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *SS = (<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *)E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o13">Sessions</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[Index];
02865                 memcpy(p1, &amp;(SS-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o16">ID</a>), <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>));
02866                 p1 += <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> char) * 2;
02867                 sl = strlen(SS-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o17">Name</a>);
02868                 <a class="code" href="../../df/dde/_defs_8h.html#a9">IPDR_SET_HTONL</a>(nsl, sl);
02869                 memcpy(p1, &amp;nsl, <span class="keyword">sizeof</span>(nsl));
02870                 p1 += <span class="keyword">sizeof</span>(nsl);
02871                 memcpy(p1, SS-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o17">Name</a>, sl);
02872                 p1 += sl;
02873                 sl = strlen(SS-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o18">Description</a>);
02874                 <a class="code" href="../../df/dde/_defs_8h.html#a9">IPDR_SET_HTONL</a>(nsl, sl);
02875                 memcpy(p1, &amp;nsl, <span class="keyword">sizeof</span>(nsl));
02876                 p1 += <span class="keyword">sizeof</span>(nsl);
02877                 memcpy(p1, SS-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o18">Description</a>, sl);
02878                 p1 += sl;
02879                 <a class="code" href="../../df/dde/_defs_8h.html#a9">IPDR_SET_HTONL</a>(ackTimeInterval, E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o4">Parameters</a>.<a class="code" href="../../d1/dac/struct_exporter_parameters.html#o9">DataAckTimeInterval</a>);
02880                 <a class="code" href="../../df/dde/_defs_8h.html#a9">IPDR_SET_HTONL</a>(ackSequenceInterval, E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o4">Parameters</a>.<a class="code" href="../../d1/dac/struct_exporter_parameters.html#o10">DataAckSequenceInterval</a>);
02881                 memcpy(p1, &amp;ackTimeInterval, <span class="keyword">sizeof</span>(ackTimeInterval));
02882                 p1 += <span class="keyword">sizeof</span>(ackTimeInterval);
02883                 memcpy(p1, &amp;ackSequenceInterval, <span class="keyword">sizeof</span>(ackSequenceInterval));
02884                 p1 += <span class="keyword">sizeof</span>(ackSequenceInterval);
02885         }
02886 
02887         <span class="keywordflow">if</span> (<a class="code" href="../../da/df4/_log_8h.html#a15">Log_ShouldWrite</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>)) {
02888         <a class="code" href="../../de/da6/_protocol_debug_8c.html#a4">ProtocolDebug_PrintOutgoingMessage</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, Conn, BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>);
02889     }
02890 
02891     Status = <a class="code" href="../../d5/d93/_transport_8h.html#a9">TL_Send</a>(Conn, &amp; BH, <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>);
02892         <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
02893         {
02894                 <span class="keywordflow">return</span> Status;
02895         }
02896     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
02897 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a65" doxytag="ExporterProtocol.c::ExporterProtocol_SendGetTemplatesResponse"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_SendGetTemplatesResponse           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Conn</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>RequestID</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Send a GET TMPL RSP message to a server .<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>E</em>&nbsp;</td><td>exporter handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>session handle (pointer)NumSessions </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Coll</em>&nbsp;</td><td>collector </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Conn</em>&nbsp;</td><td>connection </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>RequestID</em>&nbsp;</td><td>id associated with the reply.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga15">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">02955 {
02956         size_t                          Size;
02957     <a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a>                BH;
02958     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>                 Status;
02959         <a class="code" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html">TransmissionContext</a>* TC = S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o3">ActiveContext</a>;
02960     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                NumTemplates;
02961     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>               MsgID = <a class="code" href="../../db/d1e/_protocol_8h.html#a38">IPDR_MSG_GET_TEMPLATES_RESPONSE</a>;
02962     <a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a>*              CMgr;
02963         <a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a>*         IC = Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>;
02964         <span class="comment">/*CollectorSession*     CS = NULL;*/</span>
02965 
02966         <span class="comment">/*Status = ExporterProtocol_CollectorSession(Coll, S, &amp;CS, NULL, IPDR_TRUE);*/</span>
02967         <span class="keywordflow">if</span>(S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o10">Running</a> != <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>)
02968                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a177">IPDR_ERR_SESSION_LOGICALLY_STOPED</a>;
02969 
02970         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a69">ExporterProtocol_KeepAliveOutTimerReset</a>(IC);
02971 
02972 
02973     <span class="keywordflow">if</span> (Conn == NULL || IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o1">State</a> == <a class="code" href="../../d5/d93/_exporter_8h.html#a51a21">IPDR_CONNECTION_DISCONNECTED</a> || IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o1">State</a> == <a class="code" href="../../d5/d93/_exporter_8h.html#a51a22">IPDR_CONNECTION_WAITRESPONSE</a>)
02974         {
02975         <span class="comment">/* XXX should signal error event */</span>
02976         <a class="code" href="../../da/df4/_log_8h.html#a29">Log_Write1</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
02977                   <span class="stringliteral">"ExporterProtocol_SendGetTemplatesResponse"</span>,
02978                   <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a57">MSG_EXPORTER_NOT_READY_SEND2</a>,  <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn));
02979         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a205">IPDR_ERR_NO_ACTIVE_COLLECTOR</a>;
02980     }
02981 
02982         <span class="comment">/*if(CS == NULL)</span>
02983 <span class="comment">        {</span>
02984 <span class="comment">                Log_Write2(EXPORTER_LOG, PROTOCOL_MODULE_ID, IPDR_LEVEL_ERROR,</span>
02985 <span class="comment">                                        "ExporterProtocol_SendGetTemplatesResponse",</span>
02986 <span class="comment">                                        MSG_EXPORTER_NO_SESSIONS,  TL_GetConnectionInfoStr(Conn),  TL_GetConnectionInfoStr(Conn));</span>
02987 <span class="comment">                return IPDR_ERR_UNABLE_TO_FIND_SESSION ;</span>
02988 <span class="comment">        }*/</span>
02989 
02990     <span class="comment">/* calculate the size of the message */</span>
02991 
02992     <a class="code" href="../../d3/d58/_dynamic_array_8c.html#a15">DynamicArray_CountObjects</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, &amp; (TC-&gt;<a class="code" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html#o2">Templates</a>),
02993                               &amp; NumTemplates);
02994 
02995     Size = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a11">ExporterProtocol_GetTemplatesResponseMsgLen</a>(TC);
02996 
02997     <span class="comment">/* allocate a buffer for the message */</span>
02998     <a class="code" href="../../d5/d93/_transport_8h.html#a22">TL_GetSendChunksManager</a>(Conn, &amp; CMgr);
02999     Status = <a class="code" href="../../d8/d51/_chunks_manager_8c.html#a19">ChunksManager_AllocateBuffer</a>(CMgr, Size, &amp; BH);
03000     <span class="keywordflow">if</span> (<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
03001         {
03002         <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
03003                    <span class="stringliteral">"ExporterProtocol_SendGetTemplatesResponse"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a72">MSG_EXPORTER_CHUNKS_MANAGER_FAILED</a>);
03004         <span class="keywordflow">return</span> Status;
03005         }
03006 
03007     <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a40">ExporterProtocol_FillHeader</a>(S, BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, MsgID, Size);
03008 
03009         Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a28">ExporterProtocol_GetTemplates</a>(TC, BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, RequestID);
03010     <span class="keywordflow">if</span> (<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
03011         {
03012                 <span class="comment">/*NOTE: ExporterProtocol_WriteTemplateData always returns IPDR_OK !!! */</span>
03013         <span class="keywordflow">return</span> Status;
03014         }
03015 
03016     <span class="keywordflow">if</span> (<a class="code" href="../../da/df4/_log_8h.html#a15">Log_ShouldWrite</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>)) {
03017         <a class="code" href="../../de/da6/_protocol_debug_8c.html#a4">ProtocolDebug_PrintOutgoingMessage</a>(EXPORTER_LOG, Conn, BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>);
03018     }
03019 
03020     Status = <a class="code" href="../../d5/d93/_transport_8h.html#a9">TL_Send</a>(Conn, &amp; BH, <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>);
03021         <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
03022         {
03023                 <span class="keywordflow">return</span> Status;
03024         }
03025     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
03026 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a58" doxytag="ExporterProtocol.c::ExporterProtocol_SendKeepAlive"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_SendKeepAlive           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Conn</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01792 {
01793         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>     Status;
01794         <a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a>    BH;
01795     <a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a>*      CMgr;
01796         <a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a>* IC = NULL;
01797         <a class="code" href="../../d5/d93/_transport_8h.html#a28">TL_PABuf</a> paBuf;
01798         
01799         <span class="keywordflow">if</span>(!Conn)       
01800                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a> ;
01801                 
01802         IC = Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>;
01803 
01804         <a class="code" href="../../d2/dc9/_platform_8h.html#a34">Platform_Lock</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>);
01805 
01806         <span class="keywordflow">if</span> (IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o1">State</a> != <a class="code" href="../../d5/d93/_exporter_8h.html#a51a23">IPDR_CONNECTION_CONNECTED</a>) {
01807         <span class="comment">/* XXX should signal error event */</span>
01808         <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
01809                   <span class="stringliteral">"ExporterProtocol_SendKeepAlive"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a84">MSG_EXPORTER_CONNECTION_MUST_BE_SET</a>);
01810                                   
01811                 <a class="code" href="../../d2/dc9/_platform_8h.html#a35">Platform_Unlock</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>);
01812         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>;
01813     }
01814 
01815         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a69">ExporterProtocol_KeepAliveOutTimerReset</a>(IC);
01816 
01817     <a class="code" href="../../d5/d93/_transport_8h.html#a22">TL_GetSendChunksManager</a>(Conn, &amp; CMgr);
01818     Status = <a class="code" href="../../d8/d51/_chunks_manager_8c.html#a19">ChunksManager_AllocateBuffer</a>(CMgr,
01819                                           <span class="keyword">sizeof</span>(MessageHeader),
01820                                                                                   &amp; BH);
01821     <span class="keywordflow">if</span> (<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
01822         {
01823                 <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
01824                            <span class="stringliteral">"ExporterProtocol_SendKeepAlive"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a72">MSG_EXPORTER_CHUNKS_MANAGER_FAILED</a>);
01825                            
01826                 <a class="code" href="../../d2/dc9/_platform_8h.html#a35">Platform_Unlock</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>);
01827         <span class="keywordflow">return</span> Status;
01828         }
01829 
01830     <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a40">ExporterProtocol_FillHeader</a>(S, BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, <a class="code" href="../../db/d1e/_protocol_8h.html#a31">IPDR_MSG_KEEP_ALIVE</a>,
01831                               <span class="keyword">sizeof</span>(MessageHeader));
01832 
01833     <span class="keywordflow">if</span> (<a class="code" href="../../da/df4/_log_8h.html#a15">Log_ShouldWrite</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>)) {
01834         <a class="code" href="../../de/da6/_protocol_debug_8c.html#a4">ProtocolDebug_PrintOutgoingMessage</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, Conn, BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>);
01835     }
01836 
01837     Status = <a class="code" href="../../d5/d93/_transport_8h.html#a9">TL_Send</a>(Conn, &amp; BH, <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>);
01838         <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
01839         {
01840                 <a class="code" href="../../da/df4/_log_8h.html#a29">Log_Write1</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
01841                                         <span class="stringliteral">"ExporterProtocol_SendKeepAlive"</span>,
01842                                         <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a94">MSG_EXPORTER_SEND_KEEPALIVE_FAILED</a>, <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn));
01843                 <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(Conn);
01844                 
01845                 <a class="code" href="../../d2/dc9/_platform_8h.html#a35">Platform_Unlock</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>);
01846                 <span class="keywordflow">return</span> Status;
01847         }
01848 
01849         <a class="code" href="../../da/df4/_log_8h.html#a29">Log_Write1</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
01850                                         <span class="stringliteral">"ExporterProtocol_SendKeepAlive"</span>,
01851                                         <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a95">MSG_EXPORTER_SEND_KEEPALIVE_TARGET</a>, <a class="code" href="../../d5/d93/_transport_8h.html#a18">TL_PrintConnectionRemote</a>(Conn,paBuf));
01852                                         
01853         <a class="code" href="../../d2/dc9/_platform_8h.html#a35">Platform_Unlock</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>);
01854     <span class="keywordflow">return</span> Status;
01855 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a62" doxytag="ExporterProtocol.c::ExporterProtocol_SendModifyTemplateResponse"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_SendModifyTemplateResponse           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Conn</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02641 {
02642         size_t                          Size;
02643     <a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a>                BH;
02644     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>                 Status;
02645         <a class="code" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html">TransmissionContext</a>* TC = S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o3">ActiveContext</a>;
02646     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                NumTemplates;
02647     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>               MsgID;
02648     <a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a>*              CMgr;
02649         <a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a>*         IC = Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>;
02650         <a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html">CollectorSession</a>*       CS = NULL;
02651 
02652         Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a5">ExporterProtocol_CollectorSession</a>(Coll, S, &amp;CS, NULL, <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>);
02653 
02654         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a69">ExporterProtocol_KeepAliveOutTimerReset</a>(IC);
02655 
02656 
02657     <span class="keywordflow">if</span> (Conn == NULL || IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o1">State</a> == <a class="code" href="../../d5/d93/_exporter_8h.html#a51a21">IPDR_CONNECTION_DISCONNECTED</a> || IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o1">State</a> == <a class="code" href="../../d5/d93/_exporter_8h.html#a51a22">IPDR_CONNECTION_WAITRESPONSE</a>)
02658         {
02659         <span class="comment">/* XXX should signal error event */</span>
02660         <a class="code" href="../../da/df4/_log_8h.html#a29">Log_Write1</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
02661                            <span class="stringliteral">"ExporterProtocol_SendModifyTemplateResponse"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a57">MSG_EXPORTER_NOT_READY_SEND2</a>,
02662                            <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn));
02663                            <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a205">IPDR_ERR_NO_ACTIVE_COLLECTOR</a>;
02664     }
02665 
02666         <span class="keywordflow">if</span>(CS == NULL)
02667         {
02668                 <a class="code" href="../../da/df4/_log_8h.html#a30">Log_Write2</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
02669                            <span class="stringliteral">"ExporterProtocol_SendModifyTemplateResponse"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a45">MSG_EXPORTER_NO_SESSIONS</a>,
02670                            <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn),  <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn));
02671                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a192">IPDR_ERR_UNABLE_TO_FIND_SESSION</a> ;
02672         }
02673 
02674     <span class="comment">/* calculate the size of the message */</span>
02675 
02676     <a class="code" href="../../d3/d58/_dynamic_array_8c.html#a15">DynamicArray_CountObjects</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, &amp; (TC-&gt;<a class="code" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html#o2">Templates</a>),
02677                               &amp; NumTemplates);
02678 
02679     Size = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a10">ExporterProtocol_GetTemplateDataMsgLen</a>(TC);
02680 
02681     <span class="comment">/* allocate a buffer for the message */</span>
02682     <a class="code" href="../../d5/d93/_transport_8h.html#a22">TL_GetSendChunksManager</a>(Conn, &amp; CMgr);
02683     Status = <a class="code" href="../../d8/d51/_chunks_manager_8c.html#a19">ChunksManager_AllocateBuffer</a>(CMgr, Size, &amp; BH);
02684     <span class="keywordflow">if</span> (<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
02685         {
02686                 <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
02687                            <span class="stringliteral">"ExporterProtocol_SendModifyTemplateResponse"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a72">MSG_EXPORTER_CHUNKS_MANAGER_FAILED</a>);
02688         <span class="keywordflow">return</span> Status;
02689         }
02690 
02691 
02692     MsgID = <a class="code" href="../../db/d1e/_protocol_8h.html#a35">IPDR_MSG_MODIFY_TEMPLATE_RESPONSE</a>;
02693     <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a40">ExporterProtocol_FillHeader</a>(S, BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, MsgID, Size);
02694 
02695         Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a21">ExporterProtocol_WriteTemplateData</a>(TC, BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o7">Negotiable</a>);
02696     <span class="keywordflow">if</span> (<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
02697         {
02698                 <span class="comment">/*NOTE: ExporterProtocol_WriteTemplateData always returns IPDR_OK !!! */</span>
02699                 <span class="keywordflow">return</span> Status;
02700         }
02701 
02702     <span class="keywordflow">if</span> (<a class="code" href="../../da/df4/_log_8h.html#a15">Log_ShouldWrite</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>)) {
02703         <a class="code" href="../../de/da6/_protocol_debug_8c.html#a4">ProtocolDebug_PrintOutgoingMessage</a>(EXPORTER_LOG, Conn, BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>);
02704     }
02705 
02706     Status = <a class="code" href="../../d5/d93/_transport_8h.html#a9">TL_Send</a>(Conn, &amp; BH, <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>);
02707         <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
02708         {
02709                 <span class="keywordflow">return</span> Status;
02710         }
02711 
02712         <span class="keywordflow">if</span>(CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o8">TmplDataTimer</a> != NULL)
02713                 <a class="code" href="../../d2/dc9/_platform_8h.html#a13">Platform_UnregisterTimerAndClear</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, &amp;CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o8">TmplDataTimer</a>);
02714 
02715         <a class="code" href="../../d2/dc9/_platform_8h.html#a9">Platform_RegisterTimer</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>,
02716                                                 <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a32">ExporterProtocol_TmplDataTimerCallback</a>,
02717                                                         CS,
02718                             E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o4">Parameters</a>.<a class="code" href="../../d1/dac/struct_exporter_parameters.html#o6">TemplateAckTimeout</a>,
02719                             &amp; (CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o8">TmplDataTimer</a>));
02720     <span class="keywordflow">return</span> Status;
02721 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a59" doxytag="ExporterProtocol.c::ExporterProtocol_SendSessionStart"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_SendSessionStart           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Conn</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01861 {
01862         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>                     Status;
01863         <a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a>                    BH;
01864         <a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a>*                 IC = Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>;
01865         SessionStartMessage*    SSM;
01866         <a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a>*                  CMgr;
01867 
01868         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a69">ExporterProtocol_KeepAliveOutTimerReset</a>(IC);
01869 
01870         <a class="code" href="../../d5/d93/_transport_8h.html#a22">TL_GetSendChunksManager</a>(Conn, &amp; CMgr);
01871     Status = <a class="code" href="../../d8/d51/_chunks_manager_8c.html#a19">ChunksManager_AllocateBuffer</a>(CMgr, <span class="keyword">sizeof</span>(SessionStartMessage), &amp;BH);
01872     <span class="keywordflow">if</span> (<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
01873         {
01874                 <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
01875                           <span class="stringliteral">"ExporterProtocol_SendSessionStart"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a72">MSG_EXPORTER_CHUNKS_MANAGER_FAILED</a>);
01876         <span class="keywordflow">return</span> Status;
01877         }
01878 
01879     <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a40">ExporterProtocol_FillHeader</a>(S, BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, <a class="code" href="../../db/d1e/_protocol_8h.html#a32">IPDR_MSG_SESSION_START</a>, <span class="keyword">sizeof</span>(SessionStartMessage));
01880 
01881         SSM = (SessionStartMessage*)BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>;
01882 
01883     <a class="code" href="../../df/dde/_defs_8h.html#a9">IPDR_SET_HTONL</a>(SSM-&gt;exporterBootTime, E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o2">ExporterStartTime</a>);
01884     <a class="code" href="../../df/dde/_defs_8h.html#a10">IPDR_SET_HTONLL</a>(SSM-&gt;firstRecordSequenceNumber, S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o6">DSN</a>);
01885     <a class="code" href="../../df/dde/_defs_8h.html#a10">IPDR_SET_HTONLL</a>(SSM-&gt;droppedRecordCount, 0);
01886     <a class="code" href="../../df/dde/_defs_8h.html#a9">IPDR_SET_HTONL</a>(SSM-&gt;ackTimeInterval,((E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o4">Parameters</a>.<a class="code" href="../../d1/dac/struct_exporter_parameters.html#o9">DataAckTimeInterval</a>)/1000) );
01887     <a class="code" href="../../df/dde/_defs_8h.html#a9">IPDR_SET_HTONL</a>(SSM-&gt;ackSequenceInterval, E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o4">Parameters</a>.<a class="code" href="../../d1/dac/struct_exporter_parameters.html#o10">DataAckSequenceInterval</a> );
01888     memcpy( SSM-&gt;documentId, S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o5">DocumentID</a>, <span class="keyword">sizeof</span>(S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o5">DocumentID</a>) );
01889     SSM-&gt;primary = 1 ;
01890 
01891         <a class="code" href="../../da/df4/_log_8h.html#a30">Log_Write2</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
01892                         <span class="stringliteral">"ExporterProtocol_SendSessionStart"</span>,
01893                         <span class="stringliteral">"ackTimeInterval=%lu, dataAckSequenceInterval=%lu."</span>,
01894                         (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)<a class="code" href="../../df/dde/_defs_8h.html#a12">IPDR_NTOHL</a>(SSM-&gt;ackTimeInterval),
01895                         (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)<a class="code" href="../../df/dde/_defs_8h.html#a12">IPDR_NTOHL</a>(SSM-&gt;ackSequenceInterval));
01896 
01897 
01898     <span class="keywordflow">if</span> (<a class="code" href="../../da/df4/_log_8h.html#a15">Log_ShouldWrite</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>)) {
01899         <a class="code" href="../../de/da6/_protocol_debug_8c.html#a4">ProtocolDebug_PrintOutgoingMessage</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, Conn, BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>);
01900     }
01901 
01902         Status = <a class="code" href="../../d5/d93/_transport_8h.html#a9">TL_Send</a>(Conn, &amp; BH, <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>);
01903         <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
01904         {
01905                 <a class="code" href="../../da/df4/_log_8h.html#a29">Log_Write1</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
01906                                         <span class="stringliteral">"ExporterProtocol_SendSessionStart"</span>,
01907                                         <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a79">MSG_EXPORTER_SEND_SESSION_START_FAILED</a>, <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn));
01908                 <span class="keywordflow">return</span> Status;
01909         }
01910 
01911         <a class="code" href="../../da/df4/_log_8h.html#a29">Log_Write1</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a172">IPDR_LEVEL_DEBUG</a>,
01912                                         <span class="stringliteral">"ExporterProtocol_SendSessionStart"</span>,
01913                                         <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a80">MSG_EXPORTER_SEND_SESSION_START_TARGET</a>, <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn));
01914         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01915 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a60" doxytag="ExporterProtocol.c::ExporterProtocol_SendSessionStop"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_SendSessionStop           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Conn</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned short&nbsp;</td>
          <td class="mdname" nowrap> <em>reasonCode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>ReasonDescripsion</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01919 {
01920         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status;
01921     <a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> BH;
01922     <a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a> *CMgr;
01923     SessionStopMessage *SSM;
01924     <a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a> *IC = NULL;
01925     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> MsgLen = (ReasonDescripsion == NULL) ? 0 : strlen(ReasonDescripsion);
01926 
01927 
01928         <span class="keywordflow">if</span>( !E || !S || !Coll )
01929                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a181">IPDR_ERR_INVALID_VALUE</a>;
01930 
01931         <span class="keywordflow">if</span>( Conn == NULL || Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a> == NULL)
01932         {
01933                 <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
01934                   <span class="stringliteral">"ExporterProtocol_SendSessionStop"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a77">MSG_EXPORTER_COLLECTOR_NOT_CONNECTED</a>);
01935                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a205">IPDR_ERR_NO_ACTIVE_COLLECTOR</a>;
01936         }
01937 
01938         IC = Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>;
01939 
01940         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a69">ExporterProtocol_KeepAliveOutTimerReset</a>(IC);
01941 
01942         <span class="keywordflow">if</span> (IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a> == NULL ||
01943             IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o1">State</a> == <a class="code" href="../../d5/d93/_exporter_8h.html#a51a21">IPDR_CONNECTION_DISCONNECTED</a> ||
01944             IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o1">State</a> == <a class="code" href="../../d5/d93/_exporter_8h.html#a51a22">IPDR_CONNECTION_WAITRESPONSE</a>)
01945         {
01946         <span class="comment">/* XXX should signal error event */</span>
01947         <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
01948                   <span class="stringliteral">"ExporterProtocol_SendSessionStop"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a37">MSG_EXPORTER_NOT_READY_SEND</a>);
01949         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a205">IPDR_ERR_NO_ACTIVE_COLLECTOR</a>;
01950     }
01951 
01952     <a class="code" href="../../d5/d93/_transport_8h.html#a22">TL_GetSendChunksManager</a>(Conn, &amp; CMgr);
01953     Status = <a class="code" href="../../d8/d51/_chunks_manager_8c.html#a19">ChunksManager_AllocateBuffer</a>(CMgr,
01954                                           <span class="keyword">sizeof</span> (SessionStopMessage) + MsgLen + 1,
01955                                           &amp; BH);
01956     <span class="keywordflow">if</span> (<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
01957     {
01958         <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
01959                    <span class="stringliteral">"ExporterProtocol_SendSessionStop"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a72">MSG_EXPORTER_CHUNKS_MANAGER_FAILED</a>);
01960         <span class="keywordflow">return</span> Status;
01961     }
01962 
01963 
01964     SSM = (SessionStopMessage*)BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>;
01965     <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a40">ExporterProtocol_FillHeader</a>(S, BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, <a class="code" href="../../db/d1e/_protocol_8h.html#a33">IPDR_MSG_SESSION_STOP</a>,
01966                                 sizeof (SessionStopMessage)  + MsgLen + 1 );
01967 
01968     <a class="code" href="../../df/dde/_defs_8h.html#a8">IPDR_SET_HTONS</a>(SSM-&gt;reasonCode, reasonCode);
01969     <a class="code" href="../../df/dde/_defs_8h.html#a9">IPDR_SET_HTONL</a>(SSM-&gt;reasonInfoLength, MsgLen);
01970     <span class="comment">/* The description comes after the ErrorMessage ... it would have</span>
01971 <span class="comment">     * been nice to have had a char Descr[0] at the end of the</span>
01972 <span class="comment">     * struct,so we could do "memset(&amp;EM-&gt;Data, ...)" but some</span>
01973 <span class="comment">     * incorrect compilers don't allow this. */</span>
01974     memset(BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> + sizeof (SessionStopMessage), 0, MsgLen + 1);
01975     strncpy(BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> + sizeof (SessionStopMessage), ReasonDescripsion, MsgLen);
01976 
01977     <span class="keywordflow">if</span> (<a class="code" href="../../da/df4/_log_8h.html#a15">Log_ShouldWrite</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>)) {
01978                 <a class="code" href="../../de/da6/_protocol_debug_8c.html#a4">ProtocolDebug_PrintOutgoingMessage</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, Conn, BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>);
01979     }
01980 
01981     Status = <a class="code" href="../../d5/d93/_transport_8h.html#a9">TL_Send</a>(Conn, &amp; BH, <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>);
01982     <span class="keywordflow">if</span> (<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
01983         {
01984                 <a class="code" href="../../da/df4/_log_8h.html#a29">Log_Write1</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
01985                                         <span class="stringliteral">"ExporterProtocol_SendSessionStop"</span>,
01986                                         <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a81">MSG_EXPORTER_ERROR_SEND_FAILED</a>, <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn));
01987                 <span class="keywordflow">return</span> Status;
01988         }
01989 
01990         <a class="code" href="../../da/df4/_log_8h.html#a29">Log_Write1</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a172">IPDR_LEVEL_DEBUG</a>,
01991                                         <span class="stringliteral">"ExporterProtocol_SendError"</span>,
01992                                         <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a82">MSG_EXPORTER_ERROR_SEND_TARGET</a>, <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn));
01993 
01994     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01995 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a63" doxytag="ExporterProtocol.c::ExporterProtocol_SendStartNegotiationReject"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_SendStartNegotiationReject           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Conn</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02724 {
02725         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>     Status;
02726         <a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a>    BH;
02727         <a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a>*  CMgr;
02728         <a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a>* IC = Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>;
02729 
02730         <span class="keywordflow">if</span> (IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o1">State</a> != <a class="code" href="../../d5/d93/_exporter_8h.html#a51a23">IPDR_CONNECTION_CONNECTED</a>) {
02731         <span class="comment">/* XXX should signal error event */</span>
02732         <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
02733                   <span class="stringliteral">"ExporterProtocol_SendStartNegotiationReject"</span>,
02734                   <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a84">MSG_EXPORTER_CONNECTION_MUST_BE_SET</a>);
02735         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>;
02736     }
02737 
02738         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a69">ExporterProtocol_KeepAliveOutTimerReset</a>(IC);
02739 
02740     <a class="code" href="../../d5/d93/_transport_8h.html#a22">TL_GetSendChunksManager</a>(Conn, &amp; CMgr);
02741     Status = <a class="code" href="../../d8/d51/_chunks_manager_8c.html#a19">ChunksManager_AllocateBuffer</a>(CMgr,
02742                                           <span class="keyword">sizeof</span>(MessageHeader),
02743                                                                                   &amp; BH);
02744     <span class="keywordflow">if</span> (<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
02745         {
02746                 <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
02747                           <span class="stringliteral">"ExporterProtocol_SendStartNegotiationReject"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a72">MSG_EXPORTER_CHUNKS_MANAGER_FAILED</a>);
02748                 <span class="keywordflow">return</span> Status;
02749         }
02750 
02751     <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a40">ExporterProtocol_FillHeader</a>(S, BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, <a class="code" href="../../db/d1e/_protocol_8h.html#a36">IPDR_MSG_START_NEGOTIATION_REJECT</a>,
02752                               <span class="keyword">sizeof</span>(MessageHeader));
02753 
02754     <span class="keywordflow">if</span> (<a class="code" href="../../da/df4/_log_8h.html#a15">Log_ShouldWrite</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>)) {
02755         <a class="code" href="../../de/da6/_protocol_debug_8c.html#a4">ProtocolDebug_PrintOutgoingMessage</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, Conn, BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>);
02756     }
02757 
02758     Status = <a class="code" href="../../d5/d93/_transport_8h.html#a9">TL_Send</a>(Conn, &amp; BH, <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>);
02759         <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
02760         {
02761                 <a class="code" href="../../da/df4/_log_8h.html#a29">Log_Write1</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
02762                                         <span class="stringliteral">"ExporterProtocol_SendStartNegotiationReject"</span>,
02763                                         <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a94">MSG_EXPORTER_SEND_KEEPALIVE_FAILED</a>, <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn));
02764                 <span class="keywordflow">return</span> Status;
02765         }
02766 
02767         <a class="code" href="../../da/df4/_log_8h.html#a29">Log_Write1</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a172">IPDR_LEVEL_DEBUG</a>,
02768                                         <span class="stringliteral">"ExporterProtocol_SendStartNegotiationReject"</span>,
02769                                         <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a95">MSG_EXPORTER_SEND_KEEPALIVE_TARGET</a>, <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn));
02770     <span class="keywordflow">return</span> Status;
02771 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a61" doxytag="ExporterProtocol.c::ExporterProtocol_SendTemplateData"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_SendTemplateData           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Conn</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../df/dde/_defs_8h.html#a16">IPDR_BOOL</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Negotiable</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Sends a TEMPLATE DATA message to a collector.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>E</em>&nbsp;</td><td>exporter handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>session handle (pointer) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Coll</em>&nbsp;</td><td>collector to which to send the message </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Conn</em>&nbsp;</td><td>connection between Coll and S </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Negotiable</em>&nbsp;</td><td>true if the template is negotiable</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga15">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">02553 {
02554         size_t                          Size;
02555     <a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a>                BH;
02556     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>                 Status;
02557         <a class="code" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html">TransmissionContext</a>* TC = S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o3">ActiveContext</a>;
02558     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                NumTemplates;
02559     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>               MsgID;
02560     <a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a>*              CMgr;
02561         <a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a>*         IC = Conn-&gt;<a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html#o11">Owner</a>;
02562         <a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html">CollectorSession</a>*       CS = NULL;
02563 
02564         Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a5">ExporterProtocol_CollectorSession</a>(Coll, S, &amp;CS, NULL, <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>);
02565 
02566         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a69">ExporterProtocol_KeepAliveOutTimerReset</a>(IC);
02567 
02568 
02569     <span class="keywordflow">if</span> (Conn == NULL || IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o1">State</a> == <a class="code" href="../../d5/d93/_exporter_8h.html#a51a21">IPDR_CONNECTION_DISCONNECTED</a> || IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o1">State</a> == <a class="code" href="../../d5/d93/_exporter_8h.html#a51a22">IPDR_CONNECTION_WAITRESPONSE</a>)
02570         {
02571         <span class="comment">/* XXX should signal error event */</span>
02572         <a class="code" href="../../da/df4/_log_8h.html#a29">Log_Write1</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
02573                            <span class="stringliteral">"ExporterProtocol_SendTmplData"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a57">MSG_EXPORTER_NOT_READY_SEND2</a>,  <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn));
02574         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a205">IPDR_ERR_NO_ACTIVE_COLLECTOR</a>;
02575     }
02576 
02577         <span class="keywordflow">if</span>(CS == NULL)
02578         {
02579                 <a class="code" href="../../da/df4/_log_8h.html#a30">Log_Write2</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
02580                            <span class="stringliteral">"ExporterProtocol_SendTmplData"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a45">MSG_EXPORTER_NO_SESSIONS</a>,
02581                            <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn),  <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn));
02582                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a192">IPDR_ERR_UNABLE_TO_FIND_SESSION</a> ;
02583         }
02584 
02585     <span class="comment">/* calculate the size of the message */</span>
02586 
02587         CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o7">Negotiable</a> = (S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o11">Negotiable</a> &amp; Negotiable &amp; Coll-&gt;<a class="code" href="../../de/d0d/struct_i_p_d_r__tag___collector.html#o7">Capabilities</a>.TemplateNegotiation);
02588 
02589     <a class="code" href="../../d3/d58/_dynamic_array_8c.html#a15">DynamicArray_CountObjects</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, &amp; (TC-&gt;<a class="code" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html#o2">Templates</a>),
02590                               &amp; NumTemplates);
02591 
02592     Size = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a10">ExporterProtocol_GetTemplateDataMsgLen</a>(TC);
02593 
02594     <span class="comment">/* allocate a buffer for the message */</span>
02595     <a class="code" href="../../d5/d93/_transport_8h.html#a22">TL_GetSendChunksManager</a>(Conn, &amp; CMgr);
02596     Status = <a class="code" href="../../d8/d51/_chunks_manager_8c.html#a19">ChunksManager_AllocateBuffer</a>(CMgr, Size, &amp; BH);
02597     <span class="keywordflow">if</span> (<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
02598         {
02599                 <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>,
02600                            <span class="stringliteral">"ExporterProtocol_SendTemplateData"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a72">MSG_EXPORTER_CHUNKS_MANAGER_FAILED</a>);
02601         <span class="keywordflow">return</span> Status;
02602         }
02603 
02604 
02605     MsgID = <a class="code" href="../../db/d1e/_protocol_8h.html#a34">IPDR_MSG_TEMPLATE_DATA</a>;
02606     <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a40">ExporterProtocol_FillHeader</a>(S, BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, MsgID, Size);
02607 
02608         Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a21">ExporterProtocol_WriteTemplateData</a>(TC, BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o7">Negotiable</a>);
02609     <span class="keywordflow">if</span> (<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
02610         {
02611                 <span class="comment">/*NOTE: ExporterProtocol_WriteTemplateData always returns IPDR_OK !!! */</span>
02612                 <span class="keywordflow">return</span> Status;
02613         }
02614 
02615     <span class="keywordflow">if</span> (<a class="code" href="../../da/df4/_log_8h.html#a15">Log_ShouldWrite</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>)) {
02616         <a class="code" href="../../de/da6/_protocol_debug_8c.html#a4">ProtocolDebug_PrintOutgoingMessage</a>(EXPORTER_LOG, Conn, BH.<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>);
02617     }
02618 
02619     Status = <a class="code" href="../../d5/d93/_transport_8h.html#a9">TL_Send</a>(Conn, &amp; BH, <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>);
02620         <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
02621         {
02622                 <span class="keywordflow">return</span> Status;
02623         }
02624 
02625         <span class="keywordflow">if</span>(CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o8">TmplDataTimer</a> != NULL)
02626                 <a class="code" href="../../d2/dc9/_platform_8h.html#a13">Platform_UnregisterTimerAndClear</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>, &amp;CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o8">TmplDataTimer</a>);
02627 
02628         <a class="code" href="../../d2/dc9/_platform_8h.html#a9">Platform_RegisterTimer</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a1">EXPORTER_PLATFORM</a>,
02629                                                 <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a32">ExporterProtocol_TmplDataTimerCallback</a>,
02630                                                         CS,
02631                             E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o4">Parameters</a>.<a class="code" href="../../d1/dac/struct_exporter_parameters.html#o6">TemplateAckTimeout</a>,
02632                             &amp; (CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o8">TmplDataTimer</a>));
02633 
02634         <span class="keywordflow">return</span> Status;
02635 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a33" doxytag="ExporterProtocol.c::ExporterProtocol_SetCollectorCapabilities"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ExporterProtocol_SetCollectorCapabilities           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Coll</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>CollCaps</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">03762 {
03763         <span class="keywordtype">int</span>             exporterCapabilities = 0;
03764         <span class="keywordtype">int</span>             collectorCapabilities = 0;
03765         <span class="keywordflow">if</span>(E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o4">Parameters</a>.<a class="code" href="../../d1/dac/struct_exporter_parameters.html#o11">caps</a>.<a class="code" href="../../d3/d7e/struct_exporter_capabilities.html#o2">StructureSupport</a> == <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>)
03766                 exporterCapabilities = exporterCapabilities | 0x1u ;
03767         <span class="keywordflow">if</span>(E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o4">Parameters</a>.<a class="code" href="../../d1/dac/struct_exporter_parameters.html#o11">caps</a>.<a class="code" href="../../d3/d7e/struct_exporter_capabilities.html#o0">MultiSession</a> == <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>)
03768                 exporterCapabilities = exporterCapabilities | 0x2u ;
03769         <span class="keywordflow">if</span>(E-&gt;<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html#o4">Parameters</a>.<a class="code" href="../../d1/dac/struct_exporter_parameters.html#o11">caps</a>.<a class="code" href="../../d3/d7e/struct_exporter_capabilities.html#o1">TemplateNegotiation</a> == <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>)
03770                 exporterCapabilities = exporterCapabilities | 0x4u ;
03771 
03772         collectorCapabilities = exporterCapabilities &amp; CollCaps ;
03773 
03774         Coll-&gt;<a class="code" href="../../de/d0d/struct_i_p_d_r__tag___collector.html#o7">Capabilities</a>.StructureSupport = (collectorCapabilities &amp; 0x1u)?<a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>:<a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
03775         Coll-&gt;<a class="code" href="../../de/d0d/struct_i_p_d_r__tag___collector.html#o7">Capabilities</a>.MultiSession = (collectorCapabilities &amp; 0x2u)?<a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>:<a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
03776         Coll-&gt;<a class="code" href="../../de/d0d/struct_i_p_d_r__tag___collector.html#o7">Capabilities</a>.TemplateNegotiation = (collectorCapabilities &amp; 0x4u)?<a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>:<a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
03777 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="ExporterProtocol.c::ExporterProtocol_SyncTemplateDataAll"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_SyncTemplateDataAll           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01999 {
02000         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status ;
02001         <span class="keywordtype">int</span> i ;
02002         <span class="keywordflow">for</span> (i = 0; i &lt; S-&gt;CollectorSessions.Length; i++) {
02003                 <a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html">CollectorSession</a> *CS = (<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html">CollectorSession</a> *) S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o14">CollectorSessions</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[i];
02004                 <span class="keywordflow">if</span>(CS == S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o13">ActiveCS</a>)
02005                         <span class="keywordflow">continue</span>;
02006 
02007                 <span class="keywordflow">if</span>(     CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o4">Collector</a> != NULL &amp;&amp;
02008                         CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a> != NULL &amp;&amp;
02009                         CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a> != NULL &amp;&amp;
02010                         (CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a> == <a class="code" href="../../d5/d93/_exporter_8h.html#a52a25">IPDR_CS_INITIATION</a> ||
02011                         (S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o12">TemplatesChnged</a> == <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a> &amp;&amp; CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a> == <a class="code" href="../../d5/d93/_exporter_8h.html#a52a26">IPDR_CS_READY</a>)))
02012                 {
02013                         CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a> = <a class="code" href="../../d5/d93/_exporter_8h.html#a52a25">IPDR_CS_INITIATION</a> ;
02014                         Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a61">ExporterProtocol_SendTemplateData</a>(E, S, CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o4">Collector</a>,
02015                                                                    CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>, <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>);
02016                         <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
02017                         {
02018                                 <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>);
02019                                 <a class="code" href="../../da/df4/_log_8h.html#a28">Log_Write</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>,
02020                                           <span class="stringliteral">"ExporterProtocol_SyncTemplateDataAll"</span>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a70">MSG_EXPORTER_SEND_TEMPLATE_DATA_FAILED</a>);
02021                         }
02022                 }
02023         }
02024         S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o12">TemplatesChnged</a> = <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
02025         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
02026 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a32" doxytag="ExporterProtocol.c::ExporterProtocol_TmplDataTimerCallback"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void ExporterProtocol_TmplDataTimerCallback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Arg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Callback triggered in when a collector did not responde to to a template data related event send from the exporter <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Arg</em>&nbsp;</td><td>callback argument (handle to a CollectorSession) </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">03361 {
03362     <a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html">CollectorSession</a> *CS = (<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html">CollectorSession</a> *) Arg;
03363     <a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a> *S = NULL;
03364         <a class="code" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">Collector</a> *Coll = NULL;
03365     <a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html">IPDRConnection</a> *IC = NULL;
03366         <a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">Exporter</a> *E = NULL;
03367         <a class="code" href="../../d4/d37/struct_i_p_d_r__tag___t_c_p_connection.html">Connection</a> Conn = NULL;
03368         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status ;
03369 
03370         <span class="keywordflow">if</span>(CS)
03371         {
03372                 <span class="keywordflow">if</span>(CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o3">SessionPtr</a> &amp;&amp; CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o2">ExporterPtr</a> &amp;&amp;
03373                         CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o4">Collector</a> &amp;&amp; CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a> &amp;&amp;
03374                         CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>)
03375                 {
03376                         E = CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o2">ExporterPtr</a>;
03377                         S = CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o3">SessionPtr</a>;
03378                         Coll = CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o4">Collector</a>;
03379                         IC = CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o5">SessionConnection</a>;
03380                         Conn = IC-&gt;<a class="code" href="../../db/d4f/struct_i_p_d_r__tag___connection.html#o3">TCPConnection</a>;
03381 
03382                         Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a57">ExporterProtocol_SendError</a>(E, S, Coll, Conn, <a class="code" href="../../db/d1e/_protocol_8h.html#a57a52">TemplateDataAckExpired</a>, <span class="stringliteral">""</span>);
03383                         <span class="keywordflow">if</span>(<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
03384                         {
03385                                 <a class="code" href="../../da/df4/_log_8h.html#a29">Log_Write1</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a170">IPDR_LEVEL_WARNING</a>,
03386                                                    <span class="stringliteral">"ExporterProtocol_TmplDataTimerCallback"</span>,
03387                                                    <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a81">MSG_EXPORTER_ERROR_SEND_FAILED</a>, <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn));
03388 
03389                                 <a class="code" href="../../d5/d93/_transport_8h.html#a24">TL_HandleDisconnection</a>(Conn);
03390                         }
03391 
03392                         <a class="code" href="../../da/df4/_log_8h.html#a30">Log_Write2</a>(<a class="code" href="../../d5/d93/_exporter_8h.html#a4">EXPORTER_LOG</a>, <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a3">PROTOCOL_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a170">IPDR_LEVEL_WARNING</a>,
03393                                                    <span class="stringliteral">"ExporterProtocol_TmplDataTimerCallback"</span>,
03394                                                    <a class="code" href="../../d0/dc0/_exporter_msgs_8h.html#a118">MSG_EXPORTER_NO_TEMPLATEDATA_ACK</a>, S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o16">ID</a>, <a class="code" href="../../d5/d93/_transport_8h.html#a14">TL_GetConnectionInfoStr</a>(Conn));
03395 
03396                         CS-&gt;<a class="code" href="../../d5/da9/struct_i_p_d_r__tag___collector_session.html#o1">CSState</a> = <a class="code" href="../../d5/d93/_exporter_8h.html#a52a24">IPDR_CS_DISCONNECTED</a> ;
03397 
03398                         <span class="keywordflow">if</span>(S-&gt;<a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html#o13">ActiveCS</a> == CS)
03399                         {
03400                                 <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a70">ExporterProtocol_SelectCollector</a>( E, S, <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>, NULL );
03401                         }
03402                 }
03403         }
03404 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="ExporterProtocol.c::ExporterProtocol_WriteFieldDescriptorBlock"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_WriteFieldDescriptorBlock           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../de/d6f/struct_i_p_d_r__tag___key.html">Key</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>K</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned char **&nbsp;</td>
          <td class="mdname" nowrap> <em>Buffer</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
struct TemplateBlock{ short templateId; / ID of Template - context within configId / / Provides numeric Identifier to / / IPDR service specification for context of / / Session/config / UTF8String schemaName; / Reference to IPDR service specification / UTF8String typeName; / Reference to IPDR service specification / FieldDescriptor fields&lt;&gt;; / Fields in this Template / }     </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="ExporterProtocol.c::ExporterProtocol_WriteInt"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_WriteInt           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>Int</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned char **&nbsp;</td>
          <td class="mdname" nowrap> <em>Buffer</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02135 {
02136         memcpy(*Buffer, &amp;Int, <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) );
02137         *Buffer += <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> int);
02138         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
02139 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="ExporterProtocol.c::ExporterProtocol_WriteLong"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_WriteLong           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">long long&nbsp;</td>
          <td class="mdname" nowrap> <em>Long</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned char **&nbsp;</td>
          <td class="mdname" nowrap> <em>Buffer</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02143 {
02144         memcpy(*Buffer, &amp;Long, <span class="keyword">sizeof</span>(<span class="keywordtype">long</span> <span class="keywordtype">long</span>) );
02145         *Buffer += <span class="keyword">sizeof</span>(<span class="keywordtype">long</span> long);
02146         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
02147 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="ExporterProtocol.c::ExporterProtocol_WriteShort"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_WriteShort           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">unsigned short&nbsp;</td>
          <td class="mdname" nowrap> <em>Short</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned char **&nbsp;</td>
          <td class="mdname" nowrap> <em>Buffer</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02127 {
02128         memcpy(*Buffer, &amp;Short, <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>) );
02129         *Buffer += <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> short);
02130         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
02131 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="ExporterProtocol.c::ExporterProtocol_WriteTemplateBlock"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_WriteTemplateBlock           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../da/d62/struct_i_p_d_r__tag___template.html">Template</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>T</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned char **&nbsp;</td>
          <td class="mdname" nowrap> <em>Buffer</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
struct TemplateData { struct IPDRStreamingHeader header; short configId; / Identifies context of Template definitions / / Changes in Template MUST use a different / / configId (0 if unused) / char flags; / LSB 0=NN 1=N; rest of bits Unused (reserved)/ TemplateBlock templates&lt;&gt;; / Definitions of Templates supported / };     </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="ExporterProtocol.c::ExporterProtocol_WriteTemplateData"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_WriteTemplateData           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html">TransmissionContext</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>TC</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned char *&nbsp;</td>
          <td class="mdname" nowrap> <em>Buffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../df/dde/_defs_8h.html#a16">IPDR_BOOL</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Negotiable</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02284 {
02285         <span class="keywordtype">int</span>                                     Index ;
02286         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*                  WriteBuffer ;
02287         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>                     Status = <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
02288         TmplDataMessage*        TDHeader ;
02289 
02290         TDHeader = (TmplDataMessage *)Buffer;
02291 
02292         <a class="code" href="../../df/dde/_defs_8h.html#a8">IPDR_SET_HTONS</a>(TDHeader-&gt;ConfigurationID, TC-&gt;<a class="code" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html#o3">ConfigurationID</a>);
02293         TDHeader-&gt;Flags = Negotiable ? 1 : 0 ;
02294         <a class="code" href="../../df/dde/_defs_8h.html#a9">IPDR_SET_HTONL</a>(TDHeader-&gt;NumTemplates, TC-&gt;<a class="code" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html#o2">Templates</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o1">Length</a>);
02295         WriteBuffer = Buffer + <span class="keyword">sizeof</span>( TmplDataMessage ) ;
02296 
02297         <span class="keywordflow">for</span>( Index = 0 ; Index &lt; TC-&gt;<a class="code" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html#o2">Templates</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o1">Length</a> ; Index++ )
02298         {
02299                 Status = <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a20">ExporterProtocol_WriteTemplateBlock</a>( TC-&gt;<a class="code" href="../../d1/d8c/struct_i_p_d_r__tag___transmission_context.html#o2">Templates</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[Index], &amp;WriteBuffer );
02300                 <span class="keywordflow">if</span>( <a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status) )
02301                 {
02302                         break ;
02303                 }
02304         }
02305         <span class="keywordflow">return</span> Status ;
02306 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="ExporterProtocol.c::ExporterProtocol_WriteTime"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_WriteTime           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga10">IPDR_Time</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Time</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned char **&nbsp;</td>
          <td class="mdname" nowrap> <em>Buffer</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02152 {
02153         memcpy(*Buffer, &amp;Time, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga10">IPDR_Time</a>) );
02154         *Buffer += <span class="keyword">sizeof</span>(<a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga10">IPDR_Time</a>);
02155         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
02156 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="ExporterProtocol.c::ExporterProtocol_WriteUF8String"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> ExporterProtocol_WriteUF8String           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>String</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned char **&nbsp;</td>
          <td class="mdname" nowrap> <em>Buffer</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02160 {
02161         size_t                  StringLength ;
02162         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*  WriteBuffer ;
02163 
02164         WriteBuffer = *Buffer ;
02165 
02166         <span class="keywordflow">if</span>( String == NULL )
02167                 StringLength = 0 ;
02168         <span class="keywordflow">else</span>
02169                 StringLength = strlen(String);
02170 
02171         <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a15">ExporterProtocol_WriteInt</a>(htonl(StringLength), &amp;WriteBuffer);
02172         <span class="keywordflow">if</span>( StringLength &gt; 0 )
02173         {
02174                 memcpy( WriteBuffer, String, StringLength );
02175                 WriteBuffer += StringLength ;
02176         }
02177         *Buffer = WriteBuffer ;
02178         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
02179 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a3" doxytag="ExporterProtocol.c::ExporterProtocol_ConnectionHandlers"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../db/dcd/struct_i_p_d_r__tag___connection_handlers.html">ConnectionHandlers</a> <a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a3">ExporterProtocol_ConnectionHandlers</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
    <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a36">ExporterProtocol_ConnectCallback</a>,
    <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a37">ExporterProtocol_DisconnectCallback</a>,
    <a class="code" href="../../dd/d44/_exporter_protocol_8c.html#a38">ExporterProtocol_DataCallback</a>,
}
</pre></div>Handlers for transport layer connections, afte#ifdef NOTDONEYET Session_SendOutstandingData(E, S); #endifr initial connection.     </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="ExporterProtocol.c::ExporterProtocol_h_rcsid"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char <a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a1">ExporterProtocol_h_rcsid</a>[] = EXPORTER_PROTOCOL_H_RCSID          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="ExporterProtocol.c::ExporterProtocol_rcsid"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char <a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a0">ExporterProtocol_rcsid</a>[] = "@(#) $Id: ExporterProtocol.c,v 1.111 2005/04/21 11:30:09 dmitryk Exp $"          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="ExporterProtocol.c::Protocol_h_rcsid"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char <a class="el" href="../../dd/d44/_exporter_protocol_8c.html#a2">Protocol_h_rcsid</a>[] = PROTOCOL_H_RCSID          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Mon Apr 25 22:28:22 2005 for IPDRAPI by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.2 </small></address>
</body>
</html>
