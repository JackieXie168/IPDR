<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>IPDRAPI: ipdr/src/Common/Console.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.2 -->
<div class="qindex"><a class="qindex" href="../../index.html">Main&nbsp;Page</a> | <a class="qindex" href="../../modules.html">Modules</a> | <a class="qindex" href="../../namespaces.html">Namespace List</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="../../dirs.html">Directories</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="../../globals.html">Globals</a></div>
<div class="nav">
<a class="el" href="../../dir_000003.html">ipdr</a>&nbsp;/&nbsp;<a class="el" href="../../dir_000010.html">src</a>&nbsp;/&nbsp;<a class="el" href="../../dir_000011.html">Common</a></div>
<h1>Console.c File Reference</h1><code>#include &lt;<a class="el" href="../../d4/d3a/ipdr_2include_2_i_p_d_r_2_config_8h.html">IPDR/Config.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="../../d7/db1/ipdr_2src_2_common_2_console_8h.html">Common/Console.h</a>&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &lt;stdarg.h&gt;</code><br>
<code>#include &lt;ctype.h&gt;</code><br>
<code>#include &lt;<a class="el" href="../../df/d5f/ipdr_2src_2_common_2_memory_management_8h.html">Common/MemoryManagement.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="../../df/d56/ipdr_2src_2_common_2_common_util_8h.html">Common/CommonUtil.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="../../d0/dce/ipdr_2src_2_common_2_transport_8h.html">Common/Transport.h</a>&gt;</code><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>&nbsp;&nbsp;&nbsp;(C-&gt;PS)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a1">CONSOLE_LOG</a>&nbsp;&nbsp;&nbsp;(C-&gt;Logger)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a2">LOGIN_MESSAGE</a>&nbsp;&nbsp;&nbsp;("Welcome to IPDR console.\r\n" PASSWORD_PROMPT)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a3">PROMPT</a>&nbsp;&nbsp;&nbsp;"IPDR&gt;&gt; "</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a4">PASSWORD_PROMPT</a>&nbsp;&nbsp;&nbsp;"password: "</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a5">MAX_LINE_LEN</a>&nbsp;&nbsp;&nbsp;2048</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a6">MAX_COMMAND_ARGS</a>&nbsp;&nbsp;&nbsp;64</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a7">COMMENT_DELIMITER</a>&nbsp;&nbsp;&nbsp;'#'</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a8">CMD_DELIMITER</a>&nbsp;&nbsp;&nbsp;';'</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a12">Console_HelpCommand</a> (<a class="el" href="../../d8/d9d/struct_console_session.html">ConsoleSession</a> *, FILE *, int, const char *const [], void *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a13">Console_HelpModuleCommand</a> (<a class="el" href="../../d8/d9d/struct_console_session.html">ConsoleSession</a> *, FILE *, int, const char *const [], void *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a14">Console_HelpCommandCommand</a> (<a class="el" href="../../d8/d9d/struct_console_session.html">ConsoleSession</a> *, FILE *, int, const char *const [], void *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a15">Console_EchoCommand</a> (<a class="el" href="../../d8/d9d/struct_console_session.html">ConsoleSession</a> *, FILE *, int, const char *const [], void *)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a16">ConsoleModule_Destructor</a> (<a class="el" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html">IPDR_PlatformServices</a> *PS, void *Obj)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a17">ConsoleSession_Destructor</a> (<a class="el" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html">IPDR_PlatformServices</a> *PS, void *Obj)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d0/d42/struct_console_command.html">ConsoleCommand</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a18">Console_FindCommandByName</a> (<a class="el" href="../../df/d59/struct_i_p_d_r__tag___console.html">Console</a> *C, const char *Command, <a class="el" href="../../df/dc8/struct_console_module.html">ConsoleModule</a> **CM)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../df/dc8/struct_console_module.html">ConsoleModule</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a19">Console_FindModuleByName</a> (<a class="el" href="../../df/d59/struct_i_p_d_r__tag___console.html">Console</a> *C, const char *ModuleName)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a20">Console_ActivateCommand</a> (<a class="el" href="../../df/d59/struct_i_p_d_r__tag___console.html">Console</a> *C, <a class="el" href="../../d8/d9d/struct_console_session.html">ConsoleSession</a> *S, FILE *Out, char *Cmd, const char **ParsedCommand, int *ParsedArgc, const char ***ParsedArgs, char **RemainingCmd, char *CmdRes, int CmdResLen)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a21">Console_ConnectionCallback</a> (<a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a> FD, void *Arg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a22">Console_AcceptCallback</a> (<a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a> FD, void *Arg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a23">Console_Initialize</a> (<a class="el" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html">IPDR_PlatformServices</a> *PS, <a class="el" href="../../df/d59/struct_i_p_d_r__tag___console.html">Console</a> *C, <a class="el" href="../../df/d84/struct_parameters_handler.html">ParametersHandler</a> *ParamsHandler, <a class="el" href="../../dc/d30/struct_i_p_d_r__tag___log.html">Log</a> *Logger)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a24">Console_Reconfigure</a> (<a class="el" href="../../df/d59/struct_i_p_d_r__tag___console.html">Console</a> *C, <a class="el" href="../../df/d84/struct_parameters_handler.html">ParametersHandler</a> *ParamsHandler)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a25">Console_Start</a> (<a class="el" href="../../df/d59/struct_i_p_d_r__tag___console.html">Console</a> *C)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a26">Console_Delete</a> (<a class="el" href="../../df/d59/struct_i_p_d_r__tag___console.html">Console</a> *C)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a27">Console_RegisterModule</a> (<a class="el" href="../../df/d59/struct_i_p_d_r__tag___console.html">Console</a> *C, const char *ModuleName, void *ContextArg, <a class="el" href="../../d0/d42/struct_console_command.html">ConsoleCommand</a> *Commands)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a28">Console_Print</a> (<a class="el" href="../../d8/d9d/struct_console_session.html">ConsoleSession</a> *S, FILE *Out, const char *FmtStr,...)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a29">Console_Println</a> (<a class="el" href="../../d8/d9d/struct_console_session.html">ConsoleSession</a> *S, FILE *Out, const char *FmtStr,...)</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a9">Console_rcsid</a> [] = "@(#) $Id: Console.c,v 1.10 2005/03/29 09:46:06 dmitryk Exp $" IPDR_COPYRIGHT_STR</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a10">Console_h_rcsid</a> [] = CONSOLE_H_RCSID</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d0/d42/struct_console_command.html">ConsoleCommand</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a11">ConsoleCommands</a> []</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a8" doxytag="Console.c::CMD_DELIMITER"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define CMD_DELIMITER&nbsp;&nbsp;&nbsp;';'          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="Console.c::COMMENT_DELIMITER"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define COMMENT_DELIMITER&nbsp;&nbsp;&nbsp;'#'          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="Console.c::CONSOLE_LOG"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define CONSOLE_LOG&nbsp;&nbsp;&nbsp;(C-&gt;Logger)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="Console.c::CONSOLE_PLATFORM"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define CONSOLE_PLATFORM&nbsp;&nbsp;&nbsp;(C-&gt;PS)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="Console.c::LOGIN_MESSAGE"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define LOGIN_MESSAGE&nbsp;&nbsp;&nbsp;("Welcome to IPDR console.\r\n" PASSWORD_PROMPT)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="Console.c::MAX_COMMAND_ARGS"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define MAX_COMMAND_ARGS&nbsp;&nbsp;&nbsp;64          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="Console.c::MAX_LINE_LEN"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define MAX_LINE_LEN&nbsp;&nbsp;&nbsp;2048          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="Console.c::PASSWORD_PROMPT"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define PASSWORD_PROMPT&nbsp;&nbsp;&nbsp;"password: "          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="Console.c::PROMPT"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define PROMPT&nbsp;&nbsp;&nbsp;"IPDR&gt;&gt; "          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a22" doxytag="Console.c::Console_AcceptCallback"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void Console_AcceptCallback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>FD</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>Arg</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Function called whenever a new connection attempt is made<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>FD</em>&nbsp;</td><td>socket file descriptor </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Arg</em>&nbsp;</td><td>context arg (<a class="el" href="../../d8/d9d/struct_console_session.html">ConsoleSession</a> structure) </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00522 {
00523     <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> RemotePort;
00524     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga9">IPDR_IPAddress</a> RemoteAddr;
00525     <a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a> NewSocketFD;
00526     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status;
00527     <a class="code" href="../../d8/d9d/struct_console_session.html">ConsoleSession</a> *CS;
00528     <span class="keywordtype">int</span> Index;
00529     FILE *Out = NULL; <span class="comment">/* We're in a socket callback, so we use the console session and don't output to a file. */</span>
00530     <a class="code" href="../../db/d58/_for_doxygen_2src_2_common_2_transport_8h.html#a28">TL_PABuf</a> paBuf;
00531 
00532     <a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html">Console</a> *C = (<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html">Console</a> *) Arg;
00533 
00534     Status = <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a46">Platform_Accept</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, FD, &amp; RemoteAddr, &amp; RemotePort,
00535                              &amp; NewSocketFD);
00536     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
00537         <span class="keywordflow">return</span>;
00538 
00539     Status = <a class="code" href="../../d5/d22/_for_doxygen_2src_2_common_2_memory_management_8c.html#a2">Object_Allocate</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d8/d9d/struct_console_session.html">ConsoleSession</a>),
00540                              <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a17">ConsoleSession_Destructor</a>, (<span class="keywordtype">void</span> **) &amp; CS);
00541     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(Status)) {
00542         <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a44">Platform_CloseAndInvalidate</a>(CONSOLE_PLATFORM, &amp;NewSocketFD);
00543         <span class="keywordflow">return</span>;
00544     }
00545     strncpy(CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o0">eyecatcher</a>, <span class="stringliteral">"CSESSN "</span>, <span class="keyword">sizeof</span> CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o0">eyecatcher</a>);
00546 
00547     CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o2">FD</a> = NewSocketFD;
00548     CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o4">ConsolePtr</a> = C;
00549     CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o10">CommandIndex</a> = 0;
00550     CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o11">SkipControlChar</a> = 0;
00551     CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o7">RemoteAddr</a> = RemoteAddr;
00552     CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o8">RemotePort</a> = RemotePort;
00553     CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o6">Echo</a> = <a class="code" href="../../db/d2e/_for_doxygen_2include_2_i_p_d_r_2_defs_8h.html#a4">IPDR_FALSE</a>;
00554 
00555     <span class="keywordflow">if</span> (C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o7">Password</a> != NULL)
00556         CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o5">LoggedIn</a> = <a class="code" href="../../db/d2e/_for_doxygen_2include_2_i_p_d_r_2_defs_8h.html#a4">IPDR_FALSE</a>;
00557     <span class="keywordflow">else</span>
00558         CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o5">LoggedIn</a> = <a class="code" href="../../db/d2e/_for_doxygen_2include_2_i_p_d_r_2_defs_8h.html#a5">IPDR_TRUE</a>;
00559 
00560 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
00561 <span class="preprocessor"></span>    fprintf(stderr, <span class="stringliteral">"RegisterReadSocket %d [Console_AcceptCallback] Console_ConnectionCallback\n"</span>, NewSocketFD); fflush(stderr);
00562 <span class="preprocessor">#endif</span>
00563 <span class="preprocessor"></span>
00564     <a class="code" href="../../d1/d4e/_for_doxygen_2src_2_common_2_log_8h.html#a29">Log_Write1</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a1">CONSOLE_LOG</a>, <a class="code" href="../../d1/d4e/_for_doxygen_2src_2_common_2_log_8h.html#a2">IPDR_PLATFORM_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga7a171">IPDR_LEVEL_INFO</a>,
00565                <span class="stringliteral">"Console_AcceptCallback"</span>,
00566                <span class="stringliteral">"Console connection from %.99s"</span>,
00567                <a class="code" href="../../db/d58/_for_doxygen_2src_2_common_2_transport_8h.html#a16">TL_PrintAddressAndPort</a>(RemoteAddr, RemotePort, paBuf));
00568 
00569     Status = <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a14">Platform_RegisterReadSocket</a>(CONSOLE_PLATFORM,
00570                                          NewSocketFD, <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a21">Console_ConnectionCallback</a>,
00571                                          CS,
00572                                          &amp; (CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o1">SocketEventID</a>));
00573     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(Status)) {
00574         <a class="code" href="../../d5/d22/_for_doxygen_2src_2_common_2_memory_management_8c.html#a5">Object_Release</a>(CONSOLE_PLATFORM, CS);
00575         return ;
00576     }
00577 
00578     Status = <a class="code" href="../../dd/d31/_for_doxygen_2src_2_common_2_dynamic_array_8c.html#a12">DynamicArray_AddElement</a>(CONSOLE_PLATFORM, &amp; (C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o6">Sessions</a>),
00579                                      CS, &amp; Index);
00580     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(Status)) {
00581         <a class="code" href="../../d5/d22/_for_doxygen_2src_2_common_2_memory_management_8c.html#a5">Object_Release</a>(CONSOLE_PLATFORM, CS);
00582         return ;
00583     }
00584 
00585     <span class="keywordflow">if</span> (C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o7">Password</a> != NULL)
00586         <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a28">Console_Print</a>(CS, Out, <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a2">LOGIN_MESSAGE</a>);
00587     <span class="keywordflow">else</span>
00588         <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a28">Console_Print</a>(CS, Out, <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a3">PROMPT</a>);
00589 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="Console.c::Console_ActivateCommand"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> Console_ActivateCommand           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d59/struct_i_p_d_r__tag___console.html">Console</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>C</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d8/d9d/struct_console_session.html">ConsoleSession</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>FILE *&nbsp;</td>
          <td class="mdname" nowrap> <em>Out</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>Cmd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char **&nbsp;</td>
          <td class="mdname" nowrap> <em>ParsedCommand</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>ParsedArgc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char ***&nbsp;</td>
          <td class="mdname" nowrap> <em>ParsedArgs</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char **&nbsp;</td>
          <td class="mdname" nowrap> <em>RemainingCmd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>CmdRes</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>CmdResLen</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Activate a command from the console<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>C</em>&nbsp;</td><td>console </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>session (may be null) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Out</em>&nbsp;</td><td>output file/socket (used if S is NULL) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Cmd</em>&nbsp;</td><td>command line </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ParsedCommand</em>&nbsp;</td><td>resulting parsed command </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ParsedArgc</em>&nbsp;</td><td>resulting number of parsed arguments </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ParsedArgs</em>&nbsp;</td><td>the parsed arguments </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>RemainingCmd</em>&nbsp;</td><td>anything after the command (e.g., after "#", ";") </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00181 {
00182     <span class="keywordtype">char</span> *Command, *Ptr;
00183     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *Args[<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a6">MAX_COMMAND_ARGS</a>]; <span class="comment">/* "static" so we can return it (being a bit lazy) */</span>
00184     <span class="keywordtype">int</span> Argc = 0;
00185     <a class="code" href="../../d0/d42/struct_console_command.html">ConsoleCommand</a> *CC;
00186     <a class="code" href="../../df/dc8/struct_console_module.html">ConsoleModule</a> *M;
00187     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status = <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00188     <span class="keywordtype">int</span> CmdDelimSeen = 0;
00189         <span class="keywordtype">char</span> *CmdResults = CmdRes ;
00190         <span class="keywordtype">int</span> CmdResultsLen = CmdResLen ;
00191 
00192     <span class="keywordflow">if</span> (ParsedCommand) { *ParsedCommand = <span class="stringliteral">""</span>; }
00193     <span class="keywordflow">if</span> (ParsedArgc) { *ParsedArgc = 0; }
00194     <span class="keywordflow">if</span> (ParsedArgs) { *ParsedArgs = Args; }
00195     <span class="keywordflow">if</span> (RemainingCmd) { *RemainingCmd = 0; }
00196         <span class="keywordflow">if</span> (CmdResults &amp;&amp; CmdResultsLen &gt; 0) { CmdResults[0] = <span class="charliteral">'\0'</span>; }
00197 
00198     <span class="keywordflow">if</span> (S &amp;&amp; S-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o6">Echo</a>) {
00199         <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a29">Console_Println</a>(S, Out, <span class="stringliteral">"Command: %.199s"</span>, Cmd);
00200     }
00201 
00202     <span class="keywordflow">if</span> (! Cmd)
00203         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00204 
00205     <span class="comment">/* Skip initial blanks */</span>
00206     <span class="keywordflow">for</span> (; isspace((<span class="keywordtype">unsigned</span>)Cmd[0]); Cmd++) {
00207         <span class="keywordflow">if</span> (Cmd[0] == <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a7">COMMENT_DELIMITER</a>) {
00208 <span class="comment">/*          Console_Println(S, Out, "Skipping: `%.99s'\n", Cmd); */</span>
00209             <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00210         }
00211     }
00212 
00213     <span class="comment">/* it would be nice to just do Ptr = strch(Cmd, ' ') but we need</span>
00214 <span class="comment">       to take care of all the space characters, plus the possibility</span>
00215 <span class="comment">       of a comment or end-of-command characater. */</span>
00216 
00217     <span class="keywordflow">for</span> (Ptr = Cmd; *Ptr != <span class="charliteral">'\0'</span> &amp;&amp; ! isspace((<span class="keywordtype">unsigned</span>)*Ptr) &amp;&amp; *Ptr != <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a7">COMMENT_DELIMITER</a> &amp;&amp; *Ptr != <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a8">CMD_DELIMITER</a>; Ptr++) { }
00218 
00219     <span class="keywordflow">if</span> (*Ptr == <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a8">CMD_DELIMITER</a>) {
00220         CmdDelimSeen = 1;
00221     }
00222 
00223     <span class="keywordflow">if</span> (*Ptr != <span class="charliteral">'\0'</span>) {
00224         *Ptr = <span class="charliteral">'\0'</span>;
00225         Ptr++;
00226     }
00227 
00228     Command = Cmd;
00229 
00230     <span class="keywordflow">if</span> (ParsedCommand) { *ParsedCommand = Command; }
00231 
00232     <span class="keywordflow">if</span> (! strlen(Command))
00233         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00234 
00235     <span class="comment">/* parse the parameters */</span>
00236     Argc = 0;
00237     <span class="keywordflow">for</span> (; ! CmdDelimSeen &amp;&amp; Ptr != <span class="charliteral">'\0'</span> &amp;&amp; isspace((<span class="keywordtype">unsigned</span>)*Ptr); Ptr++) { }
00238 
00239     <span class="keywordflow">while</span> (! CmdDelimSeen &amp;&amp; *Ptr != <span class="charliteral">'\0'</span> &amp;&amp; *Ptr != <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a7">COMMENT_DELIMITER</a> &amp;&amp; *Ptr != <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a8">CMD_DELIMITER</a>) {
00240 
00241         <span class="keywordflow">if</span> (Argc &gt;= <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a6">MAX_COMMAND_ARGS</a>)
00242             <span class="keywordflow">break</span>;
00243 
00244         <span class="keywordflow">if</span> (*Ptr == <span class="charliteral">'"'</span>) {
00245             Ptr++;
00246             Args[Argc++] = Ptr;
00247             <span class="keywordflow">for</span> (; *Ptr != <span class="charliteral">'"'</span> &amp;&amp; *Ptr != <span class="charliteral">'\0'</span>; Ptr++) { }
00248         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*Ptr == <span class="charliteral">'\''</span>) {
00249             Ptr++;
00250             Args[Argc++] = Ptr;
00251             <span class="keywordflow">for</span> (; *Ptr != <span class="charliteral">'\''</span> &amp;&amp; *Ptr != <span class="charliteral">'\0'</span>; Ptr++) { }
00252         } <span class="keywordflow">else</span> {
00253             Args[Argc++] = Ptr;
00254             <span class="keywordflow">for</span> (; ! isspace((<span class="keywordtype">unsigned</span>)*Ptr) &amp;&amp; *Ptr != <span class="charliteral">'\0'</span> &amp;&amp; *Ptr != <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a7">COMMENT_DELIMITER</a> &amp;&amp; *Ptr != <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a8">CMD_DELIMITER</a>; Ptr++) { }
00255             <span class="keywordflow">if</span> (*Ptr == <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a8">CMD_DELIMITER</a>) {
00256                 CmdDelimSeen = 1;
00257             }
00258         }
00259         <span class="keywordflow">if</span> (*Ptr == <span class="charliteral">'\0'</span>) {
00260             <span class="keywordflow">break</span>;
00261         }
00262         *Ptr = <span class="charliteral">'\0'</span>;
00263         Ptr++;
00264         <span class="keywordflow">for</span> (; isspace((<span class="keywordtype">unsigned</span>)*Ptr) &amp;&amp; *Ptr != <span class="charliteral">'\0'</span> &amp;&amp; *Ptr != <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a7">COMMENT_DELIMITER</a> &amp;&amp; *Ptr != <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a8">CMD_DELIMITER</a>; Ptr++) { }
00265     }
00266 
00267     <span class="keywordflow">if</span> (*Ptr == <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a8">CMD_DELIMITER</a>) {
00268         CmdDelimSeen = 1;
00269         Ptr++;
00270     }
00271 
00272     <span class="keywordflow">if</span> (ParsedArgc) { *ParsedArgc = Argc; }
00273     <span class="keywordflow">if</span> (ParsedArgs) { *ParsedArgs = Args; }
00274 
00275         <span class="keywordflow">if</span>( CmdResults  &amp;&amp; CmdResultsLen &gt; 0)
00276         {
00277                 strncpy(CmdResults, Command, CmdResultsLen);
00278                 CmdResults[CmdResultsLen-1] = <span class="charliteral">'\0'</span>;
00279                 CmdResults = strlen(CmdResults) + CmdResults ;
00280                 CmdResultsLen -=  strlen(CmdResults);
00281                 
00282                 strncpy(CmdResults, <span class="stringliteral">"="</span>, CmdResultsLen);
00283                 CmdResults[CmdResultsLen-1] = <span class="charliteral">'\0'</span>;
00284                 CmdResults = strlen(CmdResults) + CmdResults ;
00285                 CmdResultsLen -=  strlen(CmdResults);
00286         }
00287         
00288     CC = <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a18">Console_FindCommandByName</a>(C, Command, &amp; M);
00289     <span class="keywordflow">if</span> (CC == NULL) {
00290         <span class="keywordflow">if</span> (RemainingCmd) { *RemainingCmd = Ptr; }
00291                 <span class="keywordflow">if</span>( CmdResults  &amp;&amp; CmdResultsLen &gt; 0)
00292                 {
00293                         strncpy(CmdResults, <span class="stringliteral">"ERROR"</span>, CmdResultsLen);
00294                         CmdResults[CmdResultsLen-1] = <span class="charliteral">'\0'</span>;
00295                         CmdResults = strlen(CmdResults) + CmdResults ;
00296                         CmdResultsLen -=  strlen(CmdResults);
00297                 
00298                         strncpy(CmdResults, <span class="stringliteral">";"</span>, CmdResultsLen);
00299                         CmdResults[CmdResultsLen-1] = <span class="charliteral">'\0'</span>;
00300                         CmdResults = strlen(CmdResults) + CmdResults ;
00301                         CmdResultsLen -=  strlen(CmdResults);
00302                 }
00303         
00304                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a208">IPDR_CMD_NOT_FOUND</a>;
00305     }
00306 
00307     <span class="keywordflow">if</span> (CC-&gt;<a class="code" href="../../d0/d42/struct_console_command.html#o2">CommandFunc</a> == NULL) { <span class="comment">/* It's an "exit" type command */</span>
00308                 <span class="keywordflow">if</span>( CmdResults  &amp;&amp; CmdResultsLen &gt; 0)
00309                 {
00310                         strncpy(CmdResults, <span class="stringliteral">"ERROR"</span>, CmdResultsLen);
00311                         CmdResults[CmdResultsLen-1] = <span class="charliteral">'\0'</span>;
00312                         CmdResults = strlen(CmdResults) + CmdResults ;
00313                         CmdResultsLen -=  strlen(CmdResults);
00314         
00315                         strncpy(CmdResults, <span class="stringliteral">";"</span>, CmdResultsLen);
00316                         CmdResults[CmdResultsLen-1] = <span class="charliteral">'\0'</span>;
00317                         CmdResults = strlen(CmdResults) + CmdResults ;
00318                         CmdResultsLen -=  strlen(CmdResults);
00319                 }
00320         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a207">IPDR_CMD_EXIT</a>;
00321     } <span class="keywordflow">else</span> {
00322         Status = CC-&gt;<a class="code" href="../../d0/d42/struct_console_command.html#o2">CommandFunc</a>(S, Out, Argc, Args, M-&gt;<a class="code" href="../../df/dc8/struct_console_module.html#o1">ContextArg</a>);
00323         <span class="keywordflow">switch</span> (Status) {
00324         <span class="keywordflow">case</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>:
00325             <span class="keywordflow">if</span> (RemainingCmd) { *RemainingCmd = Ptr; }
00326             <span class="keywordflow">break</span>;
00327         <span class="keywordflow">case</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a209">IPDR_CMD_HELP</a>:
00328             <span class="keywordflow">if</span> (RemainingCmd) { *RemainingCmd = Ptr; }
00329             <span class="keywordflow">return</span> Status;
00330             <span class="keywordflow">break</span>;
00331         <span class="keywordflow">default</span>:
00332                         <span class="keywordflow">if</span>( CmdResults  &amp;&amp; CmdResultsLen &gt; 0)
00333                         {
00334                                 strncpy(CmdResults, <a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(Status)?<span class="stringliteral">"ERROR"</span>:<span class="stringliteral">"OK"</span>, CmdResultsLen);
00335                                 CmdResults[CmdResultsLen-1] = <span class="charliteral">'\0'</span>;
00336                                 CmdResults = strlen(CmdResults) + CmdResults ;
00337                                 CmdResultsLen -=  strlen(CmdResults);
00338                 
00339                                 strncpy(CmdResults, <span class="stringliteral">";"</span>, CmdResultsLen);
00340                                 CmdResults[CmdResultsLen-1] = <span class="charliteral">'\0'</span>;
00341                                 CmdResults = strlen(CmdResults) + CmdResults ;
00342                                 CmdResultsLen -=  strlen(CmdResults);
00343                         }
00344             <span class="keywordflow">return</span> <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a29">Console_Println</a>(S, Out, <span class="stringliteral">"Error during command invocation. Status = %.50s, cmd: `%.199s'"</span>, <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga22">IPDR_StatusMsg</a>(NULL, Status), Cmd);
00345         }
00346     }
00347 
00348     <span class="keywordflow">if</span> (CmdDelimSeen &amp;&amp; Ptr[0] != <span class="charliteral">'\0'</span>) {
00349                 <span class="keywordflow">if</span>( CmdResults  &amp;&amp; CmdResultsLen &gt; 0)
00350                 {
00351                         strncpy(CmdResults, <a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(Status)?<span class="stringliteral">"ERROR"</span>:<span class="stringliteral">"OK"</span>, CmdResultsLen);
00352                         CmdResults[CmdResultsLen-1] = <span class="charliteral">'\0'</span>;
00353                         CmdResults = strlen(CmdResults) + CmdResults ;
00354                         CmdResultsLen -=  strlen(CmdResults);
00355         
00356                         strncpy(CmdResults, <span class="stringliteral">";"</span>, CmdResultsLen);
00357                         CmdResults[CmdResultsLen-1] = <span class="charliteral">'\0'</span>;
00358                         CmdResults = strlen(CmdResults) + CmdResults ;
00359                         CmdResultsLen -=  strlen(CmdResults);
00360                 }
00361         <span class="keywordflow">return</span> <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a20">Console_ActivateCommand</a>(C, S, Out, Ptr, ParsedCommand, ParsedArgc, ParsedArgs, RemainingCmd, CmdResults, CmdResultsLen);
00362     } <span class="keywordflow">else</span> {
00363         <span class="keywordflow">if</span> (RemainingCmd) { *RemainingCmd = Ptr; }
00364                 <span class="keywordflow">if</span>( CmdResults  &amp;&amp; CmdResultsLen &gt; 0)
00365                 {
00366                         strncpy(CmdResults, <a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(Status)?<span class="stringliteral">"ERROR"</span>:<span class="stringliteral">"OK"</span>, CmdResultsLen);
00367                         CmdResults[CmdResultsLen-1] = <span class="charliteral">'\0'</span>;
00368                         CmdResults = strlen(CmdResults) + CmdResults ;
00369                         CmdResultsLen -=  strlen(CmdResults);
00370         
00371                         strncpy(CmdResults, <span class="stringliteral">";"</span>, CmdResultsLen);
00372                         CmdResults[CmdResultsLen-1] = <span class="charliteral">'\0'</span>;
00373                         CmdResults = strlen(CmdResults) + CmdResults ;
00374                         CmdResultsLen -=  strlen(CmdResults);
00375                 }
00376         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00377     }
00378 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="Console.c::Console_ConnectionCallback"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void Console_ConnectionCallback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>FD</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>Arg</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Function called whenever data arrives on a connection to the console.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>FD</em>&nbsp;</td><td>socket file descriptor </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Arg</em>&nbsp;</td><td>context arg (<a class="el" href="../../d8/d9d/struct_console_session.html">ConsoleSession</a> structure) </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00391 {
00392     <a class="code" href="../../d8/d9d/struct_console_session.html">ConsoleSession</a> *CS;
00393     <a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html">Console</a> *C;
00394     <span class="keywordtype">char</span> c;
00395     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> RB, i;
00396     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status;
00397     FILE *Out = NULL; <span class="comment">/* We're in a socket callback, so we use the console session and don't output to a file. */</span>
00398 
00399     CS = (<a class="code" href="../../d8/d9d/struct_console_session.html">ConsoleSession</a> *) Arg;
00400     C = CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o4">ConsolePtr</a>;
00401 
00402     Status = <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a49">Platform_Recv</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, FD, &amp; c, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), -1, &amp; RB);
00403     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(Status)) {
00404         <span class="keywordflow">for</span> (i = 0; i &lt; C-&gt;Sessions.Length; i++) {
00405             <span class="keywordflow">if</span> (CS == C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o6">Sessions</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[i]) {
00406                 <a class="code" href="../../dd/d31/_for_doxygen_2src_2_common_2_dynamic_array_8c.html#a9">DynamicArray_RemoveAndShift</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, &amp; (C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o6">Sessions</a>), i);
00407                 return ;
00408             }
00409         }
00410         <span class="keywordflow">return</span>;
00411     }
00412 
00413     <span class="keywordflow">if</span> (RB == 0)
00414         return ;
00415 
00416     <span class="keywordflow">if</span> (CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o10">CommandIndex</a> &lt; <a class="code" href="../../d1/dab/_for_doxygen_2src_2_common_2_console_8h.html#a1">MAX_COMMAND_LINE_LEN</a> - 1) {
00417 
00418         <span class="comment">/*Ignoring the 'delete' and the 'backspace' char*/</span>
00419         <span class="keywordflow">if</span> (c == <span class="charliteral">'\r'</span> == c == <span class="charliteral">'\b'</span>|| c == 127)
00420             return ;
00421         <span class="comment">/*Ignoring the arrows chars*/</span>
00422         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c == 0x1b)
00423             CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o11">SkipControlChar</a> = 1;
00424         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o11">SkipControlChar</a> == 1 &amp;&amp; c == 0x5b)
00425             CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o11">SkipControlChar</a> = 2;
00426         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c &gt;= 0x41 &amp;&amp; c &lt;= 0x44 &amp;&amp; CS-&gt;SkipControlChar == 2)
00427             return ;
00428         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c != <span class="charliteral">'\n'</span> &amp;&amp; c != <span class="charliteral">'\r'</span>) {
00429             CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o9">CommandBuffer</a>[CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o10">CommandIndex</a>] = c;
00430             CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o10">CommandIndex</a>++;
00431             CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o11">SkipControlChar</a> = 0;
00432         }
00433     }
00434 
00435     <span class="comment">/* check if we reached an end of line */</span>
00436 
00437     <span class="keywordflow">if</span> (c == <span class="charliteral">'\n'</span>) {
00438 
00439         CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o9">CommandBuffer</a>[CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o10">CommandIndex</a>] = <span class="charliteral">'\0'</span>;
00440 
00441 <span class="preprocessor">#if 0</span>
00442 <span class="preprocessor"></span>        <span class="comment">/* This code isn't quite right: it disallows a password of "exit"</span>
00443 <span class="comment">           or "stop", but it's just a debugging interface anyway. */</span>
00444         <span class="keywordflow">if</span> (0 == strcmp(CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o9">CommandBuffer</a>, <span class="stringliteral">"exit"</span>) ||
00445             0 == strcmp(CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o9">CommandBuffer</a>, <span class="stringliteral">"stop"</span>) ||
00446             0 == strcmp(CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o9">CommandBuffer</a>, <span class="stringliteral">"quit"</span>) ||
00447             CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o9">CommandBuffer</a>[0] == 4 <span class="comment">/* ^D */</span>  ) {
00448             <span class="keywordflow">for</span> (i = 0; i &lt; C-&gt;Sessions.Length; i++) {
00449                 <span class="keywordflow">if</span> (CS == C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o6">Sessions</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[i]) {
00450                     <a class="code" href="../../dd/d31/_for_doxygen_2src_2_common_2_dynamic_array_8c.html#a9">DynamicArray_RemoveAndShift</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, &amp; (C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o6">Sessions</a>), i);
00451 <span class="preprocessor">#ifdef ENABLE_SIMULATOR</span>
00452 <span class="preprocessor"></span>                    <span class="keywordflow">if</span> (0 == strcmp(CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o9">CommandBuffer</a>, <span class="stringliteral">"stop"</span>)) {
00453                         <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a3">Platform_Stop</a>(C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o3">PS</a>);
00454                     }
00455 <span class="preprocessor">#endif</span>
00456 <span class="preprocessor"></span>                    return ;
00457                 }
00458             }
00459         }
00460 <span class="preprocessor">#endif</span>
00461 <span class="preprocessor"></span>
00462         <span class="keywordflow">if</span> (! CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o5">LoggedIn</a>) {
00463             CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o10">CommandIndex</a> = 0;
00464             <span class="keywordflow">if</span> (0 == strcmp(CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o9">CommandBuffer</a>, C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o7">Password</a>)) {
00465                 CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o5">LoggedIn</a> = <a class="code" href="../../db/d2e/_for_doxygen_2include_2_i_p_d_r_2_defs_8h.html#a5">IPDR_TRUE</a>;
00466                 <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a29">Console_Println</a>(CS, Out, <span class="stringliteral">"Logged in."</span>);
00467                 <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a28">Console_Print</a>(CS, Out, <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a3">PROMPT</a>);
00468                 return ;
00469             } <span class="keywordflow">else</span> {
00470                 <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a29">Console_Println</a>(CS, Out, <span class="stringliteral">"Wrong password (Note: password is case sensitive)."</span>);
00471                 <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a28">Console_Print</a>(CS, Out, <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a4">PASSWORD_PROMPT</a>);
00472                 return ;
00473             }
00474         }
00475 
00476         <span class="keywordflow">if</span> (strlen(CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o9">CommandBuffer</a>) &gt; 0) {
00477             <span class="keyword">const</span> <span class="keywordtype">char</span>* Command;
00478             <a class="code" href="../../db/d58/_for_doxygen_2src_2_common_2_transport_8h.html#a28">TL_PABuf</a> paBuf;
00479             <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> rc =
00480                 <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a20">Console_ActivateCommand</a>(C, CS, Out, CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o9">CommandBuffer</a>, &amp;Command, NULL, NULL, NULL, NULL, 0);
00481             <span class="keywordflow">switch</span> (rc) {
00482             <span class="keywordflow">case</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a207">IPDR_CMD_EXIT</a>:
00483                 <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a29">Console_Println</a>(CS, Out, <span class="stringliteral">"Exiting."</span>, Command);
00484                 <a class="code" href="../../d1/d4e/_for_doxygen_2src_2_common_2_log_8h.html#a29">Log_Write1</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a1">CONSOLE_LOG</a>, <a class="code" href="../../d1/d4e/_for_doxygen_2src_2_common_2_log_8h.html#a2">IPDR_PLATFORM_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga7a171">IPDR_LEVEL_INFO</a>,
00485                            <span class="stringliteral">"ConsoleSession_Destructor"</span>,
00486                            <span class="stringliteral">"Console disconnection from %.99s"</span>,
00487                            <a class="code" href="../../db/d58/_for_doxygen_2src_2_common_2_transport_8h.html#a16">TL_PrintAddressAndPort</a>(CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o7">RemoteAddr</a>, CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o8">RemotePort</a>, paBuf));
00488                 <span class="keywordflow">for</span> (i = 0; i &lt; C-&gt;Sessions.Length; i++) {
00489                     <span class="keywordflow">if</span> (CS == C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o6">Sessions</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[i]) {
00490                         <a class="code" href="../../dd/d31/_for_doxygen_2src_2_common_2_dynamic_array_8c.html#a9">DynamicArray_RemoveAndShift</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, &amp; (C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o6">Sessions</a>), i);
00491                         return ;
00492                     }
00493                 }
00494                 <span class="keywordflow">break</span>;
00495             <span class="keywordflow">case</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a208">IPDR_CMD_NOT_FOUND</a>:
00496                 <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a29">Console_Println</a>(CS, Out, <span class="stringliteral">"Unable to find command: `%.199s'."</span>, Command);
00497                 <span class="keywordflow">break</span>;
00498             <span class="keywordflow">default</span>:
00499                 <span class="keywordflow">break</span>;
00500             }
00501         }
00502 
00503         <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a28">Console_Print</a>(CS, Out, <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a3">PROMPT</a>);
00504 
00505         CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o10">CommandIndex</a> = 0;
00506         CS-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o11">SkipControlChar</a> = 0;
00507 
00508         return ;
00509     }
00510 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="Console.c::Console_Delete"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> Console_Delete           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d59/struct_i_p_d_r__tag___console.html">Console</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>C</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Delete the console and close any connections<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>C</em>&nbsp;</td><td>console</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00791 {
00792     <a class="code" href="../../d5/d22/_for_doxygen_2src_2_common_2_memory_management_8c.html#a5">Object_Release</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o7">Password</a>);
00793     <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a17">Platform_UnregisterSocketAndClear</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, &amp;C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o2">AcceptEventID</a>);
00794     <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a44">Platform_CloseAndInvalidate</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, &amp;C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o1">AcceptSocket</a>);
00795     <a class="code" href="../../dd/d31/_for_doxygen_2src_2_common_2_dynamic_array_8c.html#a5">DynamicArray_Delete</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, &amp; (C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o5">Modules</a>));
00796     <a class="code" href="../../dd/d31/_for_doxygen_2src_2_common_2_dynamic_array_8c.html#a5">DynamicArray_Delete</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, &amp; (C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o6">Sessions</a>));
00797     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00798 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="Console.c::Console_EchoCommand"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> Console_EchoCommand           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d9d/struct_console_session.html">ConsoleSession</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>FILE *&nbsp;</td>
          <td class="mdname" nowrap> <em>Out</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>Argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *const &nbsp;</td>
          <td class="mdname" nowrap> <em>Argv</em>[], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>Arg</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set echoing on/off<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>session console </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Out</em>&nbsp;</td><td>output file/socket (used if S is NULL) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Argc</em>&nbsp;</td><td>number of arguments </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Argv</em>&nbsp;</td><td>arguments </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Arg</em>&nbsp;</td><td>context argument (Console)</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">01125 {
01126     <span class="comment">/* Console *C = (Console *) Arg; */</span>
01127 
01128     <span class="keywordflow">if</span> (Argc != 0) {
01129         <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a29">Console_Println</a>(S, Out, <span class="stringliteral">"Invalid number of arguments."</span>);
01130         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
01131     }
01132 
01133     <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a29">Console_Println</a>(S, Out, <span class="stringliteral">"Echoing commands."</span>);
01134 
01135     S-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o6">Echo</a> = <a class="code" href="../../db/d2e/_for_doxygen_2include_2_i_p_d_r_2_defs_8h.html#a5">IPDR_TRUE</a>;
01136 
01137     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
01138 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="Console.c::Console_FindCommandByName"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d0/d42/struct_console_command.html">ConsoleCommand</a>* Console_FindCommandByName           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d59/struct_i_p_d_r__tag___console.html">Console</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>C</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>Command</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../df/dc8/struct_console_module.html">ConsoleModule</a> **&nbsp;</td>
          <td class="mdname" nowrap> <em>CM</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Find a console command given its name<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>C</em>&nbsp;</td><td>console </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Command</em>&nbsp;</td><td>command name </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>CM</em>&nbsp;</td><td>module containing the command (output)</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Command structure or NULL if command not found </dd></dl>
<div class="fragment"><pre class="fragment">00118 {
00119     <span class="keywordtype">int</span> i;
00120     <a class="code" href="../../df/dc8/struct_console_module.html">ConsoleModule</a> *M;
00121     <a class="code" href="../../d0/d42/struct_console_command.html">ConsoleCommand</a> *CC;
00122 
00123     <span class="keywordflow">for</span> (i = 0; i &lt; C-&gt;Modules.Length; i++) {
00124         M = (<a class="code" href="../../df/dc8/struct_console_module.html">ConsoleModule</a> *) C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o5">Modules</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[i];
00125         CC = M-&gt;<a class="code" href="../../df/dc8/struct_console_module.html#o3">Commands</a>;
00126         <span class="keywordflow">while</span> (CC-&gt;<a class="code" href="../../d0/d42/struct_console_command.html#o0">Name</a> != NULL) {
00127             <span class="keywordflow">if</span> (! strcmp(CC-&gt;<a class="code" href="../../d0/d42/struct_console_command.html#o0">Name</a>, Command)) {
00128                 *CM = M;
00129                 <span class="keywordflow">return</span> CC;
00130             }
00131             CC++;
00132         }
00133     }
00134     *CM = NULL;
00135     <span class="keywordflow">return</span> NULL;
00136 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="Console.c::Console_FindModuleByName"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../df/dc8/struct_console_module.html">ConsoleModule</a>* Console_FindModuleByName           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d59/struct_i_p_d_r__tag___console.html">Console</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>C</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>ModuleName</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Find a console module given its name<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>C</em>&nbsp;</td><td>console </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ModuleName</em>&nbsp;</td><td>module name</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d0/d3b/struct_module.html">Module</a> structure or NULL if module not found </dd></dl>
<div class="fragment"><pre class="fragment">00148 {
00149     <a class="code" href="../../df/dc8/struct_console_module.html">ConsoleModule</a> *M;
00150     <span class="keywordtype">int</span> i;
00151 
00152     <span class="keywordflow">for</span> (i = 0; i &lt; C-&gt;Modules.Length; i++) {
00153         M = (<a class="code" href="../../df/dc8/struct_console_module.html">ConsoleModule</a> *) C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o5">Modules</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[i];
00154         <span class="keywordflow">if</span> (! strcmp(M-&gt;<a class="code" href="../../df/dc8/struct_console_module.html#o2">Name</a>, ModuleName))
00155             <span class="keywordflow">return</span> M;
00156     }
00157 
00158     <span class="keywordflow">return</span> NULL;
00159 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="Console.c::Console_HelpCommand"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> Console_HelpCommand           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d9d/struct_console_session.html">ConsoleSession</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>FILE *&nbsp;</td>
          <td class="mdname" nowrap> <em>Out</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>Argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *const &nbsp;</td>
          <td class="mdname" nowrap> <em>Argv</em>[], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>Arg</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Display help on all commands supported by the console.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>session </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Out</em>&nbsp;</td><td>output file/socket (used if S is NULL) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Argc</em>&nbsp;</td><td>number of arguments </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Argv</em>&nbsp;</td><td>arguments </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Arg</em>&nbsp;</td><td>context argument (NULL)</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00858 {
00859     <a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html">Console</a> *C = (<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html">Console</a> *) Arg;
00860     <a class="code" href="../../df/dc8/struct_console_module.html">ConsoleModule</a> *M;
00861     <a class="code" href="../../d0/d42/struct_console_command.html">ConsoleCommand</a> *CC;
00862     <span class="keywordtype">int</span> i;
00863 
00864     <span class="keywordflow">for</span> (i = 0; i &lt; C-&gt;Modules.Length; i++) {
00865         M = (<a class="code" href="../../df/dc8/struct_console_module.html">ConsoleModule</a> *) C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o5">Modules</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[i];
00866         <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a29">Console_Println</a>(S, Out, <span class="stringliteral">"%.99s commands:"</span>, M-&gt;<a class="code" href="../../df/dc8/struct_console_module.html#o2">Name</a>);
00867         CC = M-&gt;<a class="code" href="../../df/dc8/struct_console_module.html#o3">Commands</a>;
00868         <span class="keywordflow">while</span> (CC-&gt;<a class="code" href="../../d0/d42/struct_console_command.html#o0">Name</a> != NULL) {
00869             <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a29">Console_Println</a>(S, Out, <span class="stringliteral">"  %.99s: %.199s"</span>, CC-&gt;<a class="code" href="../../d0/d42/struct_console_command.html#o0">Name</a>, CC-&gt;<a class="code" href="../../d0/d42/struct_console_command.html#o1">Help</a>);
00870             CC++;
00871         }
00872     }
00873 
00874     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a209">IPDR_CMD_HELP</a>;
00875 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="Console.c::Console_HelpCommandCommand"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> Console_HelpCommandCommand           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d9d/struct_console_session.html">ConsoleSession</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>FILE *&nbsp;</td>
          <td class="mdname" nowrap> <em>Out</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>Argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *const &nbsp;</td>
          <td class="mdname" nowrap> <em>Argv</em>[], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>Arg</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Display help on a specific command.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>console session </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Out</em>&nbsp;</td><td>output file/socket (used if S is NULL) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Argc</em>&nbsp;</td><td>number of arguments </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Argv</em>&nbsp;</td><td>arguments </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Arg</em>&nbsp;</td><td>context argument (NULL)</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00934 {
00935     <a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html">Console</a> *C = (<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html">Console</a> *) Arg;
00936     <a class="code" href="../../df/dc8/struct_console_module.html">ConsoleModule</a> *M;
00937     <a class="code" href="../../d0/d42/struct_console_command.html">ConsoleCommand</a> *CC;
00938 
00939     <span class="keywordflow">if</span> (Argc != 1) {
00940         <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a29">Console_Println</a>(S, Out, <span class="stringliteral">"Invalid number of arguments."</span>);
00941         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00942     }
00943 
00944     CC = <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a18">Console_FindCommandByName</a>(C, Argv[0], &amp; M);
00945     <span class="keywordflow">if</span> (CC == NULL) {
00946         <span class="keywordtype">int</span> i;
00947         <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a29">Console_Println</a>(S, Out, <span class="stringliteral">"Unable to find command %.99s.  Possibilities are:"</span>, Argv[0]);
00948         <span class="keywordflow">for</span> (i = 0; i &lt; C-&gt;Modules.Length; i++) {
00949             M = (<a class="code" href="../../df/dc8/struct_console_module.html">ConsoleModule</a> *) C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o5">Modules</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[i];
00950             CC = M-&gt;<a class="code" href="../../df/dc8/struct_console_module.html#o3">Commands</a>;
00951             <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a29">Console_Println</a>(S, Out, <span class="stringliteral">"  module: %.99s"</span>, M-&gt;<a class="code" href="../../df/dc8/struct_console_module.html#o2">Name</a>);
00952             <span class="keywordflow">for</span> (; CC-&gt;<a class="code" href="../../d0/d42/struct_console_command.html#o0">Name</a>; CC++) {
00953                 <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a29">Console_Println</a>(S, Out, <span class="stringliteral">"    %.199s"</span>, CC-&gt;<a class="code" href="../../d0/d42/struct_console_command.html#o0">Name</a>);
00954             }
00955         }
00956     } <span class="keywordflow">else</span> {
00957         <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a29">Console_Println</a>(S, Out, <span class="stringliteral">"  %.99s: %.199s"</span>, CC-&gt;<a class="code" href="../../d0/d42/struct_console_command.html#o0">Name</a>, CC-&gt;<a class="code" href="../../d0/d42/struct_console_command.html#o1">Help</a>);
00958     }
00959 
00960     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00961 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="Console.c::Console_HelpModuleCommand"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> Console_HelpModuleCommand           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d9d/struct_console_session.html">ConsoleSession</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>FILE *&nbsp;</td>
          <td class="mdname" nowrap> <em>Out</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>Argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *const &nbsp;</td>
          <td class="mdname" nowrap> <em>Argv</em>[], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>Arg</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Display help on all commands supported by a module.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>console session </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Out</em>&nbsp;</td><td>output file/socket (used if S is NULL) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Argc</em>&nbsp;</td><td>number of arguments </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Argv</em>&nbsp;</td><td>arguments </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Arg</em>&nbsp;</td><td>context argument (NULL)</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00891 {
00892     <a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html">Console</a> *C = (<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html">Console</a> *) Arg;
00893     <a class="code" href="../../df/dc8/struct_console_module.html">ConsoleModule</a> *M;
00894     <a class="code" href="../../d0/d42/struct_console_command.html">ConsoleCommand</a> *CC;
00895 
00896     <span class="keywordflow">if</span> (Argc != 1) {
00897         <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a29">Console_Println</a>(S, Out, <span class="stringliteral">"Invalid number of arguments."</span>);
00898         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00899     }
00900 
00901     M = <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a19">Console_FindModuleByName</a>(C, Argv[0]);
00902     <span class="keywordflow">if</span> (M == NULL) {
00903         <span class="keywordtype">int</span> i;
00904         <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a29">Console_Println</a>(S, Out, <span class="stringliteral">"Unable to find module %.99s.  Possibilities are:"</span>, Argv[0]);
00905         <span class="keywordflow">for</span> (i = 0; i &lt; C-&gt;Modules.Length; i++) {
00906             <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a29">Console_Println</a>(S, Out, <span class="stringliteral">"    %.99s"</span>, ((<a class="code" href="../../df/dc8/struct_console_module.html">ConsoleModule</a> *)C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o5">Modules</a>.<a class="code" href="../../db/dc0/struct_dynamic_array.html#o0">Data</a>[i])-&gt;Name);
00907         }
00908         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00909     }
00910 
00911     CC = M-&gt;<a class="code" href="../../df/dc8/struct_console_module.html#o3">Commands</a>;
00912     <span class="keywordflow">while</span> (CC-&gt;<a class="code" href="../../d0/d42/struct_console_command.html#o0">Name</a> != NULL) {
00913         <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a29">Console_Println</a>(S, Out, <span class="stringliteral">"  %.99s: %.199s"</span>, CC-&gt;<a class="code" href="../../d0/d42/struct_console_command.html#o0">Name</a>, CC-&gt;<a class="code" href="../../d0/d42/struct_console_command.html#o1">Help</a>);
00914         CC++;
00915     }
00916 
00917     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00918 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="Console.c::Console_Initialize"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> Console_Initialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html">IPDR_PlatformServices</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>PS</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../df/d59/struct_i_p_d_r__tag___console.html">Console</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>C</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../df/d84/struct_parameters_handler.html">ParametersHandler</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>ParamsHandler</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../dc/d30/struct_i_p_d_r__tag___log.html">Log</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Logger</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Initialize the console given the platform services and the console port.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>PS</em>&nbsp;</td><td>platform services </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>C</em>&nbsp;</td><td>console </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ParamsHandler</em>&nbsp;</td><td>parameters handler for retrieving console parameters </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Logger</em>&nbsp;</td><td>log used for the console</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00606 {
00607     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status;
00608 
00609     C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o4">ConsolePort</a> = <a class="code" href="../../d5/dd6/_for_doxygen_2src_2_common_2_parameters_handler_8c.html#a17">ParametersHandler_GetIntParam</a>(ParamsHandler,
00610                                                    <a class="code" href="../../d8/d8f/_for_doxygen_2src_2_common_2_configuration_names_8h.html#a174">STR_configuration_console_consolePort</a>);
00611 
00612     <a class="code" href="../../d0/dfd/_for_doxygen_2src_2_common_2_common_util_8c.html#a5">Util_StrDup</a>(PS,
00613                 <a class="code" href="../../d5/dd6/_for_doxygen_2src_2_common_2_parameters_handler_8c.html#a15">ParametersHandler_GetStringParam</a>(ParamsHandler,
00614                                                  <a class="code" href="../../d8/d8f/_for_doxygen_2src_2_common_2_configuration_names_8h.html#a175">STR_configuration_console_consolePassword</a>),
00615                 &amp; (C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o7">Password</a>));
00616 
00617     C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o2">AcceptEventID</a> = NULL;
00618     <a class="code" href="../../dc/d2f/group___i_p_d_r__transitional__typedefs.html#ga2">IPDR_SetInvalidSocket</a>(&amp;C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o1">AcceptSocket</a>);
00619     C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o3">PS</a> = PS;
00620     C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o8">Logger</a> = Logger;
00621 
00622     Status = <a class="code" href="../../dd/d31/_for_doxygen_2src_2_common_2_dynamic_array_8c.html#a2">DynamicArray_Create</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, &amp; (C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o5">Modules</a>), 16);
00623     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
00624         <span class="keywordflow">return</span> Status;
00625     Status = <a class="code" href="../../dd/d31/_for_doxygen_2src_2_common_2_dynamic_array_8c.html#a2">DynamicArray_Create</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, &amp; (C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o6">Sessions</a>), 16);
00626     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
00627         <span class="keywordflow">return</span> Status;
00628 
00629     <span class="keywordflow">return</span> <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a27">Console_RegisterModule</a>(C, <span class="stringliteral">"console"</span>, C, <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a11">ConsoleCommands</a>);
00630 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="Console.c::Console_Print"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> Console_Print           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d9d/struct_console_session.html">ConsoleSession</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>FILE *&nbsp;</td>
          <td class="mdname" nowrap> <em>Out</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>FmtStr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>&nbsp;</td>
          <td class="mdname" nowrap> <em>...</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Print a string to the console<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>session to output string to </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Out</em>&nbsp;</td><td>output file/socket (used if S is NULL) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FmtStr</em>&nbsp;</td><td>format string</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">01035 {
01036 <span class="preprocessor">#ifdef STD_FILE_OPERATIONS_SUPPORT</span>
01037 <span class="preprocessor"></span>    va_list Args;
01038     <span class="keywordtype">char</span> Line[<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a5">MAX_LINE_LEN</a>];
01039     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> WB;
01040     <a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html">Console</a> *C;
01041 
01042 
01043     va_start(Args, FmtStr);
01044 <span class="preprocessor">#ifndef _MSC_VER</span>
01045 <span class="preprocessor"></span>    vsprintf (Line, FmtStr, Args),
01046 <span class="preprocessor">#else</span>
01047 <span class="preprocessor"></span>        _vsnprintf (Line, <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a5">MAX_LINE_LEN</a>, FmtStr, Args),
01048 <span class="preprocessor">#endif</span>
01049 <span class="preprocessor"></span>        va_end(Args);
01050 
01051     <span class="keywordflow">if</span> (S == NULL) {
01052         <span class="keywordflow">if</span> (Out == NULL) {
01053             fprintf(stderr, <span class="stringliteral">"%s"</span>, Line);
01054         } <span class="keywordflow">else</span> {
01055             fprintf(Out, <span class="stringliteral">"%s"</span>, Line);
01056         }
01057         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
01058     }
01059 
01060     C = S-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o4">ConsolePtr</a>;
01061     <span class="keywordflow">return</span> <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a48">Platform_Send</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, S-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o2">FD</a>, Line, strlen(Line), &amp; WB);
01062 <span class="preprocessor">#else</span>
01063 <span class="preprocessor"></span>    <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
01064 <span class="preprocessor">#endif</span>
01065 <span class="preprocessor"></span>}
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="Console.c::Console_Println"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> Console_Println           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d9d/struct_console_session.html">ConsoleSession</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>FILE *&nbsp;</td>
          <td class="mdname" nowrap> <em>Out</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>FmtStr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>&nbsp;</td>
          <td class="mdname" nowrap> <em>...</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Print a string to the console with an end of line char<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>S</em>&nbsp;</td><td>session to output string to </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Out</em>&nbsp;</td><td>output file/socket (used if S is NULL) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FmtStr</em>&nbsp;</td><td>format string</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">01077 {
01078 <span class="preprocessor">#ifdef STD_FILE_OPERATIONS_SUPPORT</span>
01079 <span class="preprocessor"></span>    va_list Args;
01080     <span class="keywordtype">char</span> Line[<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a5">MAX_LINE_LEN</a>];
01081     <span class="keyword">const</span> <span class="keywordtype">char</span> *EolStr = <span class="stringliteral">"\r\n"</span>;
01082     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> WB;
01083     <a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html">Console</a> *C;
01084 
01085     va_start(Args, FmtStr);
01086 <span class="preprocessor">#ifndef _MSC_VER</span>
01087 <span class="preprocessor"></span>    vsprintf (Line, FmtStr, Args),
01088 <span class="preprocessor">#else</span>
01089 <span class="preprocessor"></span>        _vsnprintf (Line, <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a5">MAX_LINE_LEN</a>, FmtStr, Args),
01090 <span class="preprocessor">#endif</span>
01091 <span class="preprocessor"></span>        va_end(Args);
01092 
01093     <span class="keywordflow">if</span> (S == NULL) {
01094         <span class="keywordflow">if</span> (Out == NULL) {
01095             fprintf(stderr, <span class="stringliteral">"%s\n"</span>, Line);
01096         } <span class="keywordflow">else</span> {
01097             fprintf(Out, <span class="stringliteral">"%s\n"</span>, Line);
01098         }
01099         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
01100     }
01101 
01102     C = S-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o4">ConsolePtr</a>;
01103     <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a48">Platform_Send</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, S-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o2">FD</a>, Line, strlen(Line), &amp; WB);
01104     <span class="keywordflow">return</span> <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a48">Platform_Send</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, S-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o2">FD</a>, EolStr, 2, &amp; WB);
01105 <span class="preprocessor">#else</span>
01106 <span class="preprocessor"></span>    <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
01107 <span class="preprocessor">#endif</span>
01108 <span class="preprocessor"></span>}
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="Console.c::Console_Reconfigure"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> Console_Reconfigure           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d59/struct_i_p_d_r__tag___console.html">Console</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>C</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../df/d84/struct_parameters_handler.html">ParametersHandler</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>ParamsHandler</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Reconfigure an existing console<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>C</em>&nbsp;</td><td>console </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ParamsHandler</em>&nbsp;</td><td>parameters handler for retrieving console parameters</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00643 {
00644     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status;
00645     <span class="keywordtype">int</span> Port;
00646     <span class="keyword">const</span> <span class="keywordtype">char</span> *Password;
00647 
00648     <span class="keywordflow">if</span> (! C) {
00649         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00650     }
00651 
00652     Port = <a class="code" href="../../d5/dd6/_for_doxygen_2src_2_common_2_parameters_handler_8c.html#a17">ParametersHandler_GetIntParam</a>(ParamsHandler,
00653                                          <a class="code" href="../../d8/d8f/_for_doxygen_2src_2_common_2_configuration_names_8h.html#a174">STR_configuration_console_consolePort</a>);
00654 
00655     <span class="keywordflow">if</span> (C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o4">ConsolePort</a> != Port) {
00656 
00657         <span class="comment">/* in case the port has changed, close all currently open sockets */</span>
00658 
00659         C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o4">ConsolePort</a> = Port;
00660 
00661         <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a17">Platform_UnregisterSocketAndClear</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, &amp;C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o2">AcceptEventID</a>);
00662         <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a44">Platform_CloseAndInvalidate</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, &amp;C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o1">AcceptSocket</a>);
00663 
00664         <a class="code" href="../../dd/d31/_for_doxygen_2src_2_common_2_dynamic_array_8c.html#a3">DynamicArray_Reset</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, &amp; (C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o6">Sessions</a>), 4);
00665 
00666         <span class="keywordflow">if</span> (C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o4">ConsolePort</a>) {
00667             Status = <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a39">Platform_CreateTCPSocket</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a> ,
00668                                               &amp; (C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o1">AcceptSocket</a>));
00669             <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a17">SUCCESS</a>(Status)) {
00670                 Status = <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a41">Platform_Bind</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o1">AcceptSocket</a>, 0,
00671                                        C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o4">ConsolePort</a>);
00672                 <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(Status)) {
00673                     <a class="code" href="../../d9/dea/_for_doxygen_2src_2_common_2_log_8c.html#a28">Log_LogPlatformError</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a1">CONSOLE_LOG</a>, <a class="code" href="../../d1/d4e/_for_doxygen_2src_2_common_2_log_8h.html#a2">IPDR_PLATFORM_MODULE_ID</a>,
00674                                          <span class="stringliteral">"Console_Reconfigure"</span>, <span class="stringliteral">"Platform_Bind"</span>);
00675                     <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a44">Platform_CloseAndInvalidate</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, &amp;C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o1">AcceptSocket</a>);
00676                 } <span class="keywordflow">else</span> {
00677                     Status = <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a45">Platform_Listen</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o1">AcceptSocket</a>, 16);
00678                     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(Status)) {
00679                         <a class="code" href="../../d9/dea/_for_doxygen_2src_2_common_2_log_8c.html#a28">Log_LogPlatformError</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a1">CONSOLE_LOG</a>, <a class="code" href="../../d1/d4e/_for_doxygen_2src_2_common_2_log_8h.html#a2">IPDR_PLATFORM_MODULE_ID</a>,
00680                                              <span class="stringliteral">"Console_Reconfigure"</span>, <span class="stringliteral">"Platform_Listen"</span>);
00681                         <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a44">Platform_CloseAndInvalidate</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, &amp;C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o1">AcceptSocket</a>);
00682                     } <span class="keywordflow">else</span> {
00683 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
00684 <span class="preprocessor"></span>                        fprintf(stderr, <span class="stringliteral">"RegisterReadSocket %d [Console_Reconfigure] Console_AcceptCallback\n"</span>, C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o1">AcceptSocket</a>); fflush(stderr);
00685 <span class="preprocessor">#endif</span>
00686 <span class="preprocessor"></span>                        Status = <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a14">Platform_RegisterReadSocket</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>,
00687                                                              C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o1">AcceptSocket</a>,
00688                                                              <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a22">Console_AcceptCallback</a>, C,
00689                                                              &amp; (C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o2">AcceptEventID</a>));
00690                         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(Status)) {
00691                             <a class="code" href="../../d9/dea/_for_doxygen_2src_2_common_2_log_8c.html#a28">Log_LogPlatformError</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a1">CONSOLE_LOG</a>, <a class="code" href="../../d1/d4e/_for_doxygen_2src_2_common_2_log_8h.html#a2">IPDR_PLATFORM_MODULE_ID</a>,
00692                                                  <span class="stringliteral">"Console_Reconfigure"</span>,
00693                                                  <span class="stringliteral">"Platform_RegisterReadSocket"</span>);
00694                             <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a44">Platform_CloseAndInvalidate</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, &amp;C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o1">AcceptSocket</a>);
00695                         }
00696                     }
00697                 }
00698             }
00699         } <span class="keywordflow">else</span> {
00700             <a class="code" href="../../d9/dea/_for_doxygen_2src_2_common_2_log_8c.html#a28">Log_LogPlatformError</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a1">CONSOLE_LOG</a>, <a class="code" href="../../d1/d4e/_for_doxygen_2src_2_common_2_log_8h.html#a2">IPDR_PLATFORM_MODULE_ID</a>,
00701                                  <span class="stringliteral">"Console_Reconfigure"</span>,
00702                                  <span class="stringliteral">"Platform_CreateTCPSocket"</span>);
00703         }
00704     }
00705 
00706     Password = <a class="code" href="../../d5/dd6/_for_doxygen_2src_2_common_2_parameters_handler_8c.html#a15">ParametersHandler_GetStringParam</a>(ParamsHandler,
00707                                                 <a class="code" href="../../d8/d8f/_for_doxygen_2src_2_common_2_configuration_names_8h.html#a175">STR_configuration_console_consolePassword</a>);
00708 
00709     <a class="code" href="../../d0/dfd/_for_doxygen_2src_2_common_2_common_util_8c.html#a6">Util_StrDupAndReplace</a>(C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o3">PS</a>, Password, &amp; (C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o7">Password</a>));
00710 
00711     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00712 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="Console.c::Console_RegisterModule"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> Console_RegisterModule           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d59/struct_i_p_d_r__tag___console.html">Console</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>C</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>ModuleName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>ContextArg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d0/d42/struct_console_command.html">ConsoleCommand</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Commands</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Register a module within the console given the module name and the list of commands supported by the module<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>C</em>&nbsp;</td><td>console </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ModuleName</em>&nbsp;</td><td>name of module </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ContextArg</em>&nbsp;</td><td>extra argument passed to the command functions </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Commands</em>&nbsp;</td><td>array of commands terminated by a command with a NULL name.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00816 {
00817     <a class="code" href="../../df/dc8/struct_console_module.html">ConsoleModule</a> *M;
00818     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status;
00819     <span class="keywordtype">int</span> Index;
00820 
00821     Status = <a class="code" href="../../d5/d22/_for_doxygen_2src_2_common_2_memory_management_8c.html#a2">Object_Allocate</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../df/dc8/struct_console_module.html">ConsoleModule</a>),
00822                              <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a16">ConsoleModule_Destructor</a>, (<span class="keywordtype">void</span> **) &amp; M);
00823     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
00824         <span class="keywordflow">return</span> Status;
00825     strncpy(M-&gt;<a class="code" href="../../df/dc8/struct_console_module.html#o0">eyecatcher</a>, <span class="stringliteral">"CMODULE"</span>, <span class="keyword">sizeof</span> M-&gt;<a class="code" href="../../df/dc8/struct_console_module.html#o0">eyecatcher</a>);
00826 
00827     M-&gt;<a class="code" href="../../df/dc8/struct_console_module.html#o1">ContextArg</a> = ContextArg;
00828     M-&gt;<a class="code" href="../../df/dc8/struct_console_module.html#o3">Commands</a> = Commands;
00829 
00830     Status = <a class="code" href="../../d0/dfd/_for_doxygen_2src_2_common_2_common_util_8c.html#a5">Util_StrDup</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, ModuleName, &amp; (M-&gt;<a class="code" href="../../df/dc8/struct_console_module.html#o2">Name</a>));
00831     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(Status)) {
00832         <a class="code" href="../../d5/d22/_for_doxygen_2src_2_common_2_memory_management_8c.html#a5">Object_Release</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, M);
00833         <span class="keywordflow">return</span> Status;
00834     }
00835 
00836     Status = <a class="code" href="../../dd/d31/_for_doxygen_2src_2_common_2_dynamic_array_8c.html#a12">DynamicArray_AddElement</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, &amp; (C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o5">Modules</a>),
00837                                      M, &amp; Index);
00838     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
00839         <span class="keywordflow">return</span> Status;
00840 
00841     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00842 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="Console.c::Console_Start"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> Console_Start           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d59/struct_i_p_d_r__tag___console.html">Console</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>C</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Start the console (start accepting connections)<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>C</em>&nbsp;</td><td>console</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00723 {
00724     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status;
00725 
00726     <span class="keywordflow">if</span> (! C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o4">ConsolePort</a>)
00727         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00728 
00729     Status = <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a39">Platform_CreateTCPSocket</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a> , &amp; (C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o1">AcceptSocket</a>));
00730     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(Status)) {
00731         <a class="code" href="../../d9/dea/_for_doxygen_2src_2_common_2_log_8c.html#a28">Log_LogPlatformError</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a1">CONSOLE_LOG</a>, <a class="code" href="../../d1/d4e/_for_doxygen_2src_2_common_2_log_8h.html#a2">IPDR_PLATFORM_MODULE_ID</a>,
00732                              <span class="stringliteral">"Console_Start"</span>,
00733                              <span class="stringliteral">"Platform_CreateTCPSocket"</span>);
00734         <span class="keywordflow">return</span> Status;
00735     }
00736 
00737     Status = <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a41">Platform_Bind</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o1">AcceptSocket</a>, 0, C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o4">ConsolePort</a>);
00738     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(Status)) {
00739         <a class="code" href="../../d9/dea/_for_doxygen_2src_2_common_2_log_8c.html#a28">Log_LogPlatformError</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a1">CONSOLE_LOG</a>, <a class="code" href="../../d1/d4e/_for_doxygen_2src_2_common_2_log_8h.html#a2">IPDR_PLATFORM_MODULE_ID</a>,
00740                              <span class="stringliteral">"Console_Start"</span>,
00741                              <span class="stringliteral">"Platform_Bind"</span>);
00742         <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a44">Platform_CloseAndInvalidate</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, &amp;C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o1">AcceptSocket</a>);
00743         <span class="keywordflow">return</span> Status;
00744     }
00745 
00746     Status = <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a45">Platform_Listen</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o1">AcceptSocket</a>, 16);
00747     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(Status)) {
00748         <a class="code" href="../../d9/dea/_for_doxygen_2src_2_common_2_log_8c.html#a28">Log_LogPlatformError</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a1">CONSOLE_LOG</a>, <a class="code" href="../../d1/d4e/_for_doxygen_2src_2_common_2_log_8h.html#a2">IPDR_PLATFORM_MODULE_ID</a>,
00749                              <span class="stringliteral">"Console_Start"</span>,
00750                              <span class="stringliteral">"Platform_Listen"</span>);
00751         <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a44">Platform_CloseAndInvalidate</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, &amp;C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o1">AcceptSocket</a>);
00752         <span class="keywordflow">return</span> Status;
00753     }
00754 
00755 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
00756 <span class="preprocessor"></span>    fprintf(stderr, <span class="stringliteral">"RegisterReadSocket %d [Console_Start] Console_AcceptCallback\n"</span>, C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o1">AcceptSocket</a>); fflush(stderr);
00757 <span class="preprocessor">#endif</span>
00758 <span class="preprocessor"></span>    Status = <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a14">Platform_RegisterReadSocket</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o1">AcceptSocket</a>,
00759                                          <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a22">Console_AcceptCallback</a>, C,
00760                                          &amp; (C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o2">AcceptEventID</a>));
00761     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(Status)) {
00762         <a class="code" href="../../d9/dea/_for_doxygen_2src_2_common_2_log_8c.html#a28">Log_LogPlatformError</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a1">CONSOLE_LOG</a>, <a class="code" href="../../d1/d4e/_for_doxygen_2src_2_common_2_log_8h.html#a2">IPDR_PLATFORM_MODULE_ID</a>,
00763                              <span class="stringliteral">"Console_Start"</span>,
00764                              <span class="stringliteral">"Platform_RegisterReadSocket"</span>);
00765         <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a44">Platform_CloseAndInvalidate</a>(<a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a0">CONSOLE_PLATFORM</a>, &amp;C-&gt;<a class="code" href="../../df/d59/struct_i_p_d_r__tag___console.html#o1">AcceptSocket</a>);
00766         <span class="keywordflow">return</span> Status;
00767     }
00768 
00769 <span class="preprocessor">#if 0 &amp;&amp; defined(ENABLE_SIMULATOR)</span>
00770 <span class="preprocessor"></span><span class="preprocessor">#ifdef STD_FILE_OPERATIONS_SUPPORT</span>
00771 <span class="preprocessor"></span>    <span class="comment">/* This feature has been removed */</span>
00772     <span class="keywordflow">if</span> (C-&gt;StartupScript != NULL) {
00773         <span class="keyword">const</span> <span class="keywordtype">char</span> *Argv[1];
00774         Argv[0] = C-&gt;StartupScript;
00775         Console_LoadFileCommand(NULL, 1, Argv, C);
00776     }
00777 <span class="preprocessor">#endif</span>
00778 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00779 <span class="preprocessor"></span>
00780     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00781 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="Console.c::ConsoleModule_Destructor"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ConsoleModule_Destructor           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html">IPDR_PlatformServices</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>PS</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>Obj</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Deletes resources associated with a console module structure <dl compact><dt><b>Note:</b></dt><dd>not static --- used by MemoryManagement.c</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>PS</em>&nbsp;</td><td>platform services </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Obj</em>&nbsp;</td><td>object to delete</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00080 {
00081     <a class="code" href="../../df/dc8/struct_console_module.html">ConsoleModule</a> *M = (<a class="code" href="../../df/dc8/struct_console_module.html">ConsoleModule</a> *) Obj;
00082     strncpy(M-&gt;<a class="code" href="../../df/dc8/struct_console_module.html#o0">eyecatcher</a>, <span class="stringliteral">"Dcmodul"</span>, <span class="keyword">sizeof</span> M-&gt;<a class="code" href="../../df/dc8/struct_console_module.html#o0">eyecatcher</a>);
00083     <a class="code" href="../../d5/d22/_for_doxygen_2src_2_common_2_memory_management_8c.html#a5">Object_Release</a>(PS, M-&gt;<a class="code" href="../../df/dc8/struct_console_module.html#o2">Name</a>);
00084     strncpy(M-&gt;<a class="code" href="../../df/dc8/struct_console_module.html#o0">eyecatcher</a>, <span class="stringliteral">"Xcmodul"</span>, <span class="keyword">sizeof</span> M-&gt;<a class="code" href="../../df/dc8/struct_console_module.html#o0">eyecatcher</a>);
00085 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="Console.c::ConsoleSession_Destructor"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ConsoleSession_Destructor           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html">IPDR_PlatformServices</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>PS</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>Obj</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Deletes resources associated with a console session structure <dl compact><dt><b>Note:</b></dt><dd>not static --- used by MemoryManagement.c</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>PS</em>&nbsp;</td><td>platform services </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Obj</em>&nbsp;</td><td>object to delete</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00098 {
00099     <a class="code" href="../../d8/d9d/struct_console_session.html">ConsoleSession</a> *S = (<a class="code" href="../../d8/d9d/struct_console_session.html">ConsoleSession</a> *) Obj;
00100     strncpy(S-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o0">eyecatcher</a>, <span class="stringliteral">"Dcsessn"</span>, <span class="keyword">sizeof</span> S-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o0">eyecatcher</a>);
00101     <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a17">Platform_UnregisterSocketAndClear</a>(PS, &amp;S-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o1">SocketEventID</a>);
00102     <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a44">Platform_CloseAndInvalidate</a>(PS, &amp;S-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o2">FD</a>);
00103     strncpy(S-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o0">eyecatcher</a>, <span class="stringliteral">"Xcsessn"</span>, <span class="keyword">sizeof</span> S-&gt;<a class="code" href="../../d8/d9d/struct_console_session.html#o0">eyecatcher</a>);
00104 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a10" doxytag="Console.c::Console_h_rcsid"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char <a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a10">Console_h_rcsid</a>[] = CONSOLE_H_RCSID          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="Console.c::Console_rcsid"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char <a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a9">Console_rcsid</a>[] = "@(#) $Id: Console.c,v 1.10 2005/03/29 09:46:06 dmitryk Exp $" IPDR_COPYRIGHT_STR          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="Console.c::ConsoleCommands"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d42/struct_console_command.html">ConsoleCommand</a> <a class="el" href="../../d6/d9b/ipdr_2src_2_common_2_console_8c.html#a11">ConsoleCommands</a>[]<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
    {<span class="stringliteral">"help"</span>, <span class="stringliteral">"help"</span>, <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a12">Console_HelpCommand</a> },
    {<span class="stringliteral">"helpm"</span>, <span class="stringliteral">"helpm &lt;module&gt;"</span>, <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a13">Console_HelpModuleCommand</a> },
    {<span class="stringliteral">"helpc"</span>, <span class="stringliteral">"helpc &lt;command&gt;"</span>, <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a14">Console_HelpCommandCommand</a> },
    {<span class="stringliteral">"echo"</span>, <span class="stringliteral">"echo"</span>, <a class="code" href="../../d6/d41/_for_doxygen_2src_2_common_2_console_8c.html#a15">Console_EchoCommand</a> },





    {<span class="stringliteral">"exit"</span>, <span class="stringliteral">"exit"</span>, NULL }, 
    {<span class="stringliteral">"stop"</span>, <span class="stringliteral">"stop"</span>, NULL }, 
    {NULL, NULL, NULL}
}
</pre></div>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Mon Apr 25 09:26:24 2005 for IPDRAPI by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.2 </small></address>
</body>
</html>
