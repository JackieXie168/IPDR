<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>IPDRAPI: For Doxygen/src/Simulators/IPDRsimple/IPDRsimple.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.2 -->
<div class="qindex"><a class="qindex" href="../../index.html">Main&nbsp;Page</a> | <a class="qindex" href="../../modules.html">Modules</a> | <a class="qindex" href="../../namespaces.html">Namespace List</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="../../dirs.html">Directories</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="../../globals.html">Globals</a></div>
<div class="nav">
<a class="el" href="../../dir_000000.html">For Doxygen</a>&nbsp;/&nbsp;<a class="el" href="../../dir_000003.html">src</a>&nbsp;/&nbsp;<a class="el" href="../../dir_000011.html">Simulators</a>&nbsp;/&nbsp;<a class="el" href="../../dir_000014.html">IPDRsimple</a></div>
<h1>IPDRsimple.c File Reference</h1><code>#include &lt;<a class="el" href="../../df/dde/_defs_8h.html">IPDR/Defs.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="../../da/d39/_i_p_d_r_8h.html">IPDR/IPDR.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="../../df/d23/_generic_platform_8h.html">Platforms/Generic/GenericPlatform.h</a>&gt;</code><br>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &lt;ctype.h&gt;</code><br>
<code>#include &lt;time.h&gt;</code><br>
<code>#include &lt;arpa/inet.h&gt;</code><br>
<code>#include &lt;stddef.h&gt;</code><br>
<code>#include &lt;signal.h&gt;</code><br>
<code>#include &lt;setjmp.h&gt;</code><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga9">IPDR_IPAddress</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/de2/_i_p_d_rsimple_8c.html#a1">makeIP</a> (int i1, int i2, int i3, int i4)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/de2/_i_p_d_rsimple_8c.html#a2">clientConfig</a> (const char *name, void *contextArg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/de2/_i_p_d_rsimple_8c.html#a3">logOutputCallback</a> (<a class="el" href="../../dc/d9b/group___i_p_d_r__logging.html#ga6">IPDR_DebugLevel</a> level, const char *levelStr, const char *clientName, const char *module, const char *func, const char *msg, void *context)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/de2/_i_p_d_rsimple_8c.html#a4">checkRc</a> (<a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> rc, const char *msg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/de2/_i_p_d_rsimple_8c.html#a5">trimBuf</a> (char *buf)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/de2/_i_p_d_rsimple_8c.html#a6">outputRecord</a> (int counter, int i, <a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a> clientH, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">IPDR_SessionHandle</a> sessionH, <a class="el" href="../../d4/dc8/struct_i_p_d_r__tag___template_handle.html">IPDR_TemplateHandle</a> templateH)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/de2/_i_p_d_rsimple_8c.html#a7">outputRecords</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a> clientH, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">IPDR_SessionHandle</a> sessionH, <a class="el" href="../../d4/dc8/struct_i_p_d_r__tag___template_handle.html">IPDR_TemplateHandle</a> templateH)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/de2/_i_p_d_rsimple_8c.html#a8">eventCallback</a> (const <a class="el" href="../../d6/df8/struct_i_p_d_r___event_data.html">IPDR_EventData</a> *event, const char *msg, void *context)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/de2/_i_p_d_rsimple_8c.html#a9">main</a> (int argc, const char *const argv[])</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d9/d12/struct_i_p_d_r___key.html">IPDR_Key</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/de2/_i_p_d_rsimple_8c.html#a0">outputRecordTemplate</a> []</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
IPDRsimple sample "simulation" code for the IPDR client (transmitter)<br>
<p>
Copyright (2005) Amdocs, All Rights Reserved<p>
This software is distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND either expresses or implied. <hr><h2>Function Documentation</h2>
<a class="anchor" name="a4" doxytag="IPDRsimple.c::checkRc"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void checkRc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>rc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Utility function: check a return code, printing a nasty error message and explanation, then exiting if the result isn't OK. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>rc</em>&nbsp;</td><td>The return code to be tested. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>msg</em>&nbsp;</td><td>The message to print if the return code isn't IPDR_OK. </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00150 {
00151     <span class="keywordflow">if</span> (<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(rc)) {
00152         fprintf(stdout, <span class="stringliteral">"Failed %s: %s\n"</span>, msg, <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_StatusMsg</a>(NULL, rc));
00153         exit(1);
00154     }
00155 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="IPDRsimple.c::clientConfig"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char* clientConfig           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>contextArg</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Callback for lookup of parameters. This does a lookup into the parmMap (passed in as the context). It also checks that a MIB value hasn't already been provided --- this isn't necessary currrently but is a "good idea" in case things need to change in the future. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>The parameter's name to look up </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>contextArg</em>&nbsp;</td><td>The context for the callback, as given to <a class="el" href="../../d3/d96/group___i_p_d_r__initialization__starting__deletion.html#ga3">IPDR_InitExporter()</a>: pointer to a <a class="el" href="../../d7/d79/struct_exporter_config_context__t.html">ExporterConfigContext_t</a>. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The value as a C-string pointer (NULL if unknown parameter) </dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="../../d1/d65/_i_p_d_rsim_8cpp.html#a14">initParmMap</a> <p>
<a class="el" href="../../d1/d65/_i_p_d_rsim_8cpp.html#a4">ParmMap_t</a> </dd></dl>
<div class="fragment"><pre class="fragment">00312 {
00313     <span class="keyword">const</span> <a class="code" href="../../d7/d79/struct_exporter_config_context__t.html">ExporterConfigContext_t</a>&amp; context = *static_cast&lt;ExporterConfigContext_t*&gt;(contextArg);
00314     ParmMap_t::const_iterator lookup = context.<a class="code" href="../../d7/d79/struct_exporter_config_context__t.html#o0">parmMap</a>-&gt;find(name);
00315 
00316     <span class="keywordflow">if</span> (lookup == context.<a class="code" href="../../d7/d79/struct_exporter_config_context__t.html#o0">parmMap</a>-&gt;end())
00317         {
00318         <span class="comment">// cerr &lt;&lt; outputPrefix &lt;&lt; "Unknown parameter(" &lt;&lt; name &lt;&lt; ")" &lt;&lt; endl;</span>
00319         <span class="keywordflow">return</span> NULL; <span class="comment">// will be NULL if not in MIB, hence default value</span>
00320         }
00321         <span class="keywordflow">else</span>
00322         {
00323         <span class="keywordflow">if</span> (lookup-&gt;second.setByCLI)
00324                 {
00325             <span class="keywordflow">return</span> lookup-&gt;second.value;
00326         }
00327                 <span class="keywordflow">else</span>
00328                 {
00329             <span class="keywordflow">return</span> lookup-&gt;second.value;
00330         }
00331     }
00332 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="IPDRsimple.c::eventCallback"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void eventCallback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="../../d6/df8/struct_i_p_d_r___event_data.html">IPDR_EventData</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>event</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Callback for displaying a IPDR event. <div class="fragment"><pre class="fragment">00348 {
00349 
00350     fprintf(stdout, <span class="stringliteral">"*** event [%.99s] %s\n"</span>, <a class="code" href="../../df/dd7/group___i_p_d_r__event__notification.html#ga2">IPDR_EventMsg</a>(event), msg);
00351 
00352     fflush(stdout);
00353 
00354 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="IPDRsimple.c::logOutputCallback"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void logOutputCallback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../dc/d9b/group___i_p_d_r__logging.html#ga6">IPDR_DebugLevel</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>level</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>levelStr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>clientName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>module</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>func</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The callback for outputting log messages (registered by IPDR_SetLogOutput()). This simply outputs a message to stderr. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>level</em>&nbsp;</td><td>The numeric value for the error level of this message </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>levelStr</em>&nbsp;</td><td>A C-string which relates to the error level </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>clientName</em>&nbsp;</td><td>The client's (transmitter's) name (C-string), as given to <a class="el" href="../../d3/d96/group___i_p_d_r__initialization__starting__deletion.html#ga3">IPDR_InitExporter()</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>module</em>&nbsp;</td><td>The module that generated this message "(Exporter" (transmitter), "Platform", "TCP", etc.) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>func</em>&nbsp;</td><td>The function within the module that generated this message </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>msg</em>&nbsp;</td><td>The message for outputting to the log </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>The context for this callback, as passed to IPDR_SetLogOutput(): pointer to a IPDR_ExporterHandle </td></tr>
  </table>
</dl>
<dl compact><dt><b>See also:</b></dt><dd>IPDR_SetLogOutput </dd></dl>
<div class="fragment"><pre class="fragment">00371 {
00372     <a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a> *clientH = static_cast&lt;IPDR_ExporterHandle *&gt;(context);
00373         <span class="keywordtype">char</span> timeStrBuf[<a class="code" href="../../d5/d74/group___i_p_d_r__time__services.html#ga8">IPDR_TIME_FORMAT_LENGTH</a> + 1];
00374     <span class="keywordtype">char</span> line[500];
00375 
00376     sprintf(line, <span class="stringliteral">"%.30sZ %.7s &lt;%.40s&gt; {%-8s} %.99s: %.299s"</span>,
00377             <a class="code" href="../../d1/d24/group___i_p_d_r__platform__calls.html#ga10">IPDR_FormatTimeGMTNow</a>(*clientH, timeStrBuf),
00378             levelStr, clientName, module, func, msg);
00379     cerr &lt;&lt; line &lt;&lt; endl;
00380 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="IPDRsimple.c::main"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int main           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *const &nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The main program.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>argc</em>&nbsp;</td><td>The number of arguments + 1 for the program name</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>argv</em>&nbsp;</td><td>The arguments (<code>argv[0]</code> is the program name)</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Zero for success; non-zero for error. </dd></dl>
<div class="fragment"><pre class="fragment">00421 {
00422 
00423     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> rc = 0;
00424 
00425     <a class="code" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html">IPDR_PlatformServices</a> services;
00426 
00427     <a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a> clientH;
00428 
00429     <a class="code" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">IPDR_CollectorHandle</a> serverH;
00430 
00431     <a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html">IPDR_SessionHandle</a> sessionH;
00432 
00433     <a class="code" href="../../d4/dc8/struct_i_p_d_r__tag___template_handle.html">IPDR_TemplateHandle</a> templateH;
00434 
00435     <span class="keywordtype">long</span> drainMillisec = 60000; <span class="comment">/* 60 seconds */</span>
00436 
00437 
00438 
00439     fprintf(stdout, <span class="stringliteral">"GenericPlatform_Initialize ...\n"</span>); fflush(stdout);
00440 
00441     rc = <a class="code" href="../../dd/d00/_generic_platform_8c.html#a54">GenericPlatform_Initialize</a>(&amp;services);
00442 
00443     <a class="code" href="../../d5/de2/_i_p_d_rsimple_8c.html#a4">checkRc</a>(rc, <span class="stringliteral">"GenericPlatform_Initialize"</span>);
00444 
00445 
00446 
00447     rc = <a class="code" href="../../d3/d96/group___i_p_d_r__initialization__starting__deletion.html#ga3">IPDR_InitExporter</a>(&amp;services,
00448 
00449                           <span class="stringliteral">"*"</span>, <span class="comment">// "IPDRsim",</span>
00450 
00451                           <a class="code" href="../../d1/d65/_i_p_d_rsim_8cpp.html#a15">clientConfig</a>,
00452 
00453                           0, <span class="comment">/* &amp;clientConfigContext */</span>
00454 
00455                           0, <span class="comment">/* loadMIBcallback */</span>
00456 
00457                           0, <span class="comment">/* configFileName */</span>
00458 
00459                           0, <span class="comment">/* saveMIBcallback */</span>
00460 
00461                           0, <span class="comment">/* configFileName */</span>
00462 
00463                           &amp;clientH);
00464 
00465     <a class="code" href="../../d5/de2/_i_p_d_rsimple_8c.html#a4">checkRc</a>(rc, <span class="stringliteral">"IPDR_InitExporter"</span>);
00466 
00467     <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#ga1">IPDR_SetModuleMoreDebugLevel</a>(clientH, <span class="stringliteral">"Exporter"</span>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a172">IPDR_LEVEL_DEBUG</a>);
00468 
00469     <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#ga1">IPDR_SetModuleMoreDebugLevel</a>(clientH, <span class="stringliteral">"Platform"</span>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>);
00470 
00471     <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#ga1">IPDR_SetModuleMoreDebugLevel</a>(clientH, <span class="stringliteral">"TCP"</span>,      <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>);
00472 
00473     <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#ga1">IPDR_SetModuleMoreDebugLevel</a>(clientH, <span class="stringliteral">"Host"</span>,     <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>);
00474 
00475     <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#ga1">IPDR_SetModuleMoreDebugLevel</a>(clientH, <span class="stringliteral">"Queue"</span>,    <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>);
00476 
00477     <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#ga1">IPDR_SetModuleMoreDebugLevel</a>(clientH, <span class="stringliteral">"Memory"</span>,   <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>);
00478 
00479     <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#ga1">IPDR_SetModuleMoreDebugLevel</a>(clientH, <span class="stringliteral">"Protocol"</span>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a171">IPDR_LEVEL_INFO</a>); <span class="comment">// IPDR_LEVEL_WARNING); // INFO shows things like template change messages.</span>
00480 
00481 
00482 
00483 
00484 
00485     fprintf(stdout, <span class="stringliteral">"IPDR_SetLogOutputCallbackDetailed...\n"</span>); fflush(stdout);
00486 
00487 
00488 
00489     rc = <a class="code" href="../../d3/d0a/group___i_p_d_r__sessions.html#ga0">IPDR_CreateSession</a>(clientH, <span class="stringliteral">"session1"</span>, 1, <span class="stringliteral">"NE/one"</span>, &amp;sessionH);
00490 
00491 
00492 
00493     rc = <a class="code" href="../../d3/d0a/group___i_p_d_r__sessions.html#ga4">IPDR_AddCollector</a>(clientH, <span class="stringliteral">"server1"</span>, <a class="code" href="../../d5/de2/_i_p_d_rsimple_8c.html#a1">makeIP</a>(10,1,100,81), 0, 0);
00494 
00495     fprintf(stdout, <span class="stringliteral">"IPDR_AddCollector...\n"</span>); fflush(stdout);
00496 
00497     rc = <a class="code" href="../../d3/d0a/group___i_p_d_r__sessions.html#ga6">IPDR_GetCollector</a>(clientH,<span class="stringliteral">"server1"</span>,&amp;serverH, NULL, NULL, NULL);
00498 
00499     rc = <a class="code" href="../../d3/d0a/group___i_p_d_r__sessions.html#ga7">IPDR_AssocCollectorSession</a>(clientH,sessionH,serverH,10);
00500 
00501     fprintf(stdout, <span class="stringliteral">"IPDR_AssocCollectorSession...\n"</span>); fflush(stdout);
00502 
00503     rc = <a class="code" href="../../d1/dcc/group___i_p_d_r__templates.html#ga3">IPDR_CreateTemplate</a>(
00504 
00505                   clientH,sessionH, 1, <span class="stringliteral">"OutputRecord"</span>,<span class="stringliteral">""</span>,
00506 
00507               <span class="keyword">sizeof</span> <a class="code" href="../../d5/de2/_i_p_d_rsimple_8c.html#a0">outputRecordTemplate</a> / <span class="keyword">sizeof</span> <a class="code" href="../../d5/de2/_i_p_d_rsimple_8c.html#a0">outputRecordTemplate</a>[0],
00508 
00509                   outputRecordTemplate,
00510 
00511                  &amp;templateH);
00512 
00513 
00514 
00515     fprintf(stdout, <span class="stringliteral">"IPDR_CreateTemplate...\n"</span>); fflush(stdout);
00516 
00517 
00518 
00519 
00520 
00521     fprintf(stdout, <span class="stringliteral">"IPDR_SetExporterEventHandlerDetailed...\n"</span>); fflush(stdout);
00522 
00523     <a class="code" href="../../df/dd7/group___i_p_d_r__event__notification.html#ga3">IPDR_SetExporterEventHandlerDetailed</a>(clientH, <a class="code" href="../../d1/d65/_i_p_d_rsim_8cpp.html#a18">eventCallback</a>, &amp;clientH);
00524 
00525     <a class="code" href="../../d5/de2/_i_p_d_rsimple_8c.html#a4">checkRc</a>(rc, <span class="stringliteral">"IPDR_SetExporterEventHandlerDetailed"</span>);
00526 
00527 
00528 
00529     fprintf(stdout, <span class="stringliteral">"IPDR_StartExporter...\n"</span>); fflush(stdout);
00530 
00531     rc = <a class="code" href="../../d3/d96/group___i_p_d_r__initialization__starting__deletion.html#ga4">IPDR_StartExporter</a>(clientH);
00532 
00533     <a class="code" href="../../d5/de2/_i_p_d_rsimple_8c.html#a4">checkRc</a>(rc, <span class="stringliteral">"IPDR_StartExporter"</span>);
00534 
00535 
00536 
00537     <a class="code" href="../../d5/de2/_i_p_d_rsimple_8c.html#a7">outputRecords</a>(clientH, sessionH,templateH);
00538 
00539 
00540 
00541     fprintf(stdout, <span class="stringliteral">"Waiting up to %g seconds to drain the output ...\n"</span>, drainMillisec / 1000.0); fflush(stdout);
00542 
00543     rc = <a class="code" href="../../d3/d96/group___i_p_d_r__initialization__starting__deletion.html#ga10">IPDR_DrainQueue</a>(clientH, sessionH, drainMillisec);
00544 
00545     <a class="code" href="../../d5/de2/_i_p_d_rsimple_8c.html#a4">checkRc</a>(rc, <span class="stringliteral">"IPDR_DrainQueue"</span>);
00546 
00547 
00548 
00549     fprintf(stdout, <span class="stringliteral">"IPDR_DeleteExporter...\n"</span>); fflush(stdout);
00550 
00551     rc = <a class="code" href="../../d3/d96/group___i_p_d_r__initialization__starting__deletion.html#ga8">IPDR_DeleteExporter</a>(clientH);
00552 
00553     <a class="code" href="../../d5/de2/_i_p_d_rsimple_8c.html#a4">checkRc</a>(rc, <span class="stringliteral">"IPDR_DeleteExporter"</span>);
00554 
00555 
00556 
00557     fprintf(stdout, <span class="stringliteral">"services.Delete ...\n"</span>); fflush(stdout);
00558 
00559     rc = services.<a class="code" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html#o5">Delete</a>(services.<a class="code" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html#o1">PlatformArg</a>);
00560 
00561     <a class="code" href="../../d5/de2/_i_p_d_rsimple_8c.html#a4">checkRc</a>(rc, <span class="stringliteral">"services.Delete"</span>);
00562 
00563 
00564 
00565     fprintf(stdout, <span class="stringliteral">"Processing finished.\n"</span>); fflush(stdout);
00566 
00567 
00568 
00569     <span class="keywordflow">return</span> 0;
00570 
00571 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="IPDRsimple.c::makeIP"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga9">IPDR_IPAddress</a> makeIP           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>i1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>i2</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>i3</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>i4</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Utility for making a IPDR_IPAddress from 4 integers. <div class="fragment"><pre class="fragment">00324 {
00325 
00326     <span class="keywordflow">return</span> ((i1&amp;0xff) &lt;&lt; 24) +
00327 
00328         ((i2&amp;0xff) &lt;&lt; 16) +
00329 
00330         ((i3&amp;0xff) &lt;&lt; 8) +
00331 
00332         ((i4&amp;0xff) &lt;&lt; 0);
00333 
00334 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="IPDRsimple.c::outputRecord"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void outputRecord           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>counter</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>i</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>clientH</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">IPDR_SessionHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>sessionH</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/dc8/struct_i_p_d_r__tag___template_handle.html">IPDR_TemplateHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>templateH</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Output a single record. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>counter</em>&nbsp;</td><td>The overall counter. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>i</em>&nbsp;</td><td>The counter within this group of records. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>clientH</em>&nbsp;</td><td>from IPDR_InitExporter </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>templateH</em>&nbsp;</td><td>from IPDR_CreateTemplate </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00179 {
00180         <span class="comment">/*IPDR_TemplateHandle TH;*/</span>
00181         <a class="code" href="../../db/d6d/struct_output_record_struct.html">OutputRecordStruct</a> rec;
00182         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> rc;
00183         rec.<a class="code" href="../../db/d6d/struct_output_record_struct.html#o0">counter</a> = counter;
00184         rec.<a class="code" href="../../db/d6d/struct_output_record_struct.html#o1">counter2</a> = i;
00185         <a class="code" href="../../df/dcb/group___i_p_d_r__key__type__attributes.html#ga32">FILL_STRING</a>(rec.name, <span class="stringliteral">"xdrBASE64"</span>)
00186         rec.unsigned32 = 1;
00187         rec.unsigned32_2 = 2;
00188         rec.unsigned64 = 3;
00189         rec.ipAddress = <a class="code" href="../../d5/de2/_i_p_d_rsimple_8c.html#a1">makeIP</a>(192, 168, 1, 255);
00190         rec.macAddress = 0x1122334455667788llu;
00191         rec.ipdrLong=38675690;
00192         rec.IPDRCreationTime=123456;
00193         rec.ipFloat=175.576f;
00194         rec.ipDouble=12345.45;
00195         <a class="code" href="../../df/dcb/group___i_p_d_r__key__type__attributes.html#ga30">FILL_BASE64</a>(rec.base64, "alex")
00196         <a class="code" href="../../df/dcb/group___i_p_d_r__key__type__attributes.html#ga31">FILL_HEXBINARY</a>(rec.hexBinary, "123456789123456", strlen("123456789123456"));
00197         rec.booleanValue=1;
00198         rec.byteValue=5;
00199         rec.uByteValue=3;
00200         rec.shortValue=99;
00201         rec.uShortValue=111;
00202         rec.dateTime=0;
00203         memcpy(rec.xdrIPV6ADDR, "1234567812345678", 16);
00204         <span class="keywordtype">long</span> helper = htonl(16);
00205         memcpy(rec.xdrUUID, &amp;helper, 4);
00206         memcpy(&amp;(rec.xdrUUID[4]), "1234567812345678", 16);
00207         rec.timeUsec=0xAAA;
00208 
00209         <span class="comment">/*rc = IPDR_GetTemplate(sessionH, 1, NULL, NULL, NULL, &amp;TH);</span>
00210 <span class="comment">        rc = IPDR_DeleteTemplate(sessionH, TH);*/</span>
00211 
00212         rc = <a class="code" href="../../dc/d8d/group___i_p_d_r__data__delivery.html#ga0">IPDR_SendData</a>(clientH, sessionH,templateH, &amp;rec);
00213         <a class="code" href="../../d5/de2/_i_p_d_rsimple_8c.html#a4">checkRc</a>(rc, "<a class="code" href="../../dc/d8d/group___i_p_d_r__data__delivery.html#ga0">IPDR_SendData</a>");
00214 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="IPDRsimple.c::outputRecords"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void outputRecords           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>clientH</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">IPDR_SessionHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>sessionH</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/dc8/struct_i_p_d_r__tag___template_handle.html">IPDR_TemplateHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>templateH</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Output batches of records. This reads numbers from stdin (one per<p>
line) and outputs that many records in each batch.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>clientH</em>&nbsp;</td><td>from IPDR_InitClient</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>templateH</em>&nbsp;</td><td>from IPDR_CreateTemplate </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00234 {
00235 
00236     <span class="keywordtype">int</span> counter = 0;
00237     <span class="keywordtype">int</span> value;
00238     <span class="keywordtype">int</span> i;
00239 
00240     <span class="keywordtype">char</span> buf[100];
00241 
00242     fprintf(stdout, <span class="stringliteral">"Please insert number of record to send and press enter\n"</span>);
00243     <span class="keywordflow">while</span> (0 != fgets(buf, <span class="keyword">sizeof</span> buf, stdin)) {
00244 
00245         <a class="code" href="../../d5/de2/_i_p_d_rsimple_8c.html#a5">trimBuf</a>(buf);
00246 
00247         value = atoi(buf);
00248 
00249         <span class="keywordflow">if</span> (value &lt; 0) {
00250                 fprintf(stdout, <span class="stringliteral">"ERROR - Outputting %d less then zero\n"</span>, value);
00251             <span class="keywordflow">break</span>;
00252         }
00253 
00254         <span class="keywordflow">for</span> (i = 0; i &lt; value; i++) {
00255             <a class="code" href="../../d5/de2/_i_p_d_rsimple_8c.html#a6">outputRecord</a>(counter, i, clientH, sessionH,templateH);
00256             counter++;
00257         }
00258             fprintf(stdout, <span class="stringliteral">"Please insert number of record to send and press enter\n"</span>);
00259                 <a class="code" href="../../d1/d24/group___i_p_d_r__platform__calls.html#ga8">IPDR_SleepMS</a>(clientH, 5*1000);
00260         }
00261 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="IPDRsimple.c::trimBuf"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void trimBuf           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>buf</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Trim trailing whitespace and newlines from a string. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>The string to be trimmed (it gets shortened as necessary). </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00161 {
00162     <span class="keywordtype">int</span> len = strlen(buf);
00163     <span class="keywordflow">while</span> (len &gt; 0 &amp;&amp; isspace(buf[len - 1] &amp; 0xff)) {
00164         len--;
00165         buf[len] = <span class="charliteral">'\0'</span>;
00166     }
00167 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a0" doxytag="IPDRsimple.c::outputRecordTemplate"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d12/struct_i_p_d_r___key.html">IPDR_Key</a> <a class="el" href="../../d5/de2/_i_p_d_rsimple_8c.html#a0">outputRecordTemplate</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Definition of <a class="el" href="../../db/d6d/struct_output_record_struct.html">OutputRecordStruct</a>, for a IPDR template. This definition uses field offsets everywhere.     </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Mon Apr 25 22:28:24 2005 for IPDRAPI by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.2 </small></address>
</body>
</html>
