<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>IPDRAPI: org::ipdr::protocol::ProtocolStreamMsg Class Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.2 -->
<div class="qindex"><a class="qindex" href="../../index.html">Main&nbsp;Page</a> | <a class="qindex" href="../../modules.html">Modules</a> | <a class="qindex" href="../../namespaces.html">Namespace List</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="../../dirs.html">Directories</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="../../globals.html">Globals</a></div>
<div class="nav">
<a class="el" href="../../db/d96/namespaceorg.html">org</a>::<a class="el" href="../../df/d76/namespaceorg_1_1ipdr.html">ipdr</a>::<a class="el" href="../../dd/d99/namespaceorg_1_1ipdr_1_1protocol.html">protocol</a>::<a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html">ProtocolStreamMsg</a></div>
<h1>org::ipdr::protocol::ProtocolStreamMsg Class Reference</h1><p>Inheritance diagram for org::ipdr::protocol::ProtocolStreamMsg:
<p><center><img src="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.png" usemap="#org::ipdr::protocol::ProtocolStreamMsg_map" border="0" alt=""></center>
<map name="org::ipdr::protocol::ProtocolStreamMsg_map">
<area href="../../d4/d6b/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg.html" alt="org::ipdr::protocol::ProtocolMsg" shape="rect" coords="0,56,366,80">
<area href="../../de/d83/interfaceorg_1_1ipdr_1_1protocol_1_1_protocol_msg_identification.html" alt="org::ipdr::protocol::ProtocolMsgIdentification" shape="rect" coords="0,0,366,24">
<area href="../../d2/d7f/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_c_o_n_n_e_c_t.html" alt="org::ipdr::protocol::ProtocolMsgCONNECT" shape="rect" coords="376,168,742,192">
<area href="../../d5/df8/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_c_o_n_n_e_c_t___r_e_s_p_o_n_s_e.html" alt="org::ipdr::protocol::ProtocolMsgCONNECT_RESPONSE" shape="rect" coords="376,224,742,248">
<area href="../../d4/d5d/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_d_a_t_a.html" alt="org::ipdr::protocol::ProtocolMsgDATA" shape="rect" coords="376,280,742,304">
<area href="../../da/d23/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_d_a_t_a___a_c_k.html" alt="org::ipdr::protocol::ProtocolMsgDATA_ACK" shape="rect" coords="376,336,742,360">
<area href="../../db/dcd/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_empty.html" alt="org::ipdr::protocol::ProtocolMsgEmpty" shape="rect" coords="376,392,742,416">
<area href="../../db/d5a/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_e_r_r_o_r.html" alt="org::ipdr::protocol::ProtocolMsgERROR" shape="rect" coords="376,448,742,472">
<area href="../../dd/ddb/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_f_l_o_w___s_t_o_p.html" alt="org::ipdr::protocol::ProtocolMsgFLOW_STOP" shape="rect" coords="376,504,742,528">
<area href="../../d5/d40/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_g_e_t___s_e_s_s_i_o_n_s.html" alt="org::ipdr::protocol::ProtocolMsgGET_SESSIONS" shape="rect" coords="376,560,742,584">
<area href="../../dc/d45/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_g_e_t___s_e_s_s_i_o_n_s___r_e_s_p_o_n_s_e.html" alt="org::ipdr::protocol::ProtocolMsgGET_SESSIONS_RESPONSE" shape="rect" coords="376,616,742,640">
<area href="../../d1/d2f/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_g_e_t___t_e_m_p_l_a_t_e_s.html" alt="org::ipdr::protocol::ProtocolMsgGET_TEMPLATES" shape="rect" coords="376,672,742,696">
<area href="../../d6/d4d/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_g_e_t___t_e_m_p_l_a_t_e_s___r_e_s_p_o_n_s_e.html" alt="org::ipdr::protocol::ProtocolMsgGET_TEMPLATES_RESPONSE" shape="rect" coords="376,728,742,752">
<area href="../../d5/d5d/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_header_only.html" alt="org::ipdr::protocol::ProtocolMsgHeaderOnly" shape="rect" coords="376,784,742,808">
<area href="../../dd/dba/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_s_e_s_s_i_o_n___s_t_a_r_t.html" alt="org::ipdr::protocol::ProtocolMsgSESSION_START" shape="rect" coords="376,840,742,864">
<area href="../../dd/d11/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_s_e_s_s_i_o_n___s_t_o_p.html" alt="org::ipdr::protocol::ProtocolMsgSESSION_STOP" shape="rect" coords="376,896,742,920">
<area href="../../dc/d5e/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_template.html" alt="org::ipdr::protocol::ProtocolMsgTemplate" shape="rect" coords="376,952,742,976">
</map>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#a0">ProtocolStreamMsg</a> (byte[] msg, int length, int requiredLength)  throws ProtocolMalformedMsgException 	</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">final void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#a1">set</a> (byte[] msg, int length, int requiredLength)  throws ProtocolMalformedMsgException 	</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#a2">ProtocolStreamMsg</a> (byte msgId, byte <a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#o1">sessionId</a>, int <a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#o3">msgLength</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">abstract byte&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#a3">msgId</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">boolean&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#a4">shouldOutputToLog</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">final void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#a5">sendMsg</a> (<a class="el" href="../../dc/d3c/classorg_1_1ipdr_1_1_connection_dynamic.html">ConnectionDynamic</a> connection)  throws ConnectionIOException 	</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">String&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#a6">toStringLong</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">byte&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#a7">getSessionId</a> ()</td></tr>

<tr><td colspan="2"><br><h2>Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static final int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#e0">round32</a> (int value)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static final <a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html">ProtocolStreamMsg</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#e1">readMsg</a> (byte[] buf, <a class="el" href="../../dc/d3c/classorg_1_1ipdr_1_1_connection_dynamic.html">ConnectionDynamic</a> connection, String whatDoing, <a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html">ProtocolStreamMsg</a> responseTo, int timeoutMillisec)  throws ConnectionIOException, ProtocolMalformedMsgException 	</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static final <a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html">ProtocolStreamMsg</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#e2">readMsg</a> (<a class="el" href="../../dc/d3c/classorg_1_1ipdr_1_1_connection_dynamic.html">ConnectionDynamic</a> connection, String whatDoing, <a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html">ProtocolStreamMsg</a> responseTo, int timeoutMillisec)  throws ConnectionIOException, ProtocolMalformedMsgException 	</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static final <a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html">ProtocolStreamMsg</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#e3">construct</a> (byte[] msg, int length)  throws ProtocolMalformedMsgException 	</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static final <a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html">ProtocolStreamMsg</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#e4">construct</a> (byte[] msg, int length, <a class="el" href="../../d4/d5d/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_d_a_t_a.html">ProtocolMsgDATA</a> msgDATA)  throws ProtocolMalformedMsgException 	</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static final <a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html">ProtocolStreamMsg</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#e5">construct</a> (byte[] msg)  throws ProtocolMalformedMsgException 	</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static final void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#e6">dumpHex</a> (byte[] raw, int offset, int length)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Utility: dump a raw message in hex.  <a href="#e6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#e7">unimplemented</a> (String className, String function)  throws UnsupportedOperationException 	</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#e8">unimplemented</a> (Object o, String function)  throws UnsupportedOperationException 	</td></tr>

<tr><td colspan="2"><br><h2>Data Fields</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">short&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#o0">protocolVersion</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">byte&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#o1">sessionId</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">byte&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#o2">hdrFlags</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#o3">msgLength</a></td></tr>

<tr><td colspan="2"><br><h2>Static Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static final int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#s0">HDR_LENGTH</a> = 8</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The minimum length of a message (header only).  <a href="#s0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static final byte&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#s1">PROTOCOL_VERSION</a> = 2</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The version of the CRANE protocol that we support.  <a href="#s1"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#b0">ProtocolStreamMsg</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">final void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#b1">handleIndexOutOfBounds</a> (IndexOutOfBoundsException e, byte[] buf, int length)  throws ProtocolMalformedMsgException 	</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">final byte[]&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#b2">trimToLength</a> (byte[] buf, int length)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">String&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#b3">toStringBase</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">final void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#b4">setHeader</a> (byte[] msgData)</td></tr>

<tr><td colspan="2"><br><h2>Static Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static final void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#f0">verifyLength</a> (<a class="el" href="../../de/d83/interfaceorg_1_1ipdr_1_1protocol_1_1_protocol_msg_identification.html">ProtocolMsgIdentification</a> id, byte[] buf, int bufLength, int requiredLength)  throws ProtocolMalformedMsgException 	</td></tr>

<tr><td colspan="2"><br><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">final void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#d0">initZero</a> ()</td></tr>

<tr><td colspan="2"><br><h2>Static Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static final byte[]&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#h0">readRawMsg</a> (<a class="el" href="../../dc/d3c/classorg_1_1ipdr_1_1_connection_dynamic.html">ConnectionDynamic</a> connection, byte[] buf, int timeoutMillisec)  throws java.io.IOException 	</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static final String&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#h1">makeErrMsg</a> (String whatDoing, <a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html">ProtocolStreamMsg</a> responseTo)</td></tr>

<tr><td colspan="2"><br><h2>Static Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static final int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#v0">PROTOCOL_VERSION_OFFSET</a> = 0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static final int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#v1">MSGID_OFFSET</a> = 1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static final int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#v2">SESSION_ID_OFFSET</a> = 2</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static final int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#v3">HDR_FLAGS_OFFSET</a> = 3</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static final int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#v4">MSG_LENGTH_OFFSET</a> = 4</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
The Java encapsulation of a IPDR protocol message over TCP The message has the common header: &lt;xmp&gt; struct IPDRStreamingHeader { char version; // version of protocol, for this version, set to 2 char messageId; // the ID of this <a class="el" href="../../d4/daa/struct_message.html">Message</a> (see MessageIds) char sessionId; // the ID of this Session or 0 if not Session-specific char messageFlags; // reserved/unused and set to 0 int messageLen; // length in bytes of <a class="el" href="../../d4/daa/struct_message.html">Message</a> including header } &lt;/xmp&gt; 
<p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="a0" doxytag="org::ipdr::protocol::ProtocolStreamMsg::ProtocolStreamMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">org::ipdr::protocol::ProtocolStreamMsg::ProtocolStreamMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">byte[]&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>requiredLength</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2">  throws <a class="el" href="../../d4/d86/classorg_1_1ipdr_1_1protocol_1_1_protocol_malformed_msg_exception.html">ProtocolMalformedMsgException</a> 	<code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Construct from raw bytes <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>msg</em>&nbsp;</td><td>The raw message bytes </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>The number of bytes in the message </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>requiredLength</em>&nbsp;</td><td>The required number of bytes in the message </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00036         {
00037                 <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#a1">set</a>(msg, length, requiredLength);
00038         }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b0" doxytag="org::ipdr::protocol::ProtocolStreamMsg::ProtocolStreamMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">org::ipdr::protocol::ProtocolStreamMsg::ProtocolStreamMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline, protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Constructor only for use by "pseudo" messages <div class="fragment"><pre class="fragment">00099         {
00100                 <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#d0">initZero</a>();
00101         }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="org::ipdr::protocol::ProtocolStreamMsg::ProtocolStreamMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">org::ipdr::protocol::ProtocolStreamMsg::ProtocolStreamMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">byte&nbsp;</td>
          <td class="mdname" nowrap> <em>msgId</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>byte&nbsp;</td>
          <td class="mdname" nowrap> <em>sessionId</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>msgLength</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Construct from values <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>msgId</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sessionId</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>msgLength</em>&nbsp;</td><td>The number of bytes in the message (including header) </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00121         {
00122                 <span class="keyword">this</span>.protocolVersion = <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#s1">PROTOCOL_VERSION</a>;
00123                 <span class="keyword">this</span>.hdrMsgId = <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#a3">msgId</a>;
00124                 <span class="keyword">this</span>.sessionId = <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#o1">sessionId</a>;
00125                 <span class="keyword">this</span>.hdrFlags = 0;
00126                 <span class="keyword">this</span>.msgLength = <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#o3">msgLength</a>;
00127         }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="e5" doxytag="org::ipdr::protocol::ProtocolStreamMsg::construct"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static final <a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html">ProtocolStreamMsg</a> org::ipdr::protocol::ProtocolStreamMsg::construct           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">byte[]&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msg</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>  throws <a class="el" href="../../d4/d86/classorg_1_1ipdr_1_1protocol_1_1_protocol_malformed_msg_exception.html">ProtocolMalformedMsgException</a> 	<code> [inline, static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Factory method for constructing from raw bytes. This looks into the header and calls the appropriate sub-class <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>msg</em>&nbsp;</td><td>the raw bytes </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the Java-ized form of the message </dd></dl>
<div class="fragment"><pre class="fragment">00545         {
00546                 <span class="keywordflow">return</span> <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#e3">construct</a>(msg, msg.length);
00547         }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="e4" doxytag="org::ipdr::protocol::ProtocolStreamMsg::construct"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static final <a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html">ProtocolStreamMsg</a> org::ipdr::protocol::ProtocolStreamMsg::construct           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">byte[]&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/d5d/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_d_a_t_a.html">ProtocolMsgDATA</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>msgDATA</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2">  throws <a class="el" href="../../d4/d86/classorg_1_1ipdr_1_1protocol_1_1_protocol_malformed_msg_exception.html">ProtocolMalformedMsgException</a> 	<code> [inline, static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Factory method for constructing from raw bytes. This looks into the header and calls the appropriate sub-class <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>msg</em>&nbsp;</td><td>the raw bytes </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>the number of bytes in the message </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>msgDATA</em>&nbsp;</td><td>a pre-allocated DATA object, which can be used if if this is of that type -- null if you want one constructed. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the Java-ized form of the message </dd></dl>
<div class="fragment"><pre class="fragment">00478         {
00479                 <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#f0">verifyLength</a>(null, msg, length, <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#s0">HDR_LENGTH</a>);
00480                 byte <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#o0">protocolVersion</a> = <a class="code" href="../../d4/d6b/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg.html#s0">bigE</a>.getByte(msg, 0);
00481                 <span class="keywordflow">if</span> (protocolVersion != <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#s1">PROTOCOL_VERSION</a>)
00482                 {
00483                         <span class="keywordflow">throw</span> <span class="keyword">new</span> ProtocolMalformedMsgException(
00484                                 <span class="stringliteral">"Wrong protocol version: "</span> + protocolVersion,
00485                                 msg,
00486                                 length,
00487                                 0);
00488                 }
00489                 byte <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#a3">msgId</a> = <a class="code" href="../../d4/d6b/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg.html#s0">bigE</a>.getByte(msg, 1);
00490                 <span class="keywordflow">try</span>
00491                 {
00492                         <span class="keywordflow">switch</span> (msgId)
00493                         {
00494                                 <span class="keywordflow">case</span> ProtocolMsgCONNECT.MSG_ID :
00495                                         <span class="keywordflow">return</span> <span class="keyword">new</span> ProtocolMsgCONNECT(msg, length);
00496                                 <span class="keywordflow">case</span> ProtocolMsgCONNECT_RESPONSE.MSG_ID :
00497                                         <span class="keywordflow">return</span> <span class="keyword">new</span> ProtocolMsgCONNECT_RESPONSE(msg, length);
00498                                 <span class="keywordflow">case</span> ProtocolMsgDISCONNECT.MSG_ID :
00499                                         <span class="keywordflow">return</span> <span class="keyword">new</span> ProtocolMsgDISCONNECT(msg, length);
00500                                 <span class="keywordflow">case</span> ProtocolMsgKEEPALIVE.MSG_ID :
00501                                         <span class="keywordflow">return</span> <span class="keyword">new</span> ProtocolMsgKEEPALIVE(msg, length);
00502                                 <span class="keywordflow">case</span> ProtocolMsgTEMPLATE_DATA.MSG_ID :
00503                                         <span class="keywordflow">return</span> <span class="keyword">new</span> ProtocolMsgTEMPLATE_DATA(msg, length);
00504                                 <span class="keywordflow">case</span> ProtocolMsgMODIFY_TEMPLATE_RESPONSE.MSG_ID :
00505                                         <span class="keywordflow">return</span> <span class="keyword">new</span> ProtocolMsgMODIFY_TEMPLATE_RESPONSE(msg, length);
00506                                 <span class="keywordflow">case</span> ProtocolMsgSESSION_START.MSG_ID :
00507                                         <span class="keywordflow">return</span> <span class="keyword">new</span> ProtocolMsgSESSION_START(msg, length);
00508                                 <span class="keywordflow">case</span> ProtocolMsgSESSION_STOP.MSG_ID:
00509                                         <span class="keywordflow">return</span> <span class="keyword">new</span> ProtocolMsgSESSION_STOP(msg, length);
00510                                 <span class="keywordflow">case</span> ProtocolMsgDATA.MSG_ID :
00511                                         <span class="keywordflow">return</span> <span class="keyword">new</span> ProtocolMsgDATA(msg, length);
00512                                 <span class="keywordflow">case</span> ProtocolMsgSTART_NEGOTIATION_REJECT.MSG_ID:
00513                                                 <span class="keywordflow">return</span> <span class="keyword">new</span> ProtocolMsgSTART_NEGOTIATION_REJECT(msg, length);
00514                                 <span class="keywordflow">case</span> ProtocolMsgGET_SESSIONS_RESPONSE.MSG_ID:
00515                                     <span class="keywordflow">return</span> <span class="keyword">new</span> ProtocolMsgGET_SESSIONS_RESPONSE(msg, length);
00516                                 <span class="keywordflow">case</span> ProtocolMsgGET_TEMPLATES_RESPONSE.MSG_ID:
00517                                     <span class="keywordflow">return</span> <span class="keyword">new</span> ProtocolMsgGET_TEMPLATES_RESPONSE(msg, length);
00518                                 <span class="keywordflow">case</span> ProtocolMsgERROR.MSG_ID:
00519                                     <span class="keywordflow">return</span> <span class="keyword">new</span> ProtocolMsgERROR(msg, length);
00520                                 <span class="keywordflow">default</span> :
00521                                         <span class="keywordflow">throw</span> <span class="keyword">new</span> ProtocolMalformedMsgException(
00522                                                 <span class="stringliteral">"Message header invalid msgId="</span> + msgId,
00523                                                 msg,
00524                                                 length,
00525                                                 1);
00526                         }
00527                 }
00528                 <span class="keywordflow">catch</span> (IndexOutOfBoundsException e)
00529                 {
00530                         <span class="keywordflow">throw</span> <span class="keyword">new</span> ProtocolMalformedMsgException(
00531                                 <span class="stringliteral">"Error parsing message"</span>,
00532                                 msg,
00533                                 length,
00534                                 1);
00535                 }
00536         }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="e3" doxytag="org::ipdr::protocol::ProtocolStreamMsg::construct"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static final <a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html">ProtocolStreamMsg</a> org::ipdr::protocol::ProtocolStreamMsg::construct           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">byte[]&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>length</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2">  throws <a class="el" href="../../d4/d86/classorg_1_1ipdr_1_1protocol_1_1_protocol_malformed_msg_exception.html">ProtocolMalformedMsgException</a> 	<code> [inline, static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00460         {
00461                 <span class="keywordflow">return</span> <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#e3">construct</a>(msg, length, null);
00462         }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="e6" doxytag="org::ipdr::protocol::ProtocolStreamMsg::dumpHex"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static final void org::ipdr::protocol::ProtocolStreamMsg::dumpHex           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">byte[]&nbsp;</td>
          <td class="mdname" nowrap> <em>raw</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>offset</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>length</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [inline, static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Utility: dump a raw message in hex. 
<p>
<div class="fragment"><pre class="fragment">00606         {
00607                 LogManager.println(<span class="stringliteral">"dumping ..."</span>);
00608                 <span class="keyword">final</span> <span class="keywordtype">int</span> stride = 8;
00609                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; length &amp;&amp; i + offset &lt; raw.length; i += stride)
00610                 {
00611                         String line = <span class="stringliteral">""</span>;
00612                         <span class="keywordtype">int</span> pos = offset + i;
00613                         <span class="keywordflow">if</span> (i &lt; 10)
00614                         {
00615                                 line += <span class="stringliteral">"...   "</span> + i;
00616                         }
00617                         <span class="keywordflow">else</span>
00618                                 <span class="keywordflow">if</span> (i &lt; 100)
00619                                 {
00620                                         line += <span class="stringliteral">"...  "</span> + i;
00621                                 }
00622                                 <span class="keywordflow">else</span>
00623                                 {
00624                                         line += <span class="stringliteral">"... "</span> + i;
00625                                 }
00626                         <span class="keywordflow">if</span> (pos &lt; 10)
00627                         {
00628                                 line += <span class="stringliteral">" _   "</span> + pos;
00629                         }
00630                         <span class="keywordflow">else</span>
00631                                 <span class="keywordflow">if</span> (pos &lt; 100)
00632                                 {
00633                                         line += <span class="stringliteral">" _  "</span> + pos;
00634                                 }
00635                                 <span class="keywordflow">else</span>
00636                                 {
00637                                         line += <span class="stringliteral">" _ "</span> + pos;
00638                                 }
00639                         line += <span class="stringliteral">": "</span>;
00640                         String chars = <span class="stringliteral">""</span>;
00641                         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 8 &amp;&amp; i + j + offset &lt; raw.length; j++)
00642                         {
00643                                 <span class="keywordtype">int</span> v = raw[offset + i + j] &amp; 0xff;
00644                                 line += <span class="stringliteral">" "</span> + ((v &lt; 0x10) ? <span class="stringliteral">" "</span> : <span class="stringliteral">""</span>) + Integer.toHexString(v);
00645                                 <span class="keywordflow">if</span> (v &gt;= 0x20 &amp;&amp; v &lt;= 0xfe)
00646                                 {
00647                                         chars += (char) v;
00648                                 }
00649                                 <span class="keywordflow">else</span>
00650                                 {
00651                                         chars += <span class="charliteral">'?'</span>;
00652                                 }
00653                         }
00654                         LogManager.println(line + <span class="stringliteral">" ("</span> + chars + <span class="stringliteral">")"</span>);
00655                 }
00656         }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="org::ipdr::protocol::ProtocolStreamMsg::getSessionId"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">byte org::ipdr::protocol::ProtocolStreamMsg::getSessionId           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns the sessionId. <dl compact><dt><b>Returns:</b></dt><dd>byte </dd></dl>

<p>
Reimplemented in <a class="el" href="../../d9/d78/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_f_l_o_w___s_t_a_r_t.html#a3">org::ipdr::protocol::ProtocolMsgFLOW_START</a>, and <a class="el" href="../../dd/d11/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_s_e_s_s_i_o_n___s_t_o_p.html#a6">org::ipdr::protocol::ProtocolMsgSESSION_STOP</a>.<div class="fragment"><pre class="fragment">00727         {
00728                 <span class="keywordflow">return</span> <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#o1">sessionId</a>;
00729         }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b1" doxytag="org::ipdr::protocol::ProtocolStreamMsg::handleIndexOutOfBounds"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">final void org::ipdr::protocol::ProtocolStreamMsg::handleIndexOutOfBounds           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IndexOutOfBoundsException&nbsp;</td>
          <td class="mdname" nowrap> <em>e</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>byte[]&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>length</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2">  throws <a class="el" href="../../d4/d86/classorg_1_1ipdr_1_1protocol_1_1_protocol_malformed_msg_exception.html">ProtocolMalformedMsgException</a> 	<code> [inline, protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Helper method for dealing with out-of-bounds when processing raw data <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>e</em>&nbsp;</td><td>The exception </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>the buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>the length of message as given to the constructor </td></tr>
  </table>
</dl>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Turns</em>&nbsp;</td><td>this into a <a class="el" href="../../d4/d86/classorg_1_1ipdr_1_1protocol_1_1_protocol_malformed_msg_exception.html">ProtocolMalformedMsgException</a> </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00142         {
00143                 LogManager.stackTrace(e);
00144                 String msg =
00145                         <a class="code" href="../../d4/d6b/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg.html#a0">msgName</a>()
00146                                 + <span class="stringliteral">" message length of buffer ("</span>
00147                                 + length
00148                                 + <span class="stringliteral">") shorter than message contents"</span>;
00149                 <span class="keywordflow">if</span> (buf.length != length)
00150                 {
00151                         msg += <span class="stringliteral">" - with buffer containing "</span> + buf.length + <span class="stringliteral">" bytes"</span>;
00152                 }
00153                 msg += <span class="stringliteral">" ... "</span> + e;
00154                 <span class="keywordflow">throw</span> <span class="keyword">new</span> ProtocolMalformedMsgException(msg, buf, length, 0);
00155         }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="d0" doxytag="org::ipdr::protocol::ProtocolStreamMsg::initZero"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">final void org::ipdr::protocol::ProtocolStreamMsg::initZero           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline, private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set values to zero <div class="fragment"><pre class="fragment">00107         {
00108                 <span class="keyword">this</span>.protocolVersion = 0;
00109                 <span class="keyword">this</span>.hdrMsgId = 0;
00110                 <span class="keyword">this</span>.sessionId = 0;
00111                 <span class="keyword">this</span>.hdrFlags = 0;
00112                 <span class="keyword">this</span>.msgLength = 0;
00113         }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="h1" doxytag="org::ipdr::protocol::ProtocolStreamMsg::makeErrMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static final String org::ipdr::protocol::ProtocolStreamMsg::makeErrMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">String&nbsp;</td>
          <td class="mdname" nowrap> <em>whatDoing</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html">ProtocolStreamMsg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>responseTo</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [inline, static, private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00406         {
00407                 String errMsg = <span class="stringliteral">""</span>;
00408                 <span class="keywordflow">if</span> (whatDoing != null)
00409                 {
00410                         errMsg += whatDoing;
00411                 }
00412                 <span class="keywordflow">if</span> (responseTo != null)
00413                 {
00414                         errMsg += ((errMsg.length() &gt; 0) ? <span class="stringliteral">" - "</span> : <span class="stringliteral">""</span>) + responseTo;
00415                 }
00416                 <span class="keywordflow">return</span> errMsg;
00417         }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="org::ipdr::protocol::ProtocolStreamMsg::msgId"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">abstract byte org::ipdr::protocol::ProtocolStreamMsg::msgId           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [pure virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get the message id value. This is overridden by a subclass. 
<p>
Implemented in <a class="el" href="../../d2/d7f/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_c_o_n_n_e_c_t.html#a1">org::ipdr::protocol::ProtocolMsgCONNECT</a>, <a class="el" href="../../d5/df8/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_c_o_n_n_e_c_t___r_e_s_p_o_n_s_e.html#a1">org::ipdr::protocol::ProtocolMsgCONNECT_RESPONSE</a>, <a class="el" href="../../d4/d5d/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_d_a_t_a.html#a1">org::ipdr::protocol::ProtocolMsgDATA</a>, <a class="el" href="../../da/d23/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_d_a_t_a___a_c_k.html#a1">org::ipdr::protocol::ProtocolMsgDATA_ACK</a>, <a class="el" href="../../df/d23/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_d_i_s_c_o_n_n_e_c_t.html#a1">org::ipdr::protocol::ProtocolMsgDISCONNECT</a>, <a class="el" href="../../db/dcd/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_empty.html#a3">org::ipdr::protocol::ProtocolMsgEmpty</a>, <a class="el" href="../../db/d5a/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_e_r_r_o_r.html#a1">org::ipdr::protocol::ProtocolMsgERROR</a>, <a class="el" href="../../df/d89/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_f_i_n_a_l___t_e_m_p_l_a_t_e___d_a_t_a___a_c_k.html#a1">org::ipdr::protocol::ProtocolMsgFINAL_TEMPLATE_DATA_ACK</a>, <a class="el" href="../../d9/d78/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_f_l_o_w___s_t_a_r_t.html#a1">org::ipdr::protocol::ProtocolMsgFLOW_START</a>, <a class="el" href="../../dd/ddb/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_f_l_o_w___s_t_o_p.html#a1">org::ipdr::protocol::ProtocolMsgFLOW_STOP</a>, <a class="el" href="../../d5/d40/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_g_e_t___s_e_s_s_i_o_n_s.html#a1">org::ipdr::protocol::ProtocolMsgGET_SESSIONS</a>, <a class="el" href="../../dc/d45/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_g_e_t___s_e_s_s_i_o_n_s___r_e_s_p_o_n_s_e.html#a1">org::ipdr::protocol::ProtocolMsgGET_SESSIONS_RESPONSE</a>, <a class="el" href="../../d1/d2f/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_g_e_t___t_e_m_p_l_a_t_e_s.html#a1">org::ipdr::protocol::ProtocolMsgGET_TEMPLATES</a>, <a class="el" href="../../d6/d4d/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_g_e_t___t_e_m_p_l_a_t_e_s___r_e_s_p_o_n_s_e.html#a1">org::ipdr::protocol::ProtocolMsgGET_TEMPLATES_RESPONSE</a>, <a class="el" href="../../db/d02/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_k_e_e_p_a_l_i_v_e.html#a1">org::ipdr::protocol::ProtocolMsgKEEPALIVE</a>, <a class="el" href="../../dc/d78/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_m_o_d_i_f_y___t_e_m_p_l_a_t_e.html#a1">org::ipdr::protocol::ProtocolMsgMODIFY_TEMPLATE</a>, <a class="el" href="../../db/da2/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_m_o_d_i_f_y___t_e_m_p_l_a_t_e___r_e_s_p_o_n_s_e.html#a1">org::ipdr::protocol::ProtocolMsgMODIFY_TEMPLATE_RESPONSE</a>, <a class="el" href="../../dd/dba/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_s_e_s_s_i_o_n___s_t_a_r_t.html#a1">org::ipdr::protocol::ProtocolMsgSESSION_START</a>, <a class="el" href="../../dd/d11/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_s_e_s_s_i_o_n___s_t_o_p.html#a1">org::ipdr::protocol::ProtocolMsgSESSION_STOP</a>, <a class="el" href="../../d4/de2/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_s_t_a_r_t___n_e_g_o_t_i_a_t_i_o_n.html#a0">org::ipdr::protocol::ProtocolMsgSTART_NEGOTIATION</a>, <a class="el" href="../../d3/d17/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_s_t_a_r_t___n_e_g_o_t_i_a_t_i_o_n___r_e_j_e_c_t.html#a2">org::ipdr::protocol::ProtocolMsgSTART_NEGOTIATION_REJECT</a>, and <a class="el" href="../../d2/d61/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg_t_e_m_p_l_a_t_e___d_a_t_a.html#a1">org::ipdr::protocol::ProtocolMsgTEMPLATE_DATA</a>.    </td>
  </tr>
</table>
<a class="anchor" name="e2" doxytag="org::ipdr::protocol::ProtocolStreamMsg::readMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static final <a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html">ProtocolStreamMsg</a> org::ipdr::protocol::ProtocolStreamMsg::readMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../dc/d3c/classorg_1_1ipdr_1_1_connection_dynamic.html">ConnectionDynamic</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>connection</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>String&nbsp;</td>
          <td class="mdname" nowrap> <em>whatDoing</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html">ProtocolStreamMsg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>responseTo</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>timeoutMillisec</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2">  throws <a class="el" href="../../dd/d78/classorg_1_1ipdr_1_1api_1_1_connection_i_o_exception.html">ConnectionIOException</a>, <a class="el" href="../../d4/d86/classorg_1_1ipdr_1_1protocol_1_1_protocol_malformed_msg_exception.html">ProtocolMalformedMsgException</a> 	<code> [inline, static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00398         {
00399                 <span class="keywordflow">return</span> <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#e1">readMsg</a>(<span class="keyword">new</span> byte[0x100], <span class="comment">// should be big enough</span>
00400                 connection, whatDoing, responseTo, timeoutMillisec);
00401         }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="e1" doxytag="org::ipdr::protocol::ProtocolStreamMsg::readMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static final <a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html">ProtocolStreamMsg</a> org::ipdr::protocol::ProtocolStreamMsg::readMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">byte[]&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../dc/d3c/classorg_1_1ipdr_1_1_connection_dynamic.html">ConnectionDynamic</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>connection</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>String&nbsp;</td>
          <td class="mdname" nowrap> <em>whatDoing</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html">ProtocolStreamMsg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>responseTo</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>timeoutMillisec</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2">  throws <a class="el" href="../../dd/d78/classorg_1_1ipdr_1_1api_1_1_connection_i_o_exception.html">ConnectionIOException</a>, <a class="el" href="../../d4/d86/classorg_1_1ipdr_1_1protocol_1_1_protocol_malformed_msg_exception.html">ProtocolMalformedMsgException</a> 	<code> [inline, static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Read a message from input. This allocates a buffer each time, so it is less efficient than using <a class="el" href="../../">and remembering the buffer between calls.  in The input socket (e.g., new DataInputStream(socket.getInputStream()))  whatDoing A brief description of what this read is for; used to construct a meaningful exception (may be NULL)  responseTo The message to which this is a response (may be NULL)  timeoutMillisec zero for infinite wait  The internal form of the message </a><div class="fragment"><pre class="fragment">00354         {
00355 
00356                 <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#b0">ProtocolStreamMsg</a> result;
00357 
00358                 <span class="keywordflow">try</span>
00359                 {
00360                         buf = <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#h0">readRawMsg</a>(connection, buf, timeoutMillisec);
00361 
00362                         result = <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#e3">construct</a>(buf);
00363 
00364                         <span class="keywordflow">if</span> (result.shouldOutputToLog())
00365                         {
00366                                 LogManager.debug(
00367                                         <span class="stringliteral">"ProtocolMsg"</span>,
00368                                         <span class="stringliteral">"readMsg"</span>,
00369                                         <span class="stringliteral">"received from "</span>
00370                                                 + connection.toString()
00371                                                 + <span class="stringliteral">": "</span>
00372                                                 + result.toStringLong());
00373                         }
00374                 }
00375                 <span class="keywordflow">catch</span> (java.io.IOException e)
00376                 {
00377                         <span class="keywordflow">if</span> (e instanceof java.io.InterruptedIOException)
00378                         {
00379                                 result = <span class="keyword">new</span> ProtocolMsgEmpty();
00380                         }
00381                         <span class="keywordflow">else</span>
00382                         {
00383                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> ConnectionIOException(
00384                                         <span class="stringliteral">"I/O error while reading "</span>
00385                                                 + <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#h1">makeErrMsg</a>(whatDoing, responseTo),
00386                                         e);
00387                         }
00388                 }
00389                 <span class="keywordflow">return</span> result;
00390         }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="h0" doxytag="org::ipdr::protocol::ProtocolStreamMsg::readRawMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static final byte [] org::ipdr::protocol::ProtocolStreamMsg::readRawMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../dc/d3c/classorg_1_1ipdr_1_1_connection_dynamic.html">ConnectionDynamic</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>connection</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>byte[]&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>timeoutMillisec</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2">  throws java.io.IOException 	<code> [inline, static, private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Read an entire raw message, reallocating a buffer if needed. This routine is provided for efficiency; normally, you would use <a class="el" href="../../">This function is thread-safe on "in", which must not be null XXX It is not clear to what degree DataInputStream is buffered. If performance is inadequate, consider using BufferedReader or some other buffered input class.  in The input socket (e.g., new DataInputStream(socket.getInputStream()))  buf The buffer into which the data will be read. This can be zero length initially, if desired; but it is recommended to be larger. It is not guaranteed that the message will be put into this buffer; a separate buffer might be allocated and returned.  The buffer, reallocated larger if necessary.  EOFException is thrown if end-of-file is reached before reading an entire message - if this happens, the contents of the buffer are unpredictable. IOException is thrown for all other I/O errors.  ConnectionDynamic#readFully </a><div class="fragment"><pre class="fragment">00268         {
00269                 <span class="keywordflow">if</span> (buf.length &lt; <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#s0">HDR_LENGTH</a>)
00270                 {
00271                         buf = <span class="keyword">new</span> byte[<a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#s0">HDR_LENGTH</a>];
00272                 }
00273 
00274                 <span class="comment">// The following code assumes that readFully will block</span>
00275                 <span class="comment">// until all the message is read and that if it throws an</span>
00276                 <span class="comment">// exception, on re-read will get everything again (keeps</span>
00277                 <span class="comment">// things in a buffer - see {@link ConnectionDynamic#unread}).</span>
00278                 <span class="keyword">synchronized</span> (connection.getInputSynchronizer())
00279                 {
00280                         <span class="keywordtype">long</span> t1 = System.currentTimeMillis();
00281                         <span class="keywordflow">try</span>
00282                         {
00283                                 connection.readFully(buf, 0, <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#s0">HDR_LENGTH</a>, timeoutMillisec);
00284 <span class="comment">//                              LogManager.info(ProtocolStreamMsg.class, "readRawMsg",</span>
00285 <span class="comment">//                                      "In readRawMsg : after connection.readFully 1");</span>
00286 
00287                         }
00288                         <span class="keywordflow">catch</span> (java.io.InterruptedIOException ex)
00289                         {
00290                                 connection.unread(buf, 0, ex.bytesTransferred);
00291                                 ex.bytesTransferred = 0;
00292                                 <span class="keywordflow">throw</span> ex;
00293                         }
00294 
00295                         <span class="keywordtype">int</span> <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#o3">msgLength</a> = (int) (<a class="code" href="../../d4/d6b/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg.html#s0">bigE</a>.getUnsignedInt(buf, <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#v4">MSG_LENGTH_OFFSET</a>));
00296 
00297                         <span class="keywordflow">if</span> (buf.length &lt; msgLength)
00298                         {
00299                                 byte[] newbuf = <span class="keyword">new</span> byte[msgLength];
00300                                 System.arraycopy(buf, 0, newbuf, 0, <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#s0">HDR_LENGTH</a>);
00301                                 buf = newbuf;
00302                         }
00303 
00304                         <span class="keywordtype">int</span> timeout2;
00305                         <span class="keywordflow">if</span> (timeoutMillisec == 0)
00306                         {
00307                                 timeout2 = 0;
00308                         }
00309                         <span class="keywordflow">else</span>
00310                         {
00311                                 timeout2 =
00312                                         timeoutMillisec - (int) (System.currentTimeMillis() - t1);
00313                                 <span class="keywordflow">if</span> (timeout2 &lt;= 0)
00314                                 {
00315                                         timeout2 = 1; <span class="comment">// a very short timeout</span>
00316                                 }
00317                         }
00318                         <span class="keywordflow">try</span>
00319                         {
00320                                 connection.readFully(
00321                                         buf,
00322                                         <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#s0">HDR_LENGTH</a>,
00323                                         msgLength - <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#s0">HDR_LENGTH</a>,
00324                                         timeout2);
00325 
00326                         }
00327                         <span class="keywordflow">catch</span> (java.io.InterruptedIOException ex)
00328                         {
00329                                 connection.unread(buf, 0, <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#s0">HDR_LENGTH</a> + ex.bytesTransferred);
00330                                 ex.bytesTransferred = 0;
00331                                 <span class="keywordflow">throw</span> ex;
00332                         }
00333                 }
00334                 <span class="keywordflow">return</span> buf;
00335         }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="e0" doxytag="org::ipdr::protocol::ProtocolStreamMsg::round32"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static final int org::ipdr::protocol::ProtocolStreamMsg::round32           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>value</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline, static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Round the length to 4-byte alignment <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>length </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>rounded length </dd></dl>
<div class="fragment"><pre class="fragment">00191         {
00192                 <span class="keywordflow">return</span> (value + 3) &gt;&gt; 2 &lt;&lt; 2;
00193         }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="org::ipdr::protocol::ProtocolStreamMsg::sendMsg"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">final void org::ipdr::protocol::ProtocolStreamMsg::sendMsg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../dc/d3c/classorg_1_1ipdr_1_1_connection_dynamic.html">ConnectionDynamic</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>connection</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>  throws <a class="el" href="../../dd/d78/classorg_1_1ipdr_1_1api_1_1_connection_i_o_exception.html">ConnectionIOException</a> 	<code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Write a message to the socket. This method is thread-safe on "out", which must not be null. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>connection</em>&nbsp;</td><td>the connection </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00425         {
00426                 byte[] msg = null;
00427                 <span class="keywordflow">try</span>
00428                 {
00429                         msg = <a class="code" href="../../d4/d6b/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg.html#b0">createRawMsg</a>();
00430                 }
00431                 <span class="keywordflow">catch</span> (UnknownHostException e)
00432                 {
00433                         <span class="keywordflow">throw</span> <span class="keyword">new</span> ConnectionIOException(<span class="stringliteral">"Error while sending "</span> + <span class="keyword">this</span>, e);
00434                 }
00435 
00436                 <span class="keywordflow">if</span> (<span class="keyword">this</span>.<a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#a4">shouldOutputToLog</a>())
00437                 {
00438                         LogManager.debug(
00439                                 <span class="keyword">this</span>,
00440                                 <span class="stringliteral">"send"</span>,
00441                                 <span class="stringliteral">"Sending to "</span> + connection.addrAndPortToString() + <span class="stringliteral">": "</span> + <span class="keyword">this</span>);
00442                 }
00443                 <span class="keywordflow">try</span>
00444                 {
00445                         <span class="keyword">synchronized</span> (connection.getOutputSynchronizer())
00446                         {
00447                                 connection.write(msg);
00448                         }
00449                 }
00450                 <span class="keywordflow">catch</span> (java.io.IOException e)
00451                 {
00452                         <span class="keywordflow">throw</span> <span class="keyword">new</span> ConnectionIOException(
00453                                 <span class="stringliteral">"I/O error while sending "</span> + <span class="keyword">this</span>,
00454                                 e);
00455                 }
00456         }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="org::ipdr::protocol::ProtocolStreamMsg::set"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">final void org::ipdr::protocol::ProtocolStreamMsg::set           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">byte[]&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>requiredLength</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2">  throws <a class="el" href="../../d4/d86/classorg_1_1ipdr_1_1protocol_1_1_protocol_malformed_msg_exception.html">ProtocolMalformedMsgException</a> 	<code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Create the message from raw bytes <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>msg</em>&nbsp;</td><td>The raw message bytes </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>The number of bytes in the message </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>requiredLength</em>&nbsp;</td><td>The required number of bytes in the message </td></tr>
  </table>
</dl>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="../../d4/d86/classorg_1_1ipdr_1_1protocol_1_1_protocol_malformed_msg_exception.html">ProtocolMalformedMsgException</a></em>&nbsp;</td><td></td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00049         {
00050                 <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#d0">initZero</a>();
00051                 <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#f0">verifyLength</a>(<span class="keyword">this</span>, msg, length, requiredLength);
00052 
00053                 <span class="keywordflow">try</span>
00054                 {
00055                         <span class="keyword">this</span>.protocolVersion = <a class="code" href="../../d4/d6b/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg.html#s0">bigE</a>.getByte(msg, <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#v0">PROTOCOL_VERSION_OFFSET</a>);
00056                         <span class="keyword">this</span>.hdrMsgId = <a class="code" href="../../d4/d6b/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg.html#s0">bigE</a>.getByte(msg, <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#v1">MSGID_OFFSET</a>);
00057                         <span class="keyword">this</span>.sessionId = <a class="code" href="../../d4/d6b/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg.html#s0">bigE</a>.getByte(msg, <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#v2">SESSION_ID_OFFSET</a>);
00058                         <span class="keyword">this</span>.hdrFlags = <a class="code" href="../../d4/d6b/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg.html#s0">bigE</a>.getByte(msg, <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#v3">HDR_FLAGS_OFFSET</a>);
00059                         <span class="keyword">this</span>.msgLength = (int) <a class="code" href="../../d4/d6b/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg.html#s0">bigE</a>.getUnsignedInt(msg, <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#v4">MSG_LENGTH_OFFSET</a>);
00060                 }
00061                 <span class="keywordflow">catch</span> (IndexOutOfBoundsException e)
00062                 {
00063                         <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#b1">handleIndexOutOfBounds</a>(e, msg, length);
00064                         LogManager.stackTrace(e);
00065                 }
00066 
00067                 <span class="keywordflow">if</span> (<span class="keyword">this</span>.<a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#o0">protocolVersion</a> != <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#s1">PROTOCOL_VERSION</a>)
00068                 {
00069                         <span class="keywordflow">throw</span> <span class="keyword">new</span> ProtocolMalformedMsgException(
00070                                 <a class="code" href="../../d4/d6b/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg.html#a0">msgName</a>()
00071                                         + <span class="stringliteral">" protocol version("</span>
00072                                         + <span class="keyword">this</span>.<a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#o0">protocolVersion</a>
00073                                         + <span class="stringliteral">") not "</span>
00074                                         + <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#s1">PROTOCOL_VERSION</a>,
00075                                 msg,
00076                                 length,
00077                                 <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#v0">PROTOCOL_VERSION_OFFSET</a>);
00078                 }
00079 
00080                 <span class="keywordflow">if</span> (length &gt; msg.length)
00081                 {
00082                         <span class="keywordflow">throw</span> <span class="keyword">new</span> ProtocolMalformedMsgException(
00083                                 <a class="code" href="../../d4/d6b/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg.html#a0">msgName</a>()
00084                                         + <span class="stringliteral">" message length ("</span>
00085                                         + length
00086                                         + <span class="stringliteral">") greater than bytes.length ("</span>
00087                                         + msg.length
00088                                         + <span class="stringliteral">")"</span>,
00089                                 msg,
00090                                 length,
00091                                 <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#v4">MSG_LENGTH_OFFSET</a>);
00092                 }
00093         }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b4" doxytag="org::ipdr::protocol::ProtocolStreamMsg::setHeader"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">final void org::ipdr::protocol::ProtocolStreamMsg::setHeader           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">byte[]&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>msgData</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline, protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Fill in the header of the message. Typically this is not used directly but is used by sub-classes. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>msgData</em>&nbsp;</td><td>the message bytes to be filled </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>msgId</em>&nbsp;</td><td>CRANE protocol header message id </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sessionId</em>&nbsp;</td><td>CRANE protocol header session id </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>msgFlags</em>&nbsp;</td><td>CRANE protocol header flags (normally zero) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>msgLength</em>&nbsp;</td><td>CRANE protocol header length (normally msgData.length) </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00594         {
00595                 <a class="code" href="../../d4/d6b/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg.html#s0">bigE</a>.putByte(msgData, <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#v0">PROTOCOL_VERSION_OFFSET</a>, <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#s1">PROTOCOL_VERSION</a>);
00596                 <a class="code" href="../../d4/d6b/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg.html#s0">bigE</a>.putByte(msgData, <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#v1">MSGID_OFFSET</a>, <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#a3">msgId</a>());
00597                 <a class="code" href="../../d4/d6b/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg.html#s0">bigE</a>.putByte(msgData, <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#v2">SESSION_ID_OFFSET</a>, (byte) <span class="keyword">this</span>.<a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#o1">sessionId</a>);
00598                 <a class="code" href="../../d4/d6b/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg.html#s0">bigE</a>.putByte(msgData, <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#v3">HDR_FLAGS_OFFSET</a>, (byte) 0);
00599                 <a class="code" href="../../d4/d6b/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg.html#s0">bigE</a>.putUnsignedInt(msgData, <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#v4">MSG_LENGTH_OFFSET</a>, <span class="keyword">this</span>.<a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#o3">msgLength</a>);
00600         }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="org::ipdr::protocol::ProtocolStreamMsg::shouldOutputToLog"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">boolean org::ipdr::protocol::ProtocolStreamMsg::shouldOutputToLog           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Flag for whether we should we output a log message when sending or receiving. Subclasses may override this (i.e., DATA and DATA_ACK) will to check for "debug" level output. <div class="fragment"><pre class="fragment">00240         {
00241                 <span class="keywordflow">return</span> LogManager.info();
00242         }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b3" doxytag="org::ipdr::protocol::ProtocolStreamMsg::toStringBase"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">String org::ipdr::protocol::ProtocolStreamMsg::toStringBase           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline, protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
A human-readable form of the message. This is over-ridden by sub-classes, which typically use this (super.toString()) to get the header part. <dl compact><dt><b>Returns:</b></dt><dd>human-readable display </dd></dl>
<div class="fragment"><pre class="fragment">00555         {
00556                 <span class="keywordflow">return</span> <span class="stringliteral">"msg-"</span> + <a class="code" href="../../d4/d6b/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg.html#a0">msgName</a>() +
00557                 <span class="comment">// will get sub-class method for name, if it exists</span>
00558                 <span class="stringliteral">"["</span>
00559                         + ((<a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#o0">protocolVersion</a> == <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#s1">PROTOCOL_VERSION</a>)
00560                                 ? <span class="stringliteral">""</span>
00561                                 : <span class="stringliteral">"version="</span> + <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#o0">protocolVersion</a> + <span class="stringliteral">" "</span>)
00562                         + <span class="stringliteral">"sess="</span>
00563                         + <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#o1">sessionId</a>
00564                         + ((<a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#o2">hdrFlags</a> != 0) ? <span class="stringliteral">" flags="</span> + <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#o2">hdrFlags</a> : <span class="stringliteral">""</span>)
00565                         + <span class="stringliteral">"]"</span>;
00566         }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="org::ipdr::protocol::ProtocolStreamMsg::toStringLong"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">String org::ipdr::protocol::ProtocolStreamMsg::toStringLong           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
A longer human-readable message. Overridden by some sub-classes. <dl compact><dt><b>Returns:</b></dt><dd>human-readable string (long) </dd></dl>
<div class="fragment"><pre class="fragment">00572         {
00573                 <span class="keywordflow">return</span> <span class="stringliteral">"msg-"</span> + <a class="code" href="../../d4/d6b/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg.html#a0">msgName</a>() +
00574                 <span class="comment">// will get sub-class method for name, if it exists</span>
00575                 <span class="stringliteral">"[version="</span>
00576                         + <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#o0">protocolVersion</a>
00577                         + <span class="stringliteral">" sess="</span>
00578                         + <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#o1">sessionId</a>
00579                         + ((<a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#o2">hdrFlags</a> != 0) ? <span class="stringliteral">" flags="</span> + <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#o2">hdrFlags</a> : <span class="stringliteral">""</span>)
00580                         + <span class="stringliteral">" len="</span>
00581                         + <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#o3">msgLength</a>
00582                         + <span class="stringliteral">"]"</span>;
00583         }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="b2" doxytag="org::ipdr::protocol::ProtocolStreamMsg::trimToLength"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">final byte [] org::ipdr::protocol::ProtocolStreamMsg::trimToLength           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">byte[]&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>length</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [inline, protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Trim a byte vector to a particular length. This is a slightly inefficient routine, mainly for catching errors: it may reallocate the vector in the course of trimming. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>The input vector </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>The length to trim it to </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The original vector, if it was already of that length; an exception if the length is too long; otherwise a new vector of the exact length (with the contents of the input vector). </dd></dl>
<div class="fragment"><pre class="fragment">00207         {
00208                 byte[] result;
00209                 <span class="keywordflow">if</span> (length == buf.length)
00210                 {
00211                         result = buf;
00212                 }
00213                 <span class="keywordflow">else</span>
00214                         <span class="keywordflow">if</span> (length &gt; buf.length)
00215                         {
00216                                 <span class="keywordflow">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException(
00217                                         <span class="stringliteral">"Specified length "</span>
00218                                                 + length
00219                                                 + <span class="stringliteral">" to a byte vector of length "</span>
00220                                                 + buf.length);
00221                         }
00222                         <span class="keywordflow">else</span>
00223                         {
00224                                 result = <span class="keyword">new</span> byte[length];
00225                                 System.arraycopy(buf, 0, result, 0, length);
00226                         }
00227                 <span class="keywordflow">return</span> result;
00228         }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="e8" doxytag="org::ipdr::protocol::ProtocolStreamMsg::unimplemented"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void org::ipdr::protocol::ProtocolStreamMsg::unimplemented           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Object&nbsp;</td>
          <td class="mdname" nowrap> <em>o</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>String&nbsp;</td>
          <td class="mdname" nowrap> <em>function</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2">  throws UnsupportedOperationException 	<code> [inline, static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Output a message about an unimplemented method and throw an appropriate execption. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>o</em>&nbsp;</td><td>The object whose method is unimplemented. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>function</em>&nbsp;</td><td>The name of the function (method). </td></tr>
  </table>
</dl>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>UnsupportedOperationException</em>&nbsp;</td><td>Always thrown. </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00719         {
00720                 <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#e7">unimplemented</a>(o.getClass().getName(), function);
00721         }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="e7" doxytag="org::ipdr::protocol::ProtocolStreamMsg::unimplemented"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void org::ipdr::protocol::ProtocolStreamMsg::unimplemented           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">String&nbsp;</td>
          <td class="mdname" nowrap> <em>className</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>String&nbsp;</td>
          <td class="mdname" nowrap> <em>function</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2">  throws UnsupportedOperationException 	<code> [inline, static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Output a message about an unimplemented method and throw an appropriate execption. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>className</em>&nbsp;</td><td>The name of the class. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>function</em>&nbsp;</td><td>The name of the function (method). </td></tr>
  </table>
</dl>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>UnsupportedOperationException</em>&nbsp;</td><td>Always thrown. </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00706         {
00707                 <span class="keywordflow">throw</span> <span class="keyword">new</span> UnsupportedOperationException(
00708                         <span class="stringliteral">"Not implemented ("</span> + className + <span class="stringliteral">"."</span> + function + <span class="stringliteral">")"</span>);
00709         }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="f0" doxytag="org::ipdr::protocol::ProtocolStreamMsg::verifyLength"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static final void org::ipdr::protocol::ProtocolStreamMsg::verifyLength           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../de/d83/interfaceorg_1_1ipdr_1_1protocol_1_1_protocol_msg_identification.html">ProtocolMsgIdentification</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>id</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>byte[]&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>bufLength</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>requiredLength</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2">  throws <a class="el" href="../../d4/d86/classorg_1_1ipdr_1_1protocol_1_1_protocol_malformed_msg_exception.html">ProtocolMalformedMsgException</a> 	<code> [inline, static, protected]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Verify the length and throw an exception if wrong <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>id</em>&nbsp;</td><td>the object that provides identification methods (may be null) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>the raw message buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>bufLength</em>&nbsp;</td><td>the message buffer length </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>requiredLength</em>&nbsp;</td><td>the minimum size of the message </td></tr>
  </table>
</dl>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="../../d4/d86/classorg_1_1ipdr_1_1protocol_1_1_protocol_malformed_msg_exception.html">ProtocolMalformedMsgException</a></em>&nbsp;</td><td>if bufLength &lt; requiredLength </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00170         {
00171                 requiredLength = <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#e0">round32</a>(requiredLength);
00172                 <span class="keywordflow">if</span> (bufLength &lt; requiredLength)
00173                 {
00174                         <span class="keywordflow">throw</span> <span class="keyword">new</span> ProtocolMalformedMsgException(
00175                                 ((<span class="keywordtype">id</span> == null) ? <span class="stringliteral">"???"</span> : <span class="keywordtype">id</span>.<a class="code" href="../../d4/d6b/classorg_1_1ipdr_1_1protocol_1_1_protocol_msg.html#a0">msgName</a>())
00176                                         + <span class="stringliteral">" message too short (must be at least "</span>
00177                                         + requiredLength
00178                                         + <span class="stringliteral">")"</span>,
00179                                 buf,
00180                                 bufLength,
00181                                 <a class="code" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#v4">MSG_LENGTH_OFFSET</a> + ProtocolData.unsignedIntSize);
00182                 }
00183         }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Field Documentation</h2>
<a class="anchor" name="v3" doxytag="org::ipdr::protocol::ProtocolStreamMsg::HDR_FLAGS_OFFSET"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">final int <a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#v3">org::ipdr::protocol::ProtocolStreamMsg::HDR_FLAGS_OFFSET</a> = 3<code> [static, private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="s0" doxytag="org::ipdr::protocol::ProtocolStreamMsg::HDR_LENGTH"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">final int <a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#s0">org::ipdr::protocol::ProtocolStreamMsg::HDR_LENGTH</a> = 8<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The minimum length of a message (header only). 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="o2" doxytag="org::ipdr::protocol::ProtocolStreamMsg::hdrFlags"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">byte <a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#o2">org::ipdr::protocol::ProtocolStreamMsg::hdrFlags</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<a class="el" href="../../d4/daa/struct_message.html">Message</a> header flags (ignored in version 1 and 2 of the protocol)     </td>
  </tr>
</table>
<a class="anchor" name="v4" doxytag="org::ipdr::protocol::ProtocolStreamMsg::MSG_LENGTH_OFFSET"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">final int <a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#v4">org::ipdr::protocol::ProtocolStreamMsg::MSG_LENGTH_OFFSET</a> = 4<code> [static, private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="v1" doxytag="org::ipdr::protocol::ProtocolStreamMsg::MSGID_OFFSET"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">final int <a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#v1">org::ipdr::protocol::ProtocolStreamMsg::MSGID_OFFSET</a> = 1<code> [static, private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="o3" doxytag="org::ipdr::protocol::ProtocolStreamMsg::msgLength"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#o3">org::ipdr::protocol::ProtocolStreamMsg::msgLength</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<a class="el" href="../../d4/daa/struct_message.html">Message</a> length, from the header. The header shows an unsigned 32 but Java won't let us construct a byte array with a "long", so let's leave this as an "int" (2^31 is a pretty big message in CRANE anyway!).     </td>
  </tr>
</table>
<a class="anchor" name="s1" doxytag="org::ipdr::protocol::ProtocolStreamMsg::PROTOCOL_VERSION"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">final byte <a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#s1">org::ipdr::protocol::ProtocolStreamMsg::PROTOCOL_VERSION</a> = 2<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The version of the CRANE protocol that we support. 
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="v0" doxytag="org::ipdr::protocol::ProtocolStreamMsg::PROTOCOL_VERSION_OFFSET"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">final int <a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#v0">org::ipdr::protocol::ProtocolStreamMsg::PROTOCOL_VERSION_OFFSET</a> = 0<code> [static, private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="o0" doxytag="org::ipdr::protocol::ProtocolStreamMsg::protocolVersion"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">short <a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#o0">org::ipdr::protocol::ProtocolStreamMsg::protocolVersion</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The protocol Version     </td>
  </tr>
</table>
<a class="anchor" name="v2" doxytag="org::ipdr::protocol::ProtocolStreamMsg::SESSION_ID_OFFSET"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">final int <a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#v2">org::ipdr::protocol::ProtocolStreamMsg::SESSION_ID_OFFSET</a> = 2<code> [static, private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="o1" doxytag="org::ipdr::protocol::ProtocolStreamMsg::sessionId"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">byte <a class="el" href="../../db/d66/classorg_1_1ipdr_1_1protocol_1_1_protocol_stream_msg.html#o1">org::ipdr::protocol::ProtocolStreamMsg::sessionId</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The session identifier     </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following file:<ul>
<li>ipdr/Collector/org/ipdr/protocol/<a class="el" href="../../d8/dfb/_protocol_stream_msg_8java.html">ProtocolStreamMsg.java</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Mon Apr 25 09:27:06 2005 for IPDRAPI by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.2 </small></address>
</body>
</html>
