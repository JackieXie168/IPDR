<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Cookbook: Define templates</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.2 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>Cookbook: Define templates<br>
<small>
[<a class="el" href="group___i_p_d_r__cookbook.html">Cookbook: How to build a IPDR Exporter</a>]</small>
</h1><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
</table>
After you have determined what data needs to be transmitted and the broad form of its format (see <a class="el" href="group___i_p_d_r__cookbookcollectors.html">Cookbook: Determine downstream processing needs</a>).<p>
If you are starting from scratch, you simply define a C or C++ structure which contains the data that you wish to send. Continuing with the example given in <a class="el" href="group___i_p_d_r__cookbookcollectors.html">Cookbook: Determine downstream processing needs</a>, there could be two C structures: <br>
<code>&nbsp;&nbsp;struct&nbsp;message&nbsp;{ <br>
&nbsp;&nbsp;&nbsp;&nbsp;char&nbsp;type;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;'M'&nbsp;for&nbsp;message <br>
&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;&nbsp;timestamp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;seconds&nbsp;since&nbsp;00:00:00&nbsp;UTC&nbsp;1&nbsp;January&nbsp;1970 <br>
&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;&nbsp;msgID;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;unique&nbsp;for&nbsp;each&nbsp;message <br>
&nbsp;&nbsp;&nbsp;&nbsp;char&nbsp;sender[100];&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;null-terminated <br>
}</code> <br>
<code>&nbsp;&nbsp;struct&nbsp;recipientDetail&nbsp;{ <br>
&nbsp;&nbsp;&nbsp;&nbsp;char&nbsp;type;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;'R'&nbsp;for&nbsp;recipient <br>
&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;&nbsp;msgID;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;unique&nbsp;for&nbsp;each&nbsp;message <br>
&nbsp;&nbsp;&nbsp;&nbsp;char&nbsp;recipient[100];&nbsp;//&nbsp;null-terminated <br>
&nbsp;&nbsp;}</code><p>
Next, a unique identifier must be defined for each field: <br>
<code>&nbsp;&nbsp;enum&nbsp;{ <br>
&nbsp;&nbsp;&nbsp;&nbsp;typeKeyID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1; <br>
&nbsp;&nbsp;&nbsp;&nbsp;timestampKeyID&nbsp;=&nbsp;2;&nbsp; <br>
&nbsp;&nbsp;&nbsp;&nbsp;msgIDKeyID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3; <br>
&nbsp;&nbsp;&nbsp;&nbsp;senderKeyID&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4; <br>
&nbsp;&nbsp;&nbsp;&nbsp;receipient_id&nbsp;&nbsp;=&nbsp;5; <br>
&nbsp;&nbsp;</code>}<p>
This information must be communicated to the IPDR transmitter (client), using the <a class="el" href="struct_i_p_d_r___key.html">IPDR_Key</a> data type. For example, the "sender" field would be defined: <br>
<code>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;senderKeyID,&nbsp;XDR_TYPE_STRING,&nbsp;"sender",&nbsp;"",&nbsp;"",&nbsp;0, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IPDR_ACCESS_BY_OFFSET,&nbsp;NULL, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(IPDR_KeyAccessor(offsetof(struct&nbsp;message,&nbsp;sender)))&nbsp;</code>}<p>
These key definitions are combined into templates and passed to the <a class="el" href="group___i_p_d_r__templates.html#ga5">IPDR_CreateTemplate()</a> function. The result is a "template handle", which is used when calling <a class="el" href="group___i_p_d_r__data__delivery.html#ga0">IPDR_SendData()</a>.<p>
Not all situations can be handled so simply. If the internal record structure does not match the desired output format, there are two possible solutions: <ol>
<li>
Create records in the desired format, copy the fields into them, and output directly. </li>
<li>
Use the <a class="el" href="group___i_p_d_r__key__type__attributes.html#ga22">IPDR_ACCESS_BY_FUNCTION</a> option, with a <a class="el" href="group___i_p_d_r__key__type__attributes.html#ga0">IPDR_KeyAccessor</a> function to return a pointer to the data. </li>
</ol>
<hr size="1"><address style="align: right;"><small>Generated on Mon May 30 15:54:41 2005 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.2 </small></address>
</body>
</html>
