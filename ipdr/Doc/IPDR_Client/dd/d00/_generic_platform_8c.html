<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>IPDRAPI: For Doxygen/src/Platforms/Generic/GenericPlatform.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.2 -->
<div class="qindex"><a class="qindex" href="../../index.html">Main&nbsp;Page</a> | <a class="qindex" href="../../modules.html">Modules</a> | <a class="qindex" href="../../namespaces.html">Namespace List</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="../../dirs.html">Directories</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="../../globals.html">Globals</a></div>
<div class="nav">
<a class="el" href="../../dir_000000.html">For Doxygen</a>&nbsp;/&nbsp;<a class="el" href="../../dir_000003.html">src</a>&nbsp;/&nbsp;<a class="el" href="../../dir_000008.html">Platforms</a>&nbsp;/&nbsp;<a class="el" href="../../dir_000009.html">Generic</a></div>
<h1>GenericPlatform.c File Reference</h1><code>#include &lt;<a class="el" href="../../d4/d71/_config_8h.html">IPDR/Config.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="../../df/d23/_generic_platform_8h.html">Platforms/Generic/GenericPlatform.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="../../d2/dc9/_platform_8h.html">Common/Platform.h</a>&gt;</code><br>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &lt;fcntl.h&gt;</code><br>
<code>#include &lt;errno.h&gt;</code><br>
<code>#include &lt;sys/stat.h&gt;</code><br>
<code>#include &lt;sys/types.h&gt;</code><br>
<code>#include &lt;signal.h&gt;</code><br>
<code>#include &lt;time.h&gt;</code><br>
<code>#include "<a class="el" href="../../d5/d93/_transport_8h.html">Common/Transport.h</a>"</code><br>
<code>#include &lt;unistd.h&gt;</code><br>
<code>#include "<a class="el" href="../../db/d1e/_protocol_8h.html">Common/Protocol.h</a>"</code><br>
<code>#include &lt;sys/socket.h&gt;</code><br>
<code>#include &lt;netinet/in.h&gt;</code><br>
<code>#include &lt;poll.h&gt;</code><br>
<code>#include &lt;<a class="el" href="../../da/d39/_i_p_d_r_8h.html">IPDR/IPDR.h</a>&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a0">CAST_VOID</a>(Type, P)&nbsp;&nbsp;&nbsp;((Type)(P))</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a1">ABORT_CALL</a>&nbsp;&nbsp;&nbsp;abort()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a2">Str</a>(x)&nbsp;&nbsp;&nbsp;#x</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a3">Xstr</a>(x)&nbsp;&nbsp;&nbsp;Str(x)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a4">LOG_WRITE</a>(e, lvl, msg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a5">LOG_WRITE1</a>(e, lvl, msg, a1)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a6">LOG_WRITE2</a>(e, lvl, msg, a1, a2)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a7">LOG_WRITE3</a>(e, lvl, msg, a1, a2, a3)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a8">LOG_WRITE4</a>(e, lvl, msg, a1, a2, a3, a4)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a9">LOG_WRITE5</a>(e, lvl, msg, a1, a2, a3, a4, a5)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a10">LOG_WRITE6</a>(e, lvl, msg, a1, a2, a3, a4, a5, a6)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a11">EWOULDBLOCK</a>&nbsp;&nbsp;&nbsp;EAGAIN</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a12">MAX_SELECT_ITERATIONS</a>&nbsp;&nbsp;&nbsp;128</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a13">RECEIVE_TIMEOUT</a>&nbsp;&nbsp;&nbsp;5000</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a14">MAX_ERROR_STRING_LENGTH</a>&nbsp;&nbsp;&nbsp;1024</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a15">MAX_TIMEWAIT</a>&nbsp;&nbsp;&nbsp;500000</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a16">TIME_SKEW_DELTA</a>&nbsp;&nbsp;&nbsp;10000</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a17">CONST_CAST_CHARPTR</a>(B)&nbsp;&nbsp;&nbsp;(B)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a18">CAST_CHARVOIDPTR</a>(B)&nbsp;&nbsp;&nbsp;((void*)(B))</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a19">ERRNO_EWOULDBLOCK</a>&nbsp;&nbsp;&nbsp;(errno == EWOULDBLOCK)</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a30">GenericPlatform_InitializeInternal</a> (<a class="el" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html">IPDR_PlatformServices</a> *PS)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a31">GenericPlatform_MainFunc</a> (void *P)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a32">GenericPlatform_CreateLock</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> P, void **LockPtr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a33">GenericPlatform_DeleteLock</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> P, void *LockPtr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a34">GenericPlatform_Lock</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> P, void *LockPtr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a35">GenericPlatform_Unlock</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> P, void *LockPtr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a36">GenericPlatform_LockPlatform</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> P)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a37">GenericPlatform_UnlockPlatform</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> P)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a38">GenericPlatform_SleepMS</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> P, long interval)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a39">GenericPlatform_MemoryFree</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> E, void *Buf)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a40">GenericPlatform_FormatTimeSyslogNow</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> P, char *buf)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a41">GenericPlatform_FormatTimeLocalNow</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> P, char *buf)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a42">GenericPlatform_FormatTimeLocal</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> P, <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga10">IPDR_Time</a> c, char *buf)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a43">GenericPlatform_FormatTimeGMTNow</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> P, char *buf)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a44">GenericPlatform_FormatTimeGMT</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> P, <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga10">IPDR_Time</a> c, char *buf)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a45">GenericPlatform_GetTV</a> (struct timeval *TV)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a46">BlockSigPipe</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">GenericST</a> *E)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a47">GenericPlatform_Start</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> E)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a48">GenericPlatform_Stop</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> E)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../df/dde/_defs_8h.html#a16">IPDR_BOOL</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a49">GenericPlatform_IsRunning</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> E)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a50">GenericPlatform_Delete</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> E)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a51">GenericPlatform_GetLastErrorMessage</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> P, char *Msg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a52">GenericPlatform_SetExporterHandle</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> E, <a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a> CH)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a53">GenericPlatform_UnsetExporterHandle</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> E)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a54">GenericPlatform_Initialize</a> (<a class="el" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html">IPDR_PlatformServices</a> *PS)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a55">GenericPlatform_MemoryAllocate</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> E, size_t Size, void **Buf)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a56">GenericPlatform_MemoryAllocateWithHdr</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> E, size_t HdrSize, size_t Size, void **Buf)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a57">GenericPlatform_MemoryFreeWithHdr</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> E, size_t HdrSize, void *Buf)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a58">GenericPlatform_MemoryStatistics</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> E, unsigned int *numAllocs, unsigned int *numFrees, size_t *bytesAllocated)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a59">GenericPlatform_RegisterTimer</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> E, <a class="el" href="../../d3/d9b/group___i_p_d_r__event__services.html#ga0">IPDR_TimerCallback_t</a> Callback, void *Arg, int Timeout, <a class="el" href="../../d7/d03/struct_i_p_d_r__tag___timer.html">IPDR_TimerID</a> *T)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a60">GenericPlatform_ReregisterTimer</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> E, <a class="el" href="../../d3/d9b/group___i_p_d_r__event__services.html#ga0">IPDR_TimerCallback_t</a> Callback, void *Arg, int Timeout, <a class="el" href="../../d7/d03/struct_i_p_d_r__tag___timer.html">IPDR_TimerID</a> *T)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a61">GenericPlatform_RegisterPeriodicTimer</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> E, <a class="el" href="../../d3/d9b/group___i_p_d_r__event__services.html#ga0">IPDR_TimerCallback_t</a> Callback, void *Arg, int Timeout, <a class="el" href="../../d7/d03/struct_i_p_d_r__tag___timer.html">IPDR_TimerID</a> *T)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a62">GenericPlatform_RegisterReadSocket</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> E, <a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a> FD, <a class="el" href="../../d3/d9b/group___i_p_d_r__event__services.html#ga5">IPDR_SocketCallback_t</a> Callback, void *Arg, <a class="el" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html">IPDR_SocketEventID</a> *ID)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a63">GenericPlatform_RegisterWriteSocket</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> E, <a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a> FD, <a class="el" href="../../d3/d9b/group___i_p_d_r__event__services.html#ga5">IPDR_SocketCallback_t</a> Callback, void *Arg, <a class="el" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html">IPDR_SocketEventID</a> *ID)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a64">GenericPlatform_UnregisterTimer</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> E, <a class="el" href="../../d7/d03/struct_i_p_d_r__tag___timer.html">IPDR_TimerID</a> T)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a65">GenericPlatform_UnregisterSocket</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> E, <a class="el" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html">IPDR_SocketEventID</a> ID)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a66">GenericPlatform_PersistentRetrieve</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> E, const char *UnitName, char **Buffer, unsigned int *BufferLength)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a67">GenericPlatform_PersistentStore</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> P, const char *UnitName, const char *Buffer, unsigned int BufferLength)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a68">GenericPlatform_CreateTCPSocket</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> E, <a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a> *S)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a69">GenericPlatform_CreateUDPSocket</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> P, <a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a> *S)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a70">GenericPlatform_Connect</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> P, <a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a> S, <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga9">IPDR_IPAddress</a> LocalAddr, unsigned short LocalPort)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a71">GenericPlatform_GetSockName</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> P, <a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a> S, <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga9">IPDR_IPAddress</a> *LocalAddr, unsigned short *LocalPort)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a72">GenericPlatform_Bind</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> P, <a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a> S, <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga9">IPDR_IPAddress</a> LocalAddr, unsigned short LocalPort)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a73">GenericPlatform_Close</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> P, <a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a> S)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a74">GenericPlatform_Listen</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> P, <a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a> S, int Backlog)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a75">GenericPlatform_Accept</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> E, <a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a> S, <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga9">IPDR_IPAddress</a> *Addr, unsigned short *Port, <a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a> *AcceptSocket)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a76">GenericPlatform_SetExporterSocketParams</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> E, <a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a> S, <a class="el" href="../../d3/d96/group___i_p_d_r__initialization__starting__deletion.html#ga0">IPDR_ParametersHandlerFunc</a> ParamFunc, void *ParamArg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a77">GenericPlatform_Send</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> E, <a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a> S, const char *Buf, unsigned int BufLength, unsigned int *WrittenBytes)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a78">GenericPlatform_Recv</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> E, <a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a> S, char *Buf, unsigned int BufLength, int Timeout, unsigned int *ReadBytes)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a79">GenericPlatform_RecvFrom</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> E, <a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a> S, char *Buf, unsigned int BufferLength, <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga9">IPDR_IPAddress</a> *RemoteAddr, unsigned short *RemotePort, unsigned int *ReadBytes)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a80">GenericPlatform_SendTo</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> P, <a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a> S, const char *Buf, unsigned int BufferLength, <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga9">IPDR_IPAddress</a> RemoteAddr, unsigned short RemotePort)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a81">GenericPlatform_Shutdown</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> P, <a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a> S)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a82">GenericPlatform_GetHostName</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> P, char *HostName, int NameLength)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a83">GenericPlatform_GetTime</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> P, <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga10">IPDR_Time</a> *T)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a84">GenericPlatform_SetTime</a> (<a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> P, <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga10">IPDR_Time</a> T)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a85">FormatTime</a> (char *buf, struct tm *tmPtr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d2f/group___i_p_d_r__transitional__typedefs.html#ga1">IPDR_SetInvalidSocket</a> (<a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a> *S)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d2f/group___i_p_d_r__transitional__typedefs.html#ga2">IPDR_IsValidSocket</a> (const <a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a> S)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../df/dde/_defs_8h.html#a16">IPDR_BOOL</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d2f/group___i_p_d_r__transitional__typedefs.html#ga3">IPDR_SocketEq</a> (const <a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a> S1, const <a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a> S2)</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a20">GenericPlatform_rcsid</a> [] = "@(#) $Id: GenericPlatform.c,v 1.28 2005/04/21 11:31:07 dmitryk Exp $" IPDR_COPYRIGHT_STR</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a21">GenericPlatform_h_rcsid</a> [] = GENERIC_PLATFORM_H_RCSID</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a22">Platform_h_rcsid</a> [] = PLATFORM_H_RCSID</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static struct timeval&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a23">ZeroTV</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d6/d67/struct_i_p_d_r___memory_services.html">IPDR_MemoryServices</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a24">GenericPlatform_MemoryServices</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../de/d0c/struct_i_p_d_r___event_services.html">IPDR_EventServices</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a25">GenericPlatform_EventServices</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d9/da7/struct_i_p_d_r___persistence_services.html">IPDR_PersistenceServices</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a26">GenericPlatform_PersistenceServices</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d0/d1b/struct_i_p_d_r___network_services.html">IPDR_NetworkServices</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a27">GenericPlatform_NetworkServices</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d2/d70/struct_i_p_d_r___locking_services.html">IPDR_LockingServices</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a28">GenericPlatform_LockingServices</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d3/d2e/struct_i_p_d_r___time_services.html">IPDR_TimeServices</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d00/_generic_platform_8c.html#a29">GenericPlatform_TimeServices</a></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
The generic implementation of the platform abstraction layer. This contains code for Solaris, Linux, and VxWorks. There is some code for Windows, but it is obsolete and not to be trusted.<p>
Copyright (2005) © Amdocs, All Rights Reserved<p>
This software is distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND either expresses or implied.<p>
<dl compact><dt><b>Id</b></dt><dd><a class="el" href="../../dd/d00/_generic_platform_8c.html">GenericPlatform.c</a>,v 1.28 2005/04/21 11:31:07 dmitryk Exp </dd></dl>
<p>
<dl compact><dt><b>Note:</b></dt><dd>There is a dependency between this code and Common/MemoryManagement.h (and Common/MemoryManagement.h), in the layout of object headers. </dd></dl>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a1" doxytag="GenericPlatform.c::ABORT_CALL"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define ABORT_CALL&nbsp;&nbsp;&nbsp;abort()          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="GenericPlatform.c::CAST_CHARVOIDPTR"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define CAST_CHARVOIDPTR          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">B&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;((void*)(B))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="GenericPlatform.c::CAST_VOID"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define CAST_VOID          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Type,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>P&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;((Type)(P))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="GenericPlatform.c::CONST_CAST_CHARPTR"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define CONST_CAST_CHARPTR          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">B&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(B)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="GenericPlatform.c::ERRNO_EWOULDBLOCK"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define ERRNO_EWOULDBLOCK&nbsp;&nbsp;&nbsp;(errno == EWOULDBLOCK)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="GenericPlatform.c::EWOULDBLOCK"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define EWOULDBLOCK&nbsp;&nbsp;&nbsp;EAGAIN          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="GenericPlatform.c::LOG_WRITE"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define LOG_WRITE          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">e,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>lvl,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>msg&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">{                                                \
  <span class="keywordflow">if</span> ((e) &amp;&amp; (e)-&gt;ExporterHandleRegistered) {                                     \
    <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#ga3">IPDR_LogWrite</a>((e)-&gt;ExporterHandle, <span class="stringliteral">"Platform"</span>, lvl,                          \
                   __FILE__ <span class="stringliteral">":"</span> <a class="code" href="../../d9/d0f/_exporter_console_8c.html#a1">Xstr</a>(__LINE__), msg);                           \
  } <span class="keywordflow">else</span> {                                                                      \
    <span class="keywordtype">char</span> b[<a class="code" href="../../d5/d74/group___i_p_d_r__time__services.html#ga8">IPDR_TIME_FORMAT_LENGTH</a>+1];                                         \
    fprintf(stderr, <span class="stringliteral">"*** %.49s: "</span> msg <span class="stringliteral">" ("</span> __FILE__ <span class="stringliteral">":"</span> <a class="code" href="../../d9/d0f/_exporter_console_8c.html#a1">Xstr</a>(__LINE__) <span class="stringliteral">")\n"</span>,   \
            <a class="code" href="../../dd/d00/_generic_platform_8c.html#a43">GenericPlatform_FormatTimeGMTNow</a>((e), b));                          \
    fflush(stderr);                                                             \
  }                                                                             \
}
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="GenericPlatform.c::LOG_WRITE1"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define LOG_WRITE1          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">e,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>lvl,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>msg,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>a1&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">{                                           \
  <span class="keywordflow">if</span> ((e) &amp;&amp; (e)-&gt;ExporterHandleRegistered) {                                     \
    <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#ga3">IPDR_LogWrite</a>((e)-&gt;ExporterHandle, <span class="stringliteral">"Platform"</span>, lvl,                          \
                   __FILE__ <span class="stringliteral">":"</span> <a class="code" href="../../d9/d0f/_exporter_console_8c.html#a1">Xstr</a>(__LINE__), msg, a1);                       \
  } <span class="keywordflow">else</span> {                                                                      \
    <span class="keywordtype">char</span> b[<a class="code" href="../../d5/d74/group___i_p_d_r__time__services.html#ga8">IPDR_TIME_FORMAT_LENGTH</a>+1];                                         \
    fprintf(stderr, <span class="stringliteral">"*** %.49s: "</span> msg <span class="stringliteral">" ("</span> __FILE__ <span class="stringliteral">":"</span> <a class="code" href="../../d9/d0f/_exporter_console_8c.html#a1">Xstr</a>(__LINE__) <span class="stringliteral">")\n"</span>,   \
            <a class="code" href="../../dd/d00/_generic_platform_8c.html#a43">GenericPlatform_FormatTimeGMTNow</a>((e), b),                           \
            a1);                                                                \
    fflush(stderr);                                                             \
  }                                                                             \
}
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="GenericPlatform.c::LOG_WRITE2"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define LOG_WRITE2          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">e,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>lvl,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>msg,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>a1,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>a2&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">{                                        \
  <span class="keywordflow">if</span> ((e) &amp;&amp; (e)-&gt;ExporterHandleRegistered) {                                     \
    <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#ga3">IPDR_LogWrite</a>((e)-&gt;ExporterHandle, <span class="stringliteral">"Platform"</span>, lvl,                          \
                   __FILE__ <span class="stringliteral">":"</span> <a class="code" href="../../d9/d0f/_exporter_console_8c.html#a1">Xstr</a>(__LINE__), msg, a1,a2);                    \
  } <span class="keywordflow">else</span> {                                                                      \
    <span class="keywordtype">char</span> b[<a class="code" href="../../d5/d74/group___i_p_d_r__time__services.html#ga8">IPDR_TIME_FORMAT_LENGTH</a>+1];                                         \
    fprintf(stderr, <span class="stringliteral">"*** %.49s: "</span> msg <span class="stringliteral">" ("</span> __FILE__ <span class="stringliteral">":"</span> <a class="code" href="../../d9/d0f/_exporter_console_8c.html#a1">Xstr</a>(__LINE__) <span class="stringliteral">")\n"</span>,   \
            <a class="code" href="../../dd/d00/_generic_platform_8c.html#a43">GenericPlatform_FormatTimeGMTNow</a>((e), b),                           \
           a1,a2);                                                              \
    fflush(stderr);                                                             \
  }                                                                             \
}
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="GenericPlatform.c::LOG_WRITE3"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define LOG_WRITE3          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">e,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>lvl,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>msg,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>a1,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>a2,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>a3&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">{                                     \
  <span class="keywordflow">if</span> ((e) &amp;&amp; (e)-&gt;ExporterHandleRegistered) {                                     \
    <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#ga3">IPDR_LogWrite</a>((e)-&gt;ExporterHandle, <span class="stringliteral">"Platform"</span>, lvl,                          \
                   __FILE__ <span class="stringliteral">":"</span> <a class="code" href="../../d9/d0f/_exporter_console_8c.html#a1">Xstr</a>(__LINE__), msg, a1,a2,a3);                 \
  } <span class="keywordflow">else</span> {                                                                      \
    <span class="keywordtype">char</span> b[<a class="code" href="../../d5/d74/group___i_p_d_r__time__services.html#ga8">IPDR_TIME_FORMAT_LENGTH</a>+1];                                         \
    fprintf(stderr, <span class="stringliteral">"*** %.49s: "</span> msg <span class="stringliteral">" ("</span> __FILE__ <span class="stringliteral">":"</span> <a class="code" href="../../d9/d0f/_exporter_console_8c.html#a1">Xstr</a>(__LINE__) <span class="stringliteral">")\n"</span>,   \
            <a class="code" href="../../dd/d00/_generic_platform_8c.html#a43">GenericPlatform_FormatTimeGMTNow</a>((e), b),                           \
            a1,a2,a3);                                                          \
    fflush(stderr);                                                             \
  }                                                                             \
}
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="GenericPlatform.c::LOG_WRITE4"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define LOG_WRITE4          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">e,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>lvl,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>msg,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>a1,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>a2,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>a3,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>a4&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">{                                  \
  <span class="keywordflow">if</span> ((e) &amp;&amp; (e)-&gt;ExporterHandleRegistered) {                                     \
    <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#ga3">IPDR_LogWrite</a>((e)-&gt;ExporterHandle, <span class="stringliteral">"Platform"</span>, lvl,                          \
                   __FILE__ <span class="stringliteral">":"</span> <a class="code" href="../../d9/d0f/_exporter_console_8c.html#a1">Xstr</a>(__LINE__), msg, a1,a2,a3,a4);              \
  } <span class="keywordflow">else</span> {                                                                      \
    <span class="keywordtype">char</span> b[<a class="code" href="../../d5/d74/group___i_p_d_r__time__services.html#ga8">IPDR_TIME_FORMAT_LENGTH</a>+1];                                         \
    fprintf(stderr, <span class="stringliteral">"*** %.49s: "</span> msg <span class="stringliteral">" ("</span> __FILE__ <span class="stringliteral">":"</span> <a class="code" href="../../d9/d0f/_exporter_console_8c.html#a1">Xstr</a>(__LINE__) <span class="stringliteral">")\n"</span>,   \
            <a class="code" href="../../dd/d00/_generic_platform_8c.html#a43">GenericPlatform_FormatTimeGMTNow</a>((e), b),                           \
            a1,a2,a3,a4);                                                       \
    fflush(stderr);                                                             \
  }                                                                             \
}
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="GenericPlatform.c::LOG_WRITE5"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define LOG_WRITE5          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">e,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>lvl,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>msg,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>a1,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>a2,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>a3,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>a4,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>a5&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">{                               \
  <span class="keywordflow">if</span> ((e) &amp;&amp; (e)-&gt;ExporterHandleRegistered) {                                     \
    <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#ga3">IPDR_LogWrite</a>((e)-&gt;ExporterHandle, <span class="stringliteral">"Platform"</span>, lvl,                          \
                   __FILE__ <span class="stringliteral">":"</span> <a class="code" href="../../d9/d0f/_exporter_console_8c.html#a1">Xstr</a>(__LINE__), msg, a1,a2,a3,a4,a5);           \
  } <span class="keywordflow">else</span> {                                                                      \
    <span class="keywordtype">char</span> b[<a class="code" href="../../d5/d74/group___i_p_d_r__time__services.html#ga8">IPDR_TIME_FORMAT_LENGTH</a>+1];                                         \
    fprintf(stderr, <span class="stringliteral">"*** %.49s: "</span> msg <span class="stringliteral">" ("</span> __FILE__ <span class="stringliteral">":"</span> <a class="code" href="../../d9/d0f/_exporter_console_8c.html#a1">Xstr</a>(__LINE__) <span class="stringliteral">")\n"</span>,   \
            <a class="code" href="../../dd/d00/_generic_platform_8c.html#a43">GenericPlatform_FormatTimeGMTNow</a>((e), b),                           \
            a1,a2,a3,a4,a5);                                                    \
    fflush(stderr);                                                             \
  }                                                                             \
}
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="GenericPlatform.c::LOG_WRITE6"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define LOG_WRITE6          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">e,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>lvl,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>msg,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>a1,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>a2,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>a3,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>a4,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>a5,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>a6&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">{                            \
  <span class="keywordflow">if</span> ((e) &amp;&amp; (e)-&gt;ExporterHandleRegistered) {                                     \
    <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#ga3">IPDR_LogWrite</a>((e)-&gt;ExporterHandle, <span class="stringliteral">"Platform"</span>, lvl,                          \
                   __FILE__ <span class="stringliteral">":"</span> <a class="code" href="../../d9/d0f/_exporter_console_8c.html#a1">Xstr</a>(__LINE__), msg, a1,a2,a3,a4,a5,a6);        \
  } <span class="keywordflow">else</span> {                                                                      \
    <span class="keywordtype">char</span> b[<a class="code" href="../../d5/d74/group___i_p_d_r__time__services.html#ga8">IPDR_TIME_FORMAT_LENGTH</a>+1];                                         \
    fprintf(stderr, <span class="stringliteral">"*** %.49s: "</span> msg <span class="stringliteral">" ("</span> __FILE__ <span class="stringliteral">":"</span> <a class="code" href="../../d9/d0f/_exporter_console_8c.html#a1">Xstr</a>(__LINE__) <span class="stringliteral">")\n"</span>,   \
            <a class="code" href="../../dd/d00/_generic_platform_8c.html#a43">GenericPlatform_FormatTimeGMTNow</a>((e), b),                           \
            a1,a2,a3,a4,a5,a6);                                                 \
    fflush(stderr);                                                             \
  }                                                                             \
}
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="GenericPlatform.c::MAX_ERROR_STRING_LENGTH"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define MAX_ERROR_STRING_LENGTH&nbsp;&nbsp;&nbsp;1024          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="GenericPlatform.c::MAX_SELECT_ITERATIONS"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define MAX_SELECT_ITERATIONS&nbsp;&nbsp;&nbsp;128          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="GenericPlatform.c::MAX_TIMEWAIT"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define MAX_TIMEWAIT&nbsp;&nbsp;&nbsp;500000          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="GenericPlatform.c::RECEIVE_TIMEOUT"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define RECEIVE_TIMEOUT&nbsp;&nbsp;&nbsp;5000          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="GenericPlatform.c::Str"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define Str          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">x&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;#x</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="GenericPlatform.c::TIME_SKEW_DELTA"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define TIME_SKEW_DELTA&nbsp;&nbsp;&nbsp;10000          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="GenericPlatform.c::Xstr"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define Xstr          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">x&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;Str(x)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a46" doxytag="GenericPlatform.c::BlockSigPipe"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void BlockSigPipe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">GenericST</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>E</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02649 {
02650 <span class="preprocessor">#ifndef _MSC_VER</span>
02651 <span class="preprocessor"></span>    sigset_t SigSet;
02652 
02653     sigemptyset(&amp; SigSet);
02654     sigaddset(&amp; SigSet, SIGPIPE);
02655 
02656 <span class="preprocessor">#if defined(MT_SUPPORT)</span>
02657 <span class="preprocessor"></span><span class="preprocessor">#if defined(PTHREADS_SUPPORT)</span>
02658 <span class="preprocessor"></span>    pthread_sigmask(SIG_BLOCK, &amp; SigSet, NULL);
02659 <span class="preprocessor">#else</span>
02660 <span class="preprocessor"></span>    <span class="comment">/* This might not be what you want: it does all threads in a</span>
02661 <span class="comment">       task. But it seems that VxWorks only offers this possibility;</span>
02662 <span class="comment">       it has no equivalent of pthread_sigmask. */</span>
02663     sigprocmask(SIG_BLOCK, &amp; SigSet, NULL);
02664 <span class="preprocessor">#endif</span>
02665 <span class="preprocessor"></span><span class="preprocessor">#else </span><span class="comment">/* not MT_SUPPORT */</span>
02666     sigprocmask(SIG_BLOCK, &amp; SigSet, NULL);
02667 <span class="preprocessor">#endif</span>
02668 <span class="preprocessor"></span>
02669 <span class="preprocessor">#endif</span>
02670 <span class="preprocessor"></span>}
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a85" doxytag="GenericPlatform.c::FormatTime"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char* FormatTime           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>struct tm *&nbsp;</td>
          <td class="mdname" nowrap> <em>tmPtr</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02573 {
02574     <span class="comment">/* It would be nice to use strftime; but it appears to cause problems</span>
02575 <span class="comment">       on some systems, so use sprintf */</span>
02576     sprintf(buf, <span class="stringliteral">"%04d-%02d-%02dT%02d:%02d:%02d"</span>,
02577             1900 + tmPtr-&gt;tm_year, 1 + tmPtr-&gt;tm_mon, tmPtr-&gt;tm_mday,
02578             tmPtr-&gt;tm_hour, tmPtr-&gt;tm_min, tmPtr-&gt;tm_sec);
02579     <span class="keywordflow">return</span> buf;
02580 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a75" doxytag="GenericPlatform.c::GenericPlatform_Accept"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_Accept           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga9">IPDR_IPAddress</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Addr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned short *&nbsp;</td>
          <td class="mdname" nowrap> <em>Port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>AcceptSocket</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01843 {
01844     <span class="keyword">struct </span>sockaddr_in SockAddr;
01845     <span class="keywordtype">int</span> Len;
01846     <span class="keywordtype">int</span> KeepAlive = -1; <span class="comment">/* same as 1: but this sets all the bits in case arg isn't an int */</span>
01847 
01848     Len = <span class="keyword">sizeof</span>(SockAddr);
01849 
01850     AcceptSocket-&gt;<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a> = accept(S.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, (<span class="keyword">struct</span> sockaddr *) &amp; SockAddr, &amp; Len);
01851     <span class="keywordflow">if</span> (! <a class="code" href="../../dc/d2f/group___i_p_d_r__transitional__typedefs.html#ga2">IPDR_IsValidSocket</a>(*AcceptSocket)) {
01852         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a188">IPDR_ERR_COMMUNICATION_ERROR</a>;
01853     }
01854 
01855 <span class="preprocessor">#if defined(VXWORKS) || defined(_VXWORKS)</span>
01856 <span class="preprocessor"></span><span class="preprocessor">#else</span>
01857 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (1) {
01858         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> buflen = 256*1024; <span class="comment">/* max on Solaris */</span>
01859         <span class="keywordflow">if</span> (setsockopt(AcceptSocket-&gt;<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, SOL_SOCKET, SO_SNDBUF, (<span class="keyword">const</span> <span class="keywordtype">void</span>*)&amp;buflen, <span class="keyword">sizeof</span> buflen) &lt; 0) {
01860             <a class="code" href="../../dd/d00/_generic_platform_8c.html#a6">LOG_WRITE2</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a170">IPDR_LEVEL_WARNING</a>, <span class="stringliteral">"Couldn't set accept send buflen(%lu) for socket "</span> <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga0">Platform_SOCKET_FMT</a> <span class="stringliteral">"\n"</span>, buflen, <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga1">Platform_SOCKET_DISPLAY</a>(*AcceptSocket));
01861         }
01862     }
01863     <span class="keywordflow">if</span> (0) { <span class="comment">/* Don't need a big buffer for receiving ACKs */</span>
01864         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> buflen = 256*1024; <span class="comment">/* max on Solaris */</span>
01865         <span class="keywordflow">if</span> (setsockopt(AcceptSocket-&gt;<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, SOL_SOCKET, SO_RCVBUF, (<span class="keyword">const</span> <span class="keywordtype">void</span>*)&amp;buflen, <span class="keyword">sizeof</span> buflen) &lt; 0) {
01866             <a class="code" href="../../dd/d00/_generic_platform_8c.html#a6">LOG_WRITE2</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a170">IPDR_LEVEL_WARNING</a>, <span class="stringliteral">"Couldn't set accept receive buflen(%lu) for socket "</span> <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga0">Platform_SOCKET_FMT</a> <span class="stringliteral">"\n"</span>, buflen, <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga1">Platform_SOCKET_DISPLAY</a>(*AcceptSocket));
01867         }
01868     }
01869 <span class="preprocessor">#endif</span>
01870 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (setsockopt(AcceptSocket-&gt;<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, SOL_SOCKET, SO_KEEPALIVE, (<span class="keyword">const</span> <span class="keywordtype">void</span>*)&amp;KeepAlive, <span class="keyword">sizeof</span> KeepAlive) &lt; 0) {
01871         <a class="code" href="../../dd/d00/_generic_platform_8c.html#a6">LOG_WRITE2</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a170">IPDR_LEVEL_WARNING</a>, <span class="stringliteral">"Couldn't set accept receive keepalive(%d) for socket "</span> <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga0">Platform_SOCKET_FMT</a> <span class="stringliteral">"\n"</span>, KeepAlive, <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga1">Platform_SOCKET_DISPLAY</a>(*AcceptSocket));
01872     }
01873 
01874 
01875     *Port = ntohs(SockAddr.sin_port);
01876     *Addr = ntohl(SockAddr.sin_addr.s_addr);
01877 
01878     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01879 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a72" doxytag="GenericPlatform.c::GenericPlatform_Bind"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_Bind           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga9">IPDR_IPAddress</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>LocalAddr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned short&nbsp;</td>
          <td class="mdname" nowrap> <em>LocalPort</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01751 {
01752     <span class="keyword">struct </span>sockaddr_in Addr;
01753 
01754     memset(&amp; Addr, <span class="keyword">sizeof</span> Addr, 0);
01755     Addr.sin_family = AF_INET;
01756     Addr.sin_port = htons(LocalPort);
01757     Addr.sin_addr.s_addr = htonl(LocalAddr);
01758 
01759     errno = 0;
01760     <span class="keywordflow">if</span> (bind(S.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, (<span class="keyword">struct</span> sockaddr *) &amp; Addr, <span class="keyword">sizeof</span> Addr) &lt; 0) {
01761         <a class="code" href="../../d5/d93/_transport_8h.html#a28">TL_PABuf</a> paBuf;
01762         <a class="code" href="../../dd/d00/_generic_platform_8c.html#a7">LOG_WRITE3</a>(P, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>, <span class="stringliteral">"Bind %.99s errno=%d: %.99s\n"</span>,
01763                    <a class="code" href="../../d5/d93/_transport_8h.html#a16">TL_PrintAddressAndPort</a>(LocalAddr, LocalPort, paBuf), errno, strerror(errno));
01764         <span class="keywordflow">switch</span> (errno) {
01765         <span class="keywordflow">case</span> EADDRINUSE:
01766         <span class="keywordflow">case</span> EADDRNOTAVAIL:
01767         <span class="keywordflow">case</span> EACCES:
01768         <span class="keywordflow">case</span> EINVAL:
01769             <span class="keywordflow">return</span> (LocalAddr == 0) ? <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a193">IPDR_ERR_PORT_ALREADY_IN_USE</a> : <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a189">IPDR_ERR_ADDRESS_ALREADY_IN_USE</a>;
01770         <span class="keywordflow">default</span>:
01771             <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a188">IPDR_ERR_COMMUNICATION_ERROR</a>;
01772         }
01773     }
01774 
01775     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01776 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a73" doxytag="GenericPlatform.c::GenericPlatform_Close"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_Close           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01780 {
01781     <span class="comment">/* From the Solaris manual (your mileage might vary on other platforms, even BSD):</span>
01782 <span class="comment">     *</span>
01783 <span class="comment">     * SO_LINGER controls the action taken when unsent messages are queued</span>
01784 <span class="comment">     * on a socket and a close(2) is performed. If the socket promises</span>
01785 <span class="comment">     * reliable delivery of data and SO_LINGER is set, the system will</span>
01786 <span class="comment">     * block the process on the close() attempt until it is able to</span>
01787 <span class="comment">     * transmit the data or until it decides it is unable to deliver the</span>
01788 <span class="comment">     * information (a timeout period, termed the linger interval, is</span>
01789 <span class="comment">     * specified in the set- sockopt() call when SO_LINGER is</span>
01790 <span class="comment">     * requested). If SO_LINGER is disabled and a close() is issued, the</span>
01791 <span class="comment">     * system will process the close() in a manner that allows the process</span>
01792 <span class="comment">     * to continue as quickly as possible.  */</span>
01793 
01794 <span class="preprocessor">#if 0</span>
01795 <span class="preprocessor"></span>    <span class="comment">/************* Don't do "linger" at all *******************/</span>
01796 
01797     <span class="keyword">struct </span>linger lngr;
01798 
01799 <span class="preprocessor">#if defined(_MSC_VER) || defined(VXWORKS) || defined(_VXWORKS)</span>
01800 <span class="preprocessor"></span><span class="preprocessor">#error Verify value of linger parameter</span>
01801 <span class="preprocessor"></span><span class="preprocessor">#else</span>
01802 <span class="preprocessor"></span>    lngr.l_linger = 1; <span class="comment">/* one second on Solaris; might be different on other platforms */</span>
01803     lngr.l_onoff = 1;
01804 <span class="preprocessor">#endif</span>
01805 <span class="preprocessor"></span>
01806     <span class="keywordflow">if</span> (! <a class="code" href="../../dc/d2f/group___i_p_d_r__transitional__typedefs.html#ga2">IPDR_IsValidSocket</a>(S)) {
01807         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01808     }
01809 
01810     setsockopt(S.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, SOL_SOCKET, SO_LINGER, (<span class="keywordtype">void</span> *) &amp;lngr, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> linger));
01811 
01812 <span class="preprocessor">#endif </span><span class="comment">/* if 0 for "linger" */</span>
01813 
01814 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
01815 <span class="preprocessor"></span>    fprintf(stderr, <span class="stringliteral">"*** GenericMPlatform_Close "</span> <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga0">Platform_SOCKET_FMT</a> <span class="stringliteral">" close %.150s:%d\n"</span>,
01816             <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga1">Platform_SOCKET_DISPLAY</a>(S), __FILE__, __LINE__); fflush(stderr);
01817 <span class="preprocessor">#endif</span>
01818 <span class="preprocessor"></span>
01819 <span class="preprocessor">#ifndef _MSC_VER</span>
01820 <span class="preprocessor"></span>    close(S.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>);
01821 <span class="preprocessor">#else</span>
01822 <span class="preprocessor"></span>    closesocket(S.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>);
01823 <span class="preprocessor">#endif</span>
01824 <span class="preprocessor"></span>
01825     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01826 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a70" doxytag="GenericPlatform.c::GenericPlatform_Connect"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_Connect           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga9">IPDR_IPAddress</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>LocalAddr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned short&nbsp;</td>
          <td class="mdname" nowrap> <em>LocalPort</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01693 {
01694     <span class="keyword">struct </span>sockaddr_in Addr;
01695 
01696     memset(&amp; Addr, <span class="keyword">sizeof</span> Addr, 0);
01697     Addr.sin_family = AF_INET;
01698     Addr.sin_port = htons(LocalPort);
01699     Addr.sin_addr.s_addr = htonl(LocalAddr);
01700 
01701         errno = 0;
01702         <span class="keywordflow">if</span> (connect(S.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, (<span class="keyword">struct</span> sockaddr *) &amp; Addr, <span class="keyword">sizeof</span> Addr) &lt; 0)
01703         {
01704         <a class="code" href="../../d5/d93/_transport_8h.html#a28">TL_PABuf</a> paBuf;
01705         <a class="code" href="../../dd/d00/_generic_platform_8c.html#a7">LOG_WRITE3</a>(P, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>, <span class="stringliteral">"Connect %.99s errno=%d: %.99s\n"</span>,
01706                    <a class="code" href="../../d5/d93/_transport_8h.html#a16">TL_PrintAddressAndPort</a>(LocalAddr, LocalPort, paBuf), errno, strerror(errno));
01707         <span class="keywordflow">switch</span> (errno) {
01708         <span class="keywordflow">default</span>:
01709             <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a188">IPDR_ERR_COMMUNICATION_ERROR</a>;
01710         }
01711         }
01712 
01713         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01714 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a32" doxytag="GenericPlatform.c::GenericPlatform_CreateLock"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_CreateLock           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void **&nbsp;</td>
          <td class="mdname" nowrap> <em>LockPtr</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02218 {
02219     <a class="code" href="../../d6/d25/struct_generic_lock.html">GenericLock</a>* lock;
02220     {
02221         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status = <a class="code" href="../../dd/d00/_generic_platform_8c.html#a55">GenericPlatform_MemoryAllocate</a>(E, <span class="keyword">sizeof</span> *lock, (<span class="keywordtype">void</span>**)&amp;lock);
02222         *LockPtr = lock;
02223         <span class="keywordflow">if</span> (<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status)) {
02224             <span class="keywordflow">return</span> Status;
02225         }
02226     }
02227 
02228     strncpy(lock-&gt;eyecatcher, <span class="stringliteral">"LOCKRCR"</span>, <span class="keyword">sizeof</span> lock-&gt;eyecatcher);
02229 
02230 <span class="preprocessor">#if defined(MT_SUPPORT)</span>
02231 <span class="preprocessor"></span><span class="preprocessor">#if defined(PTHREADS_SUPPORT)</span>
02232 <span class="preprocessor"></span>    pthread_mutex_init(&amp; lock-&gt;ActualLock, NULL);
02233     pthread_mutex_init(&amp; lock-&gt;CountLock, NULL);
02234     lock-&gt;RecursionCount = 0;
02235 <span class="preprocessor">#elif defined(_MSC_VER)</span>
02236 <span class="preprocessor"></span>    InitializeCriticalSection(&amp; lock-&gt;ActualLock);
02237     InitializeCriticalSection(&amp; lock-&gt;CountLock);
02238     lock-&gt;RecursionCount = 0;
02239 <span class="preprocessor">#elif defined(VXWORKS) || defined(_VXWORKS)</span>
02240 <span class="preprocessor"></span>    lock-&gt;ActualLock = semMCreate(SEM_Q_PRIORITY | SEM_DELETE_SAFE);
02241     <span class="keywordflow">if</span> (lock-&gt;ActualLock == NULL) {
02242         <a class="code" href="../../dd/d00/_generic_platform_8c.html#a39">GenericPlatform_MemoryFree</a>(E, lock);
02243         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>;
02244     }
02245     <span class="comment">/* Recursive mutex, so no need for CountLock */</span>
02246 <span class="preprocessor">#else</span>
02247 <span class="preprocessor"></span><span class="preprocessor">#error Define CreateLock</span>
02248 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
02249 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
02250 <span class="preprocessor"></span>
02251     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
02252 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a68" doxytag="GenericPlatform.c::GenericPlatform_CreateTCPSocket"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_CreateTCPSocket           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01634 {
01635     <span class="keywordtype">int</span> On = 1; <span class="comment">/* this must be an int and SO_REUSEADDR must take an int (not unsigned char) */</span>
01636         <span class="keywordtype">int</span> KeepAlive = -1; <span class="comment">/* same as 1: but this sets all the bits in case arg isn't an int */</span>
01637 
01638     S-&gt;<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a> = socket(PF_INET, SOCK_STREAM, 0);
01639     <span class="keywordflow">if</span> (! <a class="code" href="../../dc/d2f/group___i_p_d_r__transitional__typedefs.html#ga2">IPDR_IsValidSocket</a>(*S)) {
01640         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a188">IPDR_ERR_COMMUNICATION_ERROR</a>;
01641     }
01642 
01643 <span class="preprocessor">#if defined(VXWORKS) || defined(_VXWORKS)</span>
01644 <span class="preprocessor"></span><span class="preprocessor">#else</span>
01645 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (0) { <span class="comment">/* Assume that the socket is only for accepting connections. */</span>
01646         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> buflen = 256*1024; <span class="comment">/* max on Solaris */</span>
01647         <span class="keywordflow">if</span> (setsockopt(S-&gt;<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, SOL_SOCKET, SO_RCVBUF, (<span class="keyword">const</span> <span class="keywordtype">void</span>*)&amp;buflen, <span class="keyword">sizeof</span> buflen) &lt; 0) {
01648             <a class="code" href="../../dd/d00/_generic_platform_8c.html#a6">LOG_WRITE2</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a170">IPDR_LEVEL_WARNING</a>, <span class="stringliteral">"Couldn't set receive buflen(%lu) for socket "</span> <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga0">Platform_SOCKET_FMT</a> <span class="stringliteral">"\n"</span>, buflen, <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga1">Platform_SOCKET_DISPLAY</a>(*S));
01649         }
01650     }
01651     <span class="keywordflow">if</span> (1) { <span class="comment">/* Don't need a big buffer for receiving ACKs */</span>
01652         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> buflen = 256*1024; <span class="comment">/* max on Solaris */</span>
01653         <span class="keywordflow">if</span> (setsockopt(S-&gt;<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, SOL_SOCKET, SO_SNDBUF, (<span class="keyword">const</span> <span class="keywordtype">void</span>*)&amp;buflen, <span class="keyword">sizeof</span> buflen) &lt; 0) {
01654             <a class="code" href="../../dd/d00/_generic_platform_8c.html#a6">LOG_WRITE2</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a170">IPDR_LEVEL_WARNING</a>, <span class="stringliteral">"Couldn't set send buflen(%lu) for socket "</span> <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga0">Platform_SOCKET_FMT</a> <span class="stringliteral">"\n"</span>, buflen, <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga1">Platform_SOCKET_DISPLAY</a>(*S));
01655         }
01656     }
01657 <span class="preprocessor">#endif</span>
01658 <span class="preprocessor"></span>
01659     <span class="keywordflow">if</span> (setsockopt(S-&gt;<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, SOL_SOCKET, SO_KEEPALIVE, (<span class="keyword">const</span> <span class="keywordtype">void</span>*)&amp;KeepAlive, <span class="keyword">sizeof</span> KeepAlive) &lt; 0) {
01660         <a class="code" href="../../dd/d00/_generic_platform_8c.html#a6">LOG_WRITE2</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a170">IPDR_LEVEL_WARNING</a>, <span class="stringliteral">"Couldn't set accept receive keepalive(%d) for socket "</span> <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga0">Platform_SOCKET_FMT</a> <span class="stringliteral">"\n"</span>, KeepAlive, <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga1">Platform_SOCKET_DISPLAY</a>(*S));
01661     }
01662 
01663     <span class="keywordflow">if</span> (setsockopt(S-&gt;<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, SOL_SOCKET, SO_REUSEADDR,
01664                    (<span class="keywordtype">char</span> *) &amp; On, sizeof (On)) &lt; 0) {
01665 <span class="preprocessor">#ifndef _MSC_VER</span>
01666 <span class="preprocessor"></span>        close(S-&gt;<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>);
01667 <span class="preprocessor">#else</span>
01668 <span class="preprocessor"></span>        closesocket(S-&gt;<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>);
01669 <span class="preprocessor">#endif</span>
01670 <span class="preprocessor"></span>        <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a188">IPDR_ERR_COMMUNICATION_ERROR</a>;
01671     }
01672 
01673     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01674 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a69" doxytag="GenericPlatform.c::GenericPlatform_CreateUDPSocket"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_CreateUDPSocket           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01679 {
01680     S-&gt;<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a> = socket(PF_INET, SOCK_DGRAM, 0);
01681 
01682     <span class="keywordflow">if</span> (! <a class="code" href="../../dc/d2f/group___i_p_d_r__transitional__typedefs.html#ga2">IPDR_IsValidSocket</a>(*S)) {
01683         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a188">IPDR_ERR_COMMUNICATION_ERROR</a>;
01684     }
01685 
01686     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01687 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a50" doxytag="GenericPlatform.c::GenericPlatform_Delete"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_Delete           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>E</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00492 {
00493     <a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html">GenericFDEvent</a> *UFE, *NextUFE;
00494 
00495     <span class="keywordflow">if</span> (E == NULL) {
00496         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
00497     }
00498 
00499 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
00500 <span class="preprocessor"></span>    fprintf(stderr, <span class="stringliteral">"*** GenericPlatformDelete\n"</span>);
00501 <span class="preprocessor">#endif</span>
00502 <span class="preprocessor"></span>
00503     <span class="comment">/* delete the FD events associated with dispatcher once we exit */</span>
00504 
00505     UFE = E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o5">FDReadEvents</a>;
00506     <span class="keywordflow">while</span> (UFE != NULL) {
00507         NextUFE = UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o4">NextEvent</a>;
00508         <a class="code" href="../../dd/d00/_generic_platform_8c.html#a39">GenericPlatform_MemoryFree</a>(E, UFE);
00509         UFE = NextUFE;
00510     }
00511 
00512     UFE = E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o6">FDWriteEvents</a>;
00513     <span class="keywordflow">while</span> (UFE != NULL) {
00514         NextUFE = UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o4">NextEvent</a>;
00515         <a class="code" href="../../dd/d00/_generic_platform_8c.html#a39">GenericPlatform_MemoryFree</a>(E, UFE);
00516         UFE = NextUFE;
00517     }
00518 
00519     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a33">GenericPlatform_DeleteLock</a>(E, E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o4">PlatformLock</a>);
00520 
00521     free(E);
00522 
00523     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
00524 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a33" doxytag="GenericPlatform.c::GenericPlatform_DeleteLock"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_DeleteLock           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>LockPtr</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02256 {
02257     <a class="code" href="../../d6/d25/struct_generic_lock.html">GenericLock</a>* lock = (<a class="code" href="../../d6/d25/struct_generic_lock.html">GenericLock</a>*)LockPtr;
02258     strncpy(lock-&gt;<a class="code" href="../../d6/d25/struct_generic_lock.html#o0">eyecatcher</a>, <span class="stringliteral">"Xlockrc"</span>, <span class="keyword">sizeof</span> lock-&gt;<a class="code" href="../../d6/d25/struct_generic_lock.html#o0">eyecatcher</a>);
02259 
02260 <span class="preprocessor">#if defined(MT_SUPPORT)</span>
02261 <span class="preprocessor"></span><span class="preprocessor">#if defined(PTHREADS_SUPPORT)</span>
02262 <span class="preprocessor"></span>    pthread_mutex_destroy(&amp; lock-&gt;ActualLock);
02263     pthread_mutex_destroy(&amp; lock-&gt;CountLock);
02264 <span class="preprocessor">#elif defined( _MSC_VER)</span>
02265 <span class="preprocessor"></span>    DeleteCriticalSection(&amp; lock-&gt;ActualLock);
02266     DeleteCriticalSection(&amp; lock-&gt;CountLock);
02267 <span class="preprocessor">#elif defined(VXWORKS) || defined(_VXWORKS)</span>
02268 <span class="preprocessor"></span>    semDelete(lock-&gt;ActualLock);
02269     <span class="comment">/* No countLock */</span>
02270 <span class="preprocessor">#else</span>
02271 <span class="preprocessor"></span><span class="preprocessor">#error Define DeleteLock</span>
02272 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
02273 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
02274 <span class="preprocessor"></span>
02275     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a39">GenericPlatform_MemoryFree</a>(E, lock);
02276 
02277     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
02278 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a44" doxytag="GenericPlatform.c::GenericPlatform_FormatTimeGMT"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char * GenericPlatform_FormatTimeGMT           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga10">IPDR_Time</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02599 {
02600     <span class="comment">/* POSIX and VxWorks differ in their definition of gmtime_r:</span>
02601 <span class="comment">       POSIX returns struct tm* pointer but VxWorks returns an int. We</span>
02602 <span class="comment">       depend on this function simply filling the buffer and ignore the</span>
02603 <span class="comment">       return value.  */</span>
02604     <span class="keyword">struct </span>tm tmMem;
02605     time_t cx = c;
02606     gmtime_r(&amp;cx, &amp;tmMem);
02607     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a85">FormatTime</a>(buf, &amp;tmMem);
02608     <span class="keywordflow">return</span> buf;
02609 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a43" doxytag="GenericPlatform.c::GenericPlatform_FormatTimeGMTNow"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char * GenericPlatform_FormatTimeGMTNow           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02622 {
02623     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga10">IPDR_Time</a> t;
02624     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a83">GenericPlatform_GetTime</a>(P, &amp;t); <span class="comment">/* or: t = time(0); */</span>
02625     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a44">GenericPlatform_FormatTimeGMT</a>(P, t, buf);
02626     <span class="keywordflow">return</span> buf;
02627 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a42" doxytag="GenericPlatform.c::GenericPlatform_FormatTimeLocal"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char * GenericPlatform_FormatTimeLocal           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga10">IPDR_Time</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>c</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02584 {
02585     <span class="comment">/* POSIX and VxWorks differ in their definition of localtime_r:</span>
02586 <span class="comment">       POSIX returns struct tm* pointer but VxWorks returns an int. We</span>
02587 <span class="comment">       depend on this function simply filling the buffer and ignore the</span>
02588 <span class="comment">       return value.  */</span>
02589     <span class="keyword">struct </span>tm tmMem;
02590     <span class="comment">/* On VxWorks, time_t is not the same as IPDR_Time, but this seems to work: */</span>
02591     time_t cx = c;
02592     localtime_r(&amp;cx, &amp;tmMem);
02593     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a85">FormatTime</a>(buf, &amp;tmMem);
02594     <span class="keywordflow">return</span> buf;
02595 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a41" doxytag="GenericPlatform.c::GenericPlatform_FormatTimeLocalNow"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char * GenericPlatform_FormatTimeLocalNow           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02613 {
02614     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga10">IPDR_Time</a> t;
02615     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a83">GenericPlatform_GetTime</a>(P, &amp;t); <span class="comment">/* or: t = time(0); */</span>
02616     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a42">GenericPlatform_FormatTimeLocal</a>(P, t, buf);
02617     <span class="keywordflow">return</span> buf;
02618 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a40" doxytag="GenericPlatform.c::GenericPlatform_FormatTimeSyslogNow"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static char * GenericPlatform_FormatTimeSyslogNow           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02631 {
02632     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga10">IPDR_Time</a> t;
02633     <span class="comment">/* See comments with GenericPlatform_FormatTimeLocal */</span>
02634     <span class="keyword">struct </span>tm tmMem;
02635     time_t cx;
02636     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* months[] = {<span class="stringliteral">"Jan"</span>, <span class="stringliteral">"Feb"</span>, <span class="stringliteral">"Mar"</span>, <span class="stringliteral">"Apr"</span>, <span class="stringliteral">"May"</span>, <span class="stringliteral">"Jun"</span>,
02637                                    <span class="stringliteral">"Jul"</span>, <span class="stringliteral">"Aug"</span>, <span class="stringliteral">"Sep"</span>, <span class="stringliteral">"Oct"</span>, <span class="stringliteral">"Nov"</span>, <span class="stringliteral">"Dec"</span>};
02638     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a83">GenericPlatform_GetTime</a>(P, &amp;t); <span class="comment">/* or: t = time(0); */</span>
02639     cx = t;
02640     localtime_r(&amp;cx, &amp;tmMem);
02641     sprintf(buf, <span class="stringliteral">"%.3s %2d %02d:%02d:%02d"</span>,
02642             months[tmMem.tm_mon], tmMem.tm_mday,
02643             tmMem.tm_hour, tmMem.tm_min, tmMem.tm_sec);
02644     <span class="keywordflow">return</span> buf;
02645 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a82" doxytag="GenericPlatform.c::GenericPlatform_GetHostName"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_GetHostName           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>HostName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>NameLength</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02167 {
02168     errno = 0;
02169     <span class="comment">/* Implementation note: if you're on a platform that doesn't have</span>
02170 <span class="comment">     * gethostname() or similar, try to get an IP address (convert to</span>
02171 <span class="comment">     * character string with inet_ntoa()), otherwise just hard-code a</span>
02172 <span class="comment">     * result. */</span>
02173     <span class="keywordflow">if</span> (NameLength &lt;= 0) {
02174         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a181">IPDR_ERR_INVALID_VALUE</a>;
02175     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == gethostname(HostName, NameLength)) {
02176         HostName[NameLength - 1] = <span class="charliteral">'\0'</span>; <span class="comment">/* ensure it's null terminated */</span>
02177         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
02178     } <span class="keywordflow">else</span> {
02179         <span class="comment">/* errno will have been set */</span>
02180         HostName[0] = <span class="charliteral">'\0'</span>; <span class="comment">/* empty string */</span>
02181         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>;
02182     }
02183 
02184     <span class="comment">/* If we need it, here is generic code for resolving a name to an</span>
02185 <span class="comment">     * IP address (for Unix): */</span>
02186 <span class="preprocessor">#if 0</span>
02187 <span class="preprocessor"></span><span class="preprocessor">#include &lt;sys/types.h&gt;</span>
02188 <span class="preprocessor">#include &lt;sys/socket.h&gt;</span>
02189 <span class="preprocessor">#include &lt;netinet/in.h&gt;</span>
02190 <span class="preprocessor">#include &lt;arpa/inet.h&gt;</span>
02191 <span class="preprocessor">#include &lt;netdb.h&gt;</span>
02192 
02193     <span class="keywordflow">if</span> ((<span class="keywordtype">int</span>)(addr = inet_addr(hostname)) == -1) {
02194         hp = gethostbyname(hostname);
02195     } <span class="keywordflow">else</span> {
02196         hp = gethostbyaddr((<span class="keywordtype">char</span> *)&amp;addr, <span class="keyword">sizeof</span> (addr), AF_INET);
02197     }
02198     <span class="keywordflow">if</span> (hp == NULL) {
02199         (void) printf(<span class="stringliteral">"host information for %s not found\n"</span>, hostname);
02200         <span class="keywordflow">return</span> 3;
02201     }
02202     <span class="keywordflow">for</span> (p = hp-&gt;h_addr_list; *p != 0; p++) {
02203         <span class="keyword">struct </span>in_addr in;
02204         <span class="keywordtype">char</span> **q;
02205         (void) memcpy(&amp;in.s_addr, *p, sizeof (in.s_addr));
02206         (void) printf(<span class="stringliteral">"%s\t%s"</span>, inet_ntoa(in), hp-&gt;h_name);
02207         <span class="keywordflow">for</span> (q = hp-&gt;h_aliases; *q != 0; q++)
02208             (void) printf(<span class="stringliteral">" %s"</span>, *q);
02209         (void) putchar(<span class="charliteral">'\n'</span>);
02210     }
02211 <span class="preprocessor">#endif</span>
02212 <span class="preprocessor"></span>}
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a51" doxytag="GenericPlatform.c::GenericPlatform_GetLastErrorMessage"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_GetLastErrorMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>Msg</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00529 {
00530 <span class="preprocessor">#ifdef _MSC_VER</span>
00531 <span class="preprocessor"></span>    LPVOID <a class="code" href="../../d9/d0f/_exporter_console_8c.html#a0">Str</a>;
00532 
00533     FormatMessage(FORMAT_MESSAGE_FROM_SYSTEM |
00534                   FORMAT_MESSAGE_IGNORE_INSERTS |
00535                   FORMAT_MESSAGE_ALLOCATE_BUFFER,
00536                   NULL,
00537                   GetLastError(),
00538                   MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT),
00539                   (LPTSTR) &amp; Str,
00540                   <a class="code" href="../../dd/d00/_generic_platform_8c.html#a14">MAX_ERROR_STRING_LENGTH</a>,
00541                   NULL);
00542     strcpy(Msg, (<span class="keyword">const</span> <span class="keywordtype">char</span>*)Str);
00543     LocalFree(Str);
00544 
00545 <span class="preprocessor">#else</span>
00546 <span class="preprocessor"></span>    <span class="comment">/* We could use strerror_r on VxWorks (Solaris doesn't have</span>
00547 <span class="comment">       it, presumably because it's not in POSIX yet). But then we need a</span>
00548 <span class="comment">       buffer space in GenericST and the VxWorks documentation doesn't</span>
00549 <span class="comment">       specify how big that needs to be. */</span>
00550 
00551     <span class="keyword">const</span> <span class="keywordtype">char</span>* stre;
00552 
00553     <span class="keywordflow">if</span> (errno == 0) {
00554         stre = <a class="code" href="../../d0/dfa/group___i_p_d_r__msg__services.html#ga2">IPDR_NO_ERROR_ERROR_MESSAGE</a>; <span class="comment">/* Must do this to avoid weird log messages. */</span>
00555     } <span class="keywordflow">else</span> {
00556         stre = strerror(errno);
00557     }
00558 
00559     <span class="keywordflow">if</span> (stre) {
00560         strncpy(Msg, stre, <a class="code" href="../../d0/dfa/group___i_p_d_r__msg__services.html#ga1">IPDR_MAX_ERROR_LENGTH</a>-1);
00561         Msg[<a class="code" href="../../d0/dfa/group___i_p_d_r__msg__services.html#ga1">IPDR_MAX_ERROR_LENGTH</a>-1] = <span class="charliteral">'\0'</span>; <span class="comment">/* ensure null-termination */</span>
00562     } <span class="keywordflow">else</span> {
00563         sprintf(Msg, <span class="stringliteral">"errno=%d"</span>, errno);
00564     }
00565 <span class="preprocessor">#endif</span>
00566 <span class="preprocessor"></span>
00567     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
00568 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a71" doxytag="GenericPlatform.c::GenericPlatform_GetSockName"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_GetSockName           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga9">IPDR_IPAddress</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>LocalAddr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned short *&nbsp;</td>
          <td class="mdname" nowrap> <em>LocalPort</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01720 {
01721     <span class="keyword">struct </span>sockaddr_in Addr;
01722         <span class="keyword">struct </span>sockaddr * pAddr = (<span class="keyword">struct </span>sockaddr *)&amp;Addr;
01723         socklen_t addrLen = <span class="keyword">sizeof</span>( Addr );
01724 
01725     memset(pAddr, addrLen, 0);
01726 
01727         *LocalAddr = 0;
01728         *LocalPort = 0;
01729 
01730         errno = 0;
01731         <span class="keywordflow">if</span> (getsockname(S.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, pAddr, &amp;addrLen) &lt; 0)
01732         {
01733         <a class="code" href="../../dd/d00/_generic_platform_8c.html#a6">LOG_WRITE2</a>(P, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>, <span class="stringliteral">"getsockname, errno=%d: %.99s\n"</span>,
01734                    errno, strerror(errno));
01735         <span class="keywordflow">switch</span> (errno) {
01736         <span class="keywordflow">default</span>:
01737             <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a188">IPDR_ERR_COMMUNICATION_ERROR</a>;
01738         }
01739         }
01740 
01741         *LocalAddr = ntohl(Addr.sin_addr.s_addr);
01742         *LocalPort = ntohs(Addr.sin_port);
01743 
01744         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01745 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a83" doxytag="GenericPlatform.c::GenericPlatform_GetTime"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_GetTime           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga10">IPDR_Time</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>T</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02485                                                                       {
02486 <span class="preprocessor">#ifdef _MSC_VER</span>
02487 <span class="preprocessor"></span>    <span class="keyword">struct </span>_timeb tb;
02488     _ftime(&amp; tb);
02489     *T = tb.time;
02490     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
02491 <span class="comment">/* note: cygwin doesn't have clock_gettime() ... you can</span>
02492 <span class="comment">   check for defined(__unix) and do something with it ...</span>
02493 <span class="comment">   for example gettimeofday() or ftime()</span>
02494 <span class="comment">*/</span>
02495 <span class="preprocessor">#elif defined(SOLARIS) || defined(VXWORKS) || defined(_VXWORKS)</span>
02496 <span class="preprocessor"></span>    <span class="keyword">struct </span>timespec ts;
02497     <span class="keywordtype">int</span> rc = clock_gettime(CLOCK_REALTIME, &amp;ts);
02498     *T = ts.tv_sec;
02499     <span class="keywordflow">return</span> (rc == 0) ? <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a> : <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>;
02500 <span class="preprocessor">#else</span>
02501 <span class="preprocessor"></span><span class="comment">/* this also works on Solaris, but we'll use the same as VxWorks: */</span>
02502     <span class="keyword">struct </span>timeval tv;
02503     <span class="keywordtype">int</span> rc;
02504     rc = gettimeofday(&amp; tv, NULL);
02505     *T = tv.tv_sec;
02506     <span class="keywordflow">return</span> (rc == 0) ? <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a> : <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>;
02507 <span class="comment">/* or this (generic Unix): */</span>
02508 <span class="comment">/*    time_t tb = time(0); */</span>
02509 <span class="comment">/*    *T = tb; */</span>
02510 <span class="comment">/*    return (tb == (time_t)-1) ? IPDR_ERR : IPDR_OK; */</span>
02511 <span class="preprocessor">#endif</span>
02512 <span class="preprocessor"></span>}
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a45" doxytag="GenericPlatform.c::GenericPlatform_GetTV"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void GenericPlatform_GetTV           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct timeval *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>TV</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02684 {
02685 <span class="preprocessor">#if defined(SOLARIS) || defined(VXWORKS) || defined(_VXWORKS)</span>
02686 <span class="preprocessor"></span>    <span class="keyword">struct </span>timespec ts;
02687     clock_gettime(CLOCK_REALTIME, &amp;ts); <span class="comment">/* Should verify return code == 0 */</span>
02688     TV-&gt;tv_sec = ts.tv_sec;
02689     TV-&gt;tv_usec = ts.tv_nsec / 1000;
02690 <span class="preprocessor">#else</span>
02691 <span class="preprocessor"></span>    gettimeofday(TV, NULL); <span class="comment">/* is Solaris-only? also cygwin ... */</span>
02692     <span class="comment">/* see also comment under GenericPlatform_GetTime */</span>
02693 <span class="preprocessor">#endif</span>
02694 <span class="preprocessor"></span>}
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a54" doxytag="GenericPlatform.c::GenericPlatform_Initialize"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_Initialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html">IPDR_PlatformServices</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>PS</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
non-multitasking version of initialize which creates a thread if MT_SUPPORT <div class="fragment"><pre class="fragment">00607 {
00608     <span class="keywordflow">return</span> <a class="code" href="../../dd/d00/_generic_platform_8c.html#a30">GenericPlatform_InitializeInternal</a>(PS);
00609 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="GenericPlatform.c::GenericPlatform_InitializeInternal"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_InitializeInternal           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html">IPDR_PlatformServices</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>PS</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02820 {
02821     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status = <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
02822 
02823 <span class="preprocessor">#ifdef _MSC_VER</span>
02824 <span class="preprocessor"></span>    WSADATA wsaData;
02825 <span class="preprocessor">#endif</span>
02826 <span class="preprocessor"></span>
02827     <a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">GenericST</a> *UST = (<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">GenericST</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">GenericST</a>));
02828     <span class="keywordflow">if</span> (UST == NULL) {
02829         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a182">IPDR_ERR_ALLOCATION_FAILED</a>;
02830     }
02831 
02832 <span class="preprocessor">#ifdef _MSC_VER</span>
02833 <span class="preprocessor"></span>    WSAStartup(MAKEWORD(2, 2), &amp; wsaData);
02834 <span class="preprocessor">#endif</span>
02835 <span class="preprocessor"></span>
02836     strncpy(PS-&gt;<a class="code" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html#o0">eyecatcher</a>, <span class="stringliteral">"IPDRPS"</span>, <span class="keyword">sizeof</span> PS-&gt;<a class="code" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html#o0">eyecatcher</a>);
02837     PS-&gt;<a class="code" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html#o1">PlatformArg</a> = (<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>) UST;
02838 
02839     strncpy(UST-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o0">eyecatcher</a>, <span class="stringliteral">"GnrcST "</span>, <span class="keyword">sizeof</span> UST-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o0">eyecatcher</a>);
02840 
02841     UST-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o1">Timers</a> = NULL;
02842     UST-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o2">Enabled</a> = <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
02843     UST-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o3">Stopped</a> = <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
02844     UST-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o4">PlatformLock</a> = NULL;
02845     UST-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o5">FDReadEvents</a> = NULL;
02846     UST-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o6">FDWriteEvents</a> = NULL;
02847     UST-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o7">ScanningFDs</a> = <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
02848 
02849     FD_ZERO(&amp; (UST-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o8">ReadFDs</a>));
02850     FD_ZERO(&amp; (UST-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o9">WriteFDs</a>));
02851     UST-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o10">MaxFD</a>.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a> = -1;
02852 
02853     UST-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o11">ExporterHandleRegistered</a> = <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
02854     UST-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o12">ExporterHandle</a> = NULL;
02855 
02856     UST-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o13">numAllocs</a> = 0;
02857     UST-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o14">numFrees</a> = 0;
02858     UST-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o15">bytesAllocated</a> = 0;
02859 
02860     PS-&gt;<a class="code" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html#o2">Start</a> = <a class="code" href="../../dd/d00/_generic_platform_8c.html#a47">GenericPlatform_Start</a>;
02861     PS-&gt;<a class="code" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html#o3">Stop</a> = <a class="code" href="../../dd/d00/_generic_platform_8c.html#a48">GenericPlatform_Stop</a>;
02862     PS-&gt;<a class="code" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html#o4">IsRunning</a> = <a class="code" href="../../dd/d00/_generic_platform_8c.html#a49">GenericPlatform_IsRunning</a>;
02863     PS-&gt;<a class="code" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html#o5">Delete</a> = <a class="code" href="../../dd/d00/_generic_platform_8c.html#a50">GenericPlatform_Delete</a>;
02864     PS-&gt;<a class="code" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html#o6">GetLastErrorMessage</a> = <a class="code" href="../../dd/d00/_generic_platform_8c.html#a51">GenericPlatform_GetLastErrorMessage</a>;
02865     PS-&gt;<a class="code" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html#o7">SetExporterHandle</a> = <a class="code" href="../../dd/d00/_generic_platform_8c.html#a52">GenericPlatform_SetExporterHandle</a>;
02866     PS-&gt;<a class="code" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html#o8">UnsetExporterHandle</a> = <a class="code" href="../../dd/d00/_generic_platform_8c.html#a53">GenericPlatform_UnsetExporterHandle</a>;
02867 
02868     PS-&gt;<a class="code" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html#o9">MemoryServices</a> = <a class="code" href="../../dd/d00/_generic_platform_8c.html#a24">GenericPlatform_MemoryServices</a>;
02869     PS-&gt;<a class="code" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html#o10">EventServices</a> = <a class="code" href="../../dd/d00/_generic_platform_8c.html#a25">GenericPlatform_EventServices</a>;
02870     PS-&gt;<a class="code" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html#o11">PersistenceServices</a> = <a class="code" href="../../dd/d00/_generic_platform_8c.html#a26">GenericPlatform_PersistenceServices</a>;
02871     PS-&gt;<a class="code" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html#o12">NetworkServices</a> = <a class="code" href="../../dd/d00/_generic_platform_8c.html#a27">GenericPlatform_NetworkServices</a>;
02872     PS-&gt;<a class="code" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html#o13">LockingServices</a> = <a class="code" href="../../dd/d00/_generic_platform_8c.html#a28">GenericPlatform_LockingServices</a>;
02873     PS-&gt;<a class="code" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html#o14">TimeServices</a> = <a class="code" href="../../dd/d00/_generic_platform_8c.html#a29">GenericPlatform_TimeServices</a>;
02874 <span class="preprocessor">#if defined(SNMP_SUPPORT)</span>
02875 <span class="preprocessor"></span>        PS-&gt;MIBServices = GenericPlatform_MIBServices;
02876 <span class="preprocessor">#endif</span>
02877 <span class="preprocessor"></span><span class="preprocessor">#ifdef _MSC_VER</span>
02878 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (WSAStartup (MAKEWORD(1,1), &amp;wsaData) != 0)
02879         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>;
02880 <span class="preprocessor">#endif</span>
02881 <span class="preprocessor"></span>
02882     Status = <a class="code" href="../../dd/d00/_generic_platform_8c.html#a32">GenericPlatform_CreateLock</a>(UST, (<span class="keywordtype">void</span>**)&amp;UST-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o4">PlatformLock</a>);
02883     <span class="keywordflow">if</span> (<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status)) {
02884         free(UST);
02885         PS-&gt;<a class="code" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html#o1">PlatformArg</a> = NULL;
02886         <span class="keywordflow">return</span> Status;
02887     }
02888 
02889     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a46">BlockSigPipe</a>(UST);
02890 
02891 <span class="comment">/* #warning Initialize the log Platform here ... */</span>
02892 
02893     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
02894 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a49" doxytag="GenericPlatform.c::GenericPlatform_IsRunning"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../df/dde/_defs_8h.html#a16">IPDR_BOOL</a> GenericPlatform_IsRunning           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>E</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00486 {
00487     <span class="keywordflow">return</span> (E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o2">Enabled</a> &amp;&amp; ! E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o3">Stopped</a>) ? <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a> : <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
00488 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a74" doxytag="GenericPlatform.c::GenericPlatform_Listen"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_Listen           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>Backlog</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01831 {
01832     <span class="keywordflow">if</span> (listen(S.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, Backlog) &lt; 0) {
01833         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a188">IPDR_ERR_COMMUNICATION_ERROR</a>;
01834     }
01835 
01836     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01837 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a34" doxytag="GenericPlatform.c::GenericPlatform_Lock"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_Lock           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>LockPtr</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02332 {
02333 <span class="preprocessor">#if defined(MT_SUPPORT)</span>
02334 <span class="preprocessor"></span>    <a class="code" href="../../d6/d25/struct_generic_lock.html">GenericLock</a>* lock = (<a class="code" href="../../d6/d25/struct_generic_lock.html">GenericLock</a>*)LockPtr;
02335 <span class="preprocessor">#if defined(PTHREADS_SUPPORT)</span>
02336 <span class="preprocessor"></span>    <span class="comment">/* The following implements a "recursive" lock, which doesn't</span>
02337 <span class="comment">       deadlock if a thread tries to get the lock when the same thread</span>
02338 <span class="comment">       has already acquired the lock (it'll block if another thread has</span>
02339 <span class="comment">       the lock). This is accomplished by having a "use count" protected</span>
02340 <span class="comment">       by its mutex in addition to the locking mutex. */</span>
02341     <span class="comment">/* To do: the non-recursive POSIX code and the Windows code are almost</span>
02342 <span class="comment">       identical ... combine them into one. */</span>
02343     <span class="comment">/* To do: convert the following to use POSIX threads recursive option:</span>
02344 <span class="comment">       ( see http://www.as400.ibm.com/developer/threads/uguide/users-55.htm#307637 )</span>
02345 <span class="comment">       pthread_mutex_t mutex;</span>
02346 <span class="comment">       pthread_mutexattr_t mta;</span>
02347 <span class="comment">       pthread_mutexattr_init(&amp;mta);</span>
02348 <span class="comment">       pthread_mutexattr_setkind_np(&amp;mta, PTHREAD_MUTEX_RECURSIVE_NP);</span>
02349 <span class="comment">       pthread_mutex_init(&amp;mutex, &amp;mta);</span>
02350 <span class="comment">    */</span>
02351     <span class="keywordtype">int</span> AcquiredLock = 0; <span class="comment">/* flag is set to true when the lock is obtained */</span>
02352 <span class="preprocessor">#ifdef DEBUG_LOCKS</span>
02353 <span class="preprocessor"></span>    fprintf(stderr, <span class="stringliteral">"Lock try [%.150s:%d](0x%p) count=%d owner=%d self=%d\n"</span>,
02354             FileName, LineNum, lock, lock-&gt;RecursionCount, lock-&gt;Owner, THREAD_SELF()); fflush(stderr);
02355 <span class="preprocessor">#endif</span>
02356 <span class="preprocessor"></span>    <span class="keywordflow">while</span> (! AcquiredLock) {
02357         pthread_mutex_lock(&amp; lock-&gt;CountLock); <span class="comment">/* lock the counter */</span>
02358 <span class="preprocessor">#ifdef DEBUG_LOCKS</span>
02359 <span class="preprocessor"></span>        fprintf(stderr, <span class="stringliteral">"Lock on  [%.150s:%d](0x%p) count=%d owner=%d self=%d\n"</span>,
02360                 FileName, LineNum, lock, lock-&gt;RecursionCount, lock-&gt;Owner, THREAD_SELF()); fflush(stderr);
02361 <span class="preprocessor">#endif</span>
02362 <span class="preprocessor"></span>        <span class="comment">/* RecursionCount is the number of times the platform mutex has</span>
02363 <span class="comment">           been acquired by a single thread. If RecursionCount is zero,</span>
02364 <span class="comment">           the mutex hasn't been acquired by anybody. The CountLock mutex</span>
02365 <span class="comment">           protects RecursionCount. */</span>
02366         <span class="comment">/* Getting a mutex is:</span>
02367 <span class="comment">           pthread_mutex_lock(mutex)   for POSIX threads</span>
02368 <span class="comment">           EnterCriticalSection(lock)  for Windows</span>
02369 <span class="comment">           semTake(lock, WAIT_FOREVER) for VxWorks</span>
02370 <span class="comment">           Getting the current thread ID is:</span>
02371 <span class="comment">           pthread_self()              for POSIX threads</span>
02372 <span class="comment">           GetCurrentThreadId()        for Windows</span>
02373 <span class="comment">           ???                         for VxWorks</span>
02374 <span class="comment">        */</span>
02375         <span class="keywordflow">if</span> (lock-&gt;RecursionCount &lt;= 0) {            <span class="comment">/* Nobody else has this lock */</span>
02376             <span class="keywordflow">if</span> (lock-&gt;RecursionCount &lt; 0) {
02377                 <span class="comment">/* This is a serious logic error and indicates that somebody</span>
02378 <span class="comment">                   has done an extra Unlock(). */</span>
02379                 <a class="code" href="../../dd/d00/_generic_platform_8c.html#a5">LOG_WRITE1</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a168">IPDR_LEVEL_FATAL</a>, <span class="stringliteral">"lock RecursionCount=%d\n"</span>, lock-&gt;RecursionCount);
02380             }
02381             lock-&gt;RecursionCount = 1;                 <span class="comment">/* We have it now */</span>
02382             lock-&gt;Owner = pthread_self();             <span class="comment">/* And remember our thread */</span>
02383             AcquiredLock = 1;                         <span class="comment">/* We'll exit the loop */</span>
02384             pthread_mutex_lock(&amp; lock-&gt;ActualLock);   <span class="comment">/* Get the critical section mutex */</span>
02385         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pthread_equal(lock-&gt;Owner, pthread_self())) { <span class="comment">/* We already have this lock */</span>
02386             lock-&gt;RecursionCount++;                   <span class="comment">/* Increment the counter */</span>
02387             AcquiredLock = 1;                         <span class="comment">/* We'll exit the loop */</span>
02388         }
02389         pthread_mutex_unlock(&amp; lock-&gt;CountLock);
02390         <span class="keywordflow">if</span> (! AcquiredLock) {
02391             <span class="comment">/* Arrive here only if somebody else has the lock */</span>
02392             <span class="comment">/* Wait until the other person has released the platform lock,</span>
02393 <span class="comment">               so that we don't go into a tight loop looking at the count */</span>
02394             pthread_mutex_lock(&amp; lock-&gt;ActualLock);
02395             <span class="comment">/* And unlock the platform lock, and loop. Somebody else might</span>
02396 <span class="comment">               get in here in between, but that'll just be an extra unneeded</span>
02397 <span class="comment">               loop, which we can't prevent anyway.  */</span>
02398             pthread_mutex_unlock(&amp; lock-&gt;ActualLock);
02399         }
02400     }
02401 <span class="preprocessor">#elif defined(_MSC_VER)</span>
02402 <span class="preprocessor"></span><span class="preprocessor">#error _MSC_VER Lock should be integrated with VxWorks, pthreads versions</span>
02403 <span class="preprocessor"></span>    <span class="keywordtype">int</span> AcquiredLock = 0;
02404     <span class="keywordflow">while</span> (! AcquiredLock) {
02405         EnterCriticalSection(&amp; (U-&gt;CountLock));
02406         <span class="keywordflow">if</span> (! U-&gt;RecursionCount) {
02407             U-&gt;RecursionCount = 1;
02408             U-&gt;Owner = GetCurrentThreadId();
02409             AcquiredLock = 1;
02410             EnterCriticalSection(&amp; (U-&gt;ActualLock));
02411         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (U-&gt;Owner == GetCurrentThreadId()) {
02412             U-&gt;RecursionCount++;
02413             AcquiredLock = 1;
02414         }
02415         LeaveCriticalSection(&amp;(U-&gt;CountLock));
02416         <span class="keywordflow">if</span> (! AcquiredLock) {
02417             EnterCriticalSection(&amp; (U-&gt;ActualLock));
02418             LeaveCriticalSection(&amp; (U-&gt;ActualLock));
02419         }
02420     }
02421 <span class="preprocessor">#elif defined(VXWORKS) || defined(_VXWORKS)</span>
02422 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (ERROR == semTake(lock-&gt;ActualLock, WAIT_FOREVER)) {
02423         <span class="comment">/* will get ERROR only if task timed out, which won't happen with WAIT_FOREVER */</span>
02424         taskSuspend(0);
02425     }
02426 <span class="preprocessor">#else</span>
02427 <span class="preprocessor"></span><span class="preprocessor">#error Defined Lock()</span>
02428 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
02429 <span class="preprocessor"></span><span class="preprocessor">#endif </span><span class="comment">/* MT_SUPPORT */</span>
02430 
02431     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
02432 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a36" doxytag="GenericPlatform.c::GenericPlatform_LockPlatform"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_LockPlatform           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>P</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02304 {
02305     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status = <a class="code" href="../../dd/d00/_generic_platform_8c.html#a34">GenericPlatform_Lock</a>(E, E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o4">PlatformLock</a>);
02306     <span class="keywordflow">if</span> (<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status)) {
02307         <a class="code" href="../../dd/d00/_generic_platform_8c.html#a5">LOG_WRITE1</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a168">IPDR_LEVEL_FATAL</a>, <span class="stringliteral">"Platform Lock failed: rc=%d\n"</span>, Status);
02308     }
02309     <span class="keywordflow">return</span> Status;
02310 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a31" doxytag="GenericPlatform.c::GenericPlatform_MainFunc"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void * GenericPlatform_MainFunc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>P</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00615 {
00616     <span class="keyword">struct </span>timeval TV, ETV, prevTV;
00617     <a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html">GenericTimer</a> *T, *ET;
00618     <a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a> E = <a class="code" href="../../dd/d00/_generic_platform_8c.html#a0">CAST_VOID</a>(<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>, P);
00619 
00620     <a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html">GenericFDEvent</a> *UFE;
00621     <a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html">GenericFDEvent</a> *NextUFE, *PrevUFE;
00622     <a class="code" href="../../df/dde/_defs_8h.html#a16">IPDR_BOOL</a> FDEventTriggered;
00623     <a class="code" href="../../df/dde/_defs_8h.html#a16">IPDR_BOOL</a> FDUnregistered;
00624     <span class="keywordtype">int</span> i;
00625 
00626     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a34">GenericPlatform_Lock</a>(P, E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o4">PlatformLock</a>);
00627 
00628     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a46">BlockSigPipe</a>(E);
00629 
00630     E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o7">ScanningFDs</a> = <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
00631     E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o3">Stopped</a> = <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
00632     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a45">GenericPlatform_GetTV</a>(&amp;prevTV);
00633 
00634     <span class="keywordflow">for</span> (;;) {
00635         <span class="keywordtype">int</span> selectRC;
00636         <span class="keywordtype">int</span> selectErrno;
00637         <span class="keywordtype">long</span> timeDelta;
00638         <span class="keyword">struct </span>timeval *ST = NULL;
00639 
00640 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
00641 <span class="preprocessor"></span>        fprintf(stderr, <span class="stringliteral">"MainFunc loop (timers) enabled=%d, stopped=%d\n"</span>, E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o2">Enabled</a>, E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o3">Stopped</a>); fflush(stderr);
00642 <span class="preprocessor">#endif</span>
00643 <span class="preprocessor"></span>
00644         <span class="keywordflow">if</span> (! E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o2">Enabled</a>) {
00645 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
00646 <span class="preprocessor"></span>            fprintf(stderr, <span class="stringliteral">"MainFunc quit[1]\n"</span>); fflush(stderr);
00647 <span class="preprocessor">#endif</span>
00648 <span class="preprocessor"></span>            <span class="keywordflow">goto</span> endMainFunc; <span class="comment">/* need goto because we can't do 2-level break */</span>
00649         }
00650 
00651         <a class="code" href="../../dd/d00/_generic_platform_8c.html#a45">GenericPlatform_GetTV</a>(&amp;TV);
00652 
00653         timeDelta = (TV.tv_sec - prevTV.tv_sec) * 1000 + (TV.tv_usec - prevTV.tv_usec) / 1000;
00654 
00655         <span class="keywordflow">if</span> (timeDelta &lt; 0 || timeDelta &gt; <a class="code" href="../../dd/d00/_generic_platform_8c.html#a16">TIME_SKEW_DELTA</a>) {
00656             <span class="comment">/* Somebody has changed the time, do our best to readjust all</span>
00657 <span class="comment">               the timer events */</span>
00658             <span class="keywordtype">char</span> t1buf[<a class="code" href="../../d5/d74/group___i_p_d_r__time__services.html#ga8">IPDR_TIME_FORMAT_LENGTH</a> + 1];
00659             <span class="keywordtype">char</span> t2buf[<a class="code" href="../../d5/d74/group___i_p_d_r__time__services.html#ga8">IPDR_TIME_FORMAT_LENGTH</a> + 1];
00660             <a class="code" href="../../dd/d00/_generic_platform_8c.html#a7">LOG_WRITE3</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>, <span class="stringliteral">"Clock has changed by %ld millisec from %.99s to %.99s"</span>,
00661                        timeDelta,
00662                        <a class="code" href="../../dd/d00/_generic_platform_8c.html#a44">GenericPlatform_FormatTimeGMT</a>(P, prevTV.tv_sec, t1buf),
00663                        <a class="code" href="../../dd/d00/_generic_platform_8c.html#a44">GenericPlatform_FormatTimeGMT</a>(P, TV.tv_sec, t2buf));
00664             <span class="keywordflow">for</span> (T = E-&gt;Timers; T != NULL; T = T-&gt;NextTimer) {
00665                 T-&gt;ExpirationTime = TV;
00666                 T-&gt;ExpirationTime.tv_sec += (T-&gt;Remaining / 1000);
00667                 T-&gt;ExpirationTime.tv_usec += (T-&gt;Remaining % 1000) * 1000;
00668                 <span class="keywordflow">if</span> (T-&gt;ExpirationTime.tv_usec &gt; 1000000) {
00669                     T-&gt;ExpirationTime.tv_usec -= 1000000;
00670                     T-&gt;ExpirationTime.tv_sec += 1;
00671                 }
00672             }
00673             timeDelta = 0; <span class="comment">/* So it doesn't affect calculation of remaining times below */</span>
00674         }
00675 
00676         prevTV = TV;
00677 
00678         <span class="comment">/* find if there is a timer event */</span>
00679 
00680         <span class="keywordflow">if</span> (E-&gt;Timers != NULL) {
00681 
00682             T = E-&gt;Timers;
00683             ET = NULL; <span class="comment">/* gets the next expiry time */</span>
00684 
00685             <span class="keywordflow">while</span> (T != NULL) {
00686 
00687                 <span class="keywordflow">if</span> (! E-&gt;Enabled) {
00688 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
00689 <span class="preprocessor"></span>                    fprintf(stderr, <span class="stringliteral">"MainFunc quit[2]\n"</span>); fflush(stderr);
00690 <span class="preprocessor">#endif</span>
00691 <span class="preprocessor"></span>                    <span class="keywordflow">goto</span> endMainFunc; <span class="comment">/* need goto because we can't do 2-level break */</span>
00692                 }
00693 
00694                 <span class="comment">/* check for expired timers */</span>
00695                 <span class="keywordflow">if</span> (T-&gt;ExpirationTime.tv_sec &lt; TV.tv_sec ||
00696                     (T-&gt;ExpirationTime.tv_sec == TV.tv_sec
00697                      &amp;&amp; T-&gt;ExpirationTime.tv_usec &lt;= TV.tv_usec)) {
00698 
00699                     T-&gt;Remaining = 0;
00700 
00701                     <span class="keywordflow">if</span> (! T-&gt;Periodic) {
00702                         <span class="comment">/* unlink but don't delete because an unregister call</span>
00703 <span class="comment">                           will do that. */</span>
00704                         <span class="keywordflow">if</span> (T-&gt;PrevTimer == NULL)
00705                             E-&gt;Timers = T-&gt;NextTimer;
00706                         <span class="keywordflow">else</span>
00707                             T-&gt;PrevTimer-&gt;NextTimer = T-&gt;NextTimer;
00708 
00709                         <span class="keywordflow">if</span> (T-&gt;NextTimer != NULL)
00710                             T-&gt;NextTimer-&gt;PrevTimer = T-&gt;PrevTimer;
00711 
00712                         T-&gt;Expired = <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>;
00713 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
00714 <span class="preprocessor"></span>                        fprintf(stderr, <span class="stringliteral">"MainFunc timer callback\n"</span>); fflush(stderr);
00715 <span class="preprocessor">#endif</span>
00716 <span class="preprocessor"></span>                        T-&gt;Callback(T-&gt;Arg);
00717 
00718                         T = E-&gt;Timers; <span class="comment">/* repeat from beginning ... probably not needed but best to be safe. */</span>
00719                         <span class="keywordflow">continue</span>;
00720                     } <span class="keywordflow">else</span> { <span class="comment">/* periodic */</span>
00721                         <span class="comment">/* recalculate the expiration time of the timer */</span>
00722                         <a class="code" href="../../dd/d00/_generic_platform_8c.html#a45">GenericPlatform_GetTV</a>((&amp; (T-&gt;ExpirationTime)));
00723                         T-&gt;Remaining = T-&gt;Timeout;
00724                         T-&gt;ExpirationTime.tv_sec += (T-&gt;Timeout / 1000);
00725                         T-&gt;ExpirationTime.tv_usec += (T-&gt;Timeout % 1000) * 1000;
00726                         <span class="keywordflow">if</span> (T-&gt;ExpirationTime.tv_usec &gt; 1000000) {
00727                             T-&gt;ExpirationTime.tv_usec -= 1000000;
00728                             T-&gt;ExpirationTime.tv_sec += 1;
00729                         }
00730 
00731 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
00732 <span class="preprocessor"></span>                        fprintf(stderr, <span class="stringliteral">"MainFunc timer callback\n"</span>); fflush(stderr);
00733 <span class="preprocessor">#endif</span>
00734 <span class="preprocessor"></span>                        T-&gt;Callback(T-&gt;Arg);
00735 
00736                         T = E-&gt;Timers; <span class="comment">/* repeat from beginning because this one might need firing again */</span>
00737                         <span class="keywordflow">continue</span>;
00738                     }
00739                 } <span class="keywordflow">else</span> { <span class="comment">/* not yet expired */</span>
00740                     <span class="keywordflow">if</span> (ET == NULL ||
00741                         T-&gt;ExpirationTime.tv_sec &lt; ET-&gt;ExpirationTime.tv_sec ||
00742                         (T-&gt;ExpirationTime.tv_sec == ET-&gt;ExpirationTime.tv_sec &amp;&amp;
00743                          T-&gt;ExpirationTime.tv_usec &lt; ET-&gt;ExpirationTime.tv_usec)) {
00744                         T-&gt;Remaining -= timeDelta;
00745                         ET = T;
00746                     }
00747                 }
00748 
00749                 T = T-&gt;NextTimer;
00750             } <span class="comment">/* while (T != NULL) */</span>
00751 
00752             <span class="keywordflow">if</span> (ET != NULL) {
00753                 ETV.tv_sec = ET-&gt;ExpirationTime.tv_sec - TV.tv_sec;
00754                 ETV.tv_usec = ET-&gt;ExpirationTime.tv_usec - TV.tv_usec;
00755 
00756                 <span class="keywordflow">while</span> (ETV.tv_usec &lt; 0) {
00757                     ETV.tv_sec -= 1;
00758                     ETV.tv_usec += 1000000;
00759                 }
00760                 <span class="keywordflow">if</span> (ETV.tv_sec &lt; 0) { <span class="comment">/* shouldn't happen, but let's be safe */</span>
00761                     ETV.tv_sec = 0;
00762                     ETV.tv_usec = 1;
00763                 }
00764 
00765                 ST = &amp; ETV;
00766             }
00767         } <span class="comment">/* if (E-&gt;Timers != NULL) */</span>
00768 
00769         <span class="keywordflow">if</span> (ST == NULL) { <span class="comment">/* Don't wait too long, just in case */</span>
00770             ETV.tv_sec = 1;
00771             ETV.tv_usec = 0;
00772             ST = &amp; ETV;
00773         }
00774 
00775         <span class="comment">/* We've finished looking for timer events. Now, let's try for an</span>
00776 <span class="comment">           I/O event. */</span>
00777 
00778 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
00779 <span class="preprocessor"></span>        fprintf(stderr, <span class="stringliteral">"MainFunc select delay %ldsec %ldusec\n"</span>, ST-&gt;tv_sec, ST-&gt;tv_usec); fflush(stderr);
00780 <span class="preprocessor">#endif</span>
00781 <span class="preprocessor"></span>
00782 <span class="preprocessor">#ifdef _MSC_VER</span>
00783 <span class="preprocessor"></span><span class="preprocessor">#error Need to verify that select with empty list of FDs works for _MSC_VER</span>
00784 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00785 <span class="preprocessor"></span>
00786         <span class="comment">/* The following is a rather crude way of ensuring that we don't</span>
00787 <span class="comment">         * wait too long (e.g., a register timer event happens in another</span>
00788 <span class="comment">         * thread or --- more important --- the main loop has been</span>
00789 <span class="comment">         * stopped). A better way would be if we could wake up the select</span>
00790 <span class="comment">         * ... that could be done with pipes but wouldn't be very</span>
00791 <span class="comment">         * platform-indepedent. As things are, we wake up every 0.5</span>
00792 <span class="comment">         * second, find that there are no timer events, and go back to</span>
00793 <span class="comment">         * sleep.</span>
00794 <span class="comment">         *</span>
00795 <span class="comment">         * If you change this value, be sure to modify the time-out loop in</span>
00796 <span class="comment">         * GenericPlatform_Stop!!!</span>
00797 <span class="comment">         */</span>
00798 
00799         <span class="keywordflow">if</span> (ST-&gt;tv_sec &gt;= 0 || ST-&gt;tv_usec &gt;= <a class="code" href="../../dd/d00/_generic_platform_8c.html#a15">MAX_TIMEWAIT</a>) {
00800             ST-&gt;tv_sec = 0;
00801             ST-&gt;tv_usec = 500000;
00802 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
00803 <span class="preprocessor"></span>            fprintf(stderr, <span class="stringliteral">"MainFunc select delay reset to %ldsec %ldusec\n"</span>, ST-&gt;tv_sec, ST-&gt;tv_usec); fflush(stderr);
00804 <span class="preprocessor">#endif</span>
00805 <span class="preprocessor"></span>        }
00806 
00807         <span class="keywordflow">if</span> (! E-&gt;Enabled) {
00808 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
00809 <span class="preprocessor"></span>            fprintf(stderr, <span class="stringliteral">"MainFunc quit[3]\n"</span>); fflush(stderr);
00810 <span class="preprocessor">#endif</span>
00811 <span class="preprocessor"></span>            <span class="keywordflow">goto</span> endMainFunc; <span class="comment">/* need goto because we can't do 2-level break */</span>
00812         }
00813 
00814         <a class="code" href="../../dd/d00/_generic_platform_8c.html#a35">GenericPlatform_Unlock</a>(P, E-&gt;PlatformLock);
00815 
00816         selectErrno = 0;
00817         errno = 0;
00818         selectRC = select(E-&gt;MaxFD.socketFd + 1, &amp; (E-&gt;ReadFDs), &amp; (E-&gt;WriteFDs), NULL, ST);
00819         <span class="comment">/* The only errno that should be OK is EINTR ... this just means</span>
00820 <span class="comment">           to re-do the select.*/</span>
00821         <span class="keywordflow">if</span> (selectRC != 0) {
00822             selectErrno = errno;
00823         }
00824 
00825         <a class="code" href="../../dd/d00/_generic_platform_8c.html#a34">GenericPlatform_Lock</a>(E, E-&gt;PlatformLock);
00826 
00827 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
00828 <span class="preprocessor"></span>        fprintf(stderr, <span class="stringliteral">"MainFunc loop (FDs) enabled=%d, stopped=%d, selectRC=%d\n"</span>, E-&gt;Enabled, E-&gt;Stopped, selectRC); fflush(stderr);
00829 <span class="preprocessor">#endif</span>
00830 <span class="preprocessor"></span>
00831         <span class="comment">/* Do *NOT* check for selectRC here ... the code depends on</span>
00832 <span class="comment">         * going through the FDs, which resets the bits ... if no</span>
00833 <span class="comment">         * callback was triggered, then there's a break from the</span>
00834 <span class="comment">         * loop. */</span>
00835 
00836         <span class="keywordflow">for</span> (i = 0; ; i++) { <span class="comment">/* Do at most MAX_SELECT_ITERATIONS times</span>
00837 <span class="comment">                                ... break is just before select() at</span>
00838 <span class="comment">                                end of this loop. We have the loop so</span>
00839 <span class="comment">                                that we can clean up a bunch of</span>
00840 <span class="comment">                                pending reads before looking for timer</span>
00841 <span class="comment">                                events. */</span>
00842 
00843             <span class="keywordflow">if</span> (! E-&gt;Enabled) {
00844 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
00845 <span class="preprocessor"></span>                fprintf(stderr, <span class="stringliteral">"MainFunc quit[4]\n"</span>); fflush(stderr);
00846 <span class="preprocessor">#endif</span>
00847 <span class="preprocessor"></span>                <span class="keywordflow">goto</span> endMainFunc; <span class="comment">/* need goto because we can't do 2-level break */</span>
00848             }
00849 
00850             <span class="keywordflow">if</span> (selectRC &lt; 0) {
00851                                 <span class="keywordflow">switch</span>(selectErrno){
00852                         <span class="keywordflow">case</span> EINTR:
00853                                                 <a class="code" href="../../dd/d00/_generic_platform_8c.html#a7">LOG_WRITE3</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a170">IPDR_LEVEL_WARNING</a>, <span class="stringliteral">"selectRC[%d]==EINTR (%d) (%.50s)"</span>, i, selectErrno, strerror(selectErrno));
00854                                                 <span class="keywordflow">break</span>;
00855                                         <span class="keywordflow">case</span> EBADF:
00856                                                 <a class="code" href="../../dd/d00/_generic_platform_8c.html#a7">LOG_WRITE3</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a170">IPDR_LEVEL_WARNING</a>, <span class="stringliteral">"selectRC[%d]==EBADF (%d) (%.50s)"</span>, i, selectErrno, strerror(selectErrno));
00857                                                 <span class="keywordflow">break</span>;
00858                                         <span class="keywordflow">case</span> EINVAL:
00859                                                 <a class="code" href="../../dd/d00/_generic_platform_8c.html#a7">LOG_WRITE3</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a170">IPDR_LEVEL_WARNING</a>, <span class="stringliteral">"selectRC[%d]==EINVAL (%d) (%.50s)"</span>, i, selectErrno, strerror(selectErrno));
00860                                                 <span class="keywordflow">break</span>;
00861                                         <span class="keywordflow">case</span> ENOMEM:
00862                                                 <a class="code" href="../../dd/d00/_generic_platform_8c.html#a7">LOG_WRITE3</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a170">IPDR_LEVEL_WARNING</a>, <span class="stringliteral">"selectRC[%d]==ENOMEM (%d) (%.50s)"</span>, i, selectErrno, strerror(selectErrno));
00863                                                 <span class="keywordflow">goto</span> endMainFunc; <span class="comment">/* need goto because we can't do 2-level break */</span>
00864                                                 <span class="keywordflow">break</span>;
00865                                 }
00866                 <span class="keywordflow">break</span>; <span class="comment">/* get out of select() ... do timeouts again */</span>
00867             }
00868             <span class="comment">/* It's hard to say what we should do if we got a bad return</span>
00869 <span class="comment">               code from select() and errno != EINTR. For now, let's just</span>
00870 <span class="comment">               keep on doing the code and hope for the best. For future, we</span>
00871 <span class="comment">               should probably have a "deep bail-out" function from</span>
00872 <span class="comment">               MainFunc, which can do something desperate, such as</span>
00873 <span class="comment">               System.exit(). */</span>
00874 
00875             <span class="comment">/* invoke callbacks associated with file descriptors */</span>
00876 
00877             E-&gt;ScanningFDs = <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>;
00878 
00879             FDEventTriggered = <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
00880             FDUnregistered = <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
00881 
00882             <span class="keywordflow">for</span> (UFE = E-&gt;FDReadEvents; UFE != NULL; UFE = UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o4">NextEvent</a>) {
00883 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
00884 <span class="preprocessor"></span>                fprintf(stderr, <span class="stringliteral">"*** MainFunc: Read FD "</span> <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga0">Platform_SOCKET_FMT</a> <span class="stringliteral">" for run MT\n"</span>, <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga1">Platform_SOCKET_DISPLAY</a>(UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o0">FD</a>)); fflush(stderr);
00885 <span class="preprocessor">#endif</span>
00886 <span class="preprocessor"></span>                <span class="keywordflow">if</span> (! E-&gt;Enabled) {
00887 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
00888 <span class="preprocessor"></span>                    fprintf(stderr, <span class="stringliteral">"MainFunc quit[5]\n"</span>); fflush(stderr);
00889 <span class="preprocessor">#endif</span>
00890 <span class="preprocessor"></span>                    <span class="keywordflow">goto</span> endMainFunc; <span class="comment">/* need goto because we can't do 2-level break */</span>
00891                 }
00892 
00893                 <span class="keywordflow">if</span> (UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o3">Unregistered</a>) {
00894                     FDUnregistered = <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>;
00895 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
00896 <span class="preprocessor"></span>                    fprintf(stderr, <span class="stringliteral">"MainFunc callback unregistered fd "</span> <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga0">Platform_SOCKET_FMT</a> <span class="stringliteral">"\n"</span>, <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga1">Platform_SOCKET_DISPLAY</a>(UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o0">FD</a>)); fflush(stderr);
00897 <span class="preprocessor">#endif</span>
00898 <span class="preprocessor"></span>                } <span class="keywordflow">else</span> {
00899                     <span class="comment">/* Note that the Callback might call UnregisterSocket, which</span>
00900 <span class="comment">                       would clear the UFE-&gt;FD entry */</span>
00901                     <span class="keywordflow">if</span> (FD_ISSET(UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o0">FD</a>.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, &amp; (E-&gt;ReadFDs)) &amp;&amp; selectRC &gt;= 0) {
00902 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
00903 <span class="preprocessor"></span>                        fprintf(stderr, <span class="stringliteral">"MainFunc callback read fd "</span> <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga0">Platform_SOCKET_FMT</a> <span class="stringliteral">"\n"</span>, <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga1">Platform_SOCKET_DISPLAY</a>(UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o0">FD</a>)); fflush(stderr);
00904 <span class="preprocessor">#endif</span>
00905 <span class="preprocessor"></span>                        UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o1">Callback</a>(UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o0">FD</a>, UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o2">Arg</a>);
00906                         FDEventTriggered = <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>;
00907                     } <span class="keywordflow">else</span> {
00908                         FD_SET(UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o0">FD</a>.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, (&amp; E-&gt;ReadFDs)); <span class="comment">/* set it on for next select */</span>
00909                     }
00910                 }
00911             } <span class="comment">/* loop over read events */</span>
00912 
00913             <span class="keywordflow">for</span> (UFE = E-&gt;FDWriteEvents; UFE != NULL; UFE = UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o4">NextEvent</a>) {
00914 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
00915 <span class="preprocessor"></span>                fprintf(stderr, <span class="stringliteral">"*** MainFunc: Write FD "</span> <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga0">Platform_SOCKET_FMT</a> <span class="stringliteral">" for run MT"</span>, <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga1">Platform_SOCKET_DISPLAY</a>(UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o0">FD</a>)); fflush(stderr);
00916 <span class="preprocessor">#endif</span>
00917 <span class="preprocessor"></span>                <span class="keywordflow">if</span> (! E-&gt;Enabled) {
00918 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
00919 <span class="preprocessor"></span>                    fprintf(stderr, <span class="stringliteral">"MainFunc quit[6]\n"</span>); fflush(stderr);
00920 <span class="preprocessor">#endif</span>
00921 <span class="preprocessor"></span>                    <span class="keywordflow">goto</span> endMainFunc; <span class="comment">/* need goto because we can't do 2-level break */</span>
00922                 }
00923                 <span class="keywordflow">if</span> (! UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o3">Unregistered</a>) {
00924                     <span class="comment">/* Note that the Callback might call UnregisterSocket, which</span>
00925 <span class="comment">                       would clear the UFE-&gt;FD entry */</span>
00926                     <span class="keywordflow">if</span> (FD_ISSET(UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o0">FD</a>.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, &amp; (E-&gt;WriteFDs)) &amp;&amp; selectRC &gt;= 0) {
00927 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
00928 <span class="preprocessor"></span>                        fprintf(stderr, <span class="stringliteral">"MainFunc callback write fd "</span> <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga0">Platform_SOCKET_FMT</a> <span class="stringliteral">"\n"</span>, <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga1">Platform_SOCKET_DISPLAY</a>(UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o0">FD</a>)); fflush(stderr);
00929 <span class="preprocessor">#endif</span>
00930 <span class="preprocessor"></span>                        UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o1">Callback</a>(UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o0">FD</a>, UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o2">Arg</a>);
00931                         FDEventTriggered = <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>;
00932                     } <span class="keywordflow">else</span> {
00933                         FD_SET(UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o0">FD</a>.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, (&amp; E-&gt;WriteFDs)); <span class="comment">/* for next select */</span>
00934                     }
00935                 }
00936             } <span class="comment">/* loop over write events */</span>
00937 
00938             E-&gt;ScanningFDs = <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
00939 
00940             <span class="comment">/* If a file descriptor was unregistered, scan the file</span>
00941 <span class="comment">             * descriptors lists for unregistered FDs */</span>
00942 
00943             <span class="keywordflow">if</span> (FDUnregistered) {
00944                 E-&gt;MaxFD.socketFd = -1;
00945                 UFE = E-&gt;FDReadEvents;
00946                 PrevUFE = NULL;
00947                 <span class="keywordflow">while</span> (UFE != NULL) {
00948                     NextUFE = UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o4">NextEvent</a>;
00949                     <span class="keywordflow">if</span> (UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o3">Unregistered</a>) {
00950                         FD_CLR(UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o0">FD</a>.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, (&amp; E-&gt;ReadFDs));
00951                         <span class="keywordflow">if</span> (PrevUFE == NULL)
00952                             E-&gt;FDReadEvents = NextUFE;
00953                         <span class="keywordflow">else</span>
00954                             PrevUFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o4">NextEvent</a> = NextUFE;
00955                         <a class="code" href="../../dd/d00/_generic_platform_8c.html#a39">GenericPlatform_MemoryFree</a>(E, UFE);
00956                     } <span class="keywordflow">else</span> {
00957                         <span class="keywordflow">if</span> (UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o0">FD</a>.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a> &gt; E-&gt;MaxFD.socketFd)
00958                             E-&gt;MaxFD = UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o0">FD</a>;
00959                         PrevUFE = UFE;
00960                     }
00961                     UFE = NextUFE;
00962                 }
00963 
00964                 UFE = E-&gt;FDWriteEvents;
00965                 PrevUFE = NULL;
00966                 <span class="keywordflow">while</span> (UFE != NULL) {
00967                     NextUFE = UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o4">NextEvent</a>;
00968                     <span class="keywordflow">if</span> (UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o3">Unregistered</a>) {
00969                         FD_CLR(UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o0">FD</a>.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, (&amp; E-&gt;WriteFDs));
00970                         <span class="keywordflow">if</span> (PrevUFE == NULL)
00971                             E-&gt;FDWriteEvents = NextUFE;
00972                         <span class="keywordflow">else</span>
00973                             PrevUFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o4">NextEvent</a> = NextUFE;
00974                         <a class="code" href="../../dd/d00/_generic_platform_8c.html#a39">GenericPlatform_MemoryFree</a>(E, UFE);
00975                     } <span class="keywordflow">else</span> {
00976                         <span class="keywordflow">if</span> (UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o0">FD</a>.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a> &gt; E-&gt;MaxFD.socketFd)
00977                             E-&gt;MaxFD = UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o0">FD</a>;
00978                         PrevUFE = UFE;
00979                     }
00980                     UFE = NextUFE;
00981                 }
00982             } <span class="comment">/* if FDUnregistered */</span>
00983 
00984             <span class="keywordflow">if</span> (! E-&gt;Enabled) {
00985 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
00986 <span class="preprocessor"></span>                fprintf(stderr, <span class="stringliteral">"MainFunc quit[7]\n"</span>); fflush(stderr);
00987 <span class="preprocessor">#endif</span>
00988 <span class="preprocessor"></span>                <span class="keywordflow">goto</span> endMainFunc; <span class="comment">/* need goto because we can't do 2-level break */</span>
00989             }
00990 
00991             <span class="comment">/* If no I/O event happened, we're finished. Otherwise,</span>
00992 <span class="comment">             * continue on doing select()s but don't do the timer</span>
00993 <span class="comment">             * loop. The select()s are with no timeout ... we're just</span>
00994 <span class="comment">             * trying to process a bunch of pending I/Os as fast as we</span>
00995 <span class="comment">             * can without any relocking/unlocking of the mutexes. */</span>
00996 
00997             <span class="keywordflow">if</span> (! FDEventTriggered || E-&gt;MaxFD.socketFd == -1)
00998                 break ;
00999 
01000 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
01001 <span class="preprocessor"></span>            fprintf(stderr, <span class="stringliteral">"MainFunc loop (FD iteration) enabled=%d, stopped=%d\n"</span>, E-&gt;Enabled, E-&gt;Stopped); fflush(stderr);
01002 <span class="preprocessor">#endif</span>
01003 <span class="preprocessor"></span>
01004             <span class="keywordflow">if</span> (! E-&gt;Enabled) {
01005 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
01006 <span class="preprocessor"></span>                fprintf(stderr, <span class="stringliteral">"MainFunc quit[8]\n"</span>); fflush(stderr);
01007 <span class="preprocessor">#endif</span>
01008 <span class="preprocessor"></span>                <span class="keywordflow">goto</span> endMainFunc; <span class="comment">/* need goto because we can't do 2-level break */</span>
01009             }
01010 
01011             <span class="keywordflow">if</span> (i &gt;= <a class="code" href="../../dd/d00/_generic_platform_8c.html#a12">MAX_SELECT_ITERATIONS</a>) { <span class="comment">/* but don't do it too many times */</span>
01012                 <span class="keywordflow">break</span>;
01013             }
01014 
01015             selectErrno = 0;
01016             errno = 0;
01017             selectRC = select(E-&gt;MaxFD.socketFd + 1, &amp; E-&gt;ReadFDs, &amp; E-&gt;WriteFDs, NULL, &amp; <a class="code" href="../../dd/d00/_generic_platform_8c.html#a23">ZeroTV</a>);
01018             <span class="keywordflow">if</span> (selectRC &lt; 0) {
01019                 selectErrno = errno;
01020             }
01021 
01022         } <span class="comment">/* for (i = 0; i &lt; MAX_SELECT_ITERATIONS &amp;&amp; E-&gt;Enabled; i++) */</span>
01023 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
01024 <span class="preprocessor"></span>        fprintf(stderr, <span class="stringliteral">"MainFunc loop (end FD iterations) enabled=%d, stopped=%d\n"</span>, E-&gt;Enabled, E-&gt;Stopped); fflush(stderr);
01025 <span class="preprocessor">#endif</span>
01026 <span class="preprocessor"></span>    } <span class="comment">/* while (E-&gt;Enabled) */</span>
01027 
01028 endMainFunc:
01029 
01030 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
01031 <span class="preprocessor"></span>    fprintf(stderr, <span class="stringliteral">"MainFunc finished enabled=%d, stopped=%d\n"</span>, E-&gt;Enabled, E-&gt;Stopped); fflush(stderr);
01032 <span class="preprocessor">#endif</span>
01033 <span class="preprocessor"></span>
01034     E-&gt;Stopped = <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>; <span class="comment">/* Signal to GeneralPlatform_Stop that we've left the loop */</span>
01035 
01036     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a35">GenericPlatform_Unlock</a>(P, E-&gt;PlatformLock);
01037 
01038 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
01039 <span class="preprocessor"></span>    fprintf(stderr, <span class="stringliteral">"MainFunc finished[2] enabled=%d, stopped=%d\n"</span>, E-&gt;Enabled, E-&gt;Stopped); fflush(stderr);
01040 <span class="preprocessor">#endif</span>
01041 <span class="preprocessor"></span>
01042     <span class="keywordflow">return</span> NULL;
01043 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a55" doxytag="GenericPlatform.c::GenericPlatform_MemoryAllocate"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_MemoryAllocate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>Size</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void **&nbsp;</td>
          <td class="mdname" nowrap> <em>Buf</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01106 {
01107     <a class="code" href="../../d4/dd2/struct_generic_mem_hdr.html">GenericMemHdr</a> *mh;
01108 
01109     Size += <span class="keyword">sizeof</span> (<a class="code" href="../../d4/dd2/struct_generic_mem_hdr.html">GenericMemHdr</a>);
01110 
01111     E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o13">numAllocs</a>++;
01112     E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o15">bytesAllocated</a> += Size;
01113 <span class="comment">/*</span>
01114 <span class="comment">        printf("%s allocates %d bytes, %d allocs, total %lu\n", E-&gt;eyecatcher, Size, E-&gt;numAllocs, E-&gt;bytesAllocated );</span>
01115 <span class="comment">*/</span>
01116     mh = malloc(Size);
01117 
01118     <span class="keywordflow">if</span> (mh == NULL)
01119         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a182">IPDR_ERR_ALLOCATION_FAILED</a>;
01120 
01121     mh-&gt;<a class="code" href="../../d4/dd2/struct_generic_mem_hdr.html#o0">size</a> = Size;
01122     mh-&gt;<a class="code" href="../../d4/dd2/struct_generic_mem_hdr.html#o1">ReferenceCount_unused</a> = -999;
01123     mh-&gt;<a class="code" href="../../d4/dd2/struct_generic_mem_hdr.html#o2">Destructor_unused</a> = 0;
01124 <span class="preprocessor">#ifdef DEBUG_MODE</span>
01125 <span class="preprocessor"></span>    mh-&gt;<a class="code" href="../../d4/dd2/struct_generic_mem_hdr.html#o3">eyecatcher</a> = 0xdeadbeef;
01126 <span class="preprocessor">#endif</span>
01127 <span class="preprocessor"></span>    *Buf = (<span class="keywordtype">char</span> *)mh + <span class="keyword">sizeof</span> (<a class="code" href="../../d4/dd2/struct_generic_mem_hdr.html">GenericMemHdr</a>);
01128 
01129     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01130 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a56" doxytag="GenericPlatform.c::GenericPlatform_MemoryAllocateWithHdr"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_MemoryAllocateWithHdr           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>HdrSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>Size</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void **&nbsp;</td>
          <td class="mdname" nowrap> <em>Buf</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01134 {
01135     <span class="comment">/* This initial test will be optimized away */</span>
01136     <span class="keywordflow">if</span> (HdrSize != <span class="keyword">sizeof</span> (<a class="code" href="../../d4/dd2/struct_generic_mem_hdr.html">GenericMemHdr</a>)) {
01137         <a class="code" href="../../dd/d00/_generic_platform_8c.html#a6">LOG_WRITE2</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a168">IPDR_LEVEL_FATAL</a>, <span class="stringliteral">"MemoryAllocateWithHdr hdr size invalid: %u should be %u ***"</span>,
01138                    HdrSize, <span class="keyword">sizeof</span> (GenericMemHdr));
01139         <a class="code" href="../../dd/d00/_generic_platform_8c.html#a1">ABORT_CALL</a>;
01140     }
01141 
01142     <span class="keywordflow">return</span> <a class="code" href="../../dd/d00/_generic_platform_8c.html#a55">GenericPlatform_MemoryAllocate</a>(E, HdrSize + Size, Buf);
01143 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a39" doxytag="GenericPlatform.c::GenericPlatform_MemoryFree"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_MemoryFree           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>Buf</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01147 {
01148     <span class="keywordflow">if</span> (Buf != NULL) {
01149         <a class="code" href="../../d4/dd2/struct_generic_mem_hdr.html">GenericMemHdr</a>* mh = (<a class="code" href="../../d4/dd2/struct_generic_mem_hdr.html">GenericMemHdr</a>*) ((<span class="keywordtype">char</span>*)Buf - <span class="keyword">sizeof</span> (<a class="code" href="../../d4/dd2/struct_generic_mem_hdr.html">GenericMemHdr</a>));
01150         E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o14">numFrees</a>++;
01151         E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o15">bytesAllocated</a> -= mh-&gt;<a class="code" href="../../d4/dd2/struct_generic_mem_hdr.html#o0">size</a>;
01152 
01153 <span class="preprocessor">#ifdef DEBUG_MODE</span>
01154 <span class="preprocessor"></span>        mh-&gt;<a class="code" href="../../d4/dd2/struct_generic_mem_hdr.html#o3">eyecatcher</a> = 0xdeadbeef;
01155 <span class="preprocessor">#endif</span>
01156 <span class="preprocessor"></span>        free(mh);
01157     }
01158         <span class="keywordflow">else</span>
01159         {
01160                 <span class="comment">/* This is a serious logic error and indicates that somebody</span>
01161 <span class="comment">           has done an extra MemoryFree. */</span>
01162                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a175">IPDR_ERR_MEMORY_FREE</a>;
01163         }
01164     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01165 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a57" doxytag="GenericPlatform.c::GenericPlatform_MemoryFreeWithHdr"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_MemoryFreeWithHdr           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>HdrSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>Buf</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01169 {
01170     <span class="keywordflow">if</span> (Buf != NULL) {
01171         <span class="comment">/* This test will be optimized away */</span>
01172         <span class="keywordflow">if</span> (HdrSize != <span class="keyword">sizeof</span> (<a class="code" href="../../d4/dd2/struct_generic_mem_hdr.html">GenericMemHdr</a>)) {
01173             <a class="code" href="../../dd/d00/_generic_platform_8c.html#a6">LOG_WRITE2</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a168">IPDR_LEVEL_FATAL</a>, <span class="stringliteral">"MemoryFreeWitHHdr hdr size invalid: %u should be %u ***\n"</span>,
01174                        HdrSize, <span class="keyword">sizeof</span> (GenericMemHdr));
01175             <a class="code" href="../../dd/d00/_generic_platform_8c.html#a1">ABORT_CALL</a>;
01176         }
01177         <span class="keywordflow">return</span> <a class="code" href="../../dd/d00/_generic_platform_8c.html#a39">GenericPlatform_MemoryFree</a>(E, (<span class="keywordtype">char</span>*)Buf+HdrSize);
01178     }
01179         <span class="keywordflow">else</span>
01180         {
01181                 <span class="comment">/* This is a serious logic error and indicates that somebody</span>
01182 <span class="comment">           has done an extra MemoryFree. */</span>
01183                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a175">IPDR_ERR_MEMORY_FREE</a>;
01184         }
01185     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01186 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a58" doxytag="GenericPlatform.c::GenericPlatform_MemoryStatistics"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_MemoryStatistics           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int *&nbsp;</td>
          <td class="mdname" nowrap> <em>numAllocs</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int *&nbsp;</td>
          <td class="mdname" nowrap> <em>numFrees</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>size_t *&nbsp;</td>
          <td class="mdname" nowrap> <em>bytesAllocated</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01195 {
01196         <span class="keywordflow">if</span>(!numAllocs || !numFrees || !bytesAllocated)
01197                 <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a181">IPDR_ERR_INVALID_VALUE</a>;
01198 
01199     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a34">GenericPlatform_Lock</a>(E, E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o4">PlatformLock</a>);
01200     *numAllocs = E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o13">numAllocs</a>;
01201     *numFrees = E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o14">numFrees</a>;
01202     *bytesAllocated = E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o15">bytesAllocated</a>;
01203     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a35">GenericPlatform_Unlock</a>(E, E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o4">PlatformLock</a>);
01204     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01205 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a66" doxytag="GenericPlatform.c::GenericPlatform_PersistentRetrieve"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_PersistentRetrieve           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>UnitName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char **&nbsp;</td>
          <td class="mdname" nowrap> <em>Buffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int *&nbsp;</td>
          <td class="mdname" nowrap> <em>BufferLength</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01576 {
01577     FILE *FP;
01578     <span class="keyword">struct </span>stat StatBuf;
01579 
01580     <span class="keywordflow">if</span> (stat(<a class="code" href="../../dd/d00/_generic_platform_8c.html#a17">CONST_CAST_CHARPTR</a>(UnitName), &amp; StatBuf) &lt; 0)
01581         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a187">IPDR_ERR_PERSISTENCE_ERROR</a>;
01582 
01583     *BufferLength = StatBuf.st_size;
01584 
01585 <span class="preprocessor">#ifdef DEBUG_MEMORY</span>
01586 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(GenericPlatform_dm_MemoryAllocate(E, *BufferLength, (<span class="keywordtype">void</span>**)Buffer,
01587                                                       <span class="stringliteral">"PersistentRetrieve-"</span> __FILE__, __LINE__))) {
01588         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a182">IPDR_ERR_ALLOCATION_FAILED</a>;
01589     }
01590 <span class="preprocessor">#else</span>
01591 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(<a class="code" href="../../dd/d00/_generic_platform_8c.html#a55">GenericPlatform_MemoryAllocate</a>(E, *BufferLength, (<span class="keywordtype">void</span>**)Buffer))) {
01592         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a182">IPDR_ERR_ALLOCATION_FAILED</a>;
01593     }
01594 <span class="preprocessor">#endif</span>
01595 <span class="preprocessor"></span>
01596     FP = fopen(UnitName, <span class="stringliteral">"r"</span>);
01597     <span class="keywordflow">if</span> (FP == NULL)
01598         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a187">IPDR_ERR_PERSISTENCE_ERROR</a>;
01599 
01600     <span class="keywordflow">if</span> (fread(*Buffer, 1, *BufferLength, FP) &lt; (size_t) *BufferLength) {
01601         <a class="code" href="../../dd/d00/_generic_platform_8c.html#a39">GenericPlatform_MemoryFree</a>(E, *Buffer);
01602         *Buffer = 0;
01603         fclose(FP);
01604         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a187">IPDR_ERR_PERSISTENCE_ERROR</a>;
01605     }
01606 
01607     fclose(FP);
01608     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01609 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a67" doxytag="GenericPlatform.c::GenericPlatform_PersistentStore"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_PersistentStore           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>UnitName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>Buffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>BufferLength</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01614 {
01615     FILE *FP = fopen(UnitName, <span class="stringliteral">"w"</span>);
01616 
01617     <span class="keywordflow">if</span> (FP == NULL)
01618         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a187">IPDR_ERR_PERSISTENCE_ERROR</a>;
01619 
01620     <span class="keywordflow">if</span> (fwrite(Buffer, 1, BufferLength, FP) &lt; (size_t) BufferLength) {
01621         fclose(FP);
01622         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a187">IPDR_ERR_PERSISTENCE_ERROR</a>;
01623     }
01624 
01625     fclose(FP);
01626     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01627 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a78" doxytag="GenericPlatform.c::GenericPlatform_Recv"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_Recv           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>Buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>BufLength</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>Timeout</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int *&nbsp;</td>
          <td class="mdname" nowrap> <em>ReadBytes</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01984 {
01985     <span class="keywordtype">int</span> recvRC;
01986 
01987     *ReadBytes = 0;
01988 
01989 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
01990 <span class="preprocessor"></span>    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a7">LOG_WRITE3</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a172">IPDR_LEVEL_DEBUG</a>,
01991                <span class="stringliteral">"---GenericPlatform_Recv(bufLen=%ud timeout=%d socket="</span> <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga0">Platform_SOCKET_FMT</a>,
01992                BufLength, Timeout, <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga1">Platform_SOCKET_DISPLAY</a>(S));
01993 <span class="preprocessor">#endif</span>
01994 <span class="preprocessor"></span>
01995     <span class="comment">/* if a timeout is specified, do a poll or select until the socket is readable */</span>
01996     <span class="keywordflow">if</span> (Timeout &gt; 0) {
01997         <span class="comment">/* The following code assumes that we're in non-blocking</span>
01998 <span class="comment">           mode ... if not, strange things could happen. */</span>
01999 <span class="preprocessor">#if 1 || defined(VXWORKS) </span><span class="comment">/* implement this with select() for all platforms, to make sure it works ...</span>
02000 <span class="comment">                             but poll() is better for non-VxWorks */</span>
02001 <span class="keyword">struct </span>timeval timeout;
02002 <span class="keywordtype">int</span> selectRC;
02003 fd_set FDSet;
02004 FD_ZERO(&amp; FDSet);
02005 FD_SET(S.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, &amp; FDSet);
02006 timeout.tv_sec = Timeout / 1000;
02007 timeout.tv_usec = (Timeout % 1000) * 1000;
02008 <span class="keywordflow">for</span> (;;) { <span class="comment">/* select() until we don't get EINTR result */</span>
02009     errno = 0;
02010     selectRC = select(S.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a> + 1, &amp; FDSet, NULL, NULL, &amp; timeout);
02011     <span class="keywordflow">if</span> (selectRC &lt; 0 &amp;&amp; errno == EINTR) {
02012         <a class="code" href="../../dd/d00/_generic_platform_8c.html#a4">LOG_WRITE</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a170">IPDR_LEVEL_WARNING</a>, <span class="stringliteral">"select(Recv) got EINTR"</span>);
02013         <span class="keywordflow">continue</span>;
02014     }
02015     <span class="keywordflow">break</span>; <span class="comment">/* Succeeded or got non-EINTR error */</span>
02016 }
02017 <span class="keywordflow">if</span> (selectRC == 0 || ! FD_ISSET(S.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, &amp; FDSet)) {
02018 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
02019 <span class="preprocessor"></span>    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a10">LOG_WRITE6</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a172">IPDR_LEVEL_DEBUG</a>,
02020                <span class="stringliteral">"---block: GenericPlatform_Recv(bufLen=%u timeout=%d socket="</span> <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga0">Platform_SOCKET_FMT</a> <span class="stringliteral">" rc=%d set=%ld errno=%d"</span>,
02021                BufLength, Timeout, <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga1">Platform_SOCKET_DISPLAY</a>(S),
02022                selectRC, (<span class="keywordtype">long</span>)FD_ISSET(S.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, &amp; FDSet), errno);
02023 <span class="preprocessor">#endif</span>
02024 <span class="preprocessor"></span>    <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a178">IPDR_ERR_OPERATION_WOULD_BLOCK</a>;
02025 }
02026 <span class="keywordflow">if</span> (selectRC &lt; 0) {
02027     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a10">LOG_WRITE6</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a170">IPDR_LEVEL_WARNING</a>,
02028                <span class="stringliteral">"...error: GenericPlatform_Recv(bufLen=%u timeout=%d socket="</span> <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga0">Platform_SOCKET_FMT</a> <span class="stringliteral">" rc=%d set=%ld errno=%d"</span>,
02029                BufLength, Timeout, <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga1">Platform_SOCKET_DISPLAY</a>(S),
02030                selectRC, (<span class="keywordtype">long</span>)FD_ISSET(S.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, &amp; FDSet), errno);
02031     <span class="keywordflow">return</span> <a class="code" href="../../dd/d00/_generic_platform_8c.html#a19">ERRNO_EWOULDBLOCK</a> ? <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a178">IPDR_ERR_OPERATION_WOULD_BLOCK</a> : <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a188">IPDR_ERR_COMMUNICATION_ERROR</a>;
02032 }
02033 
02034 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
02035 <span class="preprocessor"></span><a class="code" href="../../dd/d00/_generic_platform_8c.html#a10">LOG_WRITE6</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a172">IPDR_LEVEL_DEBUG</a>,
02036            <span class="stringliteral">"...recv:  GenericPlatform_Recv(bufLen=%u timeout=%d socket="</span> <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga0">Platform_SOCKET_FMT</a> <span class="stringliteral">" rc=%d set=%ld errno=%d"</span>,
02037            BufLength, Timeout, <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga1">Platform_SOCKET_DISPLAY</a>(S),
02038            selectRC, (<span class="keywordtype">long</span>)FD_ISSET(S.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, &amp; FDSet), errno);
02039 <span class="preprocessor">#endif</span>
02040 <span class="preprocessor"></span><span class="preprocessor">#else</span>
02041 <span class="preprocessor"></span>{
02042     <span class="keyword">struct </span>pollfd PFD;
02043     <span class="keywordtype">int</span> pollRC;
02044     PFD.fd = S;
02045     PFD.events = POLLIN;
02046     <span class="keywordflow">for</span> (;;) { <span class="comment">/* poll() until we don't get EINTR resut */</span>
02047         errno = 0;
02048         PFD.revents = 0; <span class="comment">/* probably not needed, but let's be safe */</span>
02049         pollRC = poll(&amp; PFD, 1, Timeout);
02050         <span class="keywordflow">if</span> (pollRC &lt; 0 &amp;&amp; errno == EINTR) {
02051             <a class="code" href="../../dd/d00/_generic_platform_8c.html#a4">LOG_WRITE</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a170">IPDR_LEVEL_WARNING</a>, <span class="stringliteral">"poll(Recv) got EINTR"</span>);
02052             <span class="keywordflow">continue</span>;
02053         }
02054         <span class="keywordflow">break</span>; <span class="comment">/* Succeeded or got non-EINTR error */</span>
02055     }
02056     <span class="keywordflow">if</span> (pollRC == 0) {
02057         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a178">IPDR_ERR_OPERATION_WOULD_BLOCK</a>;
02058     }
02059     <span class="keywordflow">if</span> (pollRC &lt; 0) {
02060         <span class="keywordflow">return</span> <a class="code" href="../../dd/d00/_generic_platform_8c.html#a19">ERRNO_EWOULDBLOCK</a> ? <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a178">IPDR_ERR_OPERATION_WOULD_BLOCK</a> : <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a188">IPDR_ERR_COMMUNICATION_ERROR</a>;
02061     }
02062     <span class="keywordflow">if</span> (PFD.revents &amp; (POLLERR|POLLHUP|POLLNVAL)) {
02063         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a188">IPDR_ERR_COMMUNICATION_ERROR</a>;
02064     }
02065 }
02066 <span class="preprocessor">#endif</span>
02067 <span class="preprocessor"></span>    } <span class="comment">/* end of timeout code */</span>
02068 
02069     <span class="keywordflow">for</span> (;;) { <span class="comment">/* recv() until we don't get EINTR result */</span>
02070         errno = 0;
02071         recvRC = recv(S.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, Buf, BufLength, 0);
02072         <span class="keywordflow">if</span> (recvRC &lt; 0 &amp;&amp; errno == EINTR) {
02073             <a class="code" href="../../dd/d00/_generic_platform_8c.html#a4">LOG_WRITE</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a170">IPDR_LEVEL_WARNING</a>, <span class="stringliteral">"recv() got EINTR"</span>);
02074             <span class="keywordflow">continue</span>;
02075         }
02076         <span class="keywordflow">break</span>; <span class="comment">/* Succeeded or got non-EINTR error */</span>
02077     }
02078 
02079 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
02080 <span class="preprocessor"></span>    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a9">LOG_WRITE5</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a172">IPDR_LEVEL_DEBUG</a>,
02081                <span class="stringliteral">"+++recv:  GenericPlatform_Recv(bufLen=%u timeout=%d socket="</span> <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga0">Platform_SOCKET_FMT</a> <span class="stringliteral">" rc=%d errno=%d"</span>,
02082                BufLength, Timeout, <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga1">Platform_SOCKET_DISPLAY</a>(S),
02083                recvRC, errno);
02084 <span class="preprocessor">#endif</span>
02085 <span class="preprocessor"></span>
02086     <span class="keywordflow">if</span> (recvRC == 0) { <span class="comment">/* end-of-file */</span>
02087         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a188">IPDR_ERR_COMMUNICATION_ERROR</a>;
02088     }
02089 
02090     <span class="keywordflow">if</span> (recvRC &lt; 0) {
02091         *ReadBytes = 0;
02092         <span class="keywordflow">if</span> (<a class="code" href="../../dd/d00/_generic_platform_8c.html#a19">ERRNO_EWOULDBLOCK</a>) {
02093             <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a178">IPDR_ERR_OPERATION_WOULD_BLOCK</a>;
02094         } <span class="keywordflow">else</span> {
02095             <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a188">IPDR_ERR_COMMUNICATION_ERROR</a>;
02096         }
02097     }
02098 
02099     *ReadBytes = recvRC;
02100     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
02101 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a79" doxytag="GenericPlatform.c::GenericPlatform_RecvFrom"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_RecvFrom           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>Buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>BufferLength</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga9">IPDR_IPAddress</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>RemoteAddr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned short *&nbsp;</td>
          <td class="mdname" nowrap> <em>RemotePort</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int *&nbsp;</td>
          <td class="mdname" nowrap> <em>ReadBytes</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02108 {
02109     <span class="keyword">struct </span>sockaddr_in Addr;
02110     <span class="keywordtype">int</span> AddrLen = <span class="keyword">sizeof</span>(Addr);
02111     <span class="keywordtype">int</span> rc;
02112 
02113     *ReadBytes = 0;
02114 
02115     rc = recvfrom(S.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>,  Buf, BufferLength, 0,
02116                   (<span class="keyword">struct</span> sockaddr *) &amp; Addr, &amp; AddrLen);
02117 
02118 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
02119 <span class="preprocessor"></span>    fprintf(stderr, <span class="stringliteral">"*** GenericPlatformRecvfrom(timeout=%d) rc=%d\n"</span>, <a class="code" href="../../dd/d00/_generic_platform_8c.html#a13">RECEIVE_TIMEOUT</a>, rc);
02120 <span class="preprocessor">#endif</span>
02121 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (rc == 0) {
02122         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a178">IPDR_ERR_OPERATION_WOULD_BLOCK</a>;
02123     }
02124     <span class="keywordflow">if</span> (rc &lt; 0) {
02125         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a188">IPDR_ERR_COMMUNICATION_ERROR</a>;
02126     }
02127 
02128     *ReadBytes = rc;
02129     *RemotePort = ntohs(Addr.sin_port);
02130     *RemoteAddr = ntohl(Addr.sin_addr.s_addr);
02131 
02132     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
02133 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a61" doxytag="GenericPlatform.c::GenericPlatform_RegisterPeriodicTimer"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_RegisterPeriodicTimer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d3/d9b/group___i_p_d_r__event__services.html#ga0">IPDR_TimerCallback_t</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Callback</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>Arg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>Timeout</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/d03/struct_i_p_d_r__tag___timer.html">IPDR_TimerID</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>T</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01294 {
01295     <a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html">GenericTimer</a> *UT;
01296 
01297     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a34">GenericPlatform_Lock</a>(E, E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o4">PlatformLock</a>);
01298     {
01299         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status = <a class="code" href="../../dd/d00/_generic_platform_8c.html#a55">GenericPlatform_MemoryAllocate</a>(E, <span class="keyword">sizeof</span> *UT, (<span class="keywordtype">void</span>**)&amp;UT);
01300         <span class="keywordflow">if</span> (<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status)) {
01301             <a class="code" href="../../dd/d00/_generic_platform_8c.html#a35">GenericPlatform_Unlock</a>(E, E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o4">PlatformLock</a>);
01302             <span class="keywordflow">return</span> Status;
01303         }
01304     }
01305 
01306     <span class="keywordflow">if</span> (E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o1">Timers</a> != NULL)
01307         E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o1">Timers</a>-&gt;<a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html#o7">PrevTimer</a> = UT;
01308 
01309     UT-&gt;<a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html#o3">Callback</a> = Callback;
01310     UT-&gt;Arg = Arg;
01311     UT-&gt;PrevTimer = NULL;
01312     UT-&gt;NextTimer = E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o1">Timers</a>;
01313     UT-&gt;<a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html#o5">Periodic</a> = <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>;
01314     UT-&gt;Timeout = Timeout;
01315     UT-&gt;Remaining = Timeout;
01316     UT-&gt;Expired = <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
01317 
01318     E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o1">Timers</a> = UT;
01319 
01320     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a45">GenericPlatform_GetTV</a>((&amp; (UT-&gt;ExpirationTime)));
01321 
01322     UT-&gt;ExpirationTime.tv_sec += (Timeout / 1000);
01323     UT-&gt;ExpirationTime.tv_usec += (Timeout % 1000) * 1000;
01324     <span class="keywordflow">if</span> (UT-&gt;ExpirationTime.tv_usec &gt; 1000000) {
01325         UT-&gt;ExpirationTime.tv_usec -= 1000000;
01326         UT-&gt;ExpirationTime.tv_sec += 1;
01327     }
01328 
01329     *T = (<a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html">IPDR_TimerID</a>) UT;
01330 
01331     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a35">GenericPlatform_Unlock</a>(E, E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o4">PlatformLock</a>);
01332     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01333 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a62" doxytag="GenericPlatform.c::GenericPlatform_RegisterReadSocket"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_RegisterReadSocket           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>FD</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d3/d9b/group___i_p_d_r__event__services.html#ga5">IPDR_SocketCallback_t</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Callback</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>Arg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html">IPDR_SocketEventID</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>ID</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01341 {
01342     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status;
01343     <a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html">GenericFDEvent</a> *UFE;
01344 
01345     Status = <a class="code" href="../../dd/d00/_generic_platform_8c.html#a55">GenericPlatform_MemoryAllocate</a>(E, <span class="keyword">sizeof</span>(<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html">GenericFDEvent</a>), (<span class="keywordtype">void</span>**)&amp;UFE);
01346     <span class="keywordflow">if</span> (<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status)) { <span class="keywordflow">return</span> Status; }
01347 
01348 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
01349 <span class="preprocessor"></span>    fprintf(stderr, <span class="stringliteral">"RegisterReadSocket fd "</span> <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga0">Platform_SOCKET_FMT</a> <span class="stringliteral">"\n"</span>, <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga1">Platform_SOCKET_DISPLAY</a>(FD)); fflush(stderr);
01350 <span class="preprocessor">#endif</span>
01351 <span class="preprocessor"></span>
01352     *ID = NULL;
01353 
01354     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a34">GenericPlatform_Lock</a>(E, E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o4">PlatformLock</a>);
01355 
01356     UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o0">FD</a> = FD;
01357     UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o1">Callback</a> = Callback;
01358     UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o2">Arg</a> = Arg;
01359     UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o3">Unregistered</a> = <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
01360 
01361     <span class="comment">/* If we were running in multi-threaded mode (that is, one thread</span>
01362 <span class="comment">     * for each socket), we would start a thread to handle the reads.</span>
01363 <span class="comment">     * However, we're in single-threaded mode with non-blocking I/O,</span>
01364 <span class="comment">     * so we add the FD to the list of FDs to be checked by</span>
01365 <span class="comment">     * select(). [Yes, the Start function starts a thread; but that</span>
01366 <span class="comment">     * thread is the only one.]  */</span>
01367 
01368     UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o4">NextEvent</a> = E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o5">FDReadEvents</a>;
01369     E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o5">FDReadEvents</a> = UFE;
01370 
01371     FD_SET(UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o0">FD</a>.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, &amp; (E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o8">ReadFDs</a>));
01372     <span class="keywordflow">if</span> (FD.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a> &gt; E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o10">MaxFD</a>.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>) {
01373         E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o10">MaxFD</a> = FD;
01374     }
01375 
01376     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a35">GenericPlatform_Unlock</a>(E, E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o4">PlatformLock</a>);
01377     *ID = UFE;
01378     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01379 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a59" doxytag="GenericPlatform.c::GenericPlatform_RegisterTimer"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_RegisterTimer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d3/d9b/group___i_p_d_r__event__services.html#ga0">IPDR_TimerCallback_t</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Callback</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>Arg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>Timeout</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/d03/struct_i_p_d_r__tag___timer.html">IPDR_TimerID</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>T</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01216 {
01217     <a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html">GenericTimer</a> *UT;
01218 
01219     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a34">GenericPlatform_Lock</a>(E, E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o4">PlatformLock</a>);
01220     {
01221         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status = <a class="code" href="../../dd/d00/_generic_platform_8c.html#a55">GenericPlatform_MemoryAllocate</a>(E, <span class="keyword">sizeof</span> *UT, (<span class="keywordtype">void</span>**)&amp;UT);
01222         <span class="keywordflow">if</span> (<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status)) {
01223             <a class="code" href="../../dd/d00/_generic_platform_8c.html#a35">GenericPlatform_Unlock</a>(E, E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o4">PlatformLock</a>);
01224             <span class="keywordflow">return</span> Status;
01225         }
01226     }
01227 
01228     <span class="keywordflow">if</span> (E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o1">Timers</a> != NULL)
01229         E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o1">Timers</a>-&gt;<a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html#o7">PrevTimer</a> = UT;
01230 
01231     UT-&gt;<a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html#o3">Callback</a> = Callback;
01232     UT-&gt;Arg = Arg;
01233     UT-&gt;PrevTimer = NULL;
01234     UT-&gt;NextTimer = E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o1">Timers</a>;
01235     UT-&gt;<a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html#o5">Periodic</a> = <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
01236     UT-&gt;Timeout = Timeout;
01237     UT-&gt;Remaining = Timeout;
01238     UT-&gt;Expired = <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
01239 
01240     E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o1">Timers</a> = UT;
01241 
01242     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a45">GenericPlatform_GetTV</a>((&amp; (UT-&gt;ExpirationTime)));
01243 
01244     UT-&gt;ExpirationTime.tv_sec += (Timeout / 1000);
01245     UT-&gt;ExpirationTime.tv_usec += (Timeout % 1000) * 1000;
01246     <span class="keywordflow">if</span> (UT-&gt;ExpirationTime.tv_usec &gt; 1000000) {
01247         UT-&gt;ExpirationTime.tv_usec -= 1000000;
01248         UT-&gt;ExpirationTime.tv_sec += 1;
01249     }
01250 
01251     *T = (<a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html">IPDR_TimerID</a>) UT;
01252 
01253     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a35">GenericPlatform_Unlock</a>(E, E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o4">PlatformLock</a>);
01254     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01255 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a63" doxytag="GenericPlatform.c::GenericPlatform_RegisterWriteSocket"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_RegisterWriteSocket           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>FD</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d3/d9b/group___i_p_d_r__event__services.html#ga5">IPDR_SocketCallback_t</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Callback</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>Arg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html">IPDR_SocketEventID</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>ID</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01387 {
01388     <a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html">GenericFDEvent</a> *UFE;
01389     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a34">GenericPlatform_Lock</a>(E, E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o4">PlatformLock</a>);
01390 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
01391 <span class="preprocessor"></span>    fprintf(stderr, <span class="stringliteral">"RegisterWriteSocket fd "</span> <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga0">Platform_SOCKET_FMT</a> <span class="stringliteral">"\n"</span>, <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga1">Platform_SOCKET_DISPLAY</a>(FD)); fflush(stderr);
01392 <span class="preprocessor">#endif</span>
01393 <span class="preprocessor"></span>    *ID = NULL;
01394 
01395     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a55">GenericPlatform_MemoryAllocate</a>(E, <span class="keyword">sizeof</span>(<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html">GenericFDEvent</a>), (<span class="keywordtype">void</span>**)&amp;UFE);
01396     <span class="keywordflow">if</span> (UFE == NULL) {
01397         <a class="code" href="../../dd/d00/_generic_platform_8c.html#a35">GenericPlatform_Unlock</a>(E, E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o4">PlatformLock</a>);
01398         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a182">IPDR_ERR_ALLOCATION_FAILED</a>;
01399     }
01400 
01401     UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o0">FD</a> = FD;
01402     UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o1">Callback</a> = Callback;
01403     UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o2">Arg</a> = Arg;
01404     UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o4">NextEvent</a> = E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o6">FDWriteEvents</a>;
01405     UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o3">Unregistered</a> = <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
01406 
01407     E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o6">FDWriteEvents</a> = UFE;
01408 
01409     FD_SET(UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o0">FD</a>.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, &amp; (E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o9">WriteFDs</a>));
01410     <span class="keywordflow">if</span> (FD.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a> &gt; E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o10">MaxFD</a>.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>) {
01411         E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o10">MaxFD</a> = FD;
01412     }
01413 
01414     *ID = UFE;
01415 
01416     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a35">GenericPlatform_Unlock</a>(E, E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o4">PlatformLock</a>);
01417     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01418 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a60" doxytag="GenericPlatform.c::GenericPlatform_ReregisterTimer"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_ReregisterTimer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d3/d9b/group___i_p_d_r__event__services.html#ga0">IPDR_TimerCallback_t</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Callback</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>Arg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>Timeout</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/d03/struct_i_p_d_r__tag___timer.html">IPDR_TimerID</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>T</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01263 {
01264     <a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html">GenericTimer</a> *UT = *T;
01265 
01266     <span class="keywordflow">if</span> (*T == NULL) {
01267         <span class="keywordflow">return</span> <a class="code" href="../../dd/d00/_generic_platform_8c.html#a59">GenericPlatform_RegisterTimer</a>(E, Callback, Arg, Timeout, T);
01268     }
01269 
01270     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a34">GenericPlatform_Lock</a>(E, E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o4">PlatformLock</a>);
01271 
01272     UT-&gt;<a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html#o3">Callback</a> = Callback;
01273     UT-&gt;<a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html#o4">Arg</a> = Arg;
01274 
01275     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a45">GenericPlatform_GetTV</a>((&amp; (UT-&gt;<a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html#o0">ExpirationTime</a>)));
01276 
01277     UT-&gt;<a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html#o0">ExpirationTime</a>.tv_sec += (Timeout / 1000);
01278     UT-&gt;<a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html#o0">ExpirationTime</a>.tv_usec += (Timeout % 1000) * 1000;
01279     <span class="keywordflow">if</span> (UT-&gt;<a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html#o0">ExpirationTime</a>.tv_usec &gt; 1000000) {
01280         UT-&gt;<a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html#o0">ExpirationTime</a>.tv_usec -= 1000000;
01281         UT-&gt;<a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html#o0">ExpirationTime</a>.tv_sec += 1;
01282     }
01283 
01284     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a35">GenericPlatform_Unlock</a>(E, E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o4">PlatformLock</a>);
01285     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01286 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a77" doxytag="GenericPlatform.c::GenericPlatform_Send"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_Send           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>Buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>BufLength</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int *&nbsp;</td>
          <td class="mdname" nowrap> <em>WrittenBytes</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01922 {
01923     <span class="keywordtype">int</span> RC = 0;
01924     *WrittenBytes = 0;
01925 
01926 <span class="comment">/*#define TESTING_SLOW_SEND 1*/</span>
01927 <span class="preprocessor">#ifdef TESTING_SLOW_SEND</span>
01928 <span class="preprocessor"></span>    <span class="comment">/* Slow send is for testing that the collector can handle the</span>
01929 <span class="comment">     * message arriving in tiny bits with long timeouts. We send a</span>
01930 <span class="comment">     * random amount at a time, then sleep for a period that is</span>
01931 <span class="comment">     * hopefully greater than the Nagle algorithm's wait on the</span>
01932 <span class="comment">     * buffer. */</span>
01933     <span class="keyword">static</span> <span class="keywordtype">int</span> haveSetRand = 0;
01934     <span class="keywordflow">if</span> (! haveSetRand) { srand(time(0)); }
01935 
01936     <span class="keywordflow">while</span> (*WrittenBytes &lt; BufLength) {
01937         <span class="keywordtype">int</span> amountToWrite;
01938         amountToWrite = (int)((BufLength - *WrittenBytes) * (double)rand() / (double)RAND_MAX);
01939         <span class="keywordflow">if</span> (amountToWrite &lt; 5) { amountToWrite = 5; }
01940         <span class="keywordflow">if</span> (amountToWrite &gt; 100) { amountToWrite = 100; }
01941         <span class="keywordflow">if</span> (amountToWrite &gt; (BufLength - *WrittenBytes)) { amountToWrite = (BufLength - *WrittenBytes); }
01942         <span class="keywordflow">if</span> (amountToWrite &lt;= 0) { amountToWrite = 1; }
01943         errno = 0;
01944         fprintf(stderr, <span class="stringliteral">"... sending %d bytes of %d\n"</span>, amountToWrite, BufLength);
01945         RC = send(S.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, Buf + *WrittenBytes, amountToWrite, 0);
01946         <span class="keywordflow">if</span> (RC &lt; 0 &amp;&amp; errno == EINTR) {
01947             <a class="code" href="../../dd/d00/_generic_platform_8c.html#a4">LOG_WRITE</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a170">IPDR_LEVEL_WARNING</a>, <span class="stringliteral">"send() got EINTR"</span>);
01948             <span class="keywordflow">continue</span>;
01949         }
01950         <span class="keywordflow">if</span> (RC &lt; 0) {
01951             <span class="keywordflow">return</span> <a class="code" href="../../dd/d00/_generic_platform_8c.html#a19">ERRNO_EWOULDBLOCK</a> ? <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a178">IPDR_ERR_OPERATION_WOULD_BLOCK</a> : <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a188">IPDR_ERR_COMMUNICATION_ERROR</a>;     }
01952         *WrittenBytes += RC;
01953         <span class="keywordflow">if</span> (RC &lt; amountToWrite) {
01954             <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a178">IPDR_ERR_OPERATION_WOULD_BLOCK</a>;
01955         }
01956         <a class="code" href="../../dd/d00/_generic_platform_8c.html#a38">GenericPlatform_SleepMS</a>(E, 100);
01957     }
01958     fprintf(stderr, <span class="stringliteral">"... finished sending %d bytes\n"</span>, BufLength);
01959     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01960 <span class="preprocessor">#else</span>
01961 <span class="preprocessor"></span>    <span class="keywordflow">for</span> (;;) { <span class="comment">/* send() until we don't get EINTR result */</span>
01962         errno = 0;
01963         RC = send(S.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, Buf, BufLength, 0);
01964         <span class="keywordflow">if</span> (RC &lt; 0 &amp;&amp; errno == EINTR) {
01965             <a class="code" href="../../dd/d00/_generic_platform_8c.html#a4">LOG_WRITE</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a170">IPDR_LEVEL_WARNING</a>, <span class="stringliteral">"send() got EINTR"</span>);
01966             <span class="keywordflow">continue</span>;
01967         }
01968         <span class="keywordflow">break</span>; <span class="comment">/* Succeeded or got non-EINTR error */</span>
01969     }
01970 
01971     <span class="keywordflow">if</span> (RC &lt; 0) {
01972         <span class="keywordflow">return</span> <a class="code" href="../../dd/d00/_generic_platform_8c.html#a19">ERRNO_EWOULDBLOCK</a> ? <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a178">IPDR_ERR_OPERATION_WOULD_BLOCK</a> : <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a188">IPDR_ERR_COMMUNICATION_ERROR</a>;
01973     } <span class="keywordflow">else</span> {
01974         *WrittenBytes = RC;
01975         <span class="keywordflow">return</span> (RC &lt; BufLength) ? <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a178">IPDR_ERR_OPERATION_WOULD_BLOCK</a> : <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01976     }
01977 <span class="preprocessor">#endif</span>
01978 <span class="preprocessor"></span>}
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a80" doxytag="GenericPlatform.c::GenericPlatform_SendTo"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_SendTo           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>Buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>BufferLength</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga9">IPDR_IPAddress</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>RemoteAddr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned short&nbsp;</td>
          <td class="mdname" nowrap> <em>RemotePort</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02139 {
02140     <span class="keyword">struct </span>sockaddr_in Addr;
02141 
02142     memset(&amp; Addr, <span class="keyword">sizeof</span>(Addr), 0);
02143     Addr.sin_family = AF_INET;
02144     Addr.sin_port = htons(RemotePort);
02145     Addr.sin_addr.s_addr = htonl(RemoteAddr);
02146 
02147     <span class="keywordflow">if</span> (sendto(S.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, <a class="code" href="../../dd/d00/_generic_platform_8c.html#a17">CONST_CAST_CHARPTR</a>(Buf), BufferLength, 0,
02148                (<span class="keyword">struct</span> sockaddr *) &amp; Addr, <span class="keyword">sizeof</span>(Addr)) &lt; 0)
02149         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a188">IPDR_ERR_COMMUNICATION_ERROR</a>;
02150 
02151     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
02152 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a52" doxytag="GenericPlatform.c::GenericPlatform_SetExporterHandle"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_SetExporterHandle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>CH</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00574 {
00575 <span class="preprocessor"># if defined(TEST_SET_EXPORTER_HANDLE)</span>
00576 <span class="preprocessor"></span>    <span class="comment">/* will go to stderr */</span>
00577     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a4">LOG_WRITE</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>, <span class="stringliteral">"*** testing SetExporterHandle: before"</span>);
00578 <span class="preprocessor"># endif</span>
00579 <span class="preprocessor"></span>    E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o12">ExporterHandle</a> = CH;
00580     E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o11">ExporterHandleRegistered</a> = <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>;
00581 <span class="preprocessor"># if defined(TEST_SET_EXPORTER_HANDLE)</span>
00582 <span class="preprocessor"></span>    <span class="comment">/* will go to log */</span>
00583     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a4">LOG_WRITE</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>, <span class="stringliteral">"*** testing SetClienHandle: after"</span>);
00584 <span class="preprocessor"># endif</span>
00585 <span class="preprocessor"></span>    <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
00586 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a76" doxytag="GenericPlatform.c::GenericPlatform_SetExporterSocketParams"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_SetExporterSocketParams           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d3/d96/group___i_p_d_r__initialization__starting__deletion.html#ga0">IPDR_ParametersHandlerFunc</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ParamFunc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>ParamArg</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01886 {
01887     <span class="comment">/* ****** WARNING WARNING WARNING WARNING WARNING WARNING **********</span>
01888 <span class="comment">     *                                                                 *</span>
01889 <span class="comment">     * You *must* set the socket to non-blocking mode for this         *</span>
01890 <span class="comment">     * implementation of the platform code. If you do not, chances are *</span>
01891 <span class="comment">     * good that the system will eventually "hang" on a read.          *</span>
01892 <span class="comment">     *                                                                 *</span>
01893 <span class="comment">     * ****** WARNING WARNING WARNING WARNING WARNING WARNING **********/</span>
01894 
01895 <span class="preprocessor">#ifndef _MSC_VER</span>
01896 <span class="preprocessor"></span><span class="preprocessor">#if defined(VXWORKS) || defined(_VXWORKS)</span>
01897 <span class="preprocessor"></span>    <span class="keywordtype">int</span> nonBlockingMode = -1; <span class="comment">/* same as 1: but this sets all the bits in case arg isn't an int */</span>
01898     <span class="keywordflow">if</span> (ioctl(S.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, FIONBIO, (<span class="keywordtype">int</span>)&amp;nonBlockingMode) &lt; 0) { <span class="comment">/* The (int) cast is for VxWork's broken header */</span>
01899         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a188">IPDR_ERR_COMMUNICATION_ERROR</a>;
01900     }
01901 <span class="preprocessor">#else</span>
01902 <span class="preprocessor"></span>    <span class="keywordtype">int</span> Flags = fcntl(S.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, F_GETFL, 0);
01903 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
01904 <span class="preprocessor"></span>    fprintf(stderr, <span class="stringliteral">"SetSocketParams: non-blocking "</span> <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga0">Platform_SOCKET_FMT</a> <span class="stringliteral">"\n"</span>, <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga1">Platform_SOCKET_DISPLAY</a>(S)); fflush(stderr);
01905 <span class="preprocessor">#endif</span>
01906 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (Flags &lt; 0) {
01907         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a188">IPDR_ERR_COMMUNICATION_ERROR</a>;
01908     }
01909     <span class="keywordflow">if</span> (fcntl(S.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, F_SETFL, Flags | O_NONBLOCK) &lt; 0) {
01910         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a188">IPDR_ERR_COMMUNICATION_ERROR</a>;
01911     }
01912 <span class="preprocessor">#endif</span>
01913 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
01914 <span class="preprocessor"></span>
01915     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01916 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a84" doxytag="GenericPlatform.c::GenericPlatform_SetTime"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_SetTime           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga10">IPDR_Time</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>T</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02515                                                                      {
02516 <span class="preprocessor">#ifdef _MSC_VER</span>
02517 <span class="preprocessor"></span>    errno = ENOTSUP;
02518     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>;
02519 <span class="preprocessor">#elif defined(SOLARIS) || defined(VXWORKS) || defined(_VXWORKS)</span>
02520 <span class="preprocessor"></span>    <span class="keyword">struct </span>timespec ts;
02521     <span class="keywordtype">int</span> rc;
02522     ts.tv_sec = T;
02523     ts.tv_nsec = 0;
02524     errno = 0;
02525     rc = clock_settime(CLOCK_REALTIME, &amp;ts);
02526     <span class="keywordflow">return</span> (rc == 0) ? <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a> : <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>;
02527 <span class="preprocessor">#else</span>
02528 <span class="preprocessor"></span><span class="comment">/* this also works on Solaris, but we'll use the same as VxWorks: */</span>
02529     <span class="keyword">struct </span>timeval ts;
02530     <span class="keywordtype">int</span> rc;
02531     ts.tv_sec = T;
02532     ts.tv_usec = 0;
02533     errno = 0;
02534     rc = settimeofday(&amp;ts, NULL);
02535     <span class="keywordflow">return</span> (rc == 0) ? <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a> : <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>;
02536 <span class="preprocessor">#endif</span>
02537 <span class="preprocessor"></span>}
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a81" doxytag="GenericPlatform.c::GenericPlatform_Shutdown"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_Shutdown           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../db/d76/struct_i_p_d_r__tag___socket.html">IPDR_SocketHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>S</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02156 {
02157     <span class="comment">/* If it turns out that linger is needed, then need to add it here</span>
02158 <span class="comment">       (I think). See code in GenericPlatform_Close. */</span>
02159 
02160     <span class="keywordtype">int</span> rc = shutdown(S.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>, 2); <span class="comment">/* shutdown both read and write */</span>
02161 
02162     <span class="keywordflow">return</span> (rc == 0) ? <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a> : <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a188">IPDR_ERR_COMMUNICATION_ERROR</a>;
02163 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a38" doxytag="GenericPlatform.c::GenericPlatform_SleepMS"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_SleepMS           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>long&nbsp;</td>
          <td class="mdname" nowrap> <em>interval</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02541 {
02542     <span class="keywordflow">if</span> (interval &gt; 0) {
02543 <span class="preprocessor">#ifdef _MSC_VER</span>
02544 <span class="preprocessor"></span>        Sleep(interval);
02545 <span class="preprocessor">#else</span>
02546 <span class="preprocessor"></span><span class="comment">/*#eif  SOLARIS*/</span>
02547         <span class="keyword">struct </span>timeval TV;
02548         TV.tv_sec = interval / 1000;
02549         TV.tv_usec = 1000 * (interval % 1000);
02550                 <span class="comment">/*fprintf(stderr, "############# GenericPlatform_SleepMS (select) 1\n"); fflush(stderr);*/</span>
02551         select(0, NULL, NULL, NULL, &amp; TV);
02552                 <span class="comment">/*fprintf(stderr, "############# GenericPlatform_SleepMS (select) 2\n"); fflush(stderr);*/</span>
02553 <span class="comment">/*#else</span>
02554 <span class="comment">                fprintf(stderr, "############# GenericPlatform_SleepMS (usleep) 1\n"); fflush(stderr);</span>
02555 <span class="comment">                usleep(1000 * interval);</span>
02556 <span class="comment">                fprintf(stderr, "############# GenericPlatform_SleepMS (usleep) 2\n"); fflush(stderr);*/</span>
02557 <span class="preprocessor">#endif</span>
02558 <span class="preprocessor"></span>    }
02559     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
02560 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a47" doxytag="GenericPlatform.c::GenericPlatform_Start"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_Start           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>E</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00379 {
00380     <span class="comment">/* if the platform has already started, don't do anything */</span>
00381     <span class="keywordflow">if</span> (E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o2">Enabled</a>)
00382         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
00383     E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o2">Enabled</a> = <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>;
00384 
00385 <span class="preprocessor">#if defined(MT_SUPPORT)</span>
00386 <span class="preprocessor"></span><span class="preprocessor">#if defined(PTHREADS_SUPPORT)</span>
00387 <span class="preprocessor"></span>    {
00388         pthread_attr_t attr;
00389         <span class="comment">/*size_t stackSize = 16*1024;*/</span>
00390         <span class="comment">/* Following commented out because not properly implemented on Solaris */</span>
00391         <span class="comment">/* if (stackSize &lt; PTHREAD_STACK_MIN) { stackSize = PTHREAD_STACK_MIN; } */</span>
00392         <span class="keywordflow">if</span> (pthread_attr_init(&amp;attr) != 0 ||
00393             <span class="comment">/* stack size must be checked careful to ensure it's big enough to</span>
00394 <span class="comment">               not cause problems with JNI's AttachCurrentThread */</span>
00395             <span class="comment">/* pthread_attr_setstacksize(&amp;attr, stackSize) != 0 || */</span>
00396             pthread_create(&amp; E-&gt;MainFuncThread, &amp;attr, <a class="code" href="../../dd/d00/_generic_platform_8c.html#a31">GenericPlatform_MainFunc</a>, (<span class="keywordtype">void</span> *) E) != 0) {
00397             (void)pthread_attr_destroy(&amp;attr);
00398             <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a180">IPDR_ERR</a>;
00399         }
00400         (void)pthread_attr_destroy(&amp;attr);
00401     }
00402 <span class="preprocessor">#elif defined(_MSC_VER)</span>
00403 <span class="preprocessor"></span>    CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE) <a class="code" href="../../dd/d00/_generic_platform_8c.html#a31">GenericPlatform_MainFunc</a>,
00404                  E, 0, &amp; E-&gt;MainFuncThread);
00405 <span class="preprocessor">#elif defined(VXWORKS) || defined(_VXWORKS)</span>
00406 <span class="preprocessor"></span>    <span class="comment">/* taskSpawn arguments:</span>
00407 <span class="comment">       char * name,      // name of new task (stored at pStackBase)</span>
00408 <span class="comment">       int priority,     // priority of new task</span>
00409 <span class="comment">       int options,      // task option word</span>
00410 <span class="comment">       int stackSize,    // size (bytes) of stack needed plus name</span>
00411 <span class="comment">       FUNCPTR entryPt,  // entry point of new task</span>
00412 <span class="comment">       int arg1,         // 1st of 10 req'd args to pass to func</span>
00413 <span class="comment">       int iarg2, int arg3, int arg4, int arg5, int arg6, int arg7, int arg8, int arg9, int arg10</span>
00414 <span class="comment">    */</span>
00415     E-&gt;MainFuncThread =
00416         taskSpawn(<span class="stringliteral">"tSocketListener"</span>,97,0,16*1024,(FUNCPTR)<a class="code" href="../../dd/d00/_generic_platform_8c.html#a31">GenericPlatform_MainFunc</a>,(<span class="keywordtype">int</span>)E,0,0,0,0,0,0,0,0,0);
00417 <span class="preprocessor">#else</span>
00418 <span class="preprocessor"></span><span class="preprocessor">#error MT_SUPPORT: did not start GenericPlatform_MainFunc</span>
00419 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00420 <span class="preprocessor"></span><span class="preprocessor">#else </span><span class="comment">/* not MT_SUPPORT */</span>
00421 <span class="preprocessor">#error You really should set MT_SUPPORT, unless you are running on MS-DOG</span>
00422 <span class="preprocessor"></span>    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a31">GenericPlatform_MainFunc</a>(P);
00423 <span class="preprocessor">#endif</span>
00424 <span class="preprocessor"></span>
00425     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
00426 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a48" doxytag="GenericPlatform.c::GenericPlatform_Stop"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_Stop           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>E</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00433 {
00434     <span class="keywordflow">if</span> (! E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o2">Enabled</a>)
00435         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
00436 
00437     E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o2">Enabled</a> = <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
00438 
00439 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
00440 <span class="preprocessor"></span>    fprintf(stderr, <span class="stringliteral">"+++ finished setting MainFunc.Enabled = false\n"</span>); fflush(stderr);
00441 <span class="preprocessor">#endif</span>
00442 <span class="preprocessor"></span>
00443 <span class="preprocessor">#if defined(MT_SUPPORT)</span>
00444 <span class="preprocessor"></span>    <span class="comment">/* There's a question of whether we should do pthread_detach() or</span>
00445 <span class="comment">       pthread_join(). The problem with pthread_join() is that it could</span>
00446 <span class="comment">       block forever if there's anything inside MainFunc that can</span>
00447 <span class="comment">       block. Also, the notion of join isn't supported on all platforms</span>
00448 <span class="comment">       (e.g., VxWorks). So, let's do a detach. This means that</span>
00449 <span class="comment">       GenericPlatform_Stop() will return almost immediately and that</span>
00450 <span class="comment">       we have to be careful not to rip the memory away. So, we go into</span>
00451 <span class="comment">       a little loop, waiting for the "Stopped" flag to be set. */</span>
00452 
00453     errno = 0;
00454     <span class="keywordflow">if</span> (! THREAD_EQ(THREAD_SELF(), E-&gt;MainFuncThread)) {
00455 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
00456 <span class="preprocessor"></span>        fprintf(stderr, <span class="stringliteral">"+++ joining MainFunc self=%p and main=%p\n"</span>, THREAD_SELF(), E-&gt;MainFuncThread); fflush(stderr);
00457 <span class="preprocessor">#endif</span>
00458 <span class="preprocessor"></span><span class="preprocessor">#if defined(PTHREADS_SUPPORT)</span>
00459 <span class="preprocessor"></span>        pthread_detach(E-&gt;MainFuncThread);
00460 <span class="preprocessor">#elif defined(VXWORKS) || defined(_VXWORKS)</span>
00461 <span class="preprocessor"></span>        <span class="comment">/* Not needed for VxWorks */</span>
00462 <span class="preprocessor">#else</span>
00463 <span class="preprocessor"></span><span class="preprocessor">#error thread detach/join not defined</span>
00464 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00465 <span class="preprocessor"></span><span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
00466 <span class="preprocessor"></span>        fprintf(stderr, <span class="stringliteral">"+++ joined MainFunc\n"</span>); fflush(stderr);
00467 <span class="preprocessor">#endif</span>
00468 <span class="preprocessor"></span>
00469         <span class="keywordflow">while</span> (E &amp;&amp; (! E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o3">Stopped</a>)) {
00470 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
00471 <span class="preprocessor"></span>            fprintf(stderr, <span class="stringliteral">"_Stop loop enabled=%d, stopped=%d\n"</span>,
00472                     E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o2">Enabled</a>, E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o3">Stopped</a>); fflush(stderr);
00473 <span class="preprocessor">#endif</span>
00474 <span class="preprocessor"></span>            <a class="code" href="../../dd/d00/_generic_platform_8c.html#a38">GenericPlatform_SleepMS</a>(E, 100);
00475         }
00476     }
00477 <span class="preprocessor">#endif</span>
00478 <span class="preprocessor"></span><span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
00479 <span class="preprocessor"></span>        fprintf(stderr, <span class="stringliteral">"+++ out MainFunc\n"</span>); fflush(stderr);
00480 <span class="preprocessor">#endif</span>
00481 <span class="preprocessor"></span>    <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
00482 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a35" doxytag="GenericPlatform.c::GenericPlatform_Unlock"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_Unlock           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>LockPtr</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02442 {
02443 <span class="preprocessor">#if defined(MT_SUPPORT)</span>
02444 <span class="preprocessor"></span>    <a class="code" href="../../d6/d25/struct_generic_lock.html">GenericLock</a>* lock = (<a class="code" href="../../d6/d25/struct_generic_lock.html">GenericLock</a>*)LockPtr;
02445 <span class="preprocessor">#if defined(PTHREADS_SUPPORT)</span>
02446 <span class="preprocessor"></span>    <span class="comment">/* See the commentary for GenericPlatform_Lock */</span>
02447     <span class="comment">/* We obtain the mutex on the count and decrement it.</span>
02448 <span class="comment">       If the count goes down to zero, we no longer need</span>
02449 <span class="comment">       the main lock, so we release it. */</span>
02450     pthread_mutex_lock(&amp; lock-&gt;CountLock);
02451 <span class="preprocessor">#ifdef DEBUG_LOCKS</span>
02452 <span class="preprocessor"></span>    fprintf(stderr, <span class="stringliteral">"Lock off [%.150s:%d](0x%p) count=%d owner=%d self=%d\n"</span>,
02453             FileName, LineNum, lock, lock-&gt;RecursionCount, lock-&gt;Owner, pthread_self()); fflush(stderr);
02454 <span class="preprocessor">#endif</span>
02455 <span class="preprocessor"></span>    --(lock-&gt;RecursionCount);
02456     <span class="keywordflow">if</span> (! lock-&gt;RecursionCount) {
02457         lock-&gt;Owner = pthread_self();
02458         pthread_mutex_unlock(&amp; lock-&gt;ActualLock);
02459     }
02460     pthread_mutex_unlock(&amp; lock-&gt;CountLock);
02461 <span class="preprocessor">#elif defined(_MSC_VER)</span>
02462 <span class="preprocessor"></span><span class="preprocessor">#error _MSC_VER _Unlock should be integrated with VxWorks, pthreads versions</span>
02463 <span class="preprocessor"></span>    EnterCriticalSection(&amp;(U-&gt;CountLock));
02464     --(U-&gt;RecursionCount);
02465     <span class="keywordflow">if</span> (! U-&gt;RecursionCount) {
02466         U-&gt;Owner = GetCurrentThreadId();
02467         LeaveCriticalSection(&amp;(U-&gt;ActualLock));
02468     }
02469     LeaveCriticalSection(&amp;(U-&gt;CountLock));
02470 <span class="preprocessor">#elif defined(VXWORKS) || defined(_VXWORKS)</span>
02471 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (ERROR == semGive(lock-&gt;ActualLock)) { <span class="comment">/* Or: OK!=... */</span>
02472         taskSuspend(0);
02473     }
02474 <span class="preprocessor">#else</span>
02475 <span class="preprocessor"></span><span class="preprocessor">#error Defined Unlock()</span>
02476 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
02477 <span class="preprocessor"></span><span class="preprocessor">#endif </span><span class="comment">/* MT_SUPPORT */</span>
02478 
02479     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
02480 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a37" doxytag="GenericPlatform.c::GenericPlatform_UnlockPlatform"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_UnlockPlatform           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>P</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">02314 {
02315     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status = <a class="code" href="../../dd/d00/_generic_platform_8c.html#a35">GenericPlatform_Unlock</a>(E, E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o4">PlatformLock</a>);
02316     <span class="keywordflow">if</span> (<a class="code" href="../../da/d39/_i_p_d_r_8h.html#a18">FAILURE</a>(Status)) {
02317         <a class="code" href="../../dd/d00/_generic_platform_8c.html#a5">LOG_WRITE1</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a168">IPDR_LEVEL_FATAL</a>, <span class="stringliteral">"Platform Unlock failed: rc=%d\n"</span>, Status);
02318     }
02319     <span class="keywordflow">return</span> Status;
02320 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a65" doxytag="GenericPlatform.c::GenericPlatform_UnregisterSocket"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_UnregisterSocket           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html">IPDR_SocketEventID</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ID</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01454 {
01455     <a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html">GenericFDEvent</a> *NextUFE, *PrevUFE = NULL, *UFE;
01456 
01457     <span class="keywordflow">if</span> (ID == NULL) {
01458         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01459     }
01460 
01461     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a34">GenericPlatform_Lock</a>(E, E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o4">PlatformLock</a>);
01462 
01463     <span class="comment">/* In case we're currently iterating over the file descriptors,</span>
01464 <span class="comment">       mark the file descriptor for deletion. Also clear the select</span>
01465 <span class="comment">       bits because otherwise select() will give us a EBADF error. */</span>
01466     <span class="keywordflow">if</span> (E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o7">ScanningFDs</a>) {
01467         UFE = ID;
01468 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
01469 <span class="preprocessor"></span>        fprintf(stderr, <span class="stringliteral">"UnregisterSocket (while scanning FDs): "</span> <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga0">Platform_SOCKET_FMT</a> <span class="stringliteral">"\n"</span>, <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga1">Platform_SOCKET_DISPLAY</a>(UFE-&gt;FD)); fflush(stderr);
01470 <span class="preprocessor">#endif</span>
01471 <span class="preprocessor"></span>        UFE-&gt;Unregistered = <a class="code" href="../../df/dde/_defs_8h.html#a5">IPDR_TRUE</a>;
01472         FD_CLR(UFE-&gt;FD.socketFd, &amp;E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o8">ReadFDs</a>);
01473         FD_CLR(UFE-&gt;FD.socketFd, &amp;E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o9">WriteFDs</a>);
01474         <a class="code" href="../../dd/d00/_generic_platform_8c.html#a35">GenericPlatform_Unlock</a>(E, E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o4">PlatformLock</a>);
01475         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01476     }
01477 
01478 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
01479 <span class="preprocessor"></span>    fprintf(stderr, <span class="stringliteral">"UnregisterSocket: "</span> <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga0">Platform_SOCKET_FMT</a> <span class="stringliteral">"\n"</span>, <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga1">Platform_SOCKET_DISPLAY</a>(ID-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o0">FD</a>)); fflush(stderr);
01480 <span class="preprocessor">#endif</span>
01481 <span class="preprocessor"></span>
01482     UFE = E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o5">FDReadEvents</a>;
01483     E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o10">MaxFD</a>.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a> = -1;
01484 
01485     <span class="keywordflow">while</span> (UFE != NULL) {
01486         NextUFE = UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o4">NextEvent</a>;
01487         <span class="keywordflow">if</span> (UFE == ID) {
01488 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
01489 <span class="preprocessor"></span>            fprintf(stderr, <span class="stringliteral">"\tUnregisterSocket (read): "</span> <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga0">Platform_SOCKET_FMT</a> <span class="stringliteral">"\n"</span>, <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga1">Platform_SOCKET_DISPLAY</a>(UFE-&gt;FD)); fflush(stderr);
01490 <span class="preprocessor">#endif</span>
01491 <span class="preprocessor"></span>            <span class="keywordflow">if</span> (PrevUFE == NULL) {
01492                 E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o5">FDReadEvents</a> = UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o4">NextEvent</a>;
01493             } <span class="keywordflow">else</span> {
01494                 PrevUFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o4">NextEvent</a> = UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o4">NextEvent</a>;
01495             }
01496 
01497             FD_CLR(UFE-&gt;FD.socketFd, &amp; (E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o8">ReadFDs</a>));
01498             <a class="code" href="../../dd/d00/_generic_platform_8c.html#a39">GenericPlatform_MemoryFree</a>(E, UFE);
01499         } <span class="keywordflow">else</span> {
01500             <span class="keywordflow">if</span> (UFE-&gt;FD.socketFd &gt; E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o10">MaxFD</a>.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>) {
01501                 E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o10">MaxFD</a> = UFE-&gt;FD;
01502             }
01503             PrevUFE = UFE;
01504         }
01505 
01506         UFE = NextUFE;
01507     }
01508 
01509     UFE = E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o6">FDWriteEvents</a>;
01510     PrevUFE = NULL;
01511 
01512     <span class="keywordflow">while</span> (UFE != NULL) {
01513         NextUFE = UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o4">NextEvent</a>;
01514         <span class="keywordflow">if</span> (UFE == ID) {
01515 <span class="preprocessor">#ifdef TRACE_MAINFUNC</span>
01516 <span class="preprocessor"></span>            fprintf(stderr, <span class="stringliteral">"\tUnregisterSocket (write): "</span> <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga0">Platform_SOCKET_FMT</a> <span class="stringliteral">"\n"</span>, <a class="code" href="../../d4/d2e/group___i_p_d_r___socket.html#ga1">Platform_SOCKET_DISPLAY</a>(UFE-&gt;FD)); fflush(stderr);
01517 <span class="preprocessor">#endif</span>
01518 <span class="preprocessor"></span>            <span class="keywordflow">if</span> (PrevUFE == NULL) {
01519                 E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o6">FDWriteEvents</a> = UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o4">NextEvent</a>;
01520             } <span class="keywordflow">else</span> {
01521                 PrevUFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o4">NextEvent</a> = UFE-&gt;<a class="code" href="../../d3/d05/struct_i_p_d_r__tag___socket_event.html#o4">NextEvent</a>;
01522             }
01523             FD_CLR(UFE-&gt;FD.socketFd, &amp; (E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o9">WriteFDs</a>));
01524             <a class="code" href="../../dd/d00/_generic_platform_8c.html#a39">GenericPlatform_MemoryFree</a>(E, UFE);
01525         } <span class="keywordflow">else</span> {
01526             <span class="keywordflow">if</span> (UFE-&gt;FD.socketFd &gt; E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o10">MaxFD</a>.<a class="code" href="../../db/d76/struct_i_p_d_r__tag___socket.html#o0">socketFd</a>) {
01527                 E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o10">MaxFD</a> = UFE-&gt;FD;
01528             }
01529             PrevUFE = UFE;
01530         }
01531         UFE = NextUFE;
01532     }
01533 
01534     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a35">GenericPlatform_Unlock</a>(E, E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o4">PlatformLock</a>);
01535 
01536     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01537 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a64" doxytag="GenericPlatform.c::GenericPlatform_UnregisterTimer"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_UnregisterTimer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>E</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/d03/struct_i_p_d_r__tag___timer.html">IPDR_TimerID</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>T</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">01423 {
01424     <a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html">GenericTimer</a> *UT = T;
01425 
01426     <span class="keywordflow">if</span> (UT == NULL) {
01427         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01428     }
01429 
01430     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a34">GenericPlatform_Lock</a>(E, E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o4">PlatformLock</a>);
01431 
01432     <span class="keywordflow">if</span> (! UT-&gt;<a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html#o6">Expired</a>) {
01433         <span class="comment">/* unlink only if unexpired: if it was expired, it will</span>
01434 <span class="comment">           already be unlinked */</span>
01435         <span class="keywordflow">if</span> (UT-&gt;<a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html#o7">PrevTimer</a> == NULL)
01436             E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o1">Timers</a> = UT-&gt;<a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html#o8">NextTimer</a>;
01437         <span class="keywordflow">else</span>
01438             UT-&gt;<a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html#o7">PrevTimer</a>-&gt;<a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html#o8">NextTimer</a> = UT-&gt;<a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html#o8">NextTimer</a>;
01439 
01440         <span class="keywordflow">if</span> (UT-&gt;<a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html#o8">NextTimer</a> != NULL)
01441             UT-&gt;<a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html#o8">NextTimer</a>-&gt;<a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html#o7">PrevTimer</a> = UT-&gt;<a class="code" href="../../d7/d03/struct_i_p_d_r__tag___timer.html#o7">PrevTimer</a>;
01442     }
01443 
01444     <span class="comment">/* now it's safe to free it */</span>
01445     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a39">GenericPlatform_MemoryFree</a>(E, T);
01446 
01447     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a35">GenericPlatform_Unlock</a>(E, E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o4">PlatformLock</a>);
01448 
01449     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
01450 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a53" doxytag="GenericPlatform.c::GenericPlatform_UnsetExporterHandle"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> GenericPlatform_UnsetExporterHandle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html">IPDR_PlatformArg</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>E</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00590 {
00591 <span class="preprocessor"># if defined(TEST_SET_EXPORTER_HANDLE)</span>
00592 <span class="preprocessor"></span>    <span class="comment">/* will go to log */</span>
00593     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a4">LOG_WRITE</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>, <span class="stringliteral">"*** testing UnsetExporterHandle: before"</span>);
00594 <span class="preprocessor"># endif</span>
00595 <span class="preprocessor"></span>    E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o12">ExporterHandle</a> = 0;
00596     E-&gt;<a class="code" href="../../d8/d41/struct_i_p_d_r__tag___platform_arg.html#o11">ExporterHandleRegistered</a> = <a class="code" href="../../df/dde/_defs_8h.html#a4">IPDR_FALSE</a>;
00597 <span class="preprocessor"># if defined(TEST_SET_EXPORTER_HANDLE)</span>
00598 <span class="preprocessor"></span>    <span class="comment">/* will go to stderr */</span>
00599     <a class="code" href="../../dd/d00/_generic_platform_8c.html#a4">LOG_WRITE</a>(E, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga6a169">IPDR_LEVEL_ERROR</a>, <span class="stringliteral">"*** testing UnsetClienHandle: after"</span>);
00600 <span class="preprocessor"># endif</span>
00601 <span class="preprocessor"></span>    <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga15a174">IPDR_OK</a>;
00602 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a25" doxytag="GenericPlatform.c::GenericPlatform_EventServices"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../de/d0c/struct_i_p_d_r___event_services.html">IPDR_EventServices</a> <a class="el" href="../../dd/d00/_generic_platform_8c.html#a25">GenericPlatform_EventServices</a><code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a59">GenericPlatform_RegisterTimer</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a60">GenericPlatform_ReregisterTimer</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a61">GenericPlatform_RegisterPeriodicTimer</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a64">GenericPlatform_UnregisterTimer</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a62">GenericPlatform_RegisterReadSocket</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a63">GenericPlatform_RegisterWriteSocket</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a65">GenericPlatform_UnregisterSocket</a>,
    
}
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="GenericPlatform.c::GenericPlatform_h_rcsid"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char <a class="el" href="../../dd/d00/_generic_platform_8c.html#a21">GenericPlatform_h_rcsid</a>[] = GENERIC_PLATFORM_H_RCSID          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="GenericPlatform.c::GenericPlatform_LockingServices"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d70/struct_i_p_d_r___locking_services.html">IPDR_LockingServices</a> <a class="el" href="../../dd/d00/_generic_platform_8c.html#a28">GenericPlatform_LockingServices</a><code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a32">GenericPlatform_CreateLock</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a33">GenericPlatform_DeleteLock</a>,



    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a34">GenericPlatform_Lock</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a35">GenericPlatform_Unlock</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a36">GenericPlatform_LockPlatform</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a37">GenericPlatform_UnlockPlatform</a>

}
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="GenericPlatform.c::GenericPlatform_MemoryServices"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d67/struct_i_p_d_r___memory_services.html">IPDR_MemoryServices</a> <a class="el" href="../../dd/d00/_generic_platform_8c.html#a24">GenericPlatform_MemoryServices</a><code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {



    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a55">GenericPlatform_MemoryAllocate</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a56">GenericPlatform_MemoryAllocateWithHdr</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a39">GenericPlatform_MemoryFree</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a57">GenericPlatform_MemoryFreeWithHdr</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a58">GenericPlatform_MemoryStatistics</a>

}
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="GenericPlatform.c::GenericPlatform_NetworkServices"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d1b/struct_i_p_d_r___network_services.html">IPDR_NetworkServices</a> <a class="el" href="../../dd/d00/_generic_platform_8c.html#a27">GenericPlatform_NetworkServices</a><code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a68">GenericPlatform_CreateTCPSocket</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a69">GenericPlatform_CreateUDPSocket</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a72">GenericPlatform_Bind</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a70">GenericPlatform_Connect</a>,
        <a class="code" href="../../dd/d00/_generic_platform_8c.html#a71">GenericPlatform_GetSockName</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a73">GenericPlatform_Close</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a74">GenericPlatform_Listen</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a75">GenericPlatform_Accept</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a76">GenericPlatform_SetExporterSocketParams</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a77">GenericPlatform_Send</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a78">GenericPlatform_Recv</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a79">GenericPlatform_RecvFrom</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a80">GenericPlatform_SendTo</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a81">GenericPlatform_Shutdown</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a82">GenericPlatform_GetHostName</a>
}
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="GenericPlatform.c::GenericPlatform_PersistenceServices"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/da7/struct_i_p_d_r___persistence_services.html">IPDR_PersistenceServices</a> <a class="el" href="../../dd/d00/_generic_platform_8c.html#a26">GenericPlatform_PersistenceServices</a><code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a67">GenericPlatform_PersistentStore</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a66">GenericPlatform_PersistentRetrieve</a>
}
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="GenericPlatform.c::GenericPlatform_rcsid"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char <a class="el" href="../../dd/d00/_generic_platform_8c.html#a20">GenericPlatform_rcsid</a>[] = "@(#) $Id: GenericPlatform.c,v 1.28 2005/04/21 11:31:07 dmitryk Exp $" IPDR_COPYRIGHT_STR          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="GenericPlatform.c::GenericPlatform_TimeServices"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d3/d2e/struct_i_p_d_r___time_services.html">IPDR_TimeServices</a> <a class="el" href="../../dd/d00/_generic_platform_8c.html#a29">GenericPlatform_TimeServices</a><code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a83">GenericPlatform_GetTime</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a84">GenericPlatform_SetTime</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a38">GenericPlatform_SleepMS</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a41">GenericPlatform_FormatTimeLocalNow</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a43">GenericPlatform_FormatTimeGMTNow</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a42">GenericPlatform_FormatTimeLocal</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a44">GenericPlatform_FormatTimeGMT</a>,
    <a class="code" href="../../dd/d00/_generic_platform_8c.html#a40">GenericPlatform_FormatTimeSyslogNow</a>
}
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="GenericPlatform.c::Platform_h_rcsid"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char <a class="el" href="../../dd/d00/_generic_platform_8c.html#a22">Platform_h_rcsid</a>[] = PLATFORM_H_RCSID          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="GenericPlatform.c::ZeroTV"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct timeval <a class="el" href="../../dd/d00/_generic_platform_8c.html#a23">ZeroTV</a><code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment">
{
    0, 0
}
</pre></div>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Mon Apr 25 22:28:23 2005 for IPDRAPI by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.2 </small></address>
</body>
</html>
