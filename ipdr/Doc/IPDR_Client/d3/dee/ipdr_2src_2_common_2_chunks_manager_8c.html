<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>IPDRAPI: ipdr/src/Common/ChunksManager.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.2 -->
<div class="qindex"><a class="qindex" href="../../index.html">Main&nbsp;Page</a> | <a class="qindex" href="../../modules.html">Modules</a> | <a class="qindex" href="../../namespaces.html">Namespace List</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="../../dirs.html">Directories</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="../../globals.html">Globals</a></div>
<div class="nav">
<a class="el" href="../../dir_000003.html">ipdr</a>&nbsp;/&nbsp;<a class="el" href="../../dir_000010.html">src</a>&nbsp;/&nbsp;<a class="el" href="../../dir_000011.html">Common</a></div>
<h1>ChunksManager.c File Reference</h1><code>#include &lt;<a class="el" href="../../d4/d3a/ipdr_2include_2_i_p_d_r_2_config_8h.html">IPDR/Config.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="../../d4/df0/ipdr_2src_2_common_2_chunks_manager_8h.html">Common/ChunksManager.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="../../dc/d02/ipdr_2include_2_i_p_d_r_2_defs_8h.html">IPDR/Defs.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="../../d6/dbc/ipdr_2src_2_common_2_protocol_8h.html">Common/Protocol.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="../../d4/d4c/ipdr_2src_2_common_2_platform_8h.html">Common/Platform.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="../../df/d98/ipdr_2src_2_common_2_log_8h.html">Common/Log.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="../../dc/d26/ipdr_2src_2_common_2_common_msgs_8h.html">Common/CommonMsgs.h</a>&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a0">CHUNK_SIZE_FACTOR</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a1">MAX_PARAM_NAME_LENGTH</a>&nbsp;&nbsp;&nbsp;64</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a2">MIN_MESSAGE_SIZE</a>&nbsp;&nbsp;&nbsp;32</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a3">CH_0</a>(CH)&nbsp;&nbsp;&nbsp;((const char *) (CH) + sizeof(<a class="el" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a>))</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a4">CH_OFFSET</a>(CH, offsetPtr)&nbsp;&nbsp;&nbsp;((offsetPtr) - CH_0(CH))</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a5">CH_START_OFFSET</a>(CH)&nbsp;&nbsp;&nbsp;((CH)-&gt;DataStart - CH_0(CH))</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a6">CH_END_OFFSET</a>(CH)&nbsp;&nbsp;&nbsp;((CH)-&gt;DataEnd - CH_0(CH))</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a7">CH_CHSIZE</a>(CH)&nbsp;&nbsp;&nbsp;((CH)-&gt;ChunkSize)</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a10">ChunksManager_ReleaseChunk</a> (<a class="el" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a> *CH)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a11">ChunksManager_DefaultAllocateFunc</a> (size_t Size, void *AllocateArg, <a class="el" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a> **C)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a12">ChunksManager_DefaultFreeFunc</a> (<a class="el" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a> *C, void *AllocateArg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a13">ChunksManager_DeallocateFreeChunks</a> (<a class="el" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a> *Mgr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a14">ChunksManager_AllocateChunk</a> (<a class="el" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a> *Mgr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a15">ChunksManager_GetDefaultChunkAllocator</a> (<a class="el" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html">IPDR_PlatformServices</a> *PS, <a class="el" href="../../db/d5a/struct_chunk_allocator.html">ChunkAllocator</a> *Allocator)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a16">ChunksManager_Initialize</a> (unsigned int InitialChunkSize, unsigned int InitialNumChunks, unsigned int MaxMemUsage, unsigned int ChunkTags, const char *NameChunkSize, const char *NameInitialNumChunks, const char *NameMaxMemory, <a class="el" href="../../df/d84/struct_parameters_handler.html">ParametersHandler</a> *ParamsHandler, <a class="el" href="../../db/d5a/struct_chunk_allocator.html">ChunkAllocator</a> Allocator, <a class="el" href="../../dc/d30/struct_i_p_d_r__tag___log.html">Log</a> *L, <a class="el" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a> *Mgr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a17">ChunksManager_Reconfigure</a> (<a class="el" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a> *Mgr, const char *NameChunkSize, const char *NameInitialNumChunks, const char *NameMaxMemory, <a class="el" href="../../df/d84/struct_parameters_handler.html">ParametersHandler</a> *ParamsHandler)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a18">ChunksManager_Destroy</a> (<a class="el" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a> *Mgr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a19">ChunksManager_AllocateBuffer</a> (<a class="el" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a> *Mgr, size_t Size, <a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *Handle)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a20">ChunksManager_AllocateMaxBuffer</a> (<a class="el" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a> *Mgr, <a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *Handle, unsigned int *Size)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a21">ChunksManager_TruncateChunk</a> (<a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *Pos)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a22">ChunksManager_TruncateChunkBefore</a> (<a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *Pos, size_t Size)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a23">ChunksManager_TruncateChunkAfter</a> (<a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *Pos, size_t Size)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a24">ChunksManager_ReleaseBuffer</a> (<a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *BH, size_t BufferSize)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a25">ChunksManager_ReleaseMessage</a> (<a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *BH)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a26">ChunksManager_GetNextBuffer</a> (<a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *CurrentBuffer, size_t BufferSize, <a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *NextBufferHandle)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a27">ChunksManager_ReleaseAndGetNextBuffer</a> (<a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *CurrentBuffer, size_t BufferSize)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a28">ChunksManager_GetNextMessage</a> (<a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *CurrentBuffer, <a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *NextBufferHandle)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a29">ChunksManager_ReleaseAndGetNextMessage</a> (<a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *CurrentBuffer)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a30">ChunksManager_FreeUntil</a> (<a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *BH, size_t Size)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a31">ChunksManager_FreeAllChunks</a> (<a class="el" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a> *Mgr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a32">ChunksManager_GetFirstBuffer</a> (<a class="el" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a> *Mgr, <a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *BH)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a33">ChunksManager_GetLastBuffer</a> (<a class="el" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a> *Mgr, size_t BufferSize, <a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *BH)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a34">ChunksManager_GetFirstChunk</a> (<a class="el" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a> *Mgr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a35">ChunksManager_GetNextChunk</a> (<a class="el" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a> *CurrentChunk)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a36">ChunksManager_GetChunkInfo</a> (<a class="el" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a> *CH, unsigned int *StartOffset, unsigned int *EndOffset)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a37">ChunksManager_Dump</a> (<a class="el" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a> *Mgr, const char *Title)</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a8">ChunksManager_rcsid</a> [] = "@(#) $Id: ChunksManager.c,v 1.12 2005/03/29 09:46:06 dmitryk Exp $" IPDR_COPYRIGHT_STR</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a9">ChunksManager_h_rcsid</a> [] = CHUNKS_MANAGER_H_RCSID</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a3" doxytag="ChunksManager.c::CH_0"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define CH_0          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">CH&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;((const char *) (CH) + sizeof(<a class="el" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a>))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Some macros for debugging     </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="ChunksManager.c::CH_CHSIZE"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define CH_CHSIZE          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">CH&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;((CH)-&gt;ChunkSize)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="ChunksManager.c::CH_END_OFFSET"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define CH_END_OFFSET          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">CH&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;((CH)-&gt;DataEnd - CH_0(CH))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="ChunksManager.c::CH_OFFSET"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define CH_OFFSET          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">CH,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>offsetPtr&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;((offsetPtr) - CH_0(CH))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="ChunksManager.c::CH_START_OFFSET"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define CH_START_OFFSET          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">CH&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;((CH)-&gt;DataStart - CH_0(CH))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="ChunksManager.c::CHUNK_SIZE_FACTOR"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define CHUNK_SIZE_FACTOR&nbsp;&nbsp;&nbsp;4          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="ChunksManager.c::MAX_PARAM_NAME_LENGTH"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define MAX_PARAM_NAME_LENGTH&nbsp;&nbsp;&nbsp;64          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="ChunksManager.c::MIN_MESSAGE_SIZE"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define MIN_MESSAGE_SIZE&nbsp;&nbsp;&nbsp;32          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a19" doxytag="ChunksManager.c::ChunksManager_AllocateBuffer"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> ChunksManager_AllocateBuffer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Mgr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>Size</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Handle</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Allocate a buffer within the chunks manager.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Mgr</em>&nbsp;</td><td>chunks manager. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Size</em>&nbsp;</td><td>buffer size </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Handle</em>&nbsp;</td><td>handle to the newly allocated buffer (output)</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00413 {
00414     <a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a> *CH = NULL;
00415     <a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a> *TempCH;
00416     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> NewChunkSize;
00417     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status;
00418 
00419 <span class="preprocessor">#ifdef DEBUG_CHUNKSMANAGER</span>
00420 <span class="preprocessor"></span>    printf(<span class="stringliteral">" +++ ChunksManager_AllocateBuffer[%.99s](%u"</span>, MgrDescr(Mgr), Size);
00421 <span class="preprocessor">#endif</span>
00422 <span class="preprocessor"></span>
00423     <span class="comment">/* pad to the next 32 bit boundary */</span>
00424 
00425 <span class="comment">/*    if (Size % 4 != 0)</span>
00426 <span class="comment">        Size += (4 - (Size % 4));</span>
00427 <span class="comment">*/</span>
00428 <span class="preprocessor">#ifdef DEBUG_CHUNKSMANAGER</span>
00429 <span class="preprocessor"></span>    printf(<span class="stringliteral">" -&gt; %u)\n"</span>, Size);
00430 <span class="preprocessor">#endif</span>
00431 <span class="preprocessor"></span>
00432     <span class="comment">/* check if there is room for the current tail of the list */</span>
00433     TempCH = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o2">Tail</a>;
00434     <span class="keywordflow">if</span> (TempCH != NULL) {
00435         <span class="keywordflow">if</span> (TempCH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a> + Size &lt;=
00436             (<span class="keywordtype">char</span> *) TempCH + <span class="keyword">sizeof</span>(<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a>) + TempCH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o5">ChunkSize</a>) {
00437             <span class="comment">/* the chunk can fit into the current tail of the chunks list */</span>
00438             CH = TempCH;
00439 <span class="preprocessor">#ifdef DEBUG_CHUNKSMANAGER</span>
00440 <span class="preprocessor"></span>            printf(<span class="stringliteral">" ... ChunksManager_AllocateBuffer[%.99s](%u) ... fit in current tail (%.99s)\n"</span>,
00441                    MgrDescr(Mgr), Size, CHDescr(TempCH));
00442 <span class="preprocessor">#endif</span>
00443 <span class="preprocessor"></span>        }
00444     }
00445 
00446     <span class="keywordflow">while</span> (CH == NULL) {
00447         <span class="comment">/* if there is no room in the current tail, check if there is a</span>
00448 <span class="comment">           large enough chunk in the free list and use it */</span>
00449         TempCH = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o3">FreeList</a>;
00450         <span class="keywordflow">while</span> (TempCH != NULL) {
00451             <span class="keywordflow">if</span> (TempCH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o5">ChunkSize</a> &gt;= Size) {
00452 
00453                 CH = TempCH;
00454                 CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a> = (<span class="keywordtype">char</span> *) CH + <span class="keyword">sizeof</span>(ChunkHeader);
00455                 CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a> = (<span class="keywordtype">char</span> *) CH + <span class="keyword">sizeof</span>(ChunkHeader);
00456 
00457                 <span class="keywordflow">if</span> (CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o2">PrevChunk</a> == NULL)
00458                     Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o3">FreeList</a> = CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a>;
00459                 <span class="keywordflow">else</span>
00460                     CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o2">PrevChunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a> = CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a>;
00461 
00462                 <span class="keywordflow">if</span> (CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a> != NULL)
00463                     CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o2">PrevChunk</a> = CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o2">PrevChunk</a>;
00464 
00465                 CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a> = NULL;
00466                 CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o2">PrevChunk</a> = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o2">Tail</a>;
00467 
00468                 <span class="keywordflow">if</span> (Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o2">Tail</a> != NULL)
00469                     Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o2">Tail</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a> = CH;
00470                 <span class="keywordflow">else</span>
00471                     Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o1">Head</a> = CH;
00472                 Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o2">Tail</a> = CH;
00473 
00474 <span class="preprocessor">#ifdef DEBUG_CHUNKSMANAGER</span>
00475 <span class="preprocessor"></span>                printf(<span class="stringliteral">" ... ChunksManager_AllocateBuffer[%.99s](%u) ... fit in free list chunk (%.99s)\n"</span>,
00476                        MgrDescr(Mgr), Size, CHDescr(CH));
00477 <span class="preprocessor">#endif</span>
00478 <span class="preprocessor"></span>
00479                 <span class="keywordflow">break</span>;
00480             }
00481             TempCH = TempCH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a>;
00482         }
00483 
00484         <span class="keywordflow">if</span> (CH != NULL)
00485             break ;
00486 
00487 <span class="preprocessor">#ifdef DEBUG_CHUNKSMANAGER</span>
00488 <span class="preprocessor"></span>        printf(<span class="stringliteral">" ... ChunksManager_AllocateBuffer[%.99s](%u) ... could not fit in free list chunk\n"</span>,
00489                MgrDescr(Mgr), Size);
00490 <span class="preprocessor">#endif</span>
00491 <span class="preprocessor"></span>
00492         <span class="comment">/* if we didn't find a large enough chunk in the free list, allocate</span>
00493 <span class="comment">           a new chunk */</span>
00494 
00495         <span class="comment">/* if there is no room to place the current buffer in a chunk, increase</span>
00496 <span class="comment">           the default chunk size */</span>
00497 
00498         NewChunkSize = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o5">ChunkSize</a>;
00499         <span class="keywordflow">if</span> (NewChunkSize &lt; Size) {
00500 <span class="preprocessor">#ifdef TRACE_OBJECTS</span>
00501 <span class="preprocessor"></span>            <a class="code" href="../../d1/d4e/_for_doxygen_2src_2_common_2_log_8h.html#a30">Log_Write2</a>(Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o0">Logger</a>, <a class="code" href="../../d8/dac/_for_doxygen_2src_2_common_2_common_msgs_8h.html#a1">MEMORY_MODULE_ID</a>,
00502                        <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga7a171">IPDR_LEVEL_INFO</a>,
00503                        <span class="stringliteral">"ChunksManager_AllocateBuffer:DeallocateFreeChunks : NewChunkSize &lt; Size"</span>,
00504                        <a class="code" href="../../d8/dac/_for_doxygen_2src_2_common_2_common_msgs_8h.html#a6">MSG_CHUNKS_MGR_OUT_OF_MEMORY</a>, Size,
00505                        Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o7">MaxMemUsage</a>, Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o5">ChunkSize</a>, Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o6">InitialChunkSize</a>, Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o8">UsedMemory</a>);
00506 <span class="preprocessor">#endif</span>
00507 <span class="preprocessor"></span>            <span class="comment">/* in case we resize the chunk, deallocate any previously allocated</span>
00508 <span class="comment">               chunks, in order to accomodate for the new chunk size, since the</span>
00509 <span class="comment">               other chunks might be too small */</span>
00510             <a class="code" href="../../d5/d9f/_for_doxygen_2src_2_common_2_chunks_manager_8c.html#a13">ChunksManager_DeallocateFreeChunks</a>(Mgr);
00511             NewChunkSize = Size * <a class="code" href="../../d5/d9f/_for_doxygen_2src_2_common_2_chunks_manager_8c.html#a0">CHUNK_SIZE_FACTOR</a>;
00512         }
00513 
00514         <span class="comment">/* If there is a memory limit, resize the chunk so it will fit the</span>
00515 <span class="comment">           current memory limits */</span>
00516         <span class="keywordflow">if</span> (Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o7">MaxMemUsage</a> &gt; 0 &amp;&amp;
00517             NewChunkSize + Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o8">UsedMemory</a> &gt; Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o7">MaxMemUsage</a>)
00518             NewChunkSize = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o7">MaxMemUsage</a> - Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o8">UsedMemory</a>;
00519 
00520         <span class="comment">/* If the buffer can't be fitted within the suggested chunk</span>
00521 <span class="comment">           size, return an error. Chances are, the caller will</span>
00522 <span class="comment">           register an error; the message we output here gives a bit</span>
00523 <span class="comment">           more information. */</span>
00524         <span class="keywordflow">if</span> (NewChunkSize &lt; Size) {
00525             <a class="code" href="../../d1/d4e/_for_doxygen_2src_2_common_2_log_8h.html#a33">Log_Write5</a>(Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o0">Logger</a>, <a class="code" href="../../d8/dac/_for_doxygen_2src_2_common_2_common_msgs_8h.html#a1">MEMORY_MODULE_ID</a>,
00526                        <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga7a170">IPDR_LEVEL_WARNING</a>, <span class="stringliteral">"ChunksManager_AllocateBuffer : NewChunkSize &lt; Size"</span>,
00527                        <a class="code" href="../../d8/dac/_for_doxygen_2src_2_common_2_common_msgs_8h.html#a6">MSG_CHUNKS_MGR_OUT_OF_MEMORY</a>, Size,
00528                        Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o7">MaxMemUsage</a>, Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o5">ChunkSize</a>, Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o6">InitialChunkSize</a>, Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o8">UsedMemory</a>);
00529             <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a182">IPDR_ERR_ALLOCATION_FAILED</a>;
00530         }
00531 
00532         Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o5">ChunkSize</a> = NewChunkSize;
00533 
00534         Status = <a class="code" href="../../d5/d9f/_for_doxygen_2src_2_common_2_chunks_manager_8c.html#a14">ChunksManager_AllocateChunk</a>(Mgr);
00535         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(Status)) {
00536             <a class="code" href="../../d1/d4e/_for_doxygen_2src_2_common_2_log_8h.html#a33">Log_Write5</a>(Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o0">Logger</a>, <a class="code" href="../../d8/dac/_for_doxygen_2src_2_common_2_common_msgs_8h.html#a1">MEMORY_MODULE_ID</a>,
00537                        <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga7a169">IPDR_LEVEL_ERROR</a>, <span class="stringliteral">"ChunksManager_AllocateBuffer : Allocate failed"</span>,
00538                        <a class="code" href="../../d8/dac/_for_doxygen_2src_2_common_2_common_msgs_8h.html#a6">MSG_CHUNKS_MGR_OUT_OF_MEMORY</a>, Size,
00539                        Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o7">MaxMemUsage</a>, Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o5">ChunkSize</a>, Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o6">InitialChunkSize</a>, Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o8">UsedMemory</a>);
00540             <span class="keywordflow">return</span> Status;
00541         }
00542 
00543         <span class="comment">/* retry to get a free chunk (there should be a chunk now, since</span>
00544 <span class="comment">           we allocated a large enough chunk */</span>
00545     }
00546 
00547     Handle-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a> = CH;
00548     Handle-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> = CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a>;
00549     CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a> += Size;
00550 
00551 <span class="preprocessor">#ifdef DEBUG_CHUNKSMANAGER</span>
00552 <span class="preprocessor"></span>    printf(<span class="stringliteral">" ... ChunksManager_AllocateBuffer[%.99s](%u) ... at offset %u (%u from start) (%.99s)\n"</span>,
00553            MgrDescr(Mgr), Size, <a class="code" href="../../d5/d9f/_for_doxygen_2src_2_common_2_chunks_manager_8c.html#a4">CH_OFFSET</a>(CH, Handle-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>), Handle-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> - CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a>, CHDescr(CH));
00554 <span class="preprocessor">#endif</span>
00555 <span class="preprocessor"></span>
00556     <span class="comment">/* For debugging purpose, smear the buffer */</span>
00557 
00558     memset(Handle-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, 0xa1, Size);
00559 
00560     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00561 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="ChunksManager.c::ChunksManager_AllocateChunk"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> ChunksManager_AllocateChunk           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Mgr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Allocate a new chunk within the chunks manager, with the current chunk size.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Mgr</em>&nbsp;</td><td>chunks manager</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00173 {
00174     <a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a> *CH;
00175     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status;
00176 
00177     <span class="keywordflow">if</span> (Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o7">MaxMemUsage</a> &gt; 0 &amp;&amp;
00178         Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o8">UsedMemory</a> + Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o5">ChunkSize</a> &gt; Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o7">MaxMemUsage</a>)
00179         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a200">IPDR_ERR_QUEUE_FULL</a>;
00180 
00181     Status = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o4">Allocator</a>.<a class="code" href="../../db/d5a/struct_chunk_allocator.html#o0">AllocateFunc</a>(Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o5">ChunkSize</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a>),
00182                                          Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o4">Allocator</a>.<a class="code" href="../../db/d5a/struct_chunk_allocator.html#o2">AllocateArg</a>, &amp; CH);
00183     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(Status))
00184         <span class="keywordflow">return</span> Status;
00185 
00186     CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o0">Manager</a> = Mgr;
00187     CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o5">ChunkSize</a> = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o5">ChunkSize</a>;
00188     CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a> = (<span class="keywordtype">char</span> *) CH + <span class="keyword">sizeof</span>(ChunkHeader);
00189     CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a> = (<span class="keywordtype">char</span> *) CH + <span class="keyword">sizeof</span>(ChunkHeader);
00190 
00191     <span class="comment">/* You must NOT do this:</span>
00192 <span class="comment">     *    CH-&gt;AllocateFuncExtraData = NULL;</span>
00193 <span class="comment">     * because the AllocateFunc could use AllocateFuncExtraData for</span>
00194 <span class="comment">     * its own purposes (AllocateFunc allocated this chunk and it</span>
00195 <span class="comment">     * owns AllocateFuncExtraData). */</span>
00196 
00197     <span class="keywordflow">if</span> (Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o3">FreeList</a> != NULL)
00198         Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o3">FreeList</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o2">PrevChunk</a> = CH;
00199 
00200     CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a> = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o3">FreeList</a>;
00201     CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o2">PrevChunk</a> = NULL;
00202 
00203     Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o3">FreeList</a> = CH;
00204     Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o8">UsedMemory</a> += Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o5">ChunkSize</a>;
00205 
00206 <span class="preprocessor">#ifdef TRACE_OBJECTS</span>
00207 <span class="preprocessor"></span>    {
00208         <span class="keywordtype">char</span> buf[199];
00209         sprintf(buf, <span class="stringliteral">"AllocateChunk %.99s"</span>, MgrDescr(Mgr));
00210         <a class="code" href="../../d5/d9f/_for_doxygen_2src_2_common_2_chunks_manager_8c.html#a37">ChunksManager_Dump</a>(Mgr, buf);
00211     }
00212 <span class="preprocessor">#endif</span>
00213 <span class="preprocessor"></span>
00214     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00215 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="ChunksManager.c::ChunksManager_AllocateMaxBuffer"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> ChunksManager_AllocateMaxBuffer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Mgr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Handle</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int *&nbsp;</td>
          <td class="mdname" nowrap> <em>Size</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Allocate a buffer with a maximum size. The following operations are done:<ul>
<li>If the remaining space in the current chunk is larger than MIN_MESSAGE_SIZE + sizeof(MessageHeader) the rest of the chunk is allocated and returned.</li><li>Otherwise, a new chunk is used and the entire chunk is allocated.</li></ul>
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Mgr</em>&nbsp;</td><td>chunks manager. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Handle</em>&nbsp;</td><td>handle to allocated buffer (output) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Size</em>&nbsp;</td><td>size of allocated buffer (output)</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00582 {
00583     <a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a> *CH;
00584     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> Status;
00585 
00586     <span class="comment">/* if there is an existing chunk, allocate the data from it. */</span>
00587 
00588     <span class="keywordflow">if</span> (Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o2">Tail</a> != NULL) {
00589         *Size =
00590             (<span class="keywordtype">char</span> *) Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o2">Tail</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a>) + Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o2">Tail</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o5">ChunkSize</a> -
00591             Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o2">Tail</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a>;
00592         <span class="comment">/* check if the remaining space is large enough */</span>
00593         <span class="keywordflow">if</span> (*Size &gt; <span class="keyword">sizeof</span>(MessageHeader) + <a class="code" href="../../d5/d9f/_for_doxygen_2src_2_common_2_chunks_manager_8c.html#a2">MIN_MESSAGE_SIZE</a>) {
00594             Handle-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o2">Tail</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a>;
00595             Handle-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a> = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o2">Tail</a>;
00596             Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o2">Tail</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a> =
00597                 (<span class="keywordtype">char</span> *) Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o2">Tail</a> + <span class="keyword">sizeof</span>(<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a>) + Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o2">Tail</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o5">ChunkSize</a>;
00598             <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00599         }
00600     }
00601 
00602     <span class="keywordflow">if</span> (Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o3">FreeList</a> == NULL) {
00603         Status = <a class="code" href="../../d5/d9f/_for_doxygen_2src_2_common_2_chunks_manager_8c.html#a14">ChunksManager_AllocateChunk</a>(Mgr);
00604         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(Status)) {
00605             <a class="code" href="../../d1/d4e/_for_doxygen_2src_2_common_2_log_8h.html#a33">Log_Write5</a>(Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o0">Logger</a>, <a class="code" href="../../d8/dac/_for_doxygen_2src_2_common_2_common_msgs_8h.html#a1">MEMORY_MODULE_ID</a>,
00606                        <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga7a169">IPDR_LEVEL_ERROR</a>, <span class="stringliteral">"ChunksManager_AllocateBuffer"</span>,
00607                        <a class="code" href="../../d8/dac/_for_doxygen_2src_2_common_2_common_msgs_8h.html#a6">MSG_CHUNKS_MGR_OUT_OF_MEMORY</a>, *Size,
00608                        Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o7">MaxMemUsage</a>, Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o5">ChunkSize</a>, Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o6">InitialChunkSize</a>, Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o8">UsedMemory</a>);
00609             <span class="keywordflow">return</span> Status;
00610         }
00611     }
00612 
00613     CH = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o3">FreeList</a>;
00614     CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a> = (<span class="keywordtype">char</span> *) CH + <span class="keyword">sizeof</span>(<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a>) + CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o5">ChunkSize</a>;
00615     CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a> = (<span class="keywordtype">char</span> *) CH + <span class="keyword">sizeof</span>(<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a>);
00616 
00617     Handle-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a> = CH;
00618     Handle-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> = CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a>;
00619     *Size = CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o5">ChunkSize</a>;
00620 
00621     Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o3">FreeList</a> = CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a>;
00622     <span class="keywordflow">if</span> (Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o3">FreeList</a> != NULL)
00623         Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o3">FreeList</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o2">PrevChunk</a> = NULL;
00624 
00625     <span class="keywordflow">if</span> (Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o2">Tail</a> == NULL) {
00626         Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o2">Tail</a> = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o1">Head</a> = CH;
00627         CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o2">PrevChunk</a> = NULL;
00628         CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a> = NULL;
00629     } <span class="keywordflow">else</span> {
00630         Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o2">Tail</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a> = CH;
00631         CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o2">PrevChunk</a> = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o2">Tail</a>;
00632         CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a> = NULL;
00633         Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o2">Tail</a> = CH;
00634     }
00635 
00636     <span class="comment">/* if the list was previously empty it should point to the new chunk */</span>
00637     <span class="keywordflow">if</span> (Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o1">Head</a> == NULL)
00638         Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o1">Head</a> = CH;
00639 
00640     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00641 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="ChunksManager.c::ChunksManager_DeallocateFreeChunks"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> ChunksManager_DeallocateFreeChunks           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Mgr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Free the memory allocated by all unused chunks<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Mgr</em>&nbsp;</td><td>chunks manager</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00144 {
00145     <a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a> *Header, *NextHeader;
00146 
00147 <span class="preprocessor">#ifdef DEBUG_CHUNKSMANAGER</span>
00148 <span class="preprocessor"></span>    printf(<span class="stringliteral">" +++ ChunksManager_DeallocateFreeChunks[%.99s]\n"</span>, MgrDescr(Mgr));
00149 <span class="preprocessor">#endif</span>
00150 <span class="preprocessor"></span>
00151     Header = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o3">FreeList</a>;
00152     <span class="keywordflow">while</span> (Header != NULL) {
00153         NextHeader = Header-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a>;
00154         Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o8">UsedMemory</a> -= Header-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o5">ChunkSize</a>;
00155         Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o4">Allocator</a>.<a class="code" href="../../db/d5a/struct_chunk_allocator.html#o1">FreeFunc</a>(Header, Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o4">Allocator</a>.<a class="code" href="../../db/d5a/struct_chunk_allocator.html#o2">AllocateArg</a>);
00156         Header = NextHeader ;
00157     }
00158     Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o3">FreeList</a> = NULL;
00159 
00160     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00161 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="ChunksManager.c::ChunksManager_DefaultAllocateFunc"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> ChunksManager_DefaultAllocateFunc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>Size</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>AllocateArg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a> **&nbsp;</td>
          <td class="mdname" nowrap> <em>C</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Chunk allocator function, which uses the standard abstraction layer MemoryAllocate function.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Size</em>&nbsp;</td><td>chunk size </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>AllocateArg</em>&nbsp;</td><td>additional argument (the platform services) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>C</em>&nbsp;</td><td>allocated chunk (output)</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00109 {
00110     <a class="code" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html">IPDR_PlatformServices</a> *PS = (<a class="code" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html">IPDR_PlatformServices</a> *) AllocateArg;
00111     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> rc = <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a24">Platform_MEMORYALLOCATESIZE</a>(PS, Size, *C);
00112     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(rc)) {
00113         <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a28">X_MEMPANICSIZE</a>(Size, __FILE__, __LINE__);
00114     }
00115     <span class="keywordflow">return</span> rc;
00116 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="ChunksManager.c::ChunksManager_DefaultFreeFunc"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> ChunksManager_DefaultFreeFunc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>C</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>AllocateArg</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Chunk deallocator function, which uses the standard abstraction layer MemoryFree function.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>C</em>&nbsp;</td><td>chunk to free </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>AllocateArg</em>&nbsp;</td><td>additional argument (the platform services)</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00130 {
00131     <a class="code" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html">IPDR_PlatformServices</a> *PS = (<a class="code" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html">IPDR_PlatformServices</a> *) AllocateArg;
00132     <span class="keywordflow">return</span> <a class="code" href="../../d7/d54/_for_doxygen_2src_2_common_2_platform_8h.html#a20">Platform_MemoryFree</a>(PS, (<span class="keywordtype">void</span> *) C);
00133 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="ChunksManager.c::ChunksManager_Destroy"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> ChunksManager_Destroy           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Mgr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Free all resources associated with a chunks manager.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Mgr</em>&nbsp;</td><td>chunks manager.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00369 {
00370     <a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a> *Header, *NextHeader;
00371     <span class="keywordtype">int</span> i;
00372 
00373 <span class="preprocessor">#ifdef TRACE_OBJECTS</span>
00374 <span class="preprocessor"></span>    {
00375         <span class="keywordtype">char</span> buf[199];
00376         sprintf(buf, <span class="stringliteral">"Destroy %.99s"</span>, MgrDescr(Mgr));
00377         <a class="code" href="../../d5/d9f/_for_doxygen_2src_2_common_2_chunks_manager_8c.html#a37">ChunksManager_Dump</a>(Mgr, buf);
00378     }
00379 <span class="preprocessor">#endif</span>
00380 <span class="preprocessor"></span>
00381     <span class="keywordflow">if</span> (Mgr == NULL) {
00382         <span class="comment">/* XXX Should output error message to log ... except we have</span>
00383 <span class="comment">         * no log because Mgr is null */</span>
00384         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a180">IPDR_ERR</a>;
00385     }
00386 
00387     Header = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o1">Head</a>;
00388     <span class="keywordflow">for</span> (i = 0; i &lt; 2; i++) {
00389         <span class="keywordflow">while</span> (Header != NULL) {
00390             NextHeader = Header-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a>;
00391             Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o4">Allocator</a>.<a class="code" href="../../db/d5a/struct_chunk_allocator.html#o1">FreeFunc</a>(Header, Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o4">Allocator</a>.<a class="code" href="../../db/d5a/struct_chunk_allocator.html#o2">AllocateArg</a>);
00392             Header = NextHeader ;
00393         }
00394         Header = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o3">FreeList</a>;
00395     }
00396 
00397     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00398 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a37" doxytag="ChunksManager.c::ChunksManager_Dump"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void ChunksManager_Dump           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Mgr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>Title</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Dumps the contents of the chunk manager to the log<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Mgr</em>&nbsp;</td><td>chunks manager. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Title</em>&nbsp;</td><td>title to place before the dump </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">01201 {
01202     <a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a> *CH;
01203     <span class="keywordtype">int</span> StartOffset, EndOffset;
01204 
01205     <span class="keywordflow">if</span> (Mgr == NULL) {
01206         <span class="comment">/* Need error message to log ... but we have no log */</span>
01207         <span class="keywordflow">return</span>;
01208     }
01209 
01210     CH = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o1">Head</a>;
01211 
01212     <a class="code" href="../../d1/d4e/_for_doxygen_2src_2_common_2_log_8h.html#a18">Log_OutputStr2</a>(Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o0">Logger</a>, <a class="code" href="../../d8/dac/_for_doxygen_2src_2_common_2_common_msgs_8h.html#a1">MEMORY_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga7a172">IPDR_LEVEL_DEBUG</a>, <span class="stringliteral">"ChunksManager_Dump"</span>, <span class="stringliteral">"ChunksManager: 0x%p - %.99s"</span>, Mgr, Title);
01213     <a class="code" href="../../d1/d4e/_for_doxygen_2src_2_common_2_log_8h.html#a16">Log_OutputStr</a> (Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o0">Logger</a>, <a class="code" href="../../d8/dac/_for_doxygen_2src_2_common_2_common_msgs_8h.html#a1">MEMORY_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga7a172">IPDR_LEVEL_DEBUG</a>, <span class="stringliteral">"ChunksManager_Dump"</span>, <span class="stringliteral">"-------------------------------------"</span>);
01214     <a class="code" href="../../d1/d4e/_for_doxygen_2src_2_common_2_log_8h.html#a21">Log_OutputStr5</a>(Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o0">Logger</a>, <a class="code" href="../../d8/dac/_for_doxygen_2src_2_common_2_common_msgs_8h.html#a1">MEMORY_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga7a172">IPDR_LEVEL_DEBUG</a>, <span class="stringliteral">"ChunksManager_Dump"</span>, <span class="stringliteral">"chunkSize=%u initialChunkSize=%u maxMemUsage=%u usedMem=%u chunkTags=%u"</span>,
01215                    Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o5">ChunkSize</a>, Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o6">InitialChunkSize</a>, Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o7">MaxMemUsage</a>, Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o8">UsedMemory</a>, Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o9">ChunkTags</a>);
01216     <a class="code" href="../../d1/d4e/_for_doxygen_2src_2_common_2_log_8h.html#a18">Log_OutputStr2</a>(Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o0">Logger</a>, <a class="code" href="../../d8/dac/_for_doxygen_2src_2_common_2_common_msgs_8h.html#a1">MEMORY_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga7a172">IPDR_LEVEL_DEBUG</a>, <span class="stringliteral">"ChunksManager_Dump"</span>, <span class="stringliteral">"Head: 0x%p, Tail: 0x%p"</span>, Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o1">Head</a>, Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o2">Tail</a>);
01217 
01218 
01219     <span class="keywordflow">while</span> (CH != NULL) {
01220         StartOffset = CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a> - (<span class="keywordtype">char</span> *) CH;
01221         EndOffset = CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a> - (<span class="keywordtype">char</span> *) CH;
01222         <a class="code" href="../../d1/d4e/_for_doxygen_2src_2_common_2_log_8h.html#a22">Log_OutputStr6</a>(Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o0">Logger</a>, <a class="code" href="../../d8/dac/_for_doxygen_2src_2_common_2_common_msgs_8h.html#a1">MEMORY_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga7a172">IPDR_LEVEL_DEBUG</a>, <span class="stringliteral">"ChunksManager_Dump"</span>, <span class="stringliteral">"Alloc Chunk: 0x%p, Size: %d, StartOffset: %d, EndOffset: %d, Next: 0x%p, Prev:0x%p"</span>,
01223                        CH, CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o5">ChunkSize</a>, StartOffset, EndOffset,
01224                        CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a>, CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o2">PrevChunk</a>);
01225         CH = CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a>;
01226     }
01227 
01228     CH = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o3">FreeList</a>;
01229     <span class="keywordflow">while</span> (CH != NULL) {
01230         <a class="code" href="../../d1/d4e/_for_doxygen_2src_2_common_2_log_8h.html#a19">Log_OutputStr3</a>(Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o0">Logger</a>, <a class="code" href="../../d8/dac/_for_doxygen_2src_2_common_2_common_msgs_8h.html#a1">MEMORY_MODULE_ID</a>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga7a172">IPDR_LEVEL_DEBUG</a>, <span class="stringliteral">"ChunksManager_Dump"</span>, <span class="stringliteral">"Free Chunk: 0x%p, Next: 0x%p, Prev: 0x%p"</span>,
01231                        CH, CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a>, CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o2">PrevChunk</a>);
01232         CH = CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a>;
01233     }
01234 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a31" doxytag="ChunksManager.c::ChunksManager_FreeAllChunks"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> ChunksManager_FreeAllChunks           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Mgr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Retruns all chunks in a manager to the free list<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Mgr</em>&nbsp;</td><td>chunks manager</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">01058 {
01059     <span class="comment">/* look for chunks we a zero refcount (this can happen in case the</span>
01060 <span class="comment">       reference count was decreased from Java, which can only control</span>
01061 <span class="comment">       the refence count but not actually move chunks to the free list */</span>
01062 
01063     <a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a> *CH, *NextCH;
01064 
01065 <span class="preprocessor">#ifdef DEBUG_CHUNKSMANAGER</span>
01066 <span class="preprocessor"></span>    printf(<span class="stringliteral">" +++ ChunksManager_FreeAllChunks[%.99s]\n"</span>,
01067            MgrDescr(Mgr));
01068 <span class="preprocessor">#endif</span>
01069 <span class="preprocessor"></span>
01070     CH = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o1">Head</a>;
01071 
01072     <span class="keywordflow">while</span> (CH != NULL) {
01073         NextCH = CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a>;
01074 
01075         <span class="keywordflow">if</span> (Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o3">FreeList</a> != NULL)
01076             Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o3">FreeList</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o2">PrevChunk</a> = CH;
01077 
01078         CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a> = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o3">FreeList</a>;
01079         CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o2">PrevChunk</a> = NULL;
01080 
01081         Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o3">FreeList</a> = CH;
01082 
01083         CH = NextCH;
01084     }
01085 
01086     Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o1">Head</a> = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o2">Tail</a> = NULL;
01087 
01088     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
01089 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="ChunksManager.c::ChunksManager_FreeUntil"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> ChunksManager_FreeUntil           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>BH</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>Size</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Free all buffers up to a given position<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>BH</em>&nbsp;</td><td>position </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Size</em>&nbsp;</td><td>buffer size</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">01013 {
01014     <a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a> *CH, *NextCH;
01015     <a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a> *Mgr = BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o0">Manager</a>;
01016 
01017 <span class="preprocessor">#ifdef DEBUG_CHUNKSMANAGER</span>
01018 <span class="preprocessor"></span>    printf(<span class="stringliteral">" +++ ChunksManager_FreeUntil[%.99s](%.99s)(%u)\n"</span>,
01019            MgrDescr(BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o0">Manager</a>), CHDescr(BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>), Size);
01020 <span class="preprocessor">#endif</span>
01021 <span class="preprocessor"></span>
01022     CH = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o1">Head</a>;
01023 
01024     <span class="keywordflow">while</span> (CH != NULL) {
01025 
01026         <span class="keywordflow">if</span> (BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a> == CH) {
01027             CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o2">PrevChunk</a> = NULL; <span class="comment">/* Already done (we should be the 1st on the list) */</span>
01028             <span class="keywordflow">return</span> <a class="code" href="../../d5/d9f/_for_doxygen_2src_2_common_2_chunks_manager_8c.html#a22">ChunksManager_TruncateChunkBefore</a>(BH, Size);
01029         }
01030 
01031         NextCH = CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a>;
01032 
01033         <span class="keywordflow">if</span> (Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o3">FreeList</a> != NULL)
01034             Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o3">FreeList</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o2">PrevChunk</a> = CH;
01035         CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a> = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o3">FreeList</a>;
01036         CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o2">PrevChunk</a> = NULL;
01037         Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o3">FreeList</a> = CH;
01038 
01039         CH = NextCH;
01040         Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o1">Head</a> = NextCH;
01041     }
01042 
01043     Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o1">Head</a> = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o2">Tail</a> = NULL;
01044 
01045     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
01046 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a36" doxytag="ChunksManager.c::ChunksManager_GetChunkInfo"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> ChunksManager_GetChunkInfo           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>CH</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int *&nbsp;</td>
          <td class="mdname" nowrap> <em>StartOffset</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int *&nbsp;</td>
          <td class="mdname" nowrap> <em>EndOffset</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Given a chunk header, returns the starting and end offset of data within the chunk relative to the chunk header.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>CH</em>&nbsp;</td><td>chunk header </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>StartOffset</em>&nbsp;</td><td>offset of data start (output) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>EndOffset</em>&nbsp;</td><td>offset of data end (output)</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">01187 {
01188     *StartOffset = CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a> - (<span class="keywordtype">char</span> *) CH;
01189     *EndOffset = CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a> - (<span class="keywordtype">char</span> *) CH;
01190     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
01191 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="ChunksManager.c::ChunksManager_GetDefaultChunkAllocator"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> ChunksManager_GetDefaultChunkAllocator           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html">IPDR_PlatformServices</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>PS</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../db/d5a/struct_chunk_allocator.html">ChunkAllocator</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Allocator</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Creates a chunk allocator structure with the default chunk allocation functions (which use the abstraction layer)<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>PS</em>&nbsp;</td><td>platform services </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Allocator</em>&nbsp;</td><td>allocator structure to fill (output)</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00230 {
00231     Allocator-&gt;<a class="code" href="../../db/d5a/struct_chunk_allocator.html#o0">AllocateFunc</a> = <a class="code" href="../../d5/d9f/_for_doxygen_2src_2_common_2_chunks_manager_8c.html#a11">ChunksManager_DefaultAllocateFunc</a>;
00232     Allocator-&gt;<a class="code" href="../../db/d5a/struct_chunk_allocator.html#o1">FreeFunc</a> = <a class="code" href="../../d5/d9f/_for_doxygen_2src_2_common_2_chunks_manager_8c.html#a12">ChunksManager_DefaultFreeFunc</a>;
00233     Allocator-&gt;<a class="code" href="../../db/d5a/struct_chunk_allocator.html#o2">AllocateArg</a> = PS;
00234     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00235 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a32" doxytag="ChunksManager.c::ChunksManager_GetFirstBuffer"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> ChunksManager_GetFirstBuffer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Mgr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>BH</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Retruns a reference to the first allocated buffer in the manager<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Mgr</em>&nbsp;</td><td>chunks manager </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BH</em>&nbsp;</td><td>handle to the first allocated buffer (output)</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">01103 {
01104     <span class="keywordflow">if</span> (Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o1">Head</a> == NULL) {
01105         <a class="code" href="../../d0/da6/_for_doxygen_2src_2_common_2_chunks_manager_8h.html#a4">INIT_BUFFER_HANDLE</a>(*BH);
01106         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
01107     }
01108     <span class="keywordflow">if</span> (Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o1">Head</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a> &gt;= Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o1">Head</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a>) {
01109         <a class="code" href="../../d0/da6/_for_doxygen_2src_2_common_2_chunks_manager_8h.html#a4">INIT_BUFFER_HANDLE</a>(*BH);
01110         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
01111     }
01112 
01113     BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a> = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o1">Head</a>;
01114     BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o1">Head</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a>;
01115     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
01116 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a34" doxytag="ChunksManager.c::ChunksManager_GetFirstChunk"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a>* ChunksManager_GetFirstChunk           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Mgr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns the first chunk in a manager<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Mgr</em>&nbsp;</td><td>chunks manager</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>First chunk in the manager </dd></dl>
<div class="fragment"><pre class="fragment">01152 {
01153     <span class="keywordflow">return</span> Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o1">Head</a>;
01154 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a33" doxytag="ChunksManager.c::ChunksManager_GetLastBuffer"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> ChunksManager_GetLastBuffer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Mgr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>BufferSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>BH</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Return a reference to the last allocated buffer in the manager.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Mgr</em>&nbsp;</td><td>chunks manager </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BufferSize</em>&nbsp;</td><td>size of buffer (this implies that the function can only be used by fixed size buffers) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BH</em>&nbsp;</td><td>handle to the first allocated buffer (output)</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">01133 {
01134     <span class="keywordflow">if</span> (Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o2">Tail</a> == NULL || Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o2">Tail</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a> &gt;= Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o2">Tail</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a>) {
01135         <a class="code" href="../../d0/da6/_for_doxygen_2src_2_common_2_chunks_manager_8h.html#a4">INIT_BUFFER_HANDLE</a>(*BH);
01136         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
01137     }
01138 
01139     BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a> = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o2">Tail</a>;
01140     BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o2">Tail</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a> - BufferSize;
01141     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
01142 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="ChunksManager.c::ChunksManager_GetNextBuffer"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> ChunksManager_GetNextBuffer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>CurrentBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>BufferSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>NextBufferHandle</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Given a buffer handle and a buffer size, returns a handle to the next buffer in the chunk.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>CurrentBuffer</em>&nbsp;</td><td>handle to the current buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BufferSize</em>&nbsp;</td><td>size of the current buffer. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>NextBufferHandle</em>&nbsp;</td><td>reference to the next buffer (output)</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00831 {
00832     <span class="comment">/* !!! NOTE - CurrentBuffer and NextBufferHandle can point to the same</span>
00833 <span class="comment">       structure  !!! */</span>
00834 
00835 <span class="preprocessor">#ifdef DEBUG_CHUNKSMANAGER</span>
00836 <span class="preprocessor"></span>    printf(<span class="stringliteral">" +++ ChunksManager_GetNextBuffer[%.99s](%.99s)(%u)\n"</span>,
00837            MgrDescr(CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o0">Manager</a>), CHDescr(CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>), BufferSize);
00838 <span class="preprocessor">#endif</span>
00839 <span class="preprocessor"></span>    NextBufferHandle-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> = CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> + BufferSize;
00840     <span class="keywordflow">if</span> (NextBufferHandle-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> &gt;= CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a>) {
00841         NextBufferHandle-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a> = CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a>;
00842         <span class="keywordflow">if</span> (NextBufferHandle-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a> != NULL) {
00843             NextBufferHandle-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> = NextBufferHandle-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a>;
00844             <span class="keywordflow">if</span> (NextBufferHandle-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a> &gt; NextBufferHandle-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a>) {
00845                 <span class="comment">/* XXX should signal error event */</span>
00846                 <a class="code" href="../../d1/d4e/_for_doxygen_2src_2_common_2_log_8h.html#a28">Log_Write</a>(CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o0">Manager</a>-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o0">Logger</a>, <a class="code" href="../../d8/dac/_for_doxygen_2src_2_common_2_common_msgs_8h.html#a1">MEMORY_MODULE_ID</a>,
00847                           <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga7a169">IPDR_LEVEL_ERROR</a>, <span class="stringliteral">"ChunksManager_GetNextBuffer"</span>,
00848                           <a class="code" href="../../d8/dac/_for_doxygen_2src_2_common_2_common_msgs_8h.html#a7">MSG_CHUNKS_MGR_EMPTY_CHUNK</a>);
00849                 <span class="comment">/* Maybe die here? It's a nasty error ... */</span>
00850             }
00851         } <span class="keywordflow">else</span> {
00852             NextBufferHandle-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> = NULL;
00853         }
00854 
00855         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00856     }
00857 
00858     NextBufferHandle-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a> = CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>;
00859     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00860 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a35" doxytag="ChunksManager.c::ChunksManager_GetNextChunk"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a>* ChunksManager_GetNextChunk           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>CurrentChunk</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Given a chunk, returns a pointer to the next chunk in the manager<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>CurrentChunk</em>&nbsp;</td><td>reference to current chunk</td></tr>
  </table>
</dl>
RETURN VALUE: Reference to the next chunk <div class="fragment"><pre class="fragment">01166 {
01167     <span class="keywordflow">if</span> (CurrentChunk == NULL)
01168         <span class="keywordflow">return</span> NULL;
01169     <span class="keywordflow">return</span> CurrentChunk-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a>;
01170 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="ChunksManager.c::ChunksManager_GetNextMessage"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> ChunksManager_GetNextMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>CurrentBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>NextBufferHandle</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Given a handle to a message, outputs a handle to the next message in the manager.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>CurrentBuffer</em>&nbsp;</td><td>handle to the current message </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>NextBufferHandle</em>&nbsp;</td><td>handle to the next message (output)</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00918 {
00919         MessageHeader   Hdr ;
00920     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> CurrentBufferSize ;
00921 
00922 
00923         memcpy( &amp;Hdr, CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, <span class="keyword">sizeof</span>(MessageHeader) );
00924 
00925         CurrentBufferSize = <a class="code" href="../../db/d2e/_for_doxygen_2include_2_i_p_d_r_2_defs_8h.html#a12">IPDR_NTOHL</a>(Hdr.MessageLength);
00926 
00927     <span class="comment">/* Note: The is probably equivalent to</span>
00928 <span class="comment">       return ChunksManager_GetNextBuffer(CurrentBuffer, CurrentBufferSize, NextBufferHandle);</span>
00929 <span class="comment">    */</span>
00930 
00931 <span class="preprocessor">#ifdef DEBUG_CHUNKSMANAGER</span>
00932 <span class="preprocessor"></span>    printf(<span class="stringliteral">" +++ ChunksManager_GetNextMessage[%.99s](%.99s)\n"</span>,
00933            MgrDescr(CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o0">Manager</a>), CHDescr(CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>));
00934 <span class="preprocessor">#endif</span>
00935 <span class="preprocessor"></span>
00936     NextBufferHandle-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> = CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> + CurrentBufferSize;
00937     <span class="keywordflow">if</span> (NextBufferHandle-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> &gt;= CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a>) {
00938         NextBufferHandle-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a> = CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a>;
00939         <span class="keywordflow">if</span> (NextBufferHandle-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a> != NULL) {
00940             NextBufferHandle-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> = NextBufferHandle-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a>;
00941             <span class="keywordflow">if</span> (NextBufferHandle-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a> &gt; NextBufferHandle-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a>) {
00942                 <span class="comment">/* XXX should signal error event */</span>
00943                 <a class="code" href="../../d1/d4e/_for_doxygen_2src_2_common_2_log_8h.html#a28">Log_Write</a>(CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o0">Manager</a>-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o0">Logger</a>, <a class="code" href="../../d8/dac/_for_doxygen_2src_2_common_2_common_msgs_8h.html#a1">MEMORY_MODULE_ID</a>,
00944                           <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga7a169">IPDR_LEVEL_ERROR</a>, <span class="stringliteral">"ChunksManager_GetNextMessage"</span>,
00945                           <a class="code" href="../../d8/dac/_for_doxygen_2src_2_common_2_common_msgs_8h.html#a7">MSG_CHUNKS_MGR_EMPTY_CHUNK</a>);
00946                 <span class="comment">/* Maybe die here? It's a nasty error ... */</span>
00947             }
00948         } <span class="keywordflow">else</span> {
00949             NextBufferHandle-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> = NULL;
00950         }
00951 
00952         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00953     }
00954 
00955     NextBufferHandle-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a> = CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>;
00956     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00957 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="ChunksManager.c::ChunksManager_Initialize"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> ChunksManager_Initialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>InitialChunkSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>InitialNumChunks</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>MaxMemUsage</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>ChunkTags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>NameChunkSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>NameInitialNumChunks</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>NameMaxMemory</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../df/d84/struct_parameters_handler.html">ParametersHandler</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>ParamsHandler</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../db/d5a/struct_chunk_allocator.html">ChunkAllocator</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Allocator</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../dc/d30/struct_i_p_d_r__tag___log.html">Log</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>L</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Mgr</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Initialize a new chunk manager.<p>
The parameters handler can use the overide parameter values given to the manager. The following parameters can be specified:<p>
<ul>
<li>
&lt;name&gt;_chunk_size - initial chunk size </li>
<li>
&lt;name&gt;_max_mem - maximum memory usage </li>
<li>
&lt;name&gt;_initial_num_chunks - initial number of chunks to allocate. </li>
</ul>
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>InitialChunkSize</em>&nbsp;</td><td>initial chunk size in bytes </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>InitialNumChunks</em>&nbsp;</td><td>number of chunks to preallocate </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>MaxMemUsage</em>&nbsp;</td><td>maximum memory used by the manager </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ChunkTags</em>&nbsp;</td><td>tags to associate with chunks allocated by the manager </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>NameChunkSize</em>&nbsp;</td><td>name of parameter with chunk size </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>NameInitialNumChunks</em>&nbsp;</td><td>name of parameter with initial number of chunks </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>NameMaxMemory</em>&nbsp;</td><td>name of parameter with max memory </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ParamsHandler</em>&nbsp;</td><td>parameters handler used to overide parameters values specified in the first three parameters. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Allocator</em>&nbsp;</td><td>chunk allocator used to allocate chunks </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>L</em>&nbsp;</td><td>logger associated with the manager </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Mgr</em>&nbsp;</td><td>chunks manager structure to fill (output)</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00281 {
00282     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;
00283 
00284     Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o5">ChunkSize</a> = <a class="code" href="../../d5/dd6/_for_doxygen_2src_2_common_2_parameters_handler_8c.html#a18">ParametersHandler_GetUIntParam</a>(ParamsHandler,
00285                                                     NameChunkSize);
00286     Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o7">MaxMemUsage</a> = <a class="code" href="../../d5/dd6/_for_doxygen_2src_2_common_2_parameters_handler_8c.html#a18">ParametersHandler_GetUIntParam</a>(ParamsHandler,
00287                                                       NameMaxMemory);
00288 
00289     InitialNumChunks = <a class="code" href="../../d5/dd6/_for_doxygen_2src_2_common_2_parameters_handler_8c.html#a18">ParametersHandler_GetUIntParam</a>(ParamsHandler,
00290                                                       NameInitialNumChunks);
00291 
00292     <span class="keywordflow">if</span> (InitialNumChunks &lt; 2) {
00293         InitialNumChunks = 2; <span class="comment">/* Quietly fix this because algorithms</span>
00294 <span class="comment">                               * require a minimum of 2 chunks. */</span>
00295     }
00296 
00297     Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o6">InitialChunkSize</a> = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o5">ChunkSize</a>;
00298     Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o4">Allocator</a> = Allocator;
00299     Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o8">UsedMemory</a> = 0;
00300     Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o1">Head</a> = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o2">Tail</a> = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o3">FreeList</a> = NULL;
00301     Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o9">ChunkTags</a> = ChunkTags;
00302     Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o0">Logger</a> = L;
00303 
00304     <span class="keywordflow">for</span> (i = 0; i &lt; InitialNumChunks; i++)
00305         <a class="code" href="../../d5/d9f/_for_doxygen_2src_2_common_2_chunks_manager_8c.html#a14">ChunksManager_AllocateChunk</a>(Mgr);
00306 
00307 <span class="preprocessor">#ifdef TRACE_OBJECTS</span>
00308 <span class="preprocessor"></span>    {
00309         <span class="keywordtype">char</span> buf[199];
00310         sprintf(buf, <span class="stringliteral">"Initial %.99s"</span>, MgrDescr(Mgr));
00311         <a class="code" href="../../d5/d9f/_for_doxygen_2src_2_common_2_chunks_manager_8c.html#a37">ChunksManager_Dump</a>(Mgr, buf);
00312     }
00313 <span class="preprocessor">#endif</span>
00314 <span class="preprocessor"></span>
00315     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00316 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="ChunksManager.c::ChunksManager_Reconfigure"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> ChunksManager_Reconfigure           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Mgr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>NameChunkSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>NameInitialNumChunks</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>NameMaxMemory</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../df/d84/struct_parameters_handler.html">ParametersHandler</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>ParamsHandler</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Reconfigure a chunks manager after changes in parameters of the parameters handler<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Mgr</em>&nbsp;</td><td>chunks manager. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>NameChunkSize</em>&nbsp;</td><td>name of parameter with chunk size </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>NameInitialNumChunks</em>&nbsp;</td><td>name of parameter with initial number of chunks </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>NameMaxMemory</em>&nbsp;</td><td>name of parameter with max memory </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ParamsHandler</em>&nbsp;</td><td>parameters handler to use</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00336 {
00337     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> S;
00338 
00339     <span class="keywordflow">if</span> (! Mgr) {
00340         <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00341     }
00342 
00343     S = <a class="code" href="../../d5/dd6/_for_doxygen_2src_2_common_2_parameters_handler_8c.html#a18">ParametersHandler_GetUIntParam</a>(ParamsHandler,
00344                                        NameChunkSize);
00345 
00346     <span class="comment">/* in case the initial chunk size was changed, change the current chunk</span>
00347 <span class="comment">       size */</span>
00348 
00349     <span class="keywordflow">if</span> (S != Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o6">InitialChunkSize</a>) {
00350         Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o5">ChunkSize</a> = S;
00351         Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o6">InitialChunkSize</a> = S;
00352     }
00353 
00354     Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o7">MaxMemUsage</a> = <a class="code" href="../../d5/dd6/_for_doxygen_2src_2_common_2_parameters_handler_8c.html#a18">ParametersHandler_GetUIntParam</a>(ParamsHandler,
00355                                                       NameMaxMemory);
00356 
00357     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00358 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="ChunksManager.c::ChunksManager_ReleaseAndGetNextBuffer"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> ChunksManager_ReleaseAndGetNextBuffer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>CurrentBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>BufferSize</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Free the given buffer and sets CurrentBuffer to point to the next buffer.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>CurrentBuffer</em>&nbsp;</td><td>handle to the current buffer (input/output) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BufferSize</em>&nbsp;</td><td>size of the current buffer.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00874 {
00875 <span class="comment">/* Should be equivalent to:</span>
00876 <span class="comment">   BufferHandle NextBuffer;</span>
00877 <span class="comment">   ChunksManager_GetNextBuffer(CurrentBuffer, BufferSize, &amp;NextBuffer);</span>
00878 <span class="comment">   ChunksManager_ReleaseBuffer(CurrentBuffer, BufferSize);</span>
00879 <span class="comment">   *CurrentBuffer = NextBuffer;</span>
00880 <span class="comment">   */</span>
00881     <a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a> *NextChunk = CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a>;
00882 
00883 <span class="preprocessor">#ifdef DEBUG_CHUNKSMANAGER</span>
00884 <span class="preprocessor"></span>    printf(<span class="stringliteral">" +++ ChunksManager_ReleaseAndGetNextBuffer[%.99s](%.99s)(%u)\n"</span>,
00885            MgrDescr(CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o0">Manager</a>), CHDescr(CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>), BufferSize);
00886 <span class="preprocessor">#endif</span>
00887 <span class="preprocessor"></span>
00888     <span class="keywordflow">if</span> (CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> == CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a>) {
00889         CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a> += BufferSize;
00890         <span class="keywordflow">if</span> (CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a> &gt;= CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a>)
00891             <a class="code" href="../../d5/d9f/_for_doxygen_2src_2_common_2_chunks_manager_8c.html#a10">ChunksManager_ReleaseChunk</a>(CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>);
00892     }
00893 
00894     CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> = CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> + BufferSize;
00895     <span class="keywordflow">if</span> (CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> &gt;= CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a>) {
00896         CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a> = NextChunk;
00897         <span class="keywordflow">if</span> (NextChunk == NULL)
00898             CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> = NULL;
00899         <span class="keywordflow">else</span>
00900             CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> = NextChunk-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a>;
00901     }
00902 
00903     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00904 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="ChunksManager.c::ChunksManager_ReleaseAndGetNextMessage"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> ChunksManager_ReleaseAndGetNextMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>CurrentBuffer</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Given a handle to a message, frees the message and returns a handle to the next message.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>CurrentBuffer</em>&nbsp;</td><td>handle to the current message (in/out)</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00969 {
00970     <span class="comment">/* Note: The is probably equivalent to</span>
00971 <span class="comment">       return ChunksManager_ReleaseAndGetNextBuffer(CurrentBuffer, IPDR_NTOHL(...-&gt;MessageLength));</span>
00972 <span class="comment">    */</span>
00973     <a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a> *NextChunk = CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a>;
00974     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> MessageSize ;
00975         MessageHeader   Hdr ;
00976 
00977         memcpy( &amp;Hdr, CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>, <span class="keyword">sizeof</span>(MessageHeader) );
00978         MessageSize = <a class="code" href="../../db/d2e/_for_doxygen_2include_2_i_p_d_r_2_defs_8h.html#a12">IPDR_NTOHL</a>(Hdr.MessageLength);
00979 
00980 <span class="preprocessor">#ifdef DEBUG_CHUNKSMANAGER</span>
00981 <span class="preprocessor"></span>    printf(<span class="stringliteral">" +++ ChunksManager_ReleaseAndGetNextMessage[%.99s](%.99s) size=%u\n"</span>,
00982            MgrDescr(CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o0">Manager</a>), CHDescr(CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>), MessageSize);
00983 <span class="preprocessor">#endif</span>
00984 <span class="preprocessor"></span>
00985     <span class="keywordflow">if</span> (CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> == CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a>) {
00986         CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a> += MessageSize;
00987         <span class="keywordflow">if</span> (CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a> &gt;= CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a>)
00988             <a class="code" href="../../d5/d9f/_for_doxygen_2src_2_common_2_chunks_manager_8c.html#a10">ChunksManager_ReleaseChunk</a>(CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>);
00989     }
00990 
00991     CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> += MessageSize;
00992     <span class="keywordflow">if</span> (CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> &gt;= CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a>) {
00993         CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a> = NextChunk;
00994         <span class="keywordflow">if</span> (NextChunk == NULL)
00995             CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> = NULL;
00996         <span class="keywordflow">else</span>
00997             CurrentBuffer-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> = NextChunk-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a>;
00998     }
00999 
01000     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
01001 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="ChunksManager.c::ChunksManager_ReleaseBuffer"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> ChunksManager_ReleaseBuffer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>BH</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>BufferSize</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Free a buffer of a given size (in order to have any effect, the buffer has to be the first or the last buffer in a chunk)<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>BH</em>&nbsp;</td><td>handle to the buffer to release </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>BufferSize</em>&nbsp;</td><td>buffer size</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00756 {
00757 <span class="preprocessor">#ifdef DEBUG_CHUNKSMANAGER</span>
00758 <span class="preprocessor"></span>    printf(<span class="stringliteral">" +++ ChunksManager_ReleaseBuffer[%.99s](%.99s)(%u) data-start=%u, dataOffset=%u\n"</span>,
00759            MgrDescr(BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o0">Manager</a>), CHDescr(BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>), BufferSize,
00760            BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> - BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a>, <a class="code" href="../../d5/d9f/_for_doxygen_2src_2_common_2_chunks_manager_8c.html#a4">CH_OFFSET</a>(BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>, BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>));
00761 <span class="preprocessor">#endif</span>
00762 <span class="preprocessor"></span>
00763     <span class="comment">/* if the buffer is not at the beginning of the chunk, do nothing */</span>
00764     <span class="keywordflow">if</span> (BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> == BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a>) {
00765         BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a> += BufferSize;
00766     }
00767     <span class="keywordflow">if</span> (BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> + BufferSize == BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a>) {
00768         BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a> -= BufferSize;
00769     }
00770 
00771     <span class="keywordflow">if</span> (BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a> &gt;= BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a>) {
00772         <span class="keywordflow">return</span> <a class="code" href="../../d5/d9f/_for_doxygen_2src_2_common_2_chunks_manager_8c.html#a10">ChunksManager_ReleaseChunk</a>(BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>);
00773     }
00774 
00775     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00776 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="ChunksManager.c::ChunksManager_ReleaseChunk"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> ChunksManager_ReleaseChunk           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>CH</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Return the given chunk to the list of free chunks<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>CH</em>&nbsp;</td><td>chunk to release</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00712 {
00713     <a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html">ChunksManager</a> *Mgr = CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o0">Manager</a>;
00714 
00715 <span class="preprocessor">#ifdef DEBUG_CHUNKSMANAGER</span>
00716 <span class="preprocessor"></span>    printf(<span class="stringliteral">" ... ChunksManager_ReleaseChunk[%.99s] chunk %.99s\n"</span>,
00717            MgrDescr(Mgr), CHDescr(CH));
00718 <span class="preprocessor">#endif</span>
00719 <span class="preprocessor"></span>
00720     CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a> = (<span class="keywordtype">char</span> *) CH + <span class="keyword">sizeof</span>(<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a>);
00721     CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a> = (<span class="keywordtype">char</span> *) CH + <span class="keyword">sizeof</span>(<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html">ChunkHeader</a>);
00722 
00723     <span class="comment">/* remove the chunk from the chunks queue */</span>
00724     <span class="keywordflow">if</span> (CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o2">PrevChunk</a> == NULL)
00725         Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o1">Head</a> = CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a>;
00726     <span class="keywordflow">else</span>
00727         CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o2">PrevChunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a> = CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a>;
00728     <span class="keywordflow">if</span> (CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a> == NULL)
00729         Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o2">Tail</a> = CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o2">PrevChunk</a>;
00730     <span class="keywordflow">else</span>
00731         CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o2">PrevChunk</a> = CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o2">PrevChunk</a>;
00732 
00733     <span class="comment">/* add the chunk to the free list */</span>
00734     CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o1">NextChunk</a> = Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o3">FreeList</a>;
00735     CH-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o2">PrevChunk</a> = NULL;
00736     <span class="keywordflow">if</span> (Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o3">FreeList</a> != NULL)
00737         Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o3">FreeList</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o2">PrevChunk</a> = CH;
00738     Mgr-&gt;<a class="code" href="../../d1/d38/struct_i_p_d_r__tag___chunks_manager.html#o3">FreeList</a> = CH;
00739 
00740     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00741 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="ChunksManager.c::ChunksManager_ReleaseMessage"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> ChunksManager_ReleaseMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>BH</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Free a message (in order to have any effect, the buffer has to be the first or the last buffer in a chunk)<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>BH</em>&nbsp;</td><td>handle to the message to release</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00789 {
00790     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> MessageLength = <a class="code" href="../../db/d2e/_for_doxygen_2include_2_i_p_d_r_2_defs_8h.html#a12">IPDR_NTOHL</a>(((MessageHeader *) BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>)-&gt;MessageLength);
00791 <span class="preprocessor">#ifdef DEBUG_CHUNKSMANAGER</span>
00792 <span class="preprocessor"></span>    printf(<span class="stringliteral">" +++ ChunksManager_ReleaseMessage[%.99s](%.99s) MessageID=%u, Length=%ul\n"</span>,
00793            MgrDescr(BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o0">Manager</a>), CHDescr(BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>),
00794            ((MessageHeader *) BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>)-&gt;MessageID, MessageLength);
00795 <span class="preprocessor">#endif</span>
00796 <span class="preprocessor"></span>    <span class="keywordflow">return</span> <a class="code" href="../../d5/d9f/_for_doxygen_2src_2_common_2_chunks_manager_8c.html#a24">ChunksManager_ReleaseBuffer</a>(BH, MessageLength);
00797 
00798     <span class="comment">/* The above "return ChunksManager_ReleaseBuffer()" replaces the</span>
00799 <span class="comment">       following code which appears to have a typo (the first if has</span>
00800 <span class="comment">       "!=" instead of "=="). */</span>
00801 
00802 <span class="preprocessor">#if 0</span>
00803 <span class="preprocessor"></span>    <span class="comment">/* if the buffer is not at the beginning of the chunk, do nothing */</span>
00804     <span class="keywordflow">if</span> (BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> != BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a>)
00805         BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a> += MessageLength;
00806 
00807     <span class="keywordflow">if</span> (BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> + MessageLength == BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a>)
00808         BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a> -= MessageLength;
00809 
00810     <span class="keywordflow">if</span> (BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a> &gt;= BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a>)
00811         <a class="code" href="../../d5/d9f/_for_doxygen_2src_2_common_2_chunks_manager_8c.html#a10">ChunksManager_ReleaseChunk</a>(BH-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>);
00812 
00813     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00814 <span class="preprocessor">#endif</span>
00815 <span class="preprocessor"></span>}
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="ChunksManager.c::ChunksManager_TruncateChunk"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> ChunksManager_TruncateChunk           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Pos</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Free all memory allocated in the chunk after the given handle<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Pos</em>&nbsp;</td><td>position to truncate chunk at</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00653 {
00654 <span class="preprocessor">#ifdef DEBUG_CHUNKSMANAGER</span>
00655 <span class="preprocessor"></span>    printf(<span class="stringliteral">" +++ ChunksManager_TruncateChunk[%.99s](%.99s)\n"</span>,
00656            MgrDescr(Pos-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o0">Manager</a>), CHDescr(Pos-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>));
00657 <span class="preprocessor">#endif</span>
00658 <span class="preprocessor"></span>
00659     Pos-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a> = Pos-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a>;
00660     <span class="keywordflow">if</span> (Pos-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a> == Pos-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a>)
00661         <span class="keywordflow">return</span> <a class="code" href="../../d5/d9f/_for_doxygen_2src_2_common_2_chunks_manager_8c.html#a10">ChunksManager_ReleaseChunk</a>(Pos-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>);
00662     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00663 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="ChunksManager.c::ChunksManager_TruncateChunkAfter"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> ChunksManager_TruncateChunkAfter           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Pos</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>Size</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Free all memory allocated in the chunk after the given handle<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Pos</em>&nbsp;</td><td>position to truncate chunk at </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Size</em>&nbsp;</td><td>buffer size</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00696 {
00697     Pos-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a> = Pos-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> + Size;
00698     <span class="keywordflow">if</span> (Pos-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a> == Pos-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a>)
00699         <span class="keywordflow">return</span> <a class="code" href="../../d5/d9f/_for_doxygen_2src_2_common_2_chunks_manager_8c.html#a10">ChunksManager_ReleaseChunk</a>(Pos-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>);
00700     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00701 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="ChunksManager.c::ChunksManager_TruncateChunkBefore"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> ChunksManager_TruncateChunkBefore           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html">BufferHandle</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Pos</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>Size</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Free all memory allocated in the chunk before the given handle<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Pos</em>&nbsp;</td><td>position to truncate chunk at </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Size</em>&nbsp;</td><td>buffer size</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga30a174">IPDR_OK</a> on success; <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga30">IPDR_STATUS_RETURN_CODE</a> otherwise. </dd></dl>
<div class="fragment"><pre class="fragment">00677 {
00678     Pos-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a> = Pos-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o1">Data</a> + Size;
00679     <span class="keywordflow">if</span> (Pos-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o3">DataEnd</a> == Pos-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>-&gt;<a class="code" href="../../d3/dc4/struct_i_p_d_r__tag___chunk_header.html#o4">DataStart</a>)
00680         <span class="keywordflow">return</span> <a class="code" href="../../d5/d9f/_for_doxygen_2src_2_common_2_chunks_manager_8c.html#a10">ChunksManager_ReleaseChunk</a>(Pos-&gt;<a class="code" href="../../d5/d08/struct_i_p_d_r__tag___buffer_handle.html#o0">Chunk</a>);
00681     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00682 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a9" doxytag="ChunksManager.c::ChunksManager_h_rcsid"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char <a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a9">ChunksManager_h_rcsid</a>[] = CHUNKS_MANAGER_H_RCSID          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="ChunksManager.c::ChunksManager_rcsid"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char <a class="el" href="../../d3/dee/ipdr_2src_2_common_2_chunks_manager_8c.html#a8">ChunksManager_rcsid</a>[] = "@(#) $Id: ChunksManager.c,v 1.12 2005/03/29 09:46:06 dmitryk Exp $" IPDR_COPYRIGHT_STR          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Mon Apr 25 09:26:23 2005 for IPDRAPI by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.2 </small></address>
</body>
</html>
