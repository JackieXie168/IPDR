#!/bin/sh

# $Id: cmakeo,v 1.1.1.1 2004/12/12 23:02:05 michaeld Exp $

MAKE_COMMAND=`basename $0`
CURRENT_DIR=`dirname $0`

if [ ! "x$CRANE_ROOT" != 'x' ] 
then
  if [ $# -lt 1 ] 
  then
    echo "Usage: $MAKE_COMMAND <Workspace> ..."
    exit 1
  fi
  CRANE_ROOT="$HOME/$1"
  shift
fi

SYSTEM=`uname -s`
PLATFORM=`grep $SYSTEM ${CRANE_ROOT}/build/Platforms | cut -d" " -f2`
if [ ! "x${PLATFORM}" != 'x' ] 
then
  echo "Unsupported platform"
  exit 1
fi

case $MAKE_COMMAND in

'cmaked')
  MAKE_PARAMS="DEBUG_MODE=1"
  ;;
'cmakeo')
  MAKE_PARAMS="OPTIMIZE_MODE=1"
  ;;
'cmakep')
  MAKE_PARAMS="PURIFY_MODE=1"
  ;;
esac

MAKE="make CRANE_PLATFORM=$PLATFORM CRANE_ROOT=$CRANE_ROOT $MAKE_PARAMS"
export MAKE

$MAKE $*
