<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>IPDRAPI: ForDoxygen/src/Simulators/IPDRsim/IPDRsim.cpp File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.2 -->
<div class="qindex"><a class="qindex" href="../../index.html">Main&nbsp;Page</a> | <a class="qindex" href="../../modules.html">Modules</a> | <a class="qindex" href="../../namespaces.html">Namespace List</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="../../dirs.html">Directories</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="../../globals.html">Globals</a></div>
<div class="nav">
<a class="el" href="../../dir_000000.html">ForDoxygen</a>&nbsp;/&nbsp;<a class="el" href="../../dir_000008.html">src</a>&nbsp;/&nbsp;<a class="el" href="../../dir_000018.html">Simulators</a>&nbsp;/&nbsp;<a class="el" href="../../dir_000019.html">IPDRsim</a></div>
<h1>IPDRsim.cpp File Reference</h1><code>#include &lt;<a class="el" href="../../dc/d02/ipdr_2include_2_i_p_d_r_2_defs_8h.html">IPDR/Defs.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="../../de/d8c/ipdr_2include_2_i_p_d_r_2_i_p_d_r_8h.html">IPDR/IPDR.h</a>&gt;</code><br>
<code>#include &lt;<a class="el" href="../../d0/de3/ipdr_2src_2_platforms_2_generic_2_generic_platform_8h.html">Platforms/Generic/GenericPlatform.h</a>&gt;</code><br>
<code>#include &lt;unistd.h&gt;</code><br>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;cstdlib&gt;</code><br>
<code>#include &lt;iostream&gt;</code><br>
<code>#include &lt;fstream&gt;</code><br>
<code>#include &lt;cstddef&gt;</code><br>
<code>#include &lt;cstring&gt;</code><br>
<code>#include &lt;string&gt;</code><br>
<code>#include &lt;map&gt;</code><br>
<code>#include &lt;vector&gt;</code><br>
<code>#include &lt;time.h&gt;</code><br>
<code>#include &lt;arpa/inet.h&gt;</code><br>
<code>#include &lt;stddef.h&gt;</code><br>
<code>#include &lt;signal.h&gt;</code><br>
<code>#include &lt;setjmp.h&gt;</code><br>
<code>#include "<a class="el" href="../../de/d0e/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_aux_8cpp.html">IPDRsimAux.cpp</a>"</code><br>
<code>#include "<a class="el" href="../../de/d29/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_templates_8cpp.html">IPDRsimTemplates.cpp</a>"</code><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Namespaces</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">namespace &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dcc/namespacestd.html">std</a></td></tr>

<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a0">IPDR_utilities</a></td></tr>

<tr><td colspan="2"><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef map&lt; string, <a class="el" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a4">ParmMap_t</a></td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a10">nowStrX</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static struct timespec&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a11">getNowTime</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a12">handle_SIGUSR1</a> (int signum)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static const string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> ("*** ")</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a14">initParmMap</a> (<a class="el" href="../../d1/dbf/ipdr_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a4">ParmMap_t</a> &amp;parmMap)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a15">clientConfig</a> (const char *name, void *contextArg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../da/db3/class_record.html">Record</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a16">lookupRecByTemplateId</a> (<a class="el" href="../../da/db3/class_record.html">Record</a> *rec[], int templateId)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a17">logOutputCallback</a> (<a class="el" href="../../dc/d9b/group___i_p_d_r__logging.html#ga8">IPDR_DebugLevel</a> level, const char *levelStr, const char *clientName, const char *module, const char *func, const char *msg, void *context)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a18">eventCallback</a> (const <a class="el" href="../../d6/df8/struct_i_p_d_r___event_data.html">IPDR_EventData</a> *event, const char *msg, void *context)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a19">enableStartNegotiationCB</a> (<a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">IPDR_SessionHandle</a> SessionHandle, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">IPDR_CollectorHandle</a> CollectorHandle, <a class="el" href="../../dc/d02/ipdr_2include_2_i_p_d_r_2_defs_8h.html#a16">IPDR_BOOL</a> *Negotiate, void *Arg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a20">disableStartNegotiationCB</a> (<a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">IPDR_SessionHandle</a> SessionHandle, <a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">IPDR_CollectorHandle</a> CollectorHandle, <a class="el" href="../../dc/d02/ipdr_2include_2_i_p_d_r_2_defs_8h.html#a16">IPDR_BOOL</a> *Negotiate, void *Arg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a21">templatesChangedCB</a> (<a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">IPDR_SessionHandle</a> <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">Session</a>, <a class="el" href="../../df/d3e/struct_i_p_d_r___template.html">IPDR_Template</a> *templates, int numTemplates, void *context)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a22">nowStr</a> (char *buf, size_t bufSize)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a23">sendRecords</a> (<a class="el" href="../../da/db3/class_record.html">Record</a> &amp;record, unsigned long &amp;recNum, <a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a> clientH, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">IPDR_SessionHandle</a> sessionH, <a class="el" href="../../d4/dc8/struct_i_p_d_r__tag___template_handle.html">IPDR_TemplateHandle</a> templateH, unsigned int times, unsigned int intvl, ostream *ostr)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a24">cmdTemplate</a> (int sessionID, int templateId, <a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a> exporterH, <a class="el" href="../../da/db3/class_record.html">Record</a> *rec[])</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a25">cmdSetSessionDSN</a> (unsigned char sessionId, <a class="el" href="../../df/dd7/group___i_p_d_r__event__notification.html#ga2">IPDR_DSN_TYPE</a> dsn, <a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a> clientH)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a26">cmdStatistics</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a> clientH, <a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">IPDR_SessionHandle</a> sessionH)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a27">usage</a> (const char *name)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">vector&lt; <a class="el" href="../../d9/dff/struct_session_info.html">SessionInfo</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a28">getSessions</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a> clientH)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a29">saveMIBcallback</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a> clientH, int MIBVersion, void *contextArg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a30">loadMIB</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a> clientH, int MIBVersion, const char *fileName)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a31">loadMIBcallback</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a> clientH, int MIBVersion, void *contextArg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a32">executeCommand</a> (<a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a> clientH, <a class="el" href="../../da/db3/class_record.html">Record</a> *rec[], unsigned long &amp;recNum, ofstream *recordFile, const string &amp;cmd, bool *end)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a33">main</a> (int argc, const char *const argv[])</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a1">IPDRsim_rcsid</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static jmp_buf&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a2">stopJmpBuf</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a3">fastFillFlag</a> = false</td></tr>

<tr><td class="memItemLeft" nowrap>struct {</td></tr>

<tr><td class="memItemLeft" nowrap>&nbsp;&nbsp;&nbsp;long&nbsp;&nbsp;&nbsp;<a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a5">numRecords</a></td></tr>

<tr><td class="memItemLeft" nowrap>&nbsp;&nbsp;&nbsp;timespec&nbsp;&nbsp;&nbsp;<a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a6">startTime</a></td></tr>

<tr><td class="memItemLeft" nowrap>&nbsp;&nbsp;&nbsp;timespec&nbsp;&nbsp;&nbsp;<a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a7">endSendingTime</a></td></tr>

<tr><td class="memItemLeft" nowrap>&nbsp;&nbsp;&nbsp;timespec&nbsp;&nbsp;&nbsp;<a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a8">queueEmptyTime</a></td></tr>

<tr><td class="memItemLeft" nowrap valign="top">}&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a9">sendRateData</a></td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0" doxytag="IPDRsim.cpp::IPDR_utilities"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define IPDR_utilities          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="a4" doxytag="IPDRsim.cpp::ParmMap_t"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">typedef map&lt; string, <a class="el" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a> &gt; <a class="el" href="../../d1/dbf/ipdr_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a4">ParmMap_t</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
A mapping from parameter name to parameter value.     </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a15" doxytag="IPDRsim.cpp::clientConfig"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char * clientConfig           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>contextArg</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Callback for lookup of parameters. This does a lookup into the parmMap (passed in as the context). It also checks that a MIB value hasn't already been provided --- this isn't necessary currrently but is a "good idea" in case things need to change in the future. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>The parameter's name to look up </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>contextArg</em>&nbsp;</td><td>The context for the callback, as given to <a class="el" href="../../d3/d96/group___i_p_d_r__initialization__starting__deletion.html#ga6">IPDR_InitExporter()</a>: pointer to a <a class="el" href="../../d7/d79/struct_exporter_config_context__t.html">ExporterConfigContext_t</a>. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The value as a C-string pointer (NULL if unknown parameter) </dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="../../d1/dbf/ipdr_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a14">initParmMap</a> <p>
<a class="el" href="../../d1/dbf/ipdr_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a4">ParmMap_t</a> </dd></dl>
<div class="fragment"><pre class="fragment">00312 {
00313     <span class="keyword">const</span> <a class="code" href="../../d7/d79/struct_exporter_config_context__t.html">ExporterConfigContext_t</a>&amp; context = *static_cast&lt;ExporterConfigContext_t*&gt;(contextArg);
00314     ParmMap_t::const_iterator lookup = context.<a class="code" href="../../d7/d79/struct_exporter_config_context__t.html#o0">parmMap</a>-&gt;find(name);
00315 
00316     <span class="keywordflow">if</span> (lookup == context.<a class="code" href="../../d7/d79/struct_exporter_config_context__t.html#o0">parmMap</a>-&gt;end())
00317         {
00318         <span class="comment">// cerr &lt;&lt; outputPrefix &lt;&lt; "Unknown parameter(" &lt;&lt; name &lt;&lt; ")" &lt;&lt; endl;</span>
00319         <span class="keywordflow">return</span> NULL; <span class="comment">// will be NULL if not in MIB, hence default value</span>
00320         }
00321         <span class="keywordflow">else</span>
00322         {
00323         <span class="keywordflow">if</span> (lookup-&gt;second.setByCLI)
00324                 {
00325             <span class="keywordflow">return</span> lookup-&gt;second.value;
00326         }
00327                 <span class="keywordflow">else</span>
00328                 {
00329             <span class="keywordflow">return</span> lookup-&gt;second.value;
00330         }
00331     }
00332 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="IPDRsim.cpp::cmdSetSessionDSN"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void cmdSetSessionDSN           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">unsigned char&nbsp;</td>
          <td class="mdname" nowrap> <em>sessionId</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../df/dd7/group___i_p_d_r__event__notification.html#ga2">IPDR_DSN_TYPE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dsn</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>clientH</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Execute the "dsn" command. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sessionId</em>&nbsp;</td><td>the session ID </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dsn</em>&nbsp;</td><td>The new data sequence number. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>clientH</em>&nbsp;</td><td>Exporter handle from <a class="el" href="../../d3/d96/group___i_p_d_r__initialization__starting__deletion.html#ga6">IPDR_InitExporter()</a>. </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00738 {
00739 <span class="preprocessor">#ifdef DEPRECATED</span>
00740 <span class="preprocessor"></span>    <a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html">IPDR_SessionHandle</a> sessionH;
00741     <span class="keyword">const</span> <span class="keywordtype">char</span>* sessionName;
00742     <span class="keyword">const</span> <span class="keywordtype">char</span>* sessionDescr;
00743     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> rc;
00744 
00745     rc = <a class="code" href="../../d3/d0a/group___i_p_d_r__sessions.html#ga2">IPDR_GetSession</a>(clientH, sessionId, &amp;sessionH, &amp;sessionName, &amp;sessionDescr);
00746     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(rc)) {
00747         cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"setSessionDSN: GetSession(..., "</span> &lt;&lt;
00748             (<span class="keywordtype">unsigned</span> int)sessionId &lt;&lt; <span class="stringliteral">", ...) failed: "</span> &lt;&lt;
00749             <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga22">IPDR_StatusMsg</a>(clientH, rc) &lt;&lt; endl;
00750         <span class="comment">//exit(1);</span>
00751     }
00752     rc = IPDR_SetSessionDSN(clientH, sessionH, dsn);
00753     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(rc)) {
00754         cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"setSessionDSN("</span> &lt;&lt; dsn &lt;&lt;
00755             <span class="stringliteral">" failed for session("</span> &lt;&lt; sessionName &lt;&lt; <span class="stringliteral">") ["</span> &lt;&lt;
00756             sessionDescr &lt;&lt; <span class="stringliteral">"]: "</span> &lt;&lt; <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga22">IPDR_StatusMsg</a>(clientH, rc) &lt;&lt; endl;
00757         <span class="comment">//exit(1);</span>
00758     }
00759     cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"setSessionDSN("</span> &lt;&lt; dsn &lt;&lt;
00760             <span class="stringliteral">") for session("</span> &lt;&lt; sessionName &lt;&lt; <span class="stringliteral">") ["</span> &lt;&lt;
00761             sessionDescr &lt;&lt; <span class="stringliteral">"]"</span> &lt;&lt; endl;
00762 <span class="preprocessor">#endif</span>
00763 <span class="preprocessor"></span>
00764 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="IPDRsim.cpp::cmdStatistics"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void cmdStatistics           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>clientH</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">IPDR_SessionHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>sessionH</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Output statistics. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>clientH</em>&nbsp;</td><td>Exporter handle from <a class="el" href="../../d3/d96/group___i_p_d_r__initialization__starting__deletion.html#ga6">IPDR_InitExporter()</a>. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sessionH</em>&nbsp;</td><td>Session handle from <a class="el" href="../../d3/d0a/group___i_p_d_r__sessions.html#ga0">IPDR_CreateSession()</a>. </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00774 {
00775     <a class="code" href="../../d7/d1e/struct_i_p_d_r___statistics.html">IPDR_Statistics</a> stats;
00776     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> outstanding, unACKed;
00777     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> rc =
00778         <a class="code" href="../../d3/d96/group___i_p_d_r__initialization__starting__deletion.html#ga9">IPDR_GetSessionStatistics</a>(clientH, sessionH, NULL, &amp;stats, &amp;outstanding, &amp;unACKed);
00779     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a17">SUCCESS</a>(rc)) {
00780         cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a10">nowStrX</a>() &lt;&lt; <span class="stringliteral">" session: "</span> &lt;&lt;
00781             stats.<a class="code" href="../../d7/d1e/struct_i_p_d_r___statistics.html#o0">TransmittedRecords</a>  &lt;&lt; <span class="stringliteral">" TX, "</span> &lt;&lt;
00782             stats.<a class="code" href="../../d7/d1e/struct_i_p_d_r___statistics.html#o1">AcknowledgedRecords</a> &lt;&lt; <span class="stringliteral">" ACK, "</span> &lt;&lt;
00783             stats.<a class="code" href="../../d7/d1e/struct_i_p_d_r___statistics.html#o2">EnqueuedRecords</a>     &lt;&lt; <span class="stringliteral">" enq, "</span> &lt;&lt;
00784             stats.<a class="code" href="../../d7/d1e/struct_i_p_d_r___statistics.html#o3">LostRecords</a>         &lt;&lt; <span class="stringliteral">" lost, "</span> &lt;&lt;
00785             outstanding               &lt;&lt; <span class="stringliteral">" outstanding, "</span> &lt;&lt;
00786             unACKed                   &lt;&lt; <span class="stringliteral">" unAcKed"</span> &lt;&lt; endl;
00787     } <span class="keywordflow">else</span> {
00788         cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"IPDR_GetSessionStatistics failed: "</span> &lt;&lt; <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga22">IPDR_StatusMsg</a>(clientH, rc) &lt;&lt; endl;
00789     }
00790         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> NumCollectors;
00791         <a class="code" href="../../d3/d18/struct_i_p_d_r___collector.html">IPDR_Collector</a> *Collectors;
00792     rc = <a class="code" href="../../d3/d0a/group___i_p_d_r__sessions.html#ga11">IPDR_GetCollectorInSessionList</a>(clientH, sessionH, &amp;NumCollectors, &amp;Collectors);
00793     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(rc)) {
00794         cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"IPDR_GetServersList failed: "</span> &lt;&lt; <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga22">IPDR_StatusMsg</a>(clientH, rc) &lt;&lt; endl;
00795         NumCollectors = 0; <span class="comment">// so the following loop won't be executed</span>
00796     }
00797     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; NumCollectors; i++) {
00798         <a class="code" href="../../d6/df8/struct_i_p_d_r___event_data.html">IPDR_EventData</a> lastEvent;
00799         rc = <a class="code" href="../../d4/db0/group___i_p_d_r__transmitter___m_i_b.html#ga10">IPDR_GetServerStatisticsAndState</a>(clientH, sessionH, Collectors[i].Addr, Collectors[i].Port,
00800                                                NULL, &amp;stats, &amp;lastEvent);
00801         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a17">SUCCESS</a>(rc)) {
00802             cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt;
00803                 <a class="code" href="../../d8/dfc/class_i_pand_port.html#e0">IPandPort::asString</a>(Collectors[i].Addr, Collectors[i].Port) &lt;&lt;
00804                 <span class="stringliteral">" ("</span> &lt;&lt; <a class="code" href="../../df/dd7/group___i_p_d_r__event__notification.html#ga4">IPDR_EventMsg</a>(&amp;lastEvent) &lt;&lt; <span class="stringliteral">"): "</span> &lt;&lt;
00805                 stats.<a class="code" href="../../d7/d1e/struct_i_p_d_r___statistics.html#o0">TransmittedRecords</a>  &lt;&lt; <span class="stringliteral">" TX, "</span> &lt;&lt;
00806                 stats.<a class="code" href="../../d7/d1e/struct_i_p_d_r___statistics.html#o1">AcknowledgedRecords</a> &lt;&lt; <span class="stringliteral">" ACK, "</span> &lt;&lt;
00807                 stats.<a class="code" href="../../d7/d1e/struct_i_p_d_r___statistics.html#o2">EnqueuedRecords</a>     &lt;&lt; <span class="stringliteral">" enq, "</span> &lt;&lt;
00808                 stats.<a class="code" href="../../d7/d1e/struct_i_p_d_r___statistics.html#o3">LostRecords</a>        &lt;&lt; <span class="stringliteral">" lost"</span> &lt;&lt; endl;
00809         } <span class="keywordflow">else</span> {
00810             cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"IPDR_GetServersStatistics("</span> &lt;&lt;
00811                 <a class="code" href="../../d8/dfc/class_i_pand_port.html#e0">IPandPort::asString</a>(Collectors[i].Addr, Collectors[i].Port) &lt;&lt;
00812                 <span class="stringliteral">") failed: "</span> &lt;&lt; <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga22">IPDR_StatusMsg</a>(clientH, rc) &lt;&lt; endl;
00813         }
00814     }
00815 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="IPDRsim.cpp::cmdTemplate"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void cmdTemplate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>sessionID</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>templateId</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>exporterH</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../da/db3/class_record.html">Record</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>rec</em>[]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Execute the "template" command. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sessionID</em>&nbsp;</td><td>session id to assign the template </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>templateId</em>&nbsp;</td><td>The identifier for the template. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>exporterH</em>&nbsp;</td><td>Exporter handle from <a class="el" href="../../d3/d96/group___i_p_d_r__initialization__starting__deletion.html#ga6">IPDR_InitExporter()</a>. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rec</em>&nbsp;</td><td>Vector of records that can be output. </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00680 {
00681         <a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html">IPDR_SessionHandle</a> sessionH     ;
00682         <span class="keyword">const</span> <span class="keywordtype">char</span>* sessionName ;
00683 
00684         <span class="keywordflow">if</span>( <a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(<a class="code" href="../../d3/d0a/group___i_p_d_r__sessions.html#ga2">IPDR_GetSession</a>(exporterH,sessionID, &amp;sessionH, &amp;sessionName, NULL)))
00685         {
00686                 cerr &lt;&lt; <span class="stringliteral">"Invalid session ID: "</span> &lt;&lt; sessionID &lt;&lt; endl ;
00687                 return ;
00688         }
00689 
00690     <a class="code" href="../../da/db3/class_record.html">Record</a>* theRec = <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a16">lookupRecByTemplateId</a>(rec, templateId);
00691     <span class="keywordflow">if</span> (rec &amp;&amp; theRec) {
00692         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> rc;
00693         cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"Creating Template #"</span> &lt;&lt; theRec-&gt;<a class="code" href="../../da/db3/class_record.html#a0">templateId</a>() &lt;&lt;
00694             <span class="stringliteral">" ("</span> &lt;&lt; theRec-&gt;<a class="code" href="../../da/db3/class_record.html#a1">templateDescr</a>() &lt;&lt; <span class="stringliteral">")"</span> &lt;&lt;
00695             <span class="stringliteral">" for Session #"</span> &lt;&lt; sessionID &lt;&lt; <span class="stringliteral">" ("</span> &lt;&lt; sessionName &lt;&lt; <span class="stringliteral">")"</span> &lt;&lt; endl;
00696         theRec-&gt;<a class="code" href="../../da/db3/class_record.html#a8">printKeys</a>(cerr) &lt;&lt; endl;
00697 
00698                 <span class="keywordflow">if</span>(<a class="code" href="../../d3/d96/group___i_p_d_r__initialization__starting__deletion.html#ga8">IPDR_IsRunning</a>(exporterH))
00699                         <a class="code" href="../../d3/d0a/group___i_p_d_r__sessions.html#ga13">IPDR_StopSession</a>(sessionH, <a class="code" href="../../df/dcb/group___i_p_d_r__key__type__attributes.html#gga66a127">IPDR_STOP_REASON_TEMPLATEUPDATED</a>, 60*1000);
00700 
00701         rc = <a class="code" href="../../d1/dcc/group___i_p_d_r__templates.html#ga6">IPDR_CreateTemplate</a>(exporterH,
00702                                                                   sessionH,
00703                                   theRec-&gt;<a class="code" href="../../da/db3/class_record.html#a0">templateId</a>(),
00704                                   theRec-&gt;<a class="code" href="../../da/db3/class_record.html#a1">templateDescr</a>(),
00705                                                                   <span class="stringliteral">""</span>,
00706                                   theRec-&gt;<a class="code" href="../../da/db3/class_record.html#a3">numKeys</a>(),
00707                                   theRec-&gt;<a class="code" href="../../da/db3/class_record.html#a2">keys</a>(),
00708                                   &amp; theRec-&gt;<a class="code" href="../../da/db3/class_record.html#o2">templateH</a>);
00709         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(rc))
00710                 {
00711             cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"IPDR_CreateTemplate failed: "</span> &lt;&lt; <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga22">IPDR_StatusMsg</a>(exporterH, rc) &lt;&lt; endl;
00712             <span class="comment">//exit(1);</span>
00713         }
00714                 <span class="keywordflow">else</span>
00715                 {
00716                         <span class="keywordflow">if</span>(<a class="code" href="../../d3/d96/group___i_p_d_r__initialization__starting__deletion.html#ga8">IPDR_IsRunning</a>(exporterH))
00717                                 <a class="code" href="../../d1/dcc/group___i_p_d_r__templates.html#ga17">IPDR_ApplyTemplates</a>(sessionH);
00718                 }
00719 
00720                 <span class="keywordflow">if</span>(<a class="code" href="../../d3/d96/group___i_p_d_r__initialization__starting__deletion.html#ga8">IPDR_IsRunning</a>(exporterH))
00721                         <a class="code" href="../../d3/d0a/group___i_p_d_r__sessions.html#ga12">IPDR_StartSession</a> (sessionH,1);
00722 
00723     } <span class="keywordflow">else</span> {
00724         cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"Invalid templateId: "</span> &lt;&lt; templateId &lt;&lt; endl;
00725     }
00726 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="IPDRsim.cpp::disableStartNegotiationCB"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void disableStartNegotiationCB           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">IPDR_SessionHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>SessionHandle</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">IPDR_CollectorHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>CollectorHandle</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../dc/d02/ipdr_2include_2_i_p_d_r_2_defs_8h.html#a16">IPDR_BOOL</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Negotiate</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>Arg</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The callback for handling a template start negotiation always disable negotiation <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>SessionHandle</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>CollectorHandle</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Negotiate</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Arg</em>&nbsp;</td><td></td></tr>
  </table>
</dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="../../d1/dcc/group___i_p_d_r__templates.html#ga20">IPDR_SetStartNegotiationCallback</a> </dd></dl>
<div class="fragment"><pre class="fragment">00475 {
00476         *Negotiate = <a class="code" href="../../db/d2e/_for_doxygen_2include_2_i_p_d_r_2_defs_8h.html#a4">IPDR_FALSE</a> ;
00477 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="IPDRsim.cpp::enableStartNegotiationCB"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void enableStartNegotiationCB           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">IPDR_SessionHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>SessionHandle</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../de/d0d/struct_i_p_d_r__tag___collector.html">IPDR_CollectorHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>CollectorHandle</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../dc/d02/ipdr_2include_2_i_p_d_r_2_defs_8h.html#a16">IPDR_BOOL</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Negotiate</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>Arg</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The callback for handling a template start negotiation always enable negotiation <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>SessionHandle</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>CollectorHandle</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Negotiate</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Arg</em>&nbsp;</td><td></td></tr>
  </table>
</dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="../../d1/dcc/group___i_p_d_r__templates.html#ga20">IPDR_SetStartNegotiationCallback</a> </dd></dl>
<div class="fragment"><pre class="fragment">00459 {
00460         *Negotiate = <a class="code" href="../../db/d2e/_for_doxygen_2include_2_i_p_d_r_2_defs_8h.html#a5">IPDR_TRUE</a> ;
00461 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="IPDRsim.cpp::eventCallback"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void eventCallback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="../../d6/df8/struct_i_p_d_r___event_data.html">IPDR_EventData</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>event</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The callback for handling an event (registered by IPDR_SetExporterEventHandler()). This simply outputs a message to stderr. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>event</em>&nbsp;</td><td>The event and its details </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>msg</em>&nbsp;</td><td>A message associated with the event </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>The context for this callback, as passed to IPDR_SetExporterEventHandler(): a pointer to IPDR_ExporterHandle </td></tr>
  </table>
</dl>
<dl compact><dt><b>See also:</b></dt><dd>IPDR_SetExporterEventHandler <p>
<a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga15">IPDR_ExporterHandle</a> </dd></dl>
<div class="fragment"><pre class="fragment">00407 {
00408     <a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a> client = *(<a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a> *)context;
00409     <span class="keywordflow">if</span> (<a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#ga3">IPDR_CheckLogLevel</a>(client, <span class="stringliteral">"Host"</span>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga7a172">IPDR_LEVEL_DEBUG</a>)) {
00410         cerr &lt;&lt; endl &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a10">nowStrX</a>() &lt;&lt; <span class="stringliteral">" Event: ["</span> &lt;&lt; <span class="comment">// event-&gt;EventID &lt;&lt; ": " &lt;&lt;</span>
00411             <a class="code" href="../../df/dd7/group___i_p_d_r__event__notification.html#ga4">IPDR_EventMsg</a>(event) &lt;&lt; <span class="stringliteral">"] "</span> &lt;&lt; msg &lt;&lt; endl &lt;&lt; endl;
00412     }
00413     <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#ga4">IPDR_LogWrite</a>(client, <span class="stringliteral">"Host"</span>,
00414                    (event-&gt;<a class="code" href="../../d6/df8/struct_i_p_d_r___event_data.html#o0">EventID</a> == <a class="code" href="../../df/dd7/group___i_p_d_r__event__notification.html#gga6a152">IPDR_EVENT_RECORD_LOST</a> ||
00415                     event-&gt;<a class="code" href="../../d6/df8/struct_i_p_d_r___event_data.html#o0">EventID</a> == <a class="code" href="../../df/dd7/group___i_p_d_r__event__notification.html#gga6a156">IPDR_EVENT_ERROR</a>) ? <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga7a169">IPDR_LEVEL_ERROR</a> : <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga7a171">IPDR_LEVEL_INFO</a>,
00416                    <span class="stringliteral">"EventCallback"</span>, <span class="stringliteral">"*** Event[%.99s] %s"</span>, <a class="code" href="../../df/dd7/group___i_p_d_r__event__notification.html#ga4">IPDR_EventMsg</a>(event), msg);
00417     <span class="keywordflow">switch</span> (event-&gt;<a class="code" href="../../d6/df8/struct_i_p_d_r___event_data.html#o0">EventID</a>) {
00418     <span class="keywordflow">case</span> <a class="code" href="../../df/dd7/group___i_p_d_r__event__notification.html#gga6a154">IPDR_EVENT_QUEUE_EMPTY</a>:
00419         <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a9">sendRateData</a>.queueEmptyTime = <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a11">getNowTime</a>();
00420         {
00421             <span class="keywordtype">long</span> sec0 = <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a9">sendRateData</a>.queueEmptyTime.tv_sec - <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a9">sendRateData</a>.startTime.tv_sec;
00422             <span class="keywordtype">long</span> nsec_adj0 = <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a9">sendRateData</a>.queueEmptyTime.tv_nsec - <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a9">sendRateData</a>.startTime.tv_nsec;
00423 
00424             <span class="keywordtype">double</span> sec = sec0;
00425             <span class="keywordtype">long</span> nsec_adj = nsec_adj0;
00426 
00427             <span class="keywordflow">while</span> (nsec_adj &lt; 0) {
00428                 sec -= 1;
00429                 nsec_adj += (1000 * 1000 * 1000);
00430             }
00431             sec += ((double)nsec_adj) / (1000 * 1000 * 1000);
00432             <span class="keywordflow">if</span> (sec != 0.0) {
00433                 <span class="keywordtype">double</span> rate = ((double)<a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a9">sendRateData</a>.numRecords) / sec;
00434                 <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#ga4">IPDR_LogWrite</a>(client, <span class="stringliteral">"Host"</span>, IPDR_LEVEL_INFO, <span class="stringliteral">"EventCallback"</span>,
00435                                <span class="stringliteral">"+++ Time to transmit %ld records: %g sec: %7g rec/sec"</span>,
00436                                <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a9">sendRateData</a>.numRecords,
00437                                sec, <span class="comment">//  "(%ld.%10ld)"sec0, nsec_adj0,</span>
00438                                rate, rate);
00439             }
00440         }
00441         <span class="keywordflow">break</span>;
00442     <span class="keywordflow">default</span>:
00443         <span class="keywordflow">break</span>;
00444     }
00445 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a32" doxytag="IPDRsim.cpp::executeCommand"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void executeCommand           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>clientH</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../da/db3/class_record.html">Record</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>rec</em>[], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned long &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>recNum</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>ofstream *&nbsp;</td>
          <td class="mdname" nowrap> <em>recordFile</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const string &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>bool *&nbsp;</td>
          <td class="mdname" nowrap> <em>end</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Execute a command. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>clientH</em>&nbsp;</td><td>client Handle. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rec</em>&nbsp;</td><td>Vector of Records. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>recNum</em>&nbsp;</td><td>Current record number (initially 0). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>recordFile</em>&nbsp;</td><td>File which gets CVS form of the records sent by IPDR. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cmd</em>&nbsp;</td><td>The command line. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>end</em>&nbsp;</td><td>(output) set to true if the command was one that stops execution; otherwise set to false. </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00968 {
00969     *end = <span class="keyword">false</span>;
00970     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> rc;
00971 
00972     <span class="keywordflow">if</span> (! cmd.empty()) {
00973         <span class="keyword">const</span> <span class="keywordtype">char</span> *cmdPart;
00974         <span class="keywordtype">int</span> cmdArgC;
00975         <span class="keyword">const</span> <span class="keywordtype">char</span> **cmdArgs;
00976                 <span class="comment">// The following line is bad style, but it's more convenient</span>
00977         <span class="comment">// than allocating a C-string, just so it can be modified.</span>
00978         <span class="keywordtype">char</span> *line = const_cast&lt;char*&gt;(cmd.c_str());
00979         <span class="keywordflow">while</span> (line &amp;&amp; line[0] != <span class="charliteral">'\0'</span>) {
00980                         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> cmdRc = IPDR_DoConsoleCommand(clientH, stderr,
00981                                                         line,
00982                                                         &amp;cmdPart, &amp;cmdArgC, &amp;cmdArgs,
00983                                                         &amp;line,
00984                                                                                                                 NULL,
00985                                                                                                                 0);
00986                         string cmdStr = cmdPart;
00987             <span class="keywordflow">switch</span> (cmdRc) {
00988             <span class="keywordflow">case</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a207">IPDR_CMD_EXIT</a>:
00989                 *end = <span class="keyword">true</span>;
00990                 <span class="keywordflow">return</span>;
00991             <span class="keywordflow">case</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a209">IPDR_CMD_HELP</a>:
00992                 cerr &lt;&lt; <span class="stringliteral">"Testing commands:"</span> &lt;&lt; endl &lt;&lt;
00993                     <span class="stringliteral">"  template &lt;sessionID&gt; &lt;templateId&gt;"</span> &lt;&lt; endl &lt;&lt;
00994                     <span class="stringliteral">"  dsn &lt;sessionId&gt; &lt;dsn&gt;"</span> &lt;&lt; endl &lt;&lt;
00995                     <span class="stringliteral">"  start"</span> &lt;&lt; endl &lt;&lt;
00996                     <span class="stringliteral">"  send &lt;templateId&gt; &lt;numberOfRecords&gt; &lt;intervalBetweenRecords&gt;"</span> &lt;&lt; endl &lt;&lt;
00997                     <span class="stringliteral">"  sleep &lt;milliSeconds&gt;"</span> &lt;&lt; endl &lt;&lt;
00998                     <span class="stringliteral">"  statistics"</span> &lt;&lt; endl &lt;&lt;
00999                     <span class="stringliteral">"  drain &lt;milliSeconds&gt;"</span> &lt;&lt; endl &lt;&lt;
01000                     <span class="stringliteral">"  mibsave [ &lt;filename&gt; ]"</span> &lt;&lt; endl &lt;&lt;
01001                     <span class="stringliteral">"  mibload &lt;filename&gt;"</span> &lt;&lt; endl;
01002                 <span class="keywordflow">break</span>;
01003             <span class="keywordflow">case</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>:
01004                 <span class="keywordflow">break</span>;
01005             <span class="keywordflow">case</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a191">IPDR_ERR_SESSION_ALREADY_EXISTS</a>:
01006             <span class="keywordflow">case</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a194">IPDR_ERR_COLLECTOR_ALREADY_EXISTS</a>:
01007             <span class="keywordflow">case</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a206">IPDR_ERR_ALREADY_RUNNING</a>:
01008                 <span class="comment">/* No harm done: just ignore the command and keep going. */</span>
01009                 <span class="keywordflow">break</span>;
01010             <span class="comment">/* Errors that might be OK but probably aren't: */</span>
01011             <span class="keywordflow">case</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a199">IPDR_ERR_KEY_ALREADY_EXISTS</a>:
01012             <span class="keywordflow">case</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a196">IPDR_ERR_TEMPLATE_ALREADY_EXISTS</a>:
01013             <span class="keywordflow">default</span>:
01014                 cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"Command ("</span> &lt;&lt; cmd &lt;&lt;
01015                     <span class="stringliteral">") error: "</span> &lt;&lt; <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga22">IPDR_StatusMsg</a>(clientH, cmdRc) &lt;&lt; endl;
01016                 <span class="keywordflow">break</span>;
01017             <span class="keywordflow">case</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a208">IPDR_CMD_NOT_FOUND</a>:
01018                 <span class="keywordflow">if</span> (cmdStr == <span class="stringliteral">"template"</span>) {
01019                     <span class="keywordflow">if</span> (cmdArgC == 2) {
01020                         <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a24">cmdTemplate</a>(atoi(cmdArgs[0]), atoi(cmdArgs[1]), clientH, rec);
01021                     } <span class="keywordflow">else</span> {
01022                         cerr &lt;&lt; <span class="stringliteral">"'template' command must have 2 arguments (sessionID, templateID)"</span> &lt;&lt; endl;
01023                     }
01024                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cmdStr == <span class="stringliteral">"statistics"</span>) {
01025                     vector&lt;SessionInfo&gt; sessions = <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a28">getSessions</a>(clientH);
01026                     <span class="keywordflow">if</span> (sessions.size() &lt;= 0) {
01027                         cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"No sessions for statistics."</span> &lt;&lt; endl;
01028                     }
01029                     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; sessions.size(); i++) {
01030                         cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"Statistics for session "</span> &lt;&lt; sessions[i].id &lt;&lt;
01031                             <span class="stringliteral">" ("</span> &lt;&lt; sessions[i].name &lt;&lt; <span class="stringliteral">": "</span> &lt;&lt; sessions[i].descr &lt;&lt; <span class="stringliteral">")"</span> &lt;&lt; endl;
01032                         <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a26">cmdStatistics</a>(clientH, sessions[i].handle);
01033                     }
01034                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cmdStr == <span class="stringliteral">"dsn"</span> || cmdStr == <span class="stringliteral">"DSN"</span>) {
01035                     <span class="keywordflow">if</span> (cmdArgC == 2) {
01036                         <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a25">cmdSetSessionDSN</a>(atoi(cmdArgs[0]), strtoul(cmdArgs[1], NULL, 10), clientH);
01037                     } <span class="keywordflow">else</span> {
01038                         cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"'dsn' command must have 2 argument (session Id, new sequence number)"</span> &lt;&lt; endl;
01039                     }
01040                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cmdStr == <span class="stringliteral">"start"</span>) {
01041                     <span class="keywordflow">if</span> (cmdArgC == 0) {
01042                         cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"Starting Exporter ..."</span> &lt;&lt; endl;
01043 
01044                         rc = <a class="code" href="../../d3/d96/group___i_p_d_r__initialization__starting__deletion.html#ga7">IPDR_StartExporter</a>(clientH);
01045                         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(rc)) {
01046                             cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"IPDR_StartExporter failed: "</span> &lt;&lt; <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga22">IPDR_StatusMsg</a>(clientH, rc) &lt;&lt; endl;
01047                             <span class="comment">//exit(1);</span>
01048                         }
01049                     } <span class="keywordflow">else</span> {
01050                         cerr &lt;&lt; <span class="stringliteral">"'start' command doesn't take an argument"</span> &lt;&lt; endl;
01051                     }
01052                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cmdStr == <span class="stringliteral">"send"</span>) {
01053                     <span class="keywordflow">if</span> (cmdArgC == 4) {
01054                                                 <span class="keywordtype">int</span> sessionId = atoi(cmdArgs[0]);
01055                         <span class="keywordtype">int</span> templateId = atoi(cmdArgs[1]);
01056                         <span class="keywordtype">long</span> times = atoi(cmdArgs[2]);
01057                         <span class="keywordtype">long</span> intvl = atoi(cmdArgs[3]);
01058 
01059                                                 <a class="code" href="../../d9/d35/struct_i_p_d_r__tag___session.html">IPDR_SessionHandle</a> sessionH;
01060 
01061                                                 <span class="keywordflow">if</span>( <a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(<a class="code" href="../../d3/d0a/group___i_p_d_r__sessions.html#ga2">IPDR_GetSession</a>(clientH,sessionId, &amp;sessionH, NULL, NULL)))
01062                                                 {
01063                                                         cerr &lt;&lt; <span class="stringliteral">"Invalid session ID: "</span> &lt;&lt; sessionId &lt;&lt; endl ;
01064                                                 }
01065                                                 <span class="keywordflow">else</span>
01066                                                 {
01067                                                         <a class="code" href="../../d4/dc8/struct_i_p_d_r__tag___template_handle.html">IPDR_TemplateHandle</a> templateH;
01068                                                         <span class="keywordflow">if</span>(<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a17">SUCCESS</a>(<a class="code" href="../../d1/dcc/group___i_p_d_r__templates.html#ga8">IPDR_GetTemplate</a>(sessionH,templateId,NULL,NULL,NULL,&amp;templateH)))
01069                                                         {
01070                                                                 <a class="code" href="../../da/db3/class_record.html">Record</a>* theRec = <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a16">lookupRecByTemplateId</a>(rec, templateId);
01071                                                                 <span class="keywordflow">if</span> (theRec) {
01072                                                                         <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a23">sendRecords</a>(*theRec, recNum, clientH, sessionH, templateH, times, intvl, recordFile);
01073                                                                 } <span class="keywordflow">else</span> {
01074                                                                         cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"Invalid templateId: "</span> &lt;&lt; templateId &lt;&lt; endl;
01075                                                                 }
01076                                                         }
01077                                                         <span class="keywordflow">else</span>
01078                                                         {
01079                                                                 cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"Invalid templateId: "</span> &lt;&lt; templateId &lt;&lt; <span class="stringliteral">", For Session: "</span> &lt;&lt; sessionId &lt;&lt; endl;
01080                                                         }
01081                                                 }
01082                     } <span class="keywordflow">else</span> {
01083                         cerr &lt;&lt; <span class="stringliteral">"'send' command must have 4 arguments (sessionID, templateID, times, interval)"</span> &lt;&lt; endl;
01084                     }
01085                 } <span class="comment">/*else if (cmdStr == "mibsave") {</span>
01086 <span class="comment">                    switch (cmdArgC) {</span>
01087 <span class="comment">                    case 0:</span>
01088 <span class="comment">                        saveMIB(clientH, IPDR_MIBVersion(clientH), NULL);</span>
01089 <span class="comment">                        break;</span>
01090 <span class="comment">                    case 1:</span>
01091 <span class="comment">                        saveMIB(clientH, IPDR_MIBVersion(clientH), cmdArgs[0]);</span>
01092 <span class="comment">                        break;</span>
01093 <span class="comment">                    default:</span>
01094 <span class="comment">                        cerr &lt;&lt; outputPrefix &lt;&lt; "'mibsave' command must have 0 or 1 argument (file name)" &lt;&lt; endl;</span>
01095 <span class="comment">                    }</span>
01096 <span class="comment">                } else if (cmdStr == "mibload") {</span>
01097 <span class="comment">                    switch (cmdArgC) {</span>
01098 <span class="comment">                    case 1:</span>
01099 <span class="comment">                        loadMIB(clientH, IPDR_MIBVersion(clientH), cmdArgs[0]);</span>
01100 <span class="comment">                        break;</span>
01101 <span class="comment">                    default:</span>
01102 <span class="comment">                        cerr &lt;&lt; outputPrefix &lt;&lt; "'mibload' command must have 0 or 1 argument (file name)" &lt;&lt; endl;</span>
01103 <span class="comment">                    }</span>
01104 <span class="comment">                }*/</span> <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cmdStr == <span class="stringliteral">"sleep"</span>) {
01105                     <span class="keywordflow">if</span> (cmdArgC == 1) {
01106                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> millisec = atoi(cmdArgs[0]);
01107                         cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"Sleeping "</span> &lt;&lt; ((double)millisec)/1000.0 &lt;&lt; <span class="stringliteral">" seconds ..."</span> &lt;&lt; endl;
01108                         <a class="code" href="../../d1/d24/group___i_p_d_r__platform__calls.html#ga8">IPDR_SleepMS</a>(clientH, millisec);
01109                         cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"Awake! "</span> &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a10">nowStrX</a>() &lt;&lt; endl;
01110                     } <span class="keywordflow">else</span> {
01111                         cerr &lt;&lt; <span class="stringliteral">"sleep' command must have 1 argument (millisec)"</span> &lt;&lt; endl;
01112                     }
01113                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cmdStr == <span class="stringliteral">"drain"</span>) {
01114                     <span class="keywordflow">if</span> (cmdArgC == 1) {
01115                         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> millisec = atoi(cmdArgs[0]);
01116                         vector&lt;SessionInfo&gt; sessions = <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a28">getSessions</a>(clientH);
01117                         <span class="keywordflow">if</span> (sessions.size() &lt;= 0) {
01118                             cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"No sessions to drain."</span> &lt;&lt; endl;
01119                         }
01120                         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; sessions.size(); i++) {
01121                             cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"Draining session "</span> &lt;&lt; sessions[i].id &lt;&lt;
01122                                 <span class="stringliteral">" ("</span> &lt;&lt; sessions[i].name &lt;&lt; <span class="stringliteral">": "</span> &lt;&lt; sessions[i].descr &lt;&lt; <span class="stringliteral">")"</span>;
01123                             <span class="keywordflow">if</span> (millisec &gt; 0) {
01124                                 cerr &lt;&lt; <span class="stringliteral">" for "</span> &lt;&lt; millisec &lt;&lt; <span class="stringliteral">" milli-seconds ..."</span> &lt;&lt; endl;
01125                             } <span class="keywordflow">else</span> {
01126                                 cerr &lt;&lt; <span class="stringliteral">" (indefinite wait)"</span> &lt;&lt; endl;
01127                             }
01128                             rc = <a class="code" href="../../d3/d96/group___i_p_d_r__initialization__starting__deletion.html#ga13">IPDR_DrainQueue</a>(clientH, sessions[i].handle, millisec);
01129                             <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a17">SUCCESS</a>(rc)) {
01130                                 cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"Finished draining at "</span> &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a10">nowStrX</a>() &lt;&lt; endl;
01131                             } <span class="keywordflow">else</span> {
01132                                 cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"IPDR_DrainQueue at "</span> &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a10">nowStrX</a>() &lt;&lt; <span class="stringliteral">": "</span> &lt;&lt; <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga22">IPDR_StatusMsg</a>(clientH, rc) &lt;&lt; endl;
01133                             }
01134                         }
01135                     } <span class="keywordflow">else</span> {
01136                         cerr &lt;&lt; <span class="stringliteral">"'drain' command must have 1 argument (millisec: 0 for \"indefinite\")"</span> &lt;&lt; endl;
01137                     }
01138                 } <span class="keywordflow">else</span> {
01139                     cerr &lt;&lt; <span class="stringliteral">"Command '"</span> &lt;&lt; cmdStr &lt;&lt;
01140                         <span class="stringliteral">"' with "</span> &lt;&lt; cmdArgC &lt;&lt; <span class="stringliteral">" arguments ("</span>;
01141                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; cmdArgC; i++) {
01142                         cerr &lt;&lt; ((i == 0) ? <span class="stringliteral">""</span> : <span class="stringliteral">" "</span>) &lt;&lt; cmdArgs[i];
01143                     }
01144                     cerr &lt;&lt; <span class="stringliteral">") not found ... 'help' will give you a list."</span> &lt;&lt; endl;
01145                     <span class="keywordflow">break</span>;
01146                 }
01147             }
01148         }
01149     }
01150 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="IPDRsim.cpp::getNowTime"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static struct timespec getNowTime           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get the current time. <dl compact><dt><b>Returns:</b></dt><dd>The current time as a Unix-standard "timespec" </dd></dl>
<div class="fragment"><pre class="fragment">00569 {
00570     <span class="keyword">struct </span>timespec result;
00571 <span class="preprocessor">#if defined(CYGWIN)</span>
00572 <span class="preprocessor"></span>    <span class="keyword">struct </span>timeval tv;
00573     gettimeofday(&amp;tv, NULL);
00574     result.tv_sec  = tv.tv_sec;
00575     result.tv_nsec = tv.tv_usec * 1000;
00576 <span class="preprocessor">#else</span>
00577 <span class="preprocessor"></span>    clock_gettime(CLOCK_REALTIME, &amp;result);
00578 <span class="preprocessor">#endif</span>
00579 <span class="preprocessor"></span>    <span class="keywordflow">return</span> result;
00580 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="IPDRsim.cpp::getSessions"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">vector&lt;<a class="el" href="../../d9/dff/struct_session_info.html">SessionInfo</a>&gt; getSessions           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>clientH</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<div class="fragment"><pre class="fragment">00841 {
00842     vector&lt;SessionInfo&gt; result;
00843     <span class="keywordtype">int</span> numSessions;
00844     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *sessions;
00845 
00846     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> rc = <a class="code" href="../../d3/d0a/group___i_p_d_r__sessions.html#ga3">IPDR_GetSessionsList</a>(clientH, &amp;numSessions, &amp;sessions);
00847     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a17">SUCCESS</a>(rc)) {
00848         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; numSessions; i++) {
00849             <a class="code" href="../../d9/dff/struct_session_info.html">SessionInfo</a> si;
00850             si.<a class="code" href="../../d9/dff/struct_session_info.html#o1">id</a> = sessions[i];
00851             rc = <a class="code" href="../../d3/d0a/group___i_p_d_r__sessions.html#ga2">IPDR_GetSession</a>(clientH, sessions[i], &amp;si.<a class="code" href="../../d9/dff/struct_session_info.html#o0">handle</a>, &amp;si.<a class="code" href="../../d9/dff/struct_session_info.html#o2">name</a>, &amp;si.<a class="code" href="../../d9/dff/struct_session_info.html#o3">descr</a>);
00852             <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a17">SUCCESS</a>(rc)) {
00853                 result.push_back(si);
00854             } <span class="keywordflow">else</span> {
00855                 cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"IPDR_GetSession("</span> &lt;&lt; static_cast&lt;unsigned int&gt;(sessions[i]) &lt;&lt; <span class="stringliteral">"): "</span> &lt;&lt; <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga22">IPDR_StatusMsg</a>(clientH, rc) &lt;&lt; endl;
00856             }
00857         }
00858     } <span class="keywordflow">else</span> {
00859         cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"IPDR_GetSessionsList: "</span> &lt;&lt; <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga22">IPDR_StatusMsg</a>(clientH, rc) &lt;&lt; endl;
00860     }
00861 
00862     <span class="keywordflow">return</span> result;
00863 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="IPDRsim.cpp::handle_SIGUSR1"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void handle_SIGUSR1           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>signum</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Handle USR1 signals by bailing out. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>signum</em>&nbsp;</td><td>The UNIX signal number </td></tr>
  </table>
</dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="../../d1/dbf/ipdr_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a2">stopJmpBuf</a> </dd></dl>
<div class="fragment"><pre class="fragment">00196 {
00197     longjmp(<a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a2">stopJmpBuf</a>, 1);
00198 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="IPDRsim.cpp::initParmMap"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void initParmMap           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dbf/ipdr_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a4">ParmMap_t</a> &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>parmMap</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set the values of the parameters. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>parmMap</em>&nbsp;</td><td>(updated) parameer map </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00249 {
00250     <span class="comment">// Except as noted, the following parameters are all the default values</span>
00251     parmMap[<span class="stringliteral">"configuration.vendorString"</span>] =           <span class="comment">/*str*/</span>
00252         <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(<span class="stringliteral">"IPDR.org - IPDR Exporter (simulator)"</span>, <span class="keyword">false</span>); <span class="comment">// not default value</span>
00253     parmMap[<span class="stringliteral">"configuration.exporterAddress"</span>] =          <span class="comment">/*IPstr*/</span> <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(NULL, <span class="keyword">false</span>);
00254     parmMap[<span class="stringliteral">"configuration.exporterPort"</span>] =             <span class="comment">/*int*/</span> <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(<span class="stringliteral">"4737"</span>, <span class="keyword">false</span>);
00255     parmMap[<span class="stringliteral">"configuration.protocolInfoAddr"</span>] =       <span class="comment">/*IPstr*/</span> <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(NULL, <span class="keyword">false</span>);
00256     parmMap[<span class="stringliteral">"configuration.protocolInfoPort"</span>] =       <span class="comment">/*int*/</span> <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(<span class="stringliteral">"4737"</span>, <span class="keyword">false</span>);
00257     parmMap[<span class="stringliteral">"configuration.windowSize"</span>] =             <span class="comment">/*int*/</span> <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(NULL, <span class="keyword">false</span>); <span class="comment">// default: "1000000"</span>
00258     parmMap[<span class="stringliteral">"configuration.windowTimeout"</span>] =          <span class="comment">/*int*/</span> <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(<span class="stringliteral">"10000"</span>, <span class="keyword">false</span>); <span class="comment">// default: "10000", false);</span>
00259     parmMap[<span class="stringliteral">"configuration.tmplDataTimeout"</span>] =        <span class="comment">/*int*/</span> <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(<span class="stringliteral">"5000"</span>, <span class="keyword">false</span>);
00260     parmMap[<span class="stringliteral">"configuration.statisticsInterval"</span>] =     <span class="comment">/*int*/</span> <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(<span class="stringliteral">"23000"</span>, <span class="keyword">false</span>); <span class="comment">// default: "20000"</span>
00261     parmMap[<span class="stringliteral">"configuration.queueChunkSize"</span>] =         <span class="comment">/*int*/</span> <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(<span class="stringliteral">"16384"</span>, <span class="keyword">false</span>);
00262     parmMap[<span class="stringliteral">"configuration.queueInitialNumChunks"</span>] =  <span class="comment">/*int*/</span> <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(<span class="stringliteral">"4"</span>, <span class="keyword">false</span>);
00263     parmMap[<span class="stringliteral">"configuration.queueMaxMemory"</span>] =         <span class="comment">/*int*/</span> <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(<span class="stringliteral">"0"</span>, <span class="keyword">false</span>);
00264 
00265         parmMap[<span class="stringliteral">"configuration.waitBestCollectorTimeout"</span>] =    <span class="comment">/*int*/</span> <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(<span class="stringliteral">"60000"</span>, <span class="keyword">false</span>);
00266 
00267         parmMap[<span class="stringliteral">"configuration.dataAckTimeInterval"</span>] =         <span class="comment">/*int*/</span> <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(<span class="stringliteral">"1000"</span>, <span class="keyword">false</span>);
00268         parmMap[<span class="stringliteral">"configuration.dataAckSequenceInterval"</span>] =         <span class="comment">/*int*/</span> <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(<span class="stringliteral">"50"</span>, <span class="keyword">false</span>);
00269 
00270         parmMap[<span class="stringliteral">"configuration.keepAliveInterval"</span>] =         <span class="comment">/*int*/</span> <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(<span class="stringliteral">"20000"</span>, <span class="keyword">false</span>);
00271         parmMap[<span class="stringliteral">"configuration.autoconnectInterval"</span>] =         <span class="comment">/*int*/</span> <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(<span class="stringliteral">"5000"</span>, <span class="keyword">false</span>);
00272 
00273     parmMap[<span class="stringliteral">"configuration.transport.tcpTransport.flushInterval"</span>] =                <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(NULL, <span class="keyword">false</span>); <span class="comment">// default: "500";</span>
00274     parmMap[<span class="stringliteral">"configuration.transport.tcpTransport.dataRcvChunkSize"</span>] =             <span class="comment">/*int*/</span> <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(<span class="stringliteral">"16384"</span>, <span class="keyword">false</span>);
00275     parmMap[<span class="stringliteral">"configuration.transport.tcpTransport.dataRcvInitialNumChunks"</span>] =      <span class="comment">/*int*/</span> <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(<span class="stringliteral">"2"</span>, <span class="keyword">false</span>);
00276     parmMap[<span class="stringliteral">"configuration.transport.tcpTransport.dataRcvMaxMemory"</span>] =             <span class="comment">/*int*/</span> <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(<span class="stringliteral">"0"</span>, <span class="keyword">false</span>);
00277     parmMap[<span class="stringliteral">"configuration.transport.tcpTransport.dataSndChunkSize"</span>] =             <span class="comment">/*int*/</span> <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(<span class="stringliteral">"4096"</span>, <span class="keyword">false</span>);
00278     parmMap[<span class="stringliteral">"configuration.transport.tcpTransport.dataSndInitialNumChunks"</span>] =      <span class="comment">/*int*/</span> <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(<span class="stringliteral">"2"</span>, <span class="keyword">false</span>);
00279     parmMap[<span class="stringliteral">"configuration.transport.tcpTransport.dataSndMaxMemory"</span>] =             <span class="comment">/*int*/</span> <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(<span class="stringliteral">"0"</span>, <span class="keyword">false</span>);
00280     parmMap[<span class="stringliteral">"configuration.transport.tcpTransport.sendBuffersChunkSize"</span>] =         <span class="comment">/*int*/</span> <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(<span class="stringliteral">"4096"</span>, <span class="keyword">false</span>);
00281     parmMap[<span class="stringliteral">"configuration.transport.tcpTransport.sendBuffersInitialNumChunks"</span>] =  <span class="comment">/*int*/</span> <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(<span class="stringliteral">"2"</span>, <span class="keyword">false</span>);
00282     parmMap[<span class="stringliteral">"configuration.transport.tcpTransport.sendBuffersMaxMemory"</span>] =         <span class="comment">/*int*/</span> <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(<span class="stringliteral">"0"</span>, <span class="keyword">false</span>);
00283 
00284     parmMap[<span class="stringliteral">"configuration.transport.tcpTransport.minimumReconnectInterval"</span>] =     <span class="comment">/*int*/</span> <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(<span class="stringliteral">"1000"</span>, <span class="keyword">false</span>);
00285     parmMap[<span class="stringliteral">"configuration.transport.tcpTransport.maximumReconnectInterval"</span>] =     <span class="comment">/*int*/</span> <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(<span class="stringliteral">"10000"</span>, <span class="keyword">false</span>);
00286     parmMap[<span class="stringliteral">"configuration.transport.tcpTransport.connectionTimeout"</span>] =            <span class="comment">/*int*/</span> <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(<span class="stringliteral">"-1"</span>, <span class="keyword">false</span>);
00287 
00288     parmMap[<span class="stringliteral">"configuration.console.consolePort"</span>] =           <span class="comment">/*int*/</span> <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(<span class="stringliteral">"40200"</span>, <span class="keyword">false</span>);
00289     parmMap[<span class="stringliteral">"configuration.console.consolePassword"</span>] =       <span class="comment">/*str*/</span> <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(NULL, <span class="keyword">false</span>);
00290 
00291     <span class="comment">/* let the following default: */</span>
00292     parmMap[<span class="stringliteral">"configuration.logging"</span>] =  <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(NULL, <span class="keyword">false</span>);
00293     parmMap[<span class="stringliteral">"configuration.logging.loggerAddress"</span>] =  <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(NULL, <span class="keyword">false</span>);
00294     parmMap[<span class="stringliteral">"configuration.logging.loggerPort"</span>] =  <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(NULL, <span class="keyword">false</span>);
00295 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="IPDRsim.cpp::loadMIB"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> loadMIB           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>clientH</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>MIBVersion</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>fileName</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Load the MIB from a file. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>clientH</em>&nbsp;</td><td>Exporter handle. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>MIBVersion</em>&nbsp;</td><td>The MIB version that we're using, for verifying a match or doing necessary conversions. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fileName</em>&nbsp;</td><td>Name of file to read from: empty or "" for do-nothing. </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00887 {
00888     <span class="keywordflow">if</span> (fileName &amp;&amp; 0 != strcmp(fileName, <span class="stringliteral">""</span>)) {
00889         ifstream in(fileName);
00890         <span class="keywordflow">if</span> (! in) {
00891             cerr &lt;&lt; <span class="stringliteral">"*** loadMIB("</span> &lt;&lt; fileName &lt;&lt; <span class="stringliteral">"): could not open"</span> &lt;&lt; endl;
00892             <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a180">IPDR_ERR</a>;
00893         }
00894 
00895         {
00896             string versionLine;
00897             getline(in, versionLine);
00898             <span class="comment">// We should check that MIBversion matches ...</span>
00899         }
00900 
00901         <span class="keywordflow">while</span> (! in.eof()) {
00902             string line;
00903             getline(in, line);
00904             <span class="keywordflow">if</span> (! line.empty()) {
00905                 <span class="comment">// The line is: OID name type value</span>
00906                 <span class="comment">// separated by tabs</span>
00907                 string::size_type t1pos = line.find(<span class="charliteral">'\t'</span>, 0);
00908                 string::size_type t2pos = line.find(<span class="charliteral">'\t'</span>, t1pos+1);
00909                 string::size_type t3pos = line.find(<span class="charliteral">'\t'</span>, t2pos+1);
00910 
00911                 string oidStr = line.substr(0, t1pos);
00912                 string name = line.substr(t1pos+1, t2pos-t1pos-1);
00913                 string type = line.substr(t2pos+1, t3pos-t2pos-1);
00914                 string value = line.substr(t3pos+1);
00915 
00916                 <span class="comment">// We could use either oidStr or name: we use name, in</span>
00917                 <span class="comment">// case OID numbers have changed.</span>
00918 
00919                 <span class="comment">/*IPDR_Status rc = IPDR_MIBRestoreNodeByName(clientH, name.c_str(),</span>
00920 <span class="comment">                                                             atoi(type.c_str()),</span>
00921 <span class="comment">                                                             value.c_str(), NULL);</span>
00922 <span class="comment">                if (FAILURE(rc)) {</span>
00923 <span class="comment">                    cerr &lt;&lt; "FAILED load: " &lt;&lt;</span>
00924 <span class="comment">                        " OID(" &lt;&lt; oidStr &lt;&lt; ")" &lt;&lt;</span>
00925 <span class="comment">                        " name(" &lt;&lt; name &lt;&lt; ")" &lt;&lt;</span>
00926 <span class="comment">                        " type(" &lt;&lt; type &lt;&lt; ")" &lt;&lt;</span>
00927 <span class="comment">                        " value(" &lt;&lt; value &lt;&lt; "): " &lt;&lt;</span>
00928 <span class="comment">                        IPDR_StatusMsg(clientH, rc) &lt;&lt; endl;</span>
00929 <span class="comment">                    return rc;</span>
00930 <span class="comment">                }*/</span>
00931             }
00932         }
00933     }
00934     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00935 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a31" doxytag="IPDRsim.cpp::loadMIBcallback"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> loadMIBcallback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>clientH</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>MIBVersion</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>contextArg</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Callback for loading the MIB during initialization. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>clientH</em>&nbsp;</td><td>Exporter handle. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>MIBVersion</em>&nbsp;</td><td>The MIB's version. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>contextArg</em>&nbsp;</td><td>The context argument as provided to IPDR_InitiExporter(): name of file to read from: empty or "" for do-nothing. </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00946 {
00947     <span class="keyword">const</span> <span class="keywordtype">char</span>* fileName = reinterpret_cast&lt;const char*&gt;(contextArg);
00948     <span class="keywordflow">return</span> <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a30">loadMIB</a>(clientH, MIBVersion, fileName);
00949 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="IPDRsim.cpp::logOutputCallback"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void logOutputCallback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../dc/d9b/group___i_p_d_r__logging.html#ga8">IPDR_DebugLevel</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>level</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>levelStr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>clientName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>module</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>func</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The callback for outputting log messages (registered by IPDR_SetLogOutput()). This simply outputs a message to stderr. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>level</em>&nbsp;</td><td>The numeric value for the error level of this message </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>levelStr</em>&nbsp;</td><td>A C-string which relates to the error level </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>clientName</em>&nbsp;</td><td>The client's (transmitter's) name (C-string), as given to <a class="el" href="../../d3/d96/group___i_p_d_r__initialization__starting__deletion.html#ga6">IPDR_InitExporter()</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>module</em>&nbsp;</td><td>The module that generated this message "(Exporter" (transmitter), "Platform", "TCP", etc.) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>func</em>&nbsp;</td><td>The function within the module that generated this message </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>msg</em>&nbsp;</td><td>The message for outputting to the log </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>The context for this callback, as passed to IPDR_SetLogOutput(): pointer to a IPDR_ExporterHandle </td></tr>
  </table>
</dl>
<dl compact><dt><b>See also:</b></dt><dd>IPDR_SetLogOutput </dd></dl>
<div class="fragment"><pre class="fragment">00371 {
00372     <a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a> *clientH = static_cast&lt;IPDR_ExporterHandle *&gt;(context);
00373         <span class="keywordtype">char</span> timeStrBuf[<a class="code" href="../../d5/d74/group___i_p_d_r__time__services.html#ga16">IPDR_TIME_FORMAT_LENGTH</a> + 1];
00374     <span class="keywordtype">char</span> line[500];
00375 
00376     sprintf(line, <span class="stringliteral">"%.30sZ %.7s &lt;%.40s&gt; {%-8s} %.99s: %.299s"</span>,
00377             <a class="code" href="../../d1/d24/group___i_p_d_r__platform__calls.html#ga10">IPDR_FormatTimeGMTNow</a>(*clientH, timeStrBuf),
00378             levelStr, clientName, module, func, msg);
00379     cerr &lt;&lt; line &lt;&lt; endl;
00380 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="IPDRsim.cpp::lookupRecByTemplateId"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static <a class="el" href="../../da/db3/class_record.html">Record</a>* lookupRecByTemplateId           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../da/db3/class_record.html">Record</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>rec</em>[], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>templateId</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Look in a vector of records for one with a specific ID. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>rec</em>&nbsp;</td><td>A vector of records, terminated by an entry with NULL. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>templateId</em>&nbsp;</td><td>the template ID to look up. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>pointer to the record if found; NULL if not found </dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="../../da/db3/class_record.html#a0">Record::templateId</a> </dd></dl>
<div class="fragment"><pre class="fragment">00342 {
00343     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; rec[i]; i++) {
00344         <span class="keywordflow">if</span> (rec[i]-&gt;templateId() == templateId) {
00345             <span class="keywordflow">return</span> rec[i];
00346         }
00347     }
00348     <span class="keywordflow">return</span> NULL;
00349 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a33" doxytag="IPDRsim.cpp::main"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int main           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *const &nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[]</td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The main program. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>argc</em>&nbsp;</td><td>The number of arguments + 1 for the program name </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>argv</em>&nbsp;</td><td>The arguments (<code>argv[0]</code> is the program name) </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Zero for success; non-zero for error. </dd></dl>
<div class="fragment"><pre class="fragment">01159 {
01160     <a class="code" href="../../d1/da6/class_xyz_fwd_record.html">XyzFwdRecord</a> XyzFwdRec;
01161     <a class="code" href="../../d2/d84/class_xyz_ack_record.html">XyzAckRecord</a> XyzAckRec;
01162     <a class="code" href="../../d8/d43/class_simple_record.html">SimpleRecord</a> simpleRec;
01163         <a class="code" href="../../d8/dbf/class_d_o_c_s_i_s_record.html">DOCSISRecord</a> docsisRec;
01164         <a class="code" href="../../d1/d8d/class_vo_i_p_record.html">VoIPRecord</a>      voipRecord;
01165 
01166     <a class="code" href="../../da/db3/class_record.html">Record</a>* rec[] = { &amp;XyzFwdRec, &amp;XyzAckRec, &amp;simpleRec, &amp;docsisRec, &amp;voipRecord, 0 };
01167     <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> rc;
01168 
01169     <span class="keywordtype">int</span> argvI = 1;
01170     <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a4">ParmMap_t</a> parmMap; <span class="comment">// The parameter values go here.</span>
01171 
01172     <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a14">initParmMap</a>(parmMap);
01173 
01174     <span class="keywordflow">if</span> (argvI &lt; argc &amp;&amp; argv[argvI][0] == <span class="charliteral">'-'</span>) {
01175         <span class="keywordflow">if</span> (0 == strcmp(argv[argvI], <span class="stringliteral">"-f"</span>)) { <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a3">fastFillFlag</a> = <span class="keyword">true</span>; }
01176         <span class="comment">/*else { return usage(argv[0]); }</span>
01177 <span class="comment">        argvI++;*/</span>
01178     }
01179 
01180     <span class="keyword">const</span> string recordFileName = <span class="comment">/*(argvI &lt; argc) ? argv[argvI++] :*/</span> <span class="stringliteral">""</span>;
01181     <span class="keyword">const</span> string configFileName = <span class="comment">/*(argvI &lt; argc) ? argv[argvI++] :*/</span> <span class="stringliteral">""</span>;
01182 
01183     <span class="keywordflow">for</span> (; argvI &lt; argc; argvI++) { <span class="comment">// get the over-riding parameters</span>
01184         <span class="keyword">const</span> <span class="keywordtype">char</span>* a = argv[argvI];
01185                 <span class="keywordflow">if</span> (a[0] == <span class="charliteral">'-'</span>) {
01186             <span class="keywordflow">if</span> (a[1] == <span class="charliteral">'\0'</span>) {
01187                 argvI++;
01188                 <span class="keywordflow">break</span>;
01189             }
01190                         <span class="keywordflow">else</span> {
01191                 cerr &lt;&lt; <span class="stringliteral">"Invalid option: \""</span> &lt;&lt; a &lt;&lt; <span class="stringliteral">"\""</span> &lt;&lt; endl;
01192             }
01193         } <span class="keywordflow">else</span> {
01194             <span class="keyword">const</span> <span class="keywordtype">char</span>* eqPtr = strchr(a, <span class="charliteral">'='</span>);
01195             <span class="keywordflow">if</span> (eqPtr) {
01196                 string key(a, eqPtr - a);
01197                 cerr &lt;&lt; <span class="stringliteral">"  parameter("</span> &lt;&lt; key &lt;&lt; <span class="stringliteral">") = \""</span> &lt;&lt; &amp;eqPtr[1] &lt;&lt; <span class="stringliteral">"\""</span> &lt;&lt; endl;
01198                 <span class="comment">// Depend on the args having been allocated already and</span>
01199                 <span class="comment">// not going away ... if of form name=value, then eqPtr</span>
01200                 <span class="comment">// points to "value", which is nicely null-terminated.</span>
01201                 parmMap[key] = <a class="code" href="../../da/d32/class_parm_value__t.html">ParmValue_t</a>(&amp;eqPtr[1], <span class="keyword">true</span>);
01202             } <span class="keywordflow">else</span> {
01203                 cerr &lt;&lt; <span class="stringliteral">"Invalid override argument: \""</span> &lt;&lt; a &lt;&lt; <span class="stringliteral">"\""</span> &lt;&lt; endl;
01204                 <span class="keywordflow">return</span> <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a27">usage</a>(argv[0]);
01205             }
01206         }
01207     }
01208 
01209     string cliCmdStr = <span class="stringliteral">""</span>;
01210 
01211     <span class="keywordflow">for</span> (; argvI &lt; argc; argvI++) { <span class="comment">// get the command</span>
01212         <span class="keywordflow">if</span> (cliCmdStr.empty()) {
01213             cliCmdStr = argv[argvI];
01214         } <span class="keywordflow">else</span> {
01215             cliCmdStr += string(<span class="stringliteral">" "</span>) + argv[argvI];
01216         }
01217     }
01218 
01219     ofstream *recordFile;
01220     <span class="keywordflow">if</span> (recordFileName.empty() || recordFileName.length() == 0) {
01221         recordFile = NULL;
01222     } <span class="keywordflow">else</span> {
01223         recordFile = <span class="keyword">new</span> ofstream(recordFileName.c_str());
01224         <span class="keywordflow">if</span> (! recordFile) {
01225             cerr &lt;&lt; <span class="stringliteral">"Cannot open file \""</span> &lt;&lt; recordFileName &lt;&lt; <span class="stringliteral">"\" for output"</span> &lt;&lt; endl;
01226             <span class="keywordflow">return</span> 1;
01227         }
01228     }
01229 
01230     cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"Platform Initialization (output to \""</span> &lt;&lt; recordFileName &lt;&lt; <span class="stringliteral">"\")..."</span> &lt;&lt;
01231         (<a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a3">fastFillFlag</a> ? <span class="stringliteral">" [fast fill]"</span> : <span class="stringliteral">""</span>) &lt;&lt;
01232         endl;
01233 
01234     <span class="comment">// intialize the platform services structure</span>
01235 
01236     <a class="code" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html">IPDR_PlatformServices</a> services;
01237 
01238     cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"Single-threaded (non-blocking I/O)"</span> &lt;&lt; endl;
01239     rc = <a class="code" href="../../d2/d52/_for_doxygen_2src_2_platforms_2_generic_2_generic_platform_8c.html#a54">GenericPlatform_Initialize</a>(&amp;services);
01240     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(rc)) {
01241         cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"Platform initialization failed: "</span> &lt;&lt; <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga22">IPDR_StatusMsg</a>(NULL, rc) &lt;&lt; endl;
01242         <span class="comment">//exit(1);</span>
01243     }
01244         
01245         rc = <a class="code" href="../../d4/db0/group___i_p_d_r__transmitter___m_i_b.html#ga3">IPDR_MIB_Start</a>(&amp;services);
01246         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(rc)) {
01247         cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"MIB initialization failed: "</span> &lt;&lt; <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga22">IPDR_StatusMsg</a>(NULL, rc) &lt;&lt; endl;
01248         <span class="comment">//exit(1);</span>
01249     }
01250 
01251     <span class="comment">// end of platform services initialization</span>
01252 
01253     <span class="comment">// initialize the IPDR client</span>
01254 
01255     <a class="code" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a> clientH = 0;
01256 
01257     <a class="code" href="../../d7/d79/struct_exporter_config_context__t.html">ExporterConfigContext_t</a> clientConfigContext = { &amp;parmMap, &amp;clientH };
01258 
01259     rc = <a class="code" href="../../d3/d96/group___i_p_d_r__initialization__starting__deletion.html#ga6">IPDR_InitExporter</a>(&amp;services,
01260                           <span class="stringliteral">"*"</span>, <span class="comment">// "IPDRsim",</span>
01261                           <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a15">clientConfig</a>,
01262                           &amp;clientConfigContext,
01263                           <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a31">loadMIBcallback</a>,
01264                           const_cast&lt;char*&gt;(configFileName.c_str()),
01265                           <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a29">saveMIBcallback</a>,
01266                           const_cast&lt;char*&gt;(configFileName.c_str()),
01267                           &amp;clientH);
01268     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(rc)) {
01269         cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"IPDR_InitExporter failed: "</span> &lt;&lt; <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga22">IPDR_StatusMsg</a>(clientH, rc) &lt;&lt; endl;
01270         <span class="comment">//exit(1);</span>
01271     }
01272         
01273         <span class="comment">//IPDR_MIB_SetExporterHandle(clientH);</span>
01274 
01275     rc = <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#ga5">IPDR_SetLogOutputCallbackDetailed</a>(clientH,
01276                                             <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a17">logOutputCallback</a>,
01277                                             &amp;clientH);
01278     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(rc)) {
01279         cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"IPDR_SetLogOuptutCallback2 failed: "</span> &lt;&lt; <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga22">IPDR_StatusMsg</a>(clientH, rc) &lt;&lt; endl;
01280         <span class="comment">//exit(1);</span>
01281     }
01282 
01283     <span class="comment">// The following logging values would be saved as part of</span>
01284     <span class="comment">// "mibsave", so if "mibload" is done, it will override any values</span>
01285     <span class="comment">// set here.</span>
01286 
01287     <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#ga2">IPDR_SetModuleMoreDebugLevel</a>(clientH, <span class="stringliteral">"Exporter"</span>,   <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga7a171">IPDR_LEVEL_INFO</a>);
01288     <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#ga2">IPDR_SetModuleMoreDebugLevel</a>(clientH, <span class="stringliteral">"Platform"</span>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga7a171">IPDR_LEVEL_INFO</a>);
01289     <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#ga2">IPDR_SetModuleMoreDebugLevel</a>(clientH, <span class="stringliteral">"TCP"</span>,      <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga7a171">IPDR_LEVEL_INFO</a>);
01290     <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#ga2">IPDR_SetModuleMoreDebugLevel</a>(clientH, <span class="stringliteral">"Host"</span>,     <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga7a171">IPDR_LEVEL_INFO</a>);
01291     <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#ga2">IPDR_SetModuleMoreDebugLevel</a>(clientH, <span class="stringliteral">"Queue"</span>,    <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga7a171">IPDR_LEVEL_INFO</a>);
01292     <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#ga2">IPDR_SetModuleMoreDebugLevel</a>(clientH, <span class="stringliteral">"Memory"</span>,   <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga7a171">IPDR_LEVEL_INFO</a>);
01293     <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#ga2">IPDR_SetModuleMoreDebugLevel</a>(clientH, <span class="stringliteral">"Protocol"</span>, <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga7a171">IPDR_LEVEL_INFO</a>); <span class="comment">// IPDR_LEVEL_WARNING); // INFO shows things like template change messages.</span>
01294     <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#ga2">IPDR_SetModuleMoreDebugLevel</a>(clientH, <span class="stringliteral">"JNI"</span>,      <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga7a167">IPDR_LEVEL_MUTE</a>); <span class="comment">// only on server</span>
01295     <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#ga2">IPDR_SetModuleMoreDebugLevel</a>(clientH, <span class="stringliteral">"SERVER"</span>,   <a class="code" href="../../dc/d9b/group___i_p_d_r__logging.html#gga7a167">IPDR_LEVEL_MUTE</a>); <span class="comment">// only on server</span>
01296 
01297     <a class="code" href="../../d1/dcc/group___i_p_d_r__templates.html#ga19">IPDR_SetTemplateChangedCallback</a>(clientH, <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a21">templatesChangedCB</a>, rec);
01298         <a class="code" href="../../d1/dcc/group___i_p_d_r__templates.html#ga20">IPDR_SetStartNegotiationCallback</a>(clientH, <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a19">enableStartNegotiationCB</a>, &amp;clientH);
01299     <a class="code" href="../../df/dd7/group___i_p_d_r__event__notification.html#ga5">IPDR_SetExporterEventHandlerDetailed</a>(clientH, <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a18">eventCallback</a>, &amp;clientH);
01300 
01301     <span class="keywordflow">if</span> (setjmp(<a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a2">stopJmpBuf</a>) == 0) {
01302         <span class="comment">// normal execution</span>
01303         <span class="keywordflow">if</span> (signal(SIGUSR1, <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a12">handle_SIGUSR1</a>) == SIG_IGN) {
01304             cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"SIGUSR1 was masked off ... leave it"</span> &lt;&lt; endl;
01305             signal(SIGUSR1, SIG_IGN); <span class="comment">// leave alone if already ignored</span>
01306         }
01307 
01308         <span class="comment">// We could create one or more sessions by the following, but instead we</span>
01309         <span class="comment">// depend on commands ("add_session") to do this for us:</span>
01310         <span class="comment">//   IPDR_SessionHandle sessionH;</span>
01311         <span class="comment">//   rc = IPDR_CreateSession(clientH, "session1", sessionID, "NE/one", &amp;sessionH);</span>
01312 
01313         <span class="comment">// We could add servers (collectors) to each session by the following, but</span>
01314         <span class="comment">// instead we depend on commands ("add_server") to do this for</span>
01315         <span class="comment">// us:</span>
01316         <span class="comment">//   rc = IPDR_AddCollector(clientH, serverName, serverIPnum, serverPort, numOfConnections);</span>
01317 
01318         <span class="comment">// Normally, we'd add templates here to the session but</span>
01319         <span class="comment">// instead they're done by commands. See the cmdTemplate()</span>
01320         <span class="comment">// function.</span>
01321         <span class="comment">//   rc = IPDR_CreateTemplate(clientH, templateId, templateDesc, numKeys, keys, &amp;templateH);</span>
01322 
01323         <span class="comment">// And then we'd start the client; but again, that's done by a</span>
01324         <span class="comment">// command:</span>
01325         <span class="comment">//   rc = IPDR_StartExporter(clientH);</span>
01326 
01327         <span class="comment">// And then we'd send data; but that's also done by a command:</span>
01328         <span class="comment">//   rc = IPDR_SendData(clientH, record.templateH, &amp;record);</span>
01329 
01330         <span class="comment">// And finally we'd drain; but that's also done by a command:</span>
01331         <span class="comment">//   rc = IPDR_DrainQueue(clientH, sessionH, millisec);</span>
01332 
01333 
01334         <span class="comment">// ---------------------------------------------</span>
01335         <span class="comment">// Main loop, executing commands from command line or standard input.</span>
01336 
01337         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> recNum = 0;
01338         <span class="keywordtype">bool</span> end = <span class="keyword">false</span>;
01339 
01340         <span class="keywordflow">if</span> (!cliCmdStr.empty()) {
01341             cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"command from CLI: "</span> &lt;&lt; cliCmdStr &lt;&lt; endl;
01342             <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a32">executeCommand</a>(clientH, rec, recNum, recordFile, cliCmdStr, &amp;end);
01343         }
01344 
01345         <span class="keywordflow">while</span> (! end <span class="comment">/*&amp;&amp; ! cin.eof()*/</span>) {
01346             string cmd;
01347             getline(cin, cmd);
01348             <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a32">executeCommand</a>(clientH, rec, recNum, recordFile, cmd, &amp;end);
01349         }
01350 
01351         cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"Shutting down."</span> &lt;&lt; endl;
01352     } <span class="keywordflow">else</span> {
01353         <span class="comment">// longjmp here from signal handler</span>
01354         cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"Caught interrupt, cleaning up."</span> &lt;&lt; endl;
01355     }
01356 
01357     cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"..."</span> &lt;&lt; endl;
01358 
01359     <span class="comment">// Delete the client and remove the platform services.</span>
01360         
01361         <span class="comment">//IPDR_MIB_UnSetExporterHandle();</span>
01362 
01363     rc = <a class="code" href="../../d3/d96/group___i_p_d_r__initialization__starting__deletion.html#ga11">IPDR_DeleteExporter</a>(clientH);
01364     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(rc)) {
01365         cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"IPDR_DeleteExporter failed: "</span> &lt;&lt; <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga22">IPDR_StatusMsg</a>(clientH, rc) &lt;&lt; endl;
01366         <span class="comment">//exit(1);</span>
01367     }
01368         
01369         <a class="code" href="../../d4/db0/group___i_p_d_r__transmitter___m_i_b.html#ga4">IPDR_MIB_Stop</a>(&amp;services);
01370 
01371     rc = services.<a class="code" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html#o5">Delete</a>(services.<a class="code" href="../../dd/dc5/struct_i_p_d_r__tag___platform.html#o1">PlatformArg</a>);
01372     <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(rc)) {
01373         cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"Platform delete  failed: "</span> &lt;&lt; <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga22">IPDR_StatusMsg</a>(clientH, rc) &lt;&lt; endl;
01374         <span class="comment">//exit(1);</span>
01375     }
01376 
01377     <span class="keyword">delete</span> recordFile;
01378 
01379     cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"Finished at "</span> &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a10">nowStrX</a>() &lt;&lt; endl;
01380 
01381     <span class="keywordflow">return</span> 0;
01382 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="IPDRsim.cpp::nowStr"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void nowStr           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>size_t&nbsp;</td>
          <td class="mdname" nowrap> <em>bufSize</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Generate a C-string for the current time in ISO standard form. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>The buffer that will be filled with the date/time string (null-terminated) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>bufSize</em>&nbsp;</td><td>The buffer size </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00543 {
00544     time_t c = time(0);
00545     <span class="keyword">struct </span>tm tmMem;
00546     <span class="keyword">struct </span>tm* tmPtr = localtime_r(&amp;c, &amp;tmMem);
00547     strftime(buf, bufSize, <span class="stringliteral">"%Y-%m-%dT%H:%M:%S%Z"</span>, tmPtr);
00548 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="IPDRsim.cpp::nowStrX"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static string nowStrX           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Generate a string with the current time in ISO standard form. Uses an internal static value, so multiple calls to this function must <em>not</em> be done in a single statement. <dl compact><dt><b>Returns:</b></dt><dd>The ISO standard form string with the current date/time </dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="../../d1/dbf/ipdr_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a22">nowStr</a> </dd></dl>
<div class="fragment"><pre class="fragment">00558 {
00559     <span class="keyword">static</span> <span class="keywordtype">char</span> buf[100];
00560     <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a22">nowStr</a>(buf, <span class="keyword">sizeof</span> buf);
00561     <span class="keywordflow">return</span> string(buf);
00562 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="IPDRsim.cpp::outputPrefix"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static const string outputPrefix           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">"*** "&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
A string for prepending to output lines (to stderr), so they can be found easily amongst other outputs.     </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="IPDRsim.cpp::saveMIBcallback"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga11">IPDR_Status</a> saveMIBcallback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>clientH</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>MIBVersion</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>contextArg</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Callback for saving the MIB. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>clientH</em>&nbsp;</td><td>Exporter handle. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>MIBVersion</em>&nbsp;</td><td>The MIB's version. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>contextArg</em>&nbsp;</td><td>The context argument as provided to IPDR_InitiExporter(): name of file to write to -- if "" or NULL, nothing is done. </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00874 {
00875     <span class="keywordflow">return</span> <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#gga29a174">IPDR_OK</a>;
00876 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="IPDRsim.cpp::sendRecords"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">static void sendRecords           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../da/db3/class_record.html">Record</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>record</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned long &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>recNum</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../df/d71/struct_i_p_d_r__tag___exporter.html">IPDR_ExporterHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>clientH</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">IPDR_SessionHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>sessionH</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d4/dc8/struct_i_p_d_r__tag___template_handle.html">IPDR_TemplateHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>templateH</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>times</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>intvl</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>ostream *&nbsp;</td>
          <td class="mdname" nowrap> <em>ostr</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Send a batch of records, at a specified rate. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>record</em>&nbsp;</td><td>(updated) The record, which supports a "fill" method for putting data into it. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>recNum</em>&nbsp;</td><td>(updated) The record number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>clientH</em>&nbsp;</td><td>The client handle as set by <a class="el" href="../../d3/d96/group___i_p_d_r__initialization__starting__deletion.html#ga6">IPDR_InitExporter()</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sessionH</em>&nbsp;</td><td>The session handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>times</em>&nbsp;</td><td>The number of records to send (number of times to call <a class="el" href="../../dc/d8d/group___i_p_d_r__data__delivery.html#ga0">IPDR_SendData()</a>) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>intvl</em>&nbsp;</td><td>The interval between sends, in milliseconds: 0 means "as fast as possible" </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ostr</em>&nbsp;</td><td>Pointer to output stream for writing a CSV-form of the records that were sent via IPDR; can be NULL to prevent output. </td></tr>
  </table>
</dl>
<div class="fragment"><pre class="fragment">00601 {
00602     timespec nextSend;
00603     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> timesOrig = times;
00604     <span class="keywordtype">char</span> nowStrValue[40];
00605 
00606     <span class="keyword">static</span> <span class="keywordtype">int</span> thousand = 1000; <span class="comment">// for millisec</span>
00607     <span class="keyword">static</span> <span class="keywordtype">int</span> million = thousand * thousand; <span class="comment">// for microsecond or milliseconds in nanoseconds</span>
00608     <span class="keyword">static</span> <span class="keywordtype">int</span> billion = thousand * million; <span class="comment">// for nanoseconds</span>
00609 
00610     <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a22">nowStr</a>(nowStrValue, <span class="keyword">sizeof</span> nowStrValue);
00611 
00612     cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"+++ Sending "</span> &lt;&lt; times &lt;&lt; <span class="stringliteral">" records interval="</span> &lt;&lt; intvl &lt;&lt;
00613         <span class="stringliteral">" at "</span> &lt;&lt; nowStrValue &lt;&lt; <span class="stringliteral">" ..."</span> &lt;&lt; endl;
00614 
00615     <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a9">sendRateData</a>.numRecords = times;
00616     <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a9">sendRateData</a>.startTime = <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a11">getNowTime</a>();
00617     nextSend = <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a9">sendRateData</a>.startTime;
00618 
00619     <span class="keywordflow">for</span> (; times &gt; 0; times--) {
00620         timespec now = <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a11">getNowTime</a>();
00621 
00622         <span class="comment">// calculate how many milliseconds to sleep.</span>
00623 
00624         <span class="keywordflow">if</span> (intvl &gt; 0) {
00625             timespec sleepTime;
00626             sleepTime.tv_sec  = nextSend.tv_sec  - now.tv_sec;
00627             sleepTime.tv_nsec = nextSend.tv_nsec - now.tv_nsec;
00628             <span class="keywordflow">while</span> (sleepTime.tv_nsec &lt; 0)        { sleepTime.tv_nsec += billion; sleepTime.tv_sec -= 1; }
00629             <span class="keywordflow">while</span> (sleepTime.tv_nsec &gt;= billion) { sleepTime.tv_nsec -= billion; sleepTime.tv_sec += 1; }
00630 
00631             <span class="keywordtype">int</span> sleepDuration = sleepTime.tv_sec * thousand + sleepTime.tv_nsec / million;
00632 
00633             nextSend.tv_sec  += (intvl / thousand);
00634             nextSend.tv_nsec += ((intvl % thousand) * million);
00635             <span class="keywordflow">while</span> (nextSend.tv_nsec &lt; 0)        { nextSend.tv_nsec += billion; nextSend.tv_sec -= 1; }
00636             <span class="keywordflow">while</span> (nextSend.tv_nsec &gt;= billion) { nextSend.tv_nsec -= billion; nextSend.tv_sec += 1; }
00637 
00638             <a class="code" href="../../d1/d24/group___i_p_d_r__platform__calls.html#ga8">IPDR_SleepMS</a>(clientH, sleepDuration);
00639             <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a22">nowStr</a>(nowStrValue, <span class="keyword">sizeof</span> nowStrValue);
00640         }
00641 
00642         record.<a class="code" href="../../da/db3/class_record.html#a6">fill</a>(nowStrValue, 30 - (recNum % 30), recNum, now);
00643         recNum++;
00644 
00645         <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga0">IPDR_Status</a> rc = <a class="code" href="../../dc/d8d/group___i_p_d_r__data__delivery.html#ga0">IPDR_SendData</a>(clientH, sessionH, templateH, &amp;record);
00646         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8b/_for_doxygen_2include_2_i_p_d_r_2_i_p_d_r_8h.html#a18">FAILURE</a>(rc)) {
00647             cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"SendData failed: "</span> &lt;&lt; <a class="code" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga22">IPDR_StatusMsg</a>(clientH, rc) &lt;&lt; endl;
00648             cerr &lt;&lt; <span class="stringliteral">"    (Stopping with "</span> &lt;&lt; times &lt;&lt; <span class="stringliteral">" iterations left."</span> &lt;&lt; endl;
00649             <span class="keywordflow">break</span>;
00650         }
00651         <span class="keywordflow">if</span> (ostr) {
00652             record.<a class="code" href="../../da/db3/class_record.html#a7">printRec</a>(*ostr) &lt;&lt; endl;
00653         }
00654     }
00655 
00656     <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a9">sendRateData</a>.endSendingTime = <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a11">getNowTime</a>();
00657 
00658     <span class="keywordflow">if</span> (times != 0) {
00659         cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"finished sending "</span> &lt;&lt; (timesOrig - times) &lt;&lt;
00660             <span class="stringliteral">" records (didn't send "</span> &lt;&lt; times &lt;&lt; <span class="stringliteral">" of "</span> &lt;&lt; timesOrig &lt;&lt; <span class="stringliteral">")"</span>;
00661         <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a9">sendRateData</a>.numRecords -= times;
00662     } <span class="keywordflow">else</span> {
00663         cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"finished sending "</span> &lt;&lt; timesOrig &lt;&lt; <span class="stringliteral">" records"</span>;
00664     }
00665     cerr &lt;&lt; <span class="stringliteral">" records intvl="</span> &lt;&lt; intvl &lt;&lt; <span class="stringliteral">" at "</span> &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a10">nowStrX</a>() &lt;&lt; endl;
00666 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="IPDRsim.cpp::templatesChangedCB"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void templatesChangedCB           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d35/struct_i_p_d_r__tag___session.html">IPDR_SessionHandle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Session</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../df/d3e/struct_i_p_d_r___template.html">IPDR_Template</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>templates</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>numTemplates</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>context</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The callback for handling a template changed (registered by <a class="el" href="../../d1/dcc/group___i_p_d_r__templates.html#ga19">IPDR_SetTemplateChangedCallback()</a>). This simply outputs a message to stderr and continues to send the same information. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Session</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>templates</em>&nbsp;</td><td>Vector of changed templates. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>numTemplates</em>&nbsp;</td><td>The number of templates that were changed. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>context</em>&nbsp;</td><td>(unused) The context for this callback, as passed to <a class="el" href="../../d1/dcc/group___i_p_d_r__templates.html#ga19">IPDR_SetTemplateChangedCallback()</a>: a pointer to <a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga15">IPDR_ExporterHandle</a>. </td></tr>
  </table>
</dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="../../d1/dcc/group___i_p_d_r__templates.html#ga19">IPDR_SetTemplateChangedCallback</a> <p>
<a class="el" href="../../d1/dc2/group___i_p_d_r__general__typedefs.html#ga15">IPDR_ExporterHandle</a> </dd></dl>
<div class="fragment"><pre class="fragment">00494 {
00495     <span class="keywordtype">bool</span> SwitchStatus = <span class="keyword">true</span>;
00496     <a class="code" href="../../da/db3/class_record.html">Record</a>** rec = static_cast&lt;Record**&gt;(context);
00497     cerr &lt;&lt; <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a13">outputPrefix</a> &lt;&lt; <span class="stringliteral">"Entered templates changed callback"</span> &lt;&lt; endl;
00498     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; numTemplates; i++) {
00499         <span class="keyword">const</span> <a class="code" href="../../df/d3e/struct_i_p_d_r___template.html">IPDR_Template</a> &amp;tmpl = templates[i];
00500         <a class="code" href="../../da/db3/class_record.html">Record</a>* theRec = <a class="code" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a16">lookupRecByTemplateId</a>(rec, tmpl.<a class="code" href="../../df/d3e/struct_i_p_d_r___template.html#o0">TemplateID</a>);
00501         cerr &lt;&lt; <span class="stringliteral">"  Template ID = "</span> &lt;&lt; tmpl.<a class="code" href="../../df/d3e/struct_i_p_d_r___template.html#o0">TemplateID</a> &lt;&lt;
00502             <span class="stringliteral">", Schema Name = "</span> &lt;&lt; tmpl.<a class="code" href="../../df/d3e/struct_i_p_d_r___template.html#o1">SchemaName</a> &lt;&lt;
00503                         <span class="stringliteral">", Type Name = "</span> &lt;&lt; tmpl.<a class="code" href="../../df/d3e/struct_i_p_d_r___template.html#o2">TypeName</a> &lt;&lt; endl;
00504                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span>  j = 0; j &lt; tmpl.<a class="code" href="../../df/d3e/struct_i_p_d_r___template.html#o3">NumKeys</a>; j++)
00505                 {
00506                         <a class="code" href="../../d9/d12/struct_i_p_d_r___key.html">IPDR_Key</a> &amp;ky = tmpl.<a class="code" href="../../df/d3e/struct_i_p_d_r___template.html#o4">Keys</a>[j];
00507                         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; theRec-&gt;numKeys(); k++)
00508                         {
00509                                 <span class="keywordflow">if</span> (ky.<a class="code" href="../../d9/d12/struct_i_p_d_r___key.html#o0">KeyID</a> == theRec-&gt;<a class="code" href="../../da/db3/class_record.html#a2">keys</a>()[k].KeyID)
00510                                 {
00511                                         <span class="keywordflow">if</span>(ky.<a class="code" href="../../d9/d12/struct_i_p_d_r___key.html#o5">Enabled</a> != theRec-&gt;<a class="code" href="../../da/db3/class_record.html#a2">keys</a>()[k].Enabled)
00512                                         {
00513                                                 <span class="keywordflow">if</span>(SwitchStatus)
00514                                                 {
00515                                                         ky.<a class="code" href="../../d9/d12/struct_i_p_d_r___key.html#o5">Enabled</a> = !ky.<a class="code" href="../../d9/d12/struct_i_p_d_r___key.html#o5">Enabled</a>;
00516                                                         cerr &lt;&lt; <span class="stringliteral">"     changed to "</span> &lt;&lt;
00517                                                                                 ((ky.<a class="code" href="../../d9/d12/struct_i_p_d_r___key.html#o5">Enabled</a>) ? <span class="stringliteral">"disabled"</span> : <span class="stringliteral">"enabled "</span>) &lt;&lt;
00518                                                                                 <span class="stringliteral">" Key ID = "</span> &lt;&lt;  ky.<a class="code" href="../../d9/d12/struct_i_p_d_r___key.html#o0">KeyID</a> &lt;&lt;
00519                                                                                 <span class="stringliteral">", KeyName = "</span> &lt;&lt; ky.<a class="code" href="../../d9/d12/struct_i_p_d_r___key.html#o2">KeyName</a> &lt;&lt;
00520                                                                                 <span class="stringliteral">", KeyLabel = "</span> &lt;&lt; ky.<a class="code" href="../../d9/d12/struct_i_p_d_r___key.html#o3">KeyLabel</a> &lt;&lt;
00521                                                                                 <span class="stringliteral">", KeyHelp = "</span> &lt;&lt; ky.<a class="code" href="../../d9/d12/struct_i_p_d_r___key.html#o4">KeyHelp</a> &lt;&lt;
00522                                                                                 endl;
00523                                                         SwitchStatus = <span class="keyword">false</span>;
00524                                                 }
00525                                                 <span class="keywordflow">else</span>
00526                                                 {
00527                                                         SwitchStatus = true ;
00528                                                 }
00529                                                 <span class="keywordflow">break</span>;
00530                                         }
00531                                 }
00532                         }
00533         }
00534     }
00535 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="IPDRsim.cpp::usage"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int usage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>name</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Output usage information to stderr. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>A C-string with the program's name (<code>argv[0]</code> to <a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a33">main()</a>). </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>A non-zero value, so that you can write "&lt;code&gt;return usage(...)&lt;/code&gt;" </dd></dl>
<div class="fragment"><pre class="fragment">00823 {
00824     cerr &lt;&lt; <span class="stringliteral">"Usage: "</span> &lt;&lt; name &lt;&lt;
00825         <span class="stringliteral">" [-f] recordFile configFile [param=value] ... [ - command ]"</span> &lt;&lt; endl;
00826     <span class="keywordflow">return</span> 1;
00827 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a7" doxytag="IPDRsim.cpp::endSendingTime"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">timespec <a class="el" href="../../d1/dbf/ipdr_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a7">endSendingTime</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="IPDRsim.cpp::fastFillFlag"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">bool <a class="el" href="../../df/d1f/ipdr_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_templates_8cpp.html#a4">fastFillFlag</a> = false          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
A global flag for whether we're trying to fill the output records fast (all the same) or slowly (more variation in the fields).     </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="IPDRsim.cpp::IPDRsim_rcsid"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const char <a class="el" href="../../d1/dbf/ipdr_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a1">IPDRsim_rcsid</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment"> <span class="stringliteral">"@(#) $Id: IPDRsim.cpp,v 1.49 2005/03/29 09:46:07 dmitryk Exp $ "</span>
<span class="stringliteral">" Copyright (2005)  Amdocs, All Rights Reserved"</span>
<span class="stringliteral">"Compiled "</span> __DATE__ <span class="stringliteral">" "</span> __TIME__
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="IPDRsim.cpp::numRecords"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">long <a class="el" href="../../d1/dbf/ipdr_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a5">numRecords</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="IPDRsim.cpp::queueEmptyTime"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">timespec <a class="el" href="../../d1/dbf/ipdr_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a8">queueEmptyTime</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="IPDRsim.cpp::sendRateData"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">struct { ... }   <a class="el" href="../../d1/dbf/ipdr_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a9">sendRateData</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Data used for calculating data transfer rates (set by <a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a23">sendRecords()</a> and retrieved by <a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a18">eventCallback()</a>). It's a bit crude: it only really works if you do the "send" command immediately follwed by "drain 0".     </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="IPDRsim.cpp::startTime"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">timespec <a class="el" href="../../d1/dbf/ipdr_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a6">startTime</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="IPDRsim.cpp::stopJmpBuf"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">jmp_buf <a class="el" href="../../d1/dbf/ipdr_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a2">stopJmpBuf</a><code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The "bail-out" jump buffer (set by <code>setjmP</code>) and used by <a class="el" href="../../d7/def/_for_doxygen_2src_2_simulators_2_i_p_d_rsim_2_i_p_d_rsim_8cpp.html#a12">handle_SIGUSR1()</a>.     </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Mon Apr 25 09:26:32 2005 for IPDRAPI by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.2 </small></address>
</body>
</html>
